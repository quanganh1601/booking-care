(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9394],{50333:function(t){!function(){"use strict";t.exports=".product-combo .ant-table-wrapper{margin-top:10px}.product-combo .ant-table-wrapper .ant-table-header{padding-right:0}.product-combo .ant-table-wrapper .ant-table-body{min-height:calc(100vh - 212px)}.product-combo .ant-table-wrapper .ant-table-body .ant-table-row{cursor:pointer}.ant-popover{width:50%}.export-combo-popover{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.modal-updating .ant-modal-body{display:flex;flex-direction:column;align-items:center}.modal-updating .ant-modal-body .updating-info{width:100%;height:300px;display:flex;flex-direction:column;border:1px solid #d9d9d9;border-radius:2px;margin-top:10px;padding:10px;font-size:14px;overflow:auto}.modal-updating .ant-modal-body .updating-info .success{color:#00a854}.modal-updating .ant-modal-body .updating-info .fail{color:#f04134}.combo-info-import-modal .ant-modal-body{padding:16px 20px}.content-export-combo{display:grid}.content-export-combo .ant-checkbox-wrapper{border-bottom:1px dashed #d9d9d9;padding-bottom:5px}"}()},45812:function(t,e,o){"use strict";var n=o(65400),r=o(74806),a=o(67294),c=o(54549),i=o(74298),s=a.createElement;e.Z=function(t){var e=t.loadingData,o=t.selectedLength,a=t.total,l=t.onClick;return 0!=o||e?s(n.default,{onClick:l},e&&s(r.default,{type:"circle",percent:Math.round(o/(a||1)*100),width:18,strokeWidth:16,format:function(){return null},style:{marginRight:4}}),s("b",null,o),"\xa0",i.ZP.t("pages.shop.order.selectedOrder"),"  ",s(c.Z,null)):null}},74229:function(t,e,o){"use strict";var n=o(89552),r=o(67294),a=o(7085),c=r.createElement;e.Z=function(){return c("div",{className:"spinner"},c(n.default,{indicator:c(a.Z,{style:{fontSize:40}})}))}},65644:function(t,e,o){"use strict";var n=o(74047),r=o(52700),a=o(4706),c=o(33814),i=o(44102),s=o(20775),l=o(26265),p=o(67294),u=o(14494),d=o(36934),m=p.createElement;function f(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function h(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?f(Object(o),!0).forEach((function(e){(0,l.Z)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function b(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=(0,s.Z)(t);if(e){var r=(0,s.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,i.Z)(this,o)}}var g=function(t){(0,c.Z)(o,t);var e=b(o);function o(t){var r;return(0,n.Z)(this,o),r=e.call(this,t),(0,l.Z)((0,a.Z)(r),"listenMeronpan",(function(){var t=r.props,e=t.extension,o=t.dispatch;null==e&&(r.unlistenMeronpan(),window.addEventListener("message",r.listenMeronpanHandler.bind((0,a.Z)(r),o)),window.postMessage({type:"CHECK_EXTENSION_VERSION",from:"WEBPAGE"},"*"),window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*"))})),(0,l.Z)((0,a.Z)(r),"listenMeronpanHandler",(function(t,e){if("WEBPAGE"!=e.data.from)switch(e.data.type){case"EXTENSION_LOADED":window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*");break;case"REPORT_EXTENSION_STATUS":t((0,d.GoT)(e.data.connectionStatus));break;case"EXTENSION_VERSION":t((0,d.HfQ)(e.data.version))}})),(0,l.Z)((0,a.Z)(r),"unlistenMeronpan",(function(){window.removeEventListener("message",r.listenMeronpanHandler)})),r}return(0,r.Z)(o,[{key:"componentWillUnmount",value:function(){this.unlistenMeronpan()}},{key:"componentDidMount",value:function(){this.listenMeronpan()}},{key:"render",value:function(){var t=this.props,e=t.className,o=t.children,n=t.onScroll,r=t.style,a=t.top,c=t.height;return m("div",{id:"container-layout",onScroll:n,style:this.props.fullScreen?h(h(h({},y),r),{},{top:0,height:"calc(100%)"}):h(h(h({},y),r),{},{top:a||49,height:c||"calc(100% - ".concat(a||49,"px)")}),className:"__container-layout ".concat(e||"")},o)}}]),o}(p.Component),y={overflowY:"overlay",overflowX:"hidden",position:"absolute",height:"calc(100% - 49px)",width:"100%",padding:"10px 0",top:49,left:0};e.Z=(0,u.$j)((function(t){return{fullScreen:t.navigation.fullScreen,extension:t.shop.extension}}),null)(g)},9061:function(t,e,o){"use strict";o.r(e),o.d(e,{default:function(){return Ct}});var n,r=o(51024),a=o(56697),c=o(59361),i=o(74047),s=o(52700),l=o(4706),p=o(33814),u=o(44102),d=o(20775),m=o(26265),f=o(23279),h=o.n(f),b=o(50361),g=o.n(b),y=o(67294),v=o(22353),_=o(49101),x=o(25592),I=o(73171),w=o(76570),S=o(83049),C=o(31731),Z=o(74229),E=o(23177),O=o(28465),k=o(4863),D=o(65400),P=o(74806),R=o(809),j=o.n(R),N=o(92447),T=o(87217),F=o(7085),L=o(84189),z=o(79508),B=o(48176),M=o(22318),A=o(30381),V=o.n(A),K=o(95213),q=o(9669),H=o.n(q),X=o(89539),G=y.createElement;function U(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Q(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?U(Object(o),!0).forEach((function(e){(0,m.Z)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):U(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function Y(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,u.Z)(this,o)}}var W,J=(0,T.Z)()(n=function(t){(0,p.Z)(o,t);var e=Y(o);function o(t){var n;return(0,i.Z)(this,o),n=e.call(this,t),(0,m.Z)((0,l.Z)(n),"onDrop",(function(t){var e=t.file;n.setState({selectedFile:e,fileName:e.name});var o=n.props.t,r=new FileReader;r.readAsBinaryString(e),r.onload=function(t){var e=t.target.result,r=XLSX.read(e,{type:"binary"}),a=r.SheetNames[0],c=XLSX.utils.sheet_to_json(r.Sheets[a],{raw:!0,defval:null});if(0!=c.length){var i=[];c.map((function(t,e){var o=Object.keys(t),n=Object.values(t),r=0;n.map((function(t){t||r++})),r!=n.length&&o.map((function(t,o){var r=n[o];""!=r&&(i[e]||(i[e]={}),i[e]=Q(Q({},i[e]),{},(0,m.Z)({},t.trim(),r)))}))})),n.setState({combos:i})}else n.setState({selectedFile:!1,fileName:null}),M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.empty"))}})),(0,m.Z)((0,l.Z)(n),"handleImport",(function(t){var e=n.state.combos;n.customizeComboFromExcel(t,e)})),(0,m.Z)((0,l.Z)(n),"customizeComboFromExcel",(function(t,e){var o=n.props.t,r=[];if(!e[0][o("pages.shop.product.combo.nameCombo")])return M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.falseCompareToSample"));var a=e[0][o("pages.shop.product.combo.nameCombo")],c=-1;e.forEach((function(e){var n=e[o("components.comboInfoImportExcel.discountCombo")]||0,i=e[o("pages.shop.product.combo.discountByPercent")]||0,s=e[o("components.productPromotionDetail.maxPromotion")]||0,l=null,p=null;if(!(0,X.isNumber)(n)&&!(0,X.isNumber)(i)&&!(0,X.isNumber)(s)&&(!e[o("systemLogs.quantity")]||!(0,X.isNumber)(e[o("systemLogs.quantity")])))return M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.falseFormatFields"));if(e[o("pages.shop.product.combo.nameCombo")]){if(a=e[o("pages.shop.product.combo.nameCombo")],c++,e[o("pages.shop.statistic.statisticItem.time")])try{var u=e[o("pages.shop.statistic.statisticItem.time")].split("-"),d=u[0].trim().split("/"),m=u[1].trim().split("/");l=new Date(d[2],d[1]-1,d[0],"00","00","00"),p=new Date(m[2],m[1]-1,m[0],"23","59","59")}catch(h){return M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.falseFormatDateTime"))}if(l&&p&&V()(l).unix()>=V()(p).unix())return M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.falseFormatDateTime"));var f=[];e[o("components.productComboDetail.productId")]&&e[o("systemLogs.quantity")]&&f.push({product_id:e[o("components.productComboDetail.productId")].toString(),variation_id:e[o("components.productComboDetail.variationId")]?e[o("components.productComboDetail.variationId")].toString():null,count:e[o("systemLogs.quantity")]}),r.push({name:a,shop_id:t,is_free_shipping:!1,discount_amount:n,discount_by_percent:100*i,max_discount_by_percent:s,is_use_percent:!e[o("components.comboInfoImportExcel.discountCombo")]&&!!e[o("pages.shop.product.combo.discountByPercent")],start_time:l?V()(l).unix():l,end_time:p?V()(p).unix():p,variation:f})}else-1!=c&&e[o("components.productComboDetail.productId")]&&e[o("systemLogs.quantity")]&&r[c].variation.push({product_id:e[o("components.productComboDetail.productId")].toString(),variation_id:e[o("components.productComboDetail.variationId")]?e[o("components.productComboDetail.variationId")].toString():null,count:e[o("systemLogs.quantity")]})}));var i=!1;if(r.length>0&&r.forEach((function(t){if(t.variation.length>1){t.variation.forEach((function(t){t.count&&(0,X.isNumber)(t.count)||(i=!0)}));for(var e=t.variation[0].variation_id?1:0,o=t.variation[0].product_id,n=1;n<t.variation.length;n++)e==(t.variation[n].variation_id?0:1)&&(i=!0),1==e&&t.variation[0].variation_id==t.variation[n].variation_id&&o&&o==t.variation[n].product_id&&(i=!0),0==e&&o&&o==t.variation[n].product_id&&(i=!0)}})),i)return M.Z.error(o("components.comboInfoImportExcel.errorImportFile"),o("components.comboInfoImportExcel.falseFormatFields"));r.length>0&&r.forEach((function(t){t.variation.length>0&&null==t.variation[0].variation_id?t.is_variation=!1:t.is_variation=!0})),n.setState({data:r,isUpdating:!0},(function(){return setTimeout((function(){return n.sendRequest(0)}))}))})),(0,m.Z)((0,l.Z)(n),"sendRequest",function(){var t=(0,N.Z)(j().mark((function t(e){var o,r,a,c,i,s,l,p,u,d,m,f;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e>0&&n.scrollUpdatingInfo(),o=n.props,r=o.accessToken,a=o.shopId,c=o.t,i=n.state.data,s=i[e],l="".concat((0,K.LpH)(),"/shops/").concat(a,"/combo_products?access_token=").concat(r),p=function(t,e,o,r){var a=n.state.updatingInfo;a.push({comboId:r,message:e,success:t}),n.setState({updatingInfo:a}),r+1<o.length?n.sendRequest(r+1):n.props.fetchComboProduct()},t.next=8,H().post(l,{combo_product:s});case 8:if(!(u=t.sent).data.success){t.next=35;break}if(0!=s.variation.length){t.next=14;break}return t.abrupt("return",p(!0,c("components.comboInfoImportExcel.successInsertCombo"),i,e));case 14:if(!u.data.data){t.next=32;break}return d="".concat((0,K.LpH)(),"/shops/").concat(a,"/combo_products/").concat(u.data.data.id,"/create_from_excel?access_token=").concat(r),t.next=18,H().post(d,{combo_product_variation:s.variation});case 18:if(!(m=t.sent)){t.next=29;break}if(!m.data.success){t.next=24;break}return t.abrupt("return",p(!0,c("components.comboInfoImportExcel.successInsertCombo"),i,e));case 24:return t.next=26,n.props.deleteCombosFromExcel(r,a,{combo_ids:[m.data.combo_product_id]},!0);case 26:return t.abrupt("return",p(!1,c("components.comboInfoImportExcel.errorInsertCombo"),i,e));case 27:t.next=30;break;case 29:return t.abrupt("return",p(!1,c("components.comboInfoImportExcel.errorInsertCombo"),i,e));case 30:t.next=33;break;case 32:return t.abrupt("return",p(!1,c("components.comboInfoImportExcel.errorInsertCombo"),i,e));case 33:t.next=36;break;case 35:return t.abrupt("return",p(!1,(null===u||void 0===u||null===(f=u.data)||void 0===f?void 0:f.message)||c("components.comboInfoImportExcel.errorInsertCombo"),i,e));case 36:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,m.Z)((0,l.Z)(n),"renderResults",(function(){var t=n.state,e=t.updatingInfo,o=t.data,r=n.props.t,a=e.filter((function(t){return 1==t.success})).length,c=e.filter((function(t){return 0==t.success})).length;return G("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},G(P.default,{type:"circle",percent:Math.floor(100*e.length/o.length)}),e.length==o.length?G("h4",null,G("span",{style:{color:"#00a854"}},"".concat(r("updateSuccess")," ").concat(a," ").concat(r("components.comboInfoImportExcel.combo"))),G("span",{style:{color:"#f04134"}},"".concat(c>0?", ".concat(r("pages.admin.failure")," ").concat(c," ").concat(r("components.comboInfoImportExcel.combo")):""))):G("div",null,G("h4",{style:{color:"#096dd9"}},G(F.Z,null)," ","".concat(r("components.comboInfoImportExcel.updatingCombo"),"..."))),G("div",{id:"updating-combo-from-excel",className:"updating-info"},e.map((function(t,e){if(null!=t.success)return G("div",{key:e},G("span",null,G("strong",{className:t.success?"success":"fail"},"#".concat(t.comboId+1))),"\xa0",G("span",{className:t.success?"success":"fail"},t.message))}))))})),n.state={modalVisible:!1,combos:[],isUpdating:!1,data:[],updatingInfo:[]},n}return(0,s.Z)(o,[{key:"scrollUpdatingInfo",value:function(){var t=document.getElementById("updating-combo-from-excel");t.scrollTop=t.scrollHeight}},{key:"render",value:function(){var t=this,e=this.state,o=e.modalVisible,n=e.fileName,r=e.isUpdating,c=this.props,i=c.shopId,s=c.t,l=c.i18n;return G("div",{style:{display:"inline"}},G(C.Z,{title:s("components.comboInfoImportExcel.importComboFromExcel"),icon:G(L.Z,null),onClick:function(){return t.setState({modalVisible:!0})},isButton:!0}),o&&G(a.Z,{footer:G("div",null,G(D.default,{type:"primary",onClick:function(){r?t.setState({modalVisible:!1,isUpdating:!1}):t.handleImport(i)},disabled:!this.state.selectedFile},s(r?"close":"start"))),wrapClassName:"update-combo-excel ".concat(r&&"modal-updating"),title:s(r?"components.comboInfoImportExcel.updatingCombo":"components.comboInfoImportExcel.importFileExcelToCreateCombo"),visible:o,width:800,onCancel:function(){t.setState({modalVisible:!1,updatingInfo:[],isUpdating:!1})},destroyOnClose:!0,maskClosable:!1},!r&&G("div",null,G("div",{style:{marginTop:20,marginBottom:15,borderBottom:"1px solid #d9d9d9"}},G("div",null,G(k.default,{message:s("notes"),description:G("div",{style:{fontSize:14}},G("p",null,"- ","".concat(s("components.comboInfoImportExcel.comboMustHaveName"))),G("p",null,"- ","".concat(s("components.comboInfoImportExcel.onlyDiscountOrDiscountByPercent"))),G("p",null,"- ","".concat(s("components.comboInfoImportExcel.existFieldAboutProduct")))),type:"warning",showIcon:!0})),G("div",{style:{marginTop:10}},G("b",null,s("components.comboInfoImportExcel.sampleFileByOutputFile")," (",G("a",{target:"_blank",href:"vi"==l.language?"/static/files/import_combos.xlsx":"/static/files/import_combos_en.xlsx"},s("components.comboInfoImportExcel.sampleFile")),")"))),G("div",null,G("b",{style:{marginRight:10}},s("components.comboInfoImportExcel.chooseFile")),G(O.Z,{accept:".xlsx",showUploadList:!1,multiple:!1,customRequest:this.onDrop.bind(this)},G(D.default,{style:{width:"100%"}},n?G("span",null,G(z.Z,null)," ",n):G("span",null,G(B.Z,null)," ",s("components.comboInfoImportExcel.selectFile")))))),r&&this.renderResults()))}}]),o}(y.Component))||n,$=o(65644),tt=o(92902),et=o(50333),ot=o.n(et),nt=o(14494),rt=o(31432),at=o(36934),ct=o(62443),it=o(31059),st=o(28140),lt=o(78598),pt=o(90631),ut=y.createElement;function dt(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function mt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?dt(Object(o),!0).forEach((function(e){(0,m.Z)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):dt(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function ft(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,u.Z)(this,o)}}var ht=(0,T.Z)()(W=function(t){(0,p.Z)(o,t);var e=ft(o);function o(t){var n;return(0,i.Z)(this,o),n=e.call(this,t),(0,m.Z)((0,l.Z)(n),"componentDidMount",(function(){var t=n.props.shopId,e=!!localStorage["is_remain_qty_combos_".concat(t)]&&JSON.parse(localStorage.getItem("is_remain_qty_combos_".concat(t)));n.setState({isRemainQtyCombos:e})})),(0,m.Z)((0,l.Z)(n),"handleFetchData",(0,N.Z)(j().mark((function t(){var e,o,r,a,c,i,s;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.setState({isDownloading:!0,listCombo:[]}),e=n.props,o=e.accessToken,r=e.shopId,e.t,a=e.selectedRowKeys,c={page:1,page_size:30,selectedRowKeys:a},i=[],s="".concat((0,K.LpH)(),"/shops/").concat(r,"/export_combo_products?access_token=").concat(o),function t(e){return H().post(s,mt({},e)).then((function(o){if(o.data.success){var n=o.data.data;return i=i.concat(n),o.data.total_entries==i.length?i:(e.page=e.page+1,t(e))}return i})).catch(K.s0o)}(c).then((function(t){(null===t||void 0===t?void 0:t.length)>0?n.setState({listCombo:t,isDownloading:!1},(function(){return n.handleExportExcel()})):n.setState({isDownloading:!1})}));case 7:case"end":return t.stop()}}),t)})))),(0,m.Z)((0,l.Z)(n),"columns",(function(){var t=n.props.t;return[{header:"STT",key:"stt",width:10},{header:"ID",key:"id",width:10},{header:[t("pages.shop.product.combo.nameCombo")],key:"name_combo",width:20},{header:[t("pages.shop.product.combo.typeCombo")],key:"type_combo",width:20},{header:[t("pages.shop.product.combo.freeShip")],key:"freeship",width:15},{header:[t("pages.shop.product.combo.discountByPercent")],key:"discount_by_percent",width:15},{header:[t("pages.shop.product.combo.maxDiscountByPercent")],key:"max_discount_by_percent",width:20},{header:"Gi\xe1 nh\u1eadp cu\u1ed1i",key:"last_imported_price",width:20},{header:"Gi\xe1 b\xe1n",key:"retail_price",width:20},{header:"Gi\u1ea3m gi\xe1 Combo",key:"discount",width:20},{header:"Gi\xe1 sau chi\u1ebft kh\u1ea5u",key:"retail_price_after_discount",width:20},{header:[t("pages.shop.product.combo.insertedAt")],key:"inserted_at",width:20},{header:[t("pages.shop.product.combo.updatedAt")],key:"updated_at",width:20},{header:"Th\u1eddi gian",key:"range_time",width:20},{header:[t("pages.shop.product.combo.nameProduct")],key:"name_product",width:15},{header:"M\xe3 SP",key:"product_id",width:15},{header:"M\xe3 m\u1eabu",key:"variation_id",width:15},{header:"S\u1ed1 l\u01b0\u1ee3ng",key:"quantity",width:25}]})),(0,m.Z)((0,l.Z)(n),"handleExportExcel",(function(){var t=n.state,e=t.listCombo,o=t.isRemainQtyCombos,r=n.props,a=r.t,c=r.timezone,i=r.warehouses,s=new ExcelJS.Workbook,l=s.addWorksheet("My Sheet"),p=(0,st.Z)(n.columns());return o&&i.map((function(t){return p.push({header:"".concat(t.name," (").concat(a("components.productSearchBar.remain"),")"),key:t.id,width:15})})),l.columns=p,e.map((function(t,e){t.variations=0==t.variations.length?[null]:t.variations,t.variations.map((function(r,s){var p={stt:s?null:e+1,id:s?null:t.id,name_combo:s?null:t.name,type_combo:s?null:t.is_categories?a("components.productComboDetail.categories"):t.is_variation?a("pages.shop.product.combo.variation"):a("products.title"),freeship:s?null:t.is_free_shipping?"C\xf3":"Kh\xf4ng",last_imported_price:1==t.variations.length&&r?r.last_imported_price:null,retail_price:1==t.variations.length&&r?r.retail_price:null,retail_price_after_discount:1==t.variations.length&&r?r.retail_price-t.discount_amount:null,discount:s?null:t.discount_amount,discount_by_percent:s?null:"".concat(t.discount_by_percent," %"),max_discount_by_percent:s?null:(0,K.ufS)(t.max_discount_by_percent,n.props.currentShop.currency),inserted_at:s?null:(0,K.o0x)(c,t.inserted_at,!0),updated_at:s?null:(0,K.o0x)(c,t.updated_at,!0),range_time:!s&&t.start_time&&t.end_time?"".concat((0,K.o0x)(c,t.start_time,null,"DD/MM/YYYY"),"-").concat((0,K.o0x)(c,t.end_time,null,"DD/MM/YYYY")):null,name_product:(null===r||void 0===r?void 0:r.product.name)||null,product_id:(null===r||void 0===r?void 0:r.product.custom_id)||(null===r||void 0===r?void 0:r.product.display_id)||null,variation_id:r?r.custom_id||r.display_id:null,quantity:(null===r||void 0===r?void 0:r.count)||null};o&&i.map((function(e){var o=t.is_categories?t:r?(0,K.wOI)(t,e.id):null;p=mt(mt({},p),{},(0,m.Z)({},e.id,s||!o||o.is_categories?null:(null===o||void 0===o?void 0:o.quantity_can_be_activated)||0))})),l.addRow(p)}))})),l.getRow(1).font={size:12,bold:!0},s.xlsx.writeBuffer().then((function(t){(0,lt.saveAs)(new Blob([t],{type:"application/octet-stream"}),"Export_combo.xlsx")}))})),(0,m.Z)((0,l.Z)(n),"content",(function(){var t=n.props,e=t.selectedRowKeys,o=t.t,r=n.state,a=r.isDownloading,c=r.isRemainQtyCombos;return ut("div",{className:"content-export-combo"},ut(it.default,{checked:c,onChange:n.onChangeRemainQtyCombos},o("pages.shop.product.combo.remainQtyCombos")),ut(D.default,{type:"primary",style:{marginTop:10,borderRadius:2},icon:ut(a?F.Z:pt.Z,null),onClick:n.handleFetchData,disabled:a},(null===e||void 0===e?void 0:e.length)>0?"".concat(o("pages.shop.product.export.download")," ").concat(e.length," combo"):o("pages.shop.product.export.downloadAllCombo")))})),(0,m.Z)((0,l.Z)(n),"onChangeRemainQtyCombos",(function(t){var e=n.props.shopId,o=t.target.checked;n.setState({isRemainQtyCombos:o},(function(){return localStorage.setItem("is_remain_qty_combos_".concat(e),JSON.stringify(o))}))})),n.state={listCombo:[],isDownloading:!1,isRemainQtyCombos:!1},n}return(0,s.Z)(o,[{key:"render",value:function(){var t=this.props.t;return ut("div",{style:{display:"inline"}},ut(ct.default,{title:t("pages.shop.product.export.exportComboExcel"),content:this.content(),trigger:"click",overlayClassName:"export-combo-popover"},ut(C.Z,{title:t("pages.shop.product.export.exportToExcel"),icon:ut(pt.Z,null),isButton:!0})))}}]),o}(y.Component))||W,bt=(0,nt.$j)((function(t){return{currentShop:t.shop.currentShop,timezone:t.navigation.user.timezone,warehouses:(0,rt.op)(t)}}),null)(ht),gt=o(41850),yt=o(45812),vt=y.createElement;function _t(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function xt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(o),!0).forEach((function(e){(0,m.Z)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):_t(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function It(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=(0,d.Z)(t);if(e){var r=(0,d.Z)(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return(0,u.Z)(this,o)}}var wt={page:1,page_size:30},St=function(t){(0,p.Z)(o,t);var e=It(o);function o(t){var n;(0,i.Z)(this,o),n=e.call(this,t),(0,m.Z)((0,l.Z)(n),"fetchComboProducts",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt({},wt),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=n.props,r=o.accessToken,a=o.shopId;t=xt(xt({},n.state.params),t),n.setState({params:t,isLoading:e}),n.props.fetchComboProducts(r,a,t).then((function(){return n.setState({isLoading:!1})}))})),(0,m.Z)((0,l.Z)(n),"getData",(function(){return n.props.comboProducts.data.map((function(t){return{key:t.id,id:(0,K.pyT)(t.id,0),name:vt("strong",null,t.name),typeCombo:t.is_categories?vt(c.default,{color:"orange"},n.props.t("components.productComboDetail.categories")):t.is_variation?vt(c.default,{color:"red"},n.props.t("pages.shop.product.combo.variation")):vt(c.default,{color:"blue"},n.props.t("products.title")),discount:t.is_value_combo?"":vt("strong",null,(0,K.ufS)(t.discount_amount,t.currency||n.props.currentShop.currency)),discountByPercent:vt("strong",null,"".concat(t.discount_by_percent," %")),maxDiscountByPercent:vt("strong",null,(0,K.ufS)(t.max_discount_by_percent,t.currency||n.props.currentShop.currency)),freeShip:t.is_free_shipping?vt(v.Z,{style:{color:"#096dd9",fontSize:14}}):"",insertedAt:(0,K.o0x)(n.props.timezone||7,t.inserted_at),updateAt:(0,K.o0x)(n.props.timezone||7,t.updated_at),startDate:t.start_time?(0,K.o0x)(n.props.timezone||7,t.start_time):"",endDate:t.end_time?(0,K.o0x)(n.props.timezone||7,t.end_time):"",action:t,value:vt("strong",null,t.is_value_combo?(0,K.ufS)(t.value_combo,t.currency||n.props.currentShop.currency):null)}}))})),(0,m.Z)((0,l.Z)(n),"onSortFields",(function(t,e,o,r){var a={asc_desc:"ascend"==e?"asc":"desc"};a.sort_by=t,localStorage.setItem("sort_combo",JSON.stringify(a)),n.setState({dataSort:a}),n.fetchComboProducts(xt(xt({},r),{},{data_sort:a,page:o}))})),(0,m.Z)((0,l.Z)(n),"handleTableChange",(function(t,e,o){var r=n.state.params;r.page=t.current,r.page_size=t.pageSize,0!=Object.keys(o).length&&o.order?n.onSortFields(o.field,o.order,t.current,r):(n.setState({dataSort:void 0}),localStorage.getItem("sort_combo")&&localStorage.removeItem("sort_combo"),n.fetchComboProducts(xt(xt({},r),{},{data_sort:void 0}))),document.querySelector(".ant-table-body").scrollTop=0})),(0,m.Z)((0,l.Z)(n),"handleRowClick",(function(t){var e=t.action;n.setState({modalDetailVisible:!0,selectedCombo:e,isLoadingVariations:!0});var o=n.props;(0,o.fetchComboPorductVariations)(o.accessToken,o.shopId,{combo_product_id:e.id}).then((function(){return n.setState({isLoadingVariations:!1})}))})),(0,m.Z)((0,l.Z)(n),"handleDeleteCombo",(function(){var t=n.props.t,e=n.state.selectedRowKeys;a.Z.confirm({title:t("pages.shop.product.combo.confirmedDeleteCombo"),content:t("pages.shop.product.combo.wantToDelete")+" "+e.length+t("pages.shop.product.combo.selectedCombo"),okText:t("delete"),cancelText:t("cancel"),onOk:function(){var t=n.props,o=t.accessToken,r=t.shopId;(0,t.deleteCombos)(o,r,{combo_ids:e}).then((function(){return n.setState({selectedRowKeys:[]})}))}})})),(0,m.Z)((0,l.Z)(n),"handleSearchInputChange",(function(t){var e=g()(n.state.params);e.search=t,n.fetchComboProducts(e)})),(0,m.Z)((0,l.Z)(n),"fetchComboProductsAfterImportExcel",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt({},wt),e=n.props,o=e.accessToken,r=e.shopId;n.props.fetchComboProducts(o,r,t)})),(0,m.Z)((0,l.Z)(n),"onSelectRow",(function(){var t=n.props,e=t.shopId,o=t.accessToken,r=n.state.params,a="".concat((0,K.LpH)(),"/shops/").concat(e,"/combo_products?access_token=").concat(o);n.setState({loadingData:!0});(function t(e){return H().get(a,{params:e}).then((function(o){var r=n.state,a=r.loadingData,c=r.selectedRowKeys,i=o.data.data,s=i.map((function(t){return t.id})),l=c.filter((function(t){return!s.includes(t)})).concat(s);return a&&n.setState({selectedRowKeys:l}),(l||[]).length>=o.data.total_entries||0==i.length||!a?void 0:(e.page+=1,t(e))}))})(xt(xt({},r),{},{page:1})).then((function(t){return n.setState({loadingData:!1})}))}));var r=t.isServer&&localStorage.getItem("sort_combo")?JSON.parse(localStorage.getItem("sort_combo")):void 0;return n.state={isLoading:!1,params:xt({},wt),modalDetailVisible:!1,selectedCombo:null,isLoadingVariations:!1,selectedRowKeys:[],searchTerm:"",loadingData:!1,dataSort:r},n.handleSearchInputChange=h()(n.handleSearchInputChange,400),n}return(0,s.Z)(o,[{key:"componentDidMount",value:function(){var t=localStorage.getItem("sort_combo");t&&(t=JSON.parse(t),this.setState({dataSort:t})),this.fetchComboProducts(xt(xt({},wt),{},{data_sort:t}))}},{key:"getColumns",value:function(){var t=this.state.dataSort;return[{title:"ID",dataIndex:"id",ellipsis:!0,width:"6%"},{title:this.props.t("pages.shop.product.combo.nameCombo"),dataIndex:"name",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.typeCombo"),dataIndex:"typeCombo",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.freeShip"),dataIndex:"freeShip",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.discount"),dataIndex:"discount",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.value"),dataIndex:"value",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.discountByPercent"),dataIndex:"discountByPercent",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.maxDiscountByPercent"),dataIndex:"maxDiscountByPercent",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.insertedAt"),dataIndex:"insertedAt",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.updatedAt"),dataIndex:"updateAt",align:"right",ellipsis:!0,sorter:!0,sortOrder:!!t&&"".concat(t.asc_desc,"end")},{title:this.props.t("pages.shop.product.combo.startDate"),dataIndex:"startDate",align:"right",ellipsis:!0},{title:this.props.t("pages.shop.product.combo.endDate"),dataIndex:"endDate",align:"right",ellipsis:!0}]}},{key:"render",value:function(){var t=this,e=this.props,o=e.comboProducts.total_entries,n=e.accessToken,a=e.shopId,c=e.t,i=this.state,s=i.isLoading,l=i.params,p=i.selectedCombo,u=i.modalDetailVisible,d=i.isLoadingVariations,m=i.selectedRowKeys,f=i.isDeleting,h=i.searchTerm,b=i.loadingData;return vt($.Z,{className:"product-combo",style:{overflow:"visible"}},vt("div",{className:"tools-container"},vt(S.Z,{icon:vt(_.Z,null),title:c("pages.shop.product.combo.createComboProduct"),onClick:function(){return t.setState({selectedCombo:null,modalDetailVisible:!0})}}),vt(C.Z,{icon:vt(x.Z,null),disabled:s,onClick:function(){return t.fetchComboProducts()},title:c("pages.shop.orderControlInfo.sync"),isButton:!0}),vt(J,{accessToken:n,shopId:a,fetchComboProduct:function(){return t.fetchComboProductsAfterImportExcel()},deleteCombosFromExcel:function(e,o,n,r){t.props.deleteCombos(e,o,n,r)}}),vt(bt,{trigger:"click",params:l,accessToken:n,shopId:a,selectedRowKeys:m}),m.length>0&&vt(C.Z,{icon:vt(I.Z,null),disabled:f,tooltip:"".concat(c("delete")," ").concat(m.length," ").concat(c("pages.shop.product.combo.selectedCombo")," "),onClick:this.handleDeleteCombo,title:c("delete"),isButton:!0}),vt(yt.Z,{selectedLength:m.length,loadingData:b,total:o,onClick:function(){return t.setState({loadingData:!1,selectedRowKeys:[]})}}),vt("div",{className:"filter"},vt(r.default,{placeholder:c("pages.shop.product.combo.filterCombo"),value:h,prefix:vt(w.Z,null),onChange:function(e){t.setState({searchTerm:e.target.value}),t.handleSearchInputChange(e.target.value)}}))),vt(gt.Z,{className:s?"blur-when-loading":"",size:"small",dataSource:this.getData(),columns:this.getColumns(),pagination:{size:"small",pageSize:l.page_size,total:o,current:l.page},scroll:{x:1400,y:"calc(100vh - 212px)"},onChange:this.handleTableChange,onRow:function(e){return{onClick:function(o){return t.handleRowClick(e)}}},rowSelection:{selectedRowKeys:m,onChange:function(e){return t.setState({selectedRowKeys:e})},preserveSelectedRowKeys:!0,isSelection:!0,onSelectRow:this.onSelectRow}}),vt(E.Z,{accessToken:n,shopId:a,combo:p,visible:u,close:function(){return t.setState({modalDetailVisible:!1})},variations:this.props.comboProducts.variations,isLoadingVariations:d,timezone:this.props.timezone}),s&&vt(Z.Z,null))}}]),o}(y.Component);(0,m.Z)(St,"pageInfo",{title:"pages.shop.product.combo.comboOfProduct",sassStyle:ot()});var Ct=(0,nt.$j)((function(t){return xt({timezone:t.navigation.user.timezone},(0,rt.$w)(t))}),{fetchComboProducts:at.tt2,fetchComboPorductVariations:at.VIL,deleteCombos:at.G0f})((0,tt.Z)(St))},20679:function(t,e,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/product/combo",function(){return o(9061)}])},24654:function(){}},function(t){t.O(0,[5460,6682,2902,3177,9774,2888,179],(function(){return e=20679,t(t.s=e);var e}));var e=t.O();_N_E=e}]);