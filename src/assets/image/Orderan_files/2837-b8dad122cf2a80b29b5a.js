(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2837],{75171:function(n){!function(){"use strict";n.exports=".purchase-printer{font-size:14px;font-family:Arial,Helvetica,sans-serif;color:#000;background-color:#fff}.purchase-printer table{width:100%;margin-top:10px}.purchase-printer tr,.purchase-printer td{page-break-inside:avoid}.purchase-printer table,.purchase-printer th,.purchase-printer td{border:1px solid #000;border-collapse:collapse}.purchase-printer th,.purchase-printer td{padding:6px}.purchase-printer .display-number{text-align:right}.purchase-printer .title{font-size:18px;display:flex;justify-content:center}.purchase-printer .info{margin-top:16px}.purchase-printer .info>div{padding-bottom:3px}.purchase-printer .info>div>div{padding-bottom:3px}.printer-purchases .purchase-printer-container{width:200px}.printer-purchases .purchase-printer-container .printer-purchase-content .item-content{padding:10px 5px}.printer-purchases .purchase-printer-container .printer-purchase-content .item-content .label{display:block;font-weight:600;line-height:20px;padding-bottom:5px}.printer-purchases .purchase-printer-container .printer-purchase-content .item-content:not(:last-child){border-bottom:1px dashed #d9d9d9}.printer-purchases .purchase-printer-container .printer-purchase-content .item-content .ant-select{width:100%}.printer-purchases .purchase-printer-container .printer-purchase-footer{display:flex;flex-direction:row;justify-content:flex-end;padding:5px 5px 0 5px;border-top:1px solid #e8e8e8}"}()},60676:function(n,t,e){"use strict";e.d(t,{Z:function(){return R}});var r,i=e(62443),a=e(65400),s=e(74047),c=e(52700),o=e(4706),d=e(33814),p=e(44102),l=e(20775),u=e(26265),h=e(64749),f=e(67294),m=e(14494),g=e(9669),v=e.n(g),y=e(87217),b=e(7085),x=e(7945),w=e(31731),P=e(95213),_=function(n,t,e){return'\n    <div class="transaction-printer">\n      <div class="header">\n        <div style="display: flex; flex-direction: column; align-items: center;">\n          <div class="title">\n            '.concat(n.amount<0?"PHI\u1ebeU CHI":"PHI\u1ebeU THU",'\n          </div>\n          <div class="title">').concat(t.name,"</div>\n          <div>\n            <i>Ng\xe0y ").concat((0,P.o0x)(e||7,n.inserted_at,!1,"DD")," th\xe1ng ").concat((0,P.o0x)(e||7,n.inserted_at,!1,"MM")," n\u0103m ").concat((0,P.o0x)(e||7,n.inserted_at,!1,"YYYY"),' </i>\n          </div>\n        </div>\n        <div style="height-line: 40px">\n          S\u1ed1: ').concat(n.amount<0?"PT":"PC").concat((0,P.o0x)(e||7,n.inserted_at,!1,"MM")," /").concat(n.display_id,'\n        </div>\n      </div>\n      <div style="margin-bottom: ').concat(n.order&&(n.order.items||[]).length>0?"20px":"40px",'; display: grid; grid-template-columns: 85px auto; grid-gap: 6px">\n        <div class="info"><div class="label">H\u1ecd v\xe0 t\xean</div>:</div>\n        <div style="padding-left: 10px">').concat(n.creator?"".concat(n.creator.name):"0",'</div>\n        <div class="info"><div class="label">\u0110\u1ecba ch\u1ec9</div>:</div>\n        <div style="padding-left: 10px;">').concat(n.order&&n.order.shipping_address?n.order.shipping_address.full_address:"0",'</div>\n        <div class="info"><div class="label">L\xfd do ').concat(n.amount>=0?"thu":"chi",'</div>:</div>\n        <div style="padding-left: 10px; text-transform: uppercase">').concat(n.name.replace("#ref_display_id","#".concat(n.ref_display_id)),'</div>\n        <div class="info"><div class="label">S\u1ed1 ti\u1ec1n</div>:</div>\n        <div class="content-number">').concat((0,P.ufS)(n.amount<0?-1*n.amount:n.amount,t.currency),'</div>\n        <div class="info"><div class="label">B\u1eb1ng ch\u1eef</div>:</div>\n        <div style="padding-left: 10px">').concat((0,P.sGA)(n.amount," ")," \u0111\u1ed3ng.</div>\n        ").concat(n.note?'<div class="info"><div class="label">Ghi ch\xfa</div>:</div>\n          <div style="padding-left: 10px">'.concat(n.note,"</div>"):"<div></div>","\n      </div>\n      ").concat(n.order&&(n.order.items||[]).length>0?'<table style="width: 100%; margin-bottom: 20px">\n              <tr style="text-align: center">\n                <th width="6%">STT</th>\n                <th style="text-align: left">T\xean s\u1ea3n ph\u1ea9m</th>\n                <th width="12%;">S\u1ed1 l\u01b0\u1ee3ng</th>\n                <th width="17%;">\u0110\u01a1n gi\xe1</th>\n                <th width="17%;">Th\xe0nh ti\u1ec1n</th>\n              </tr>\n              '.concat(n.order&&(n.order.items||[]).map((function(n,e){return'<tr>\n                    <td style="text-align: center">'.concat(e+1,'</td>\n                    <td style="text-transform: uppercase">\n                      ').concat(n.name,'\n                    </td>\n                    <td  style="text-align: center">').concat((0,P.ufS)(n.quantity,t.currency,!1),'</td>\n                    <td  style="text-align: center">').concat((0,P.ufS)(n.retail_price,t.currency,!1),'</td>\n                    <td  style="text-align: center">').concat((0,P.ufS)(n.quantity*n.retail_price,t.currency,!1),"</td>\n                  </tr>")})).join(""),'\n              <tr>\n                <th colspan="3" class="display-number">T\u1ed5ng</th>\n                <th class="display-number">').concat((0,P.ufS)((n.order.items||[]).reduce((function(n,t){return n+t.quantity}),0),t.currency,!1),'</th>\n                <th class="display-number">').concat((0,P.ufS)((n.order.items||[]).reduce((function(n,t){return n+t.quantity*t.retail_price}),0),t.currency,!1),"</th>\n              </tr>\n            </table>"):"<div></div>",'\n      <div class="footer">\n        <div>\n          <strong>Gi\xe1m \u0111\u1ed1c</strong>\n        </div>\n        <div>\n          <strong>K\u1ebf to\xe1n tr\u01b0\u1edfng</strong>\n        </div>\n        <div>\n          <strong>').concat(n.amount<0?"Ng\u01b0\u1eddi nh\u1eadn ti\u1ec1n":"Ng\u01b0\u1eddi n\u1ed9p ti\u1ec1n","</strong>\n        </div>\n        <div>\n          <strong>Ng\u01b0\u1eddi l\u1eadp</strong>\n        </div>\n      </div>\n    </div>\n  ")},S=function(n,t,e){return'<div class="purchase-printer">\n      <div class="title" style="text-align: center;">\n        <strong>PHI\u1ebeU NH\u1eacP NPL</strong>\n      </div>\n      <div class="info" style="display: flex; margin-bottom: 10px">\n        <div style="width: 50%;">\n          <div>\n            <div>\n              Kho: <strong>'.concat(n.warehouse.name,"</strong>\n            </div>\n            <div>\n              S\u1ed1 \u0111i\u1ec7n tho\u1ea1i: ").concat(n.warehouse.phone_number,"\n            </div>\n          </div>\n          <div>\n            \u0110\u1ecba ch\u1ec9: ").concat(n.warehouse.full_address,"\n          </div>\n          ").concat(n.note?'<div style="margin-top: 4px;">\n              <span style="font-weight: 600"><i>GHI CH\xda: </i></span> <span><i>'.concat(n.note,"</i></span>\n            </div>"):"<div></div>",'\n        </div>\n        <div style="width: 50%; margin-left: 5px">\n          <div>\n            M\xe3 phi\u1ebfu nh\u1eadp: <strong>').concat(n.display_id,"</strong>\n          </div>\n          <div>\n            Ng\u01b0\u1eddi t\u1ea1o: <strong>").concat(n.user?n.user.name:"H\u1ec7 Th\u1ed1ng","</strong>\n          </div>\n          <div>\n            Ng\xe0y t\u1ea1o: ").concat((0,P.o0x)(e||7,n.inserted_at,!1,"DD/MM/YYYY HH:mm"),'\n          </div>\n        </div>\n      </div>\n      <table class="table" style="width: 100%">\n        <tbody>\n        <tr style="text-align: center">\n          <th width="6%">STT</th>\n          <th width="30%;" style="text-align: left">Nguy\xean ph\u1ee5 li\u1ec7u</th>\n          <th width="15%;">Thu\u1ed9c t\xednh</th>\n          <th width="12%;">S\u1ed1 l\u01b0\u1ee3ng</th>\n          <th width="17%;">\u0110\u01a1n gi\xe1</th>\n          <th width="17%;">Th\xe0nh ti\u1ec1n</th>\n        </tr>\n        ').concat(n.accessories_items.map((function(n,e){return'<tr>\n              <td style="text-align: center">'.concat(e+1,'</td>\n              <td style="text-transform: uppercase">\n                ').concat(n.accessories_variation.accessories.name,'\n              </td>\n              <td style="text-align: center">\n                ').concat(n.accessories_variation.fields.length?n.accessories_variation.fields.map((function(n){return"".concat(n.value)})).join(" - "):"",'\n              </td>\n              <td class="display-number">').concat((0,P.ufS)(n.quantity,t.currency,!1),'</td>\n              <td class="display-number">').concat((0,P.ufS)(n.imported_price,t.currency,!1),'</td>\n              <td class="display-number">').concat((0,P.ufS)(n.quantity*n.imported_price,t.currency,!1),"</td>\n            </tr>")})).join(""),'\n        <tr>\n          <th colspan="3" class="display-number">T\u1ed5ng</th>\n          <th class="display-number">').concat((0,P.ufS)(n.accessories_items.reduce((function(n,t){return n+t.quantity}),0),t.currency,!1),'</th>\n          <td></td>\n          <th class="display-number">').concat((0,P.ufS)(n.accessories_items.reduce((function(n,t){return n+t.quantity*t.imported_price}),0),t.currency,!1),'</th>\n        </tr>\n      </table></tbody>\n      <div style=" text-align: end; margin-top: 10px; margin-right: 15px; font-weight: 550;">\n        Ch\u1eef k\xfd ng\u01b0\u1eddi xu\u1ea5t\n      </div>\n    </div>\n  ')},Z=e(75171),k=e.n(Z),T=e(31432),I=e(36934),H=e(52653),N=e(28510),j=f.createElement;function C(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function D(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?C(Object(e),!0).forEach((function(t){(0,u.Z)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):C(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function O(n){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,p.Z)(this,e)}}var L=h.default.Option,M=(0,y.Z)()(r=function(n){(0,d.Z)(e,n);var t=O(e);function e(n){var r;return(0,s.Z)(this,e),r=t.call(this,n),(0,u.Z)((0,o.Z)(r),"componentDidMount",(function(){var n=r.props,t=n.accessToken,e=n.shopId;r.props.fetchPrintPurchases(t,e).then((function(){var n=r.props.printPurchases,t=n.length>0?(n.find((function(n){return n.default}))||n[0]).id.toString():null,e=localStorage.getItem("selectPrintPurchase");e=e&&n.find((function(n){return n.id==e}))?e:t,r.setState({labelId:e})}))})),(0,u.Z)((0,o.Z)(r),"handleFetchPurchases",(function(){var n=r.props,t=n.shopId,e=n.accessToken,i=n.selectedRowKeys,a={page:-1,status:-2,preload_items:!0},s="".concat((0,P.LpH)(),"/shops/").concat(t,"/purchases?access_token=").concat(e),c=i.join(",").toString();a=D(D({},a),{},{purchase_ids:c}),r.setState({showLoading:!0}),v().get(s,{params:a}).then((function(n){n.data.success&&(r.setState({purchases:n.data.data}),r.handlePrint())}))})),(0,u.Z)((0,o.Z)(r),"handleFetchPurchasesAccessories",(function(){var n=r.props,t=n.shopId,e=n.accessToken,i={page:-1,status:-2,purchase_accessories_ids:n.selectedRowKeys},a="".concat((0,P.LpH)(),"/shops/").concat(t,"/purchase_accessories?access_token=").concat(e);v().get(a,{params:i}).then((function(n){n.data.success&&(r.setState({purchases_accessories:n.data.data}),r.handlePrint())}))})),(0,u.Z)((0,o.Z)(r),"handleFetchTransactions",(function(){var n=r.props,t=n.selectedRowKeys,e=n.selectedData;t.length>0&&(r.setState({transactions:e}),r.handlePrint())})),(0,u.Z)((0,o.Z)(r),"handlePrint",(function(){return r.setState({isPrinting:!0},(function(){var n=document.getElementById(r.printDivId).innerHTML,t=document.createElement("iframe");t.name="frame1",t.style.position="absolute",t.style.top="-1000000px",document.body.appendChild(t);var e=t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument;e.document.open(),e.document.write("\n          <!DOCTYPE html>\n            <head>\n              <style type='text/css'>\n                @media print {\n                  @page {\n                    size: auto;\n                    margin: 6mm;\n                  }\n                }\n\n                table {\n                  page-break-inside: auto;\n                }\n\n                thead {\n                  display: table-header-group;\n                }\n\n                tr {\n                  page-break-inside: avoid;\n                  page-break-after: auto;\n                }\n\n                td {\n                  word-wrap: break-word;\n                }\n              </style>\n            </head>\n            <body>\n              ".concat(n,"\n              <style>\n                table,th,td {\n                  border: 1px solid black;\n                  border-collapse: collapse;\n                  padding: 5px\n                }\n\n                font-size: 18px;\n\n                .header {\n                    display: grid;\n                    grid-template-columns: 70% 30%;\n                    margin-bottom: 10px;\n                }\n\n                .title {\n                    font-size: 22px;\n                    font-weight: 500;\n                    padding-bottom: 6px\n                }\n\n                .label {\n                    width: 90px;\n                }\n\n                .info {\n                    display: flex;\n                    flex-direction: row;\n                }\n\n                .content-number {\n                    padding-left: 16px;\n                    width: 30%;\n                }\n\n                .footer {\n                  display: flex;\n                  justify-content: space-around;\n                }\n              </style>\n            </body>\n          </html>\n        ")),e.document.close(),setTimeout((function(){window.frames.frame1.focus(),window.frames.frame1.print(),document.body.removeChild(t)}),500),r.setState({isPrinting:!1,showLoading:!1})}))})),(0,u.Z)((0,o.Z)(r),"onChangeSelectLabel",(function(n){localStorage.setItem("selectPrintPurchase",n),r.setState({labelId:n})})),(0,u.Z)((0,o.Z)(r),"renderPrinter",(function(){var n=r.props,t=n.t,e=n.printPurchases,i=r.state,s=i.labelId,c=i.showLoading;return j("div",{className:"purchase-printer-container"},j("div",{className:"printer-purchase-content"},j("div",{className:"item-content"},j("label",{className:"label"},t("components.orderPrinter.selectPrintingForm")),j(h.default,{onFocus:function(){return r.setState({selecting:!0})},onBlur:function(){return r.setState({selecting:!1})},value:s?s+"":void 0,onChange:function(n){return r.onChangeSelectLabel(n)},allowClear:!0,placeholder:t("components.orderPrinter.printingForm")},e.map((function(n){return j(L,{key:n.id,value:n.id.toString()},n.name)}))))),j("div",{className:"printer-purchase-footer"},j(a.default,{icon:c?j(b.Z,null):void 0,className:"order-action-button",key:"print",type:"primary",disabled:c,onClick:r.handleFetchPurchases},t("confirmed"))))})),r.state={isPrinting:!1,purchases:[],transactions:[],purchases_accessories:[],selecting:!1,labelId:null,showLoading:!1},r.printDivId=(0,P.uuG)(),r}return(0,c.Z)(e,[{key:"render",value:function(){var n=this.props,t=n.selectedRowKeys,e=n.t,r=n.currentShop,a=n.timezone,s=n.printer,c=n.type,o=n.printPurchases,d=n.isButton,p=this.state,l=p.purchases,u=p.isPrinting,h=p.transactions,f=p.purchases_accessories,m=p.labelId,g=(t.length?"".concat(e("components.orderPrinter.print")," ").concat(t.length," ").concat("purchase"==s?e("components.productPurchaseImportExcel.productPurchase").toLowerCase():e("pages.shop.statistic.transaction.receitptsAndPaySlip").toLowerCase()):e("purchase"==s?"pages.shop.product.purchase.selectGoodsReceiptToPrint":"pages.shop.product.purchase.printAllReceiptsAndPayments"),{pageBreakInside:"avoid",minHeight:"purchase"==s?"190mm":"132mm",padding:"1mm"}),v=m?parseInt(m):void 0,y=v&&o.find((function(n){return n.id==v}))||(0,N.UR)(e),b=y&&N._$.find((function(n){return n.id==y.paper_id}))||N._$[0];return j("div",{style:{display:"inline"}},"purchase"==s&&"accessories"!=c?j(i.default,{overlayClassName:"printer-purchases",content:this.renderPrinter,trigger:"click",placement:"rightTop"},j(w.Z,{title:e("pages.shop.actionTools.print"),icon:j(x.Z,null),isButton:d})):j(w.Z,{title:e("pages.shop.actionTools.print"),icon:j(x.Z,null),onClick:"purchase"==s&&"accessories"==c?this.handleFetchPurchasesAccessories:this.handleFetchTransactions,disabled:!t.length&&"purchase"==s,isButton:d,tooltip:"Vui l\xf2ng ch\u1ecdn phi\u1ebfu \u0111\u1ec3 in"}),u&&j("div",{id:this.printDivId,className:"print-div"},"purchase"==s?"accessories"==c?f.map((function(n){return j("div",{key:f.id,style:g},j("div",{dangerouslySetInnerHTML:{__html:S(n,r,a)}}))})):l.map((function(n){return j("div",{key:n.id,style:g},j(H.Z,{key:n.id,data:n,params:y,paperSize:b,type:"purchases"}))})):h.map((function(n){return j("div",{key:n.id,style:g},j("div",{dangerouslySetInnerHTML:{__html:_(n,r,a)}}))}))),j("style",{dangerouslySetInnerHTML:{__html:k()}}))}}]),e}(f.Component))||r,R=(0,m.$j)((function(n){return{currentShop:n.shop.currentShop,timezone:n.navigation.user.timezone,printPurchases:(0,T.qA)(n)}}),{fetchPrintPurchases:I.gfX})(M)},74229:function(n,t,e){"use strict";var r=e(89552),i=e(67294),a=e(7085),s=i.createElement;t.Z=function(){return s("div",{className:"spinner"},s(r.default,{indicator:s(a.Z,{style:{fontSize:40}})}))}}}]);