(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2141],{9010:function(t){!function(){"use strict";t.exports=".ant-table-expanded-row-level-1>td:last-child{padding:0px !important}.row-variation{cursor:pointer}.index-product{width:30px}.col-footer{text-align:right;font-weight:bold}.col-footer .ant-btn{border-radius:2px !important}.table-printer-products{overflow-x:hidden}.table-printer-products .ant-table-body{overflow-x:hidden;overflow-y:auto !important}.table-printer-products .ant-table-tbody>tr>td{padding:8px !important}.table-printer-products .ant-table-wrapper{background-color:unset !important;border:unset !important;border-radius:unset}.table-printer-products .ant-table-content{border:none}.table-printer-products.ant-table-footer{padding:8px 8px}.ant-table-content{border-bottom:1px solid #e8e8e8}.print-list-transfer .ant-tabs-bar{margin:0 0 10px !important}.print-list-transfer .ant-modal-body{padding:0 24px 24px 24px !important}.print-list-transfer .ant-modal-body .ant-table-measure-row>td{padding:0px !important}"}()},15443:function(t){!function(){"use strict";t.exports=".export-excel-container .export-excel-header{background-color:#fff;padding:10px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px !important;margin-bottom:10px;min-height:145px}.export-excel-container .export-excel-header .ant-checkbox+span{font-weight:500}.export-excel-container .export-excel-setting{background-color:#fff;padding:10px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px !important}.export-excel-container .export-excel-setting .ant-checkbox-wrapper{font-weight:500}.export-excel-container .span-export{font-weight:500}.export-excel-container .ant-input{border-radius:2px !important}.export-excel-container .ant-select-selection{border-radius:2px !important}.export-excel-setting .droppable-content{display:flex;justify-content:space-between;border:1px solid #e0e0e0;border-bottom:0;padding:2px 12px;border-top-left-radius:2px;border-top-right-radius:2px}"}()},96981:function(t){!function(){"use strict";t.exports=".modal-updating .ant-modal-body{display:flex;flex-direction:column;align-items:center}.modal-updating .ant-modal-body .updating-info{width:100%;height:300px;display:flex;flex-direction:column;border:1px solid #d9d9d9;border-radius:2px;margin-top:10px;padding:10px;font-size:14px;overflow:auto}.modal-updating .ant-modal-body .updating-info .success{color:#00a854}.modal-updating .ant-modal-body .updating-info .fail{color:#f04134}.product-transfer{overflow:visible !important}.product-transfer .ant-table-wrapper .ant-table-body .ant-table-row{cursor:pointer}.modal-updating .ant-modal-body{display:flex;flex-direction:column;align-items:center}.modal-updating .ant-modal-body .updating-info{width:100%;height:300px;display:flex;flex-direction:column;border:1px solid #d9d9d9;border-radius:2px;margin-top:10px;padding:10px;font-size:14px;overflow:auto}.modal-updating .ant-modal-body .updating-info .success{color:#00a854}.modal-updating .ant-modal-body .updating-info .fail{color:#f04134}.ant-select-disabled .ant-select-selection{cursor:default;color:rgba(0,0,0,.65)}.ant-select-disabled .ant-select-arrow{display:none}.transfer-printer{font-size:14px;font-family:Arial,Helvetica,sans-serif;color:#000;background-color:#fff}.transfer-printer table{width:100%;margin-top:10px}.transfer-printer tr,.transfer-printer td{page-break-inside:avoid}.transfer-printer table,.transfer-printer th,.transfer-printer td{border:1px solid #000;border-collapse:collapse}.transfer-printer th,.transfer-printer td{padding:6px}.transfer-printer .display-number{text-align:right}.transfer-printer .title{font-size:18px;display:flex;justify-content:center}.transfer-printer .info{margin-top:16px}.transfer-printer .info>div{padding-bottom:3px}.transfer-printer .info>div>div{padding-bottom:3px}"}()},78598:function(t,e,n){var r,o=o||function(t){"use strict";if(!("undefined"===typeof t||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=/constructor/i.test(t.HTMLElement)||t.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},c=function(t){setTimeout((function(){"string"===typeof t?n().revokeObjectURL(t):t.remove()}),4e4)},l=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},d=function(e,d,u){u||(e=l(e));var p,f=this,h="application/octet-stream"===e.type,m=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var o=t["on"+e[r]];if("function"===typeof o)try{o.call(t,n||t)}catch(a){s(a)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,o)return p=n().createObjectURL(e),void setTimeout((function(){r.href=p,r.download=d,function(t){var e=new MouseEvent("click");t.dispatchEvent(e)}(r),m(),c(p),f.readyState=f.DONE}));!function(){if((i||h&&a)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=i?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,f.readyState=f.DONE,m()},r.readAsDataURL(e),void(f.readyState=f.INIT)}(p||(p=n().createObjectURL(e)),h)?t.location.href=p:t.open(p,"_blank")||(t.location.href=p);f.readyState=f.DONE,m(),c(p)}()},u=d.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=l(t)),navigator.msSaveOrOpenBlob(t,e)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,e,n){return new d(t,e||t.name||"download",n)})}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);t.exports?t.exports.saveAs=o:null!==n.amdD&&null!==n.amdO&&(void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r))},24456:function(t,e,n){var r=n(97786),o=n(10611);t.exports=function(t,e,n,a){return o(t,e,n(r(t,e)),a)}},93425:function(t,e,n){var r=n(24456),o=n(54290);t.exports=function(t,e,n){return null==t?t:r(t,e,o(n))}},74018:function(t,e,n){"use strict";var r,o=n(51024),a=n(74047),i=n(52700),s=n(4706),c=n(33814),l=n(44102),d=n(20775),u=n(26265),p=n(18446),f=n.n(p),h=n(23279),m=n.n(h),v=n(67294),g=n(14494),y=n(87217),_=n(76570),x=n(7145),w=n.n(x),b=v.createElement;function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,d.Z)(t);if(e){var o=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var Z=(0,y.Z)()(r=function(t){(0,c.Z)(n,t);var e=S(n);function n(t){var r;return(0,a.Z)(this,n),r=e.call(this,t),(0,u.Z)((0,s.Z)(r),"delaySearch",m()((function(){return r.props.fetch(r.state.params)}),800)),(0,u.Z)((0,s.Z)(r),"onChangeSearchText",(function(t){t.persist();var e=t.target.value;e?r.setState({params:T(T({},r.props.params),{},{search:e})}):r.setState({params:w()(r.props.params,{$unset:["search"]})}),r.delaySearch()})),r.state={params:T({},t.params)},r}return(0,i.Z)(n,[{key:"componentDidUpdate",value:function(t){f()(t.params,this.props.params)||this.setState({params:this.props.params})}},{key:"render",value:function(){var t=this.props,e=t.t,n=t.placeholder,r=this.state.params;return b(o.default,{placeholder:n||"".concat(e("pages.shop.product.purchase.displayId")," / ").concat(e("pages.shop.product.purchase.note")),onChange:this.onChangeSearchText,prefix:b(_.Z,null),value:r.search,className:"export-search-bar",style:{width:"44vw",left:450}})}}]),n}(v.Component))||r;e.Z=(0,g.$j)((function(t){return{currentShop:t.shop.currentShop}}),null)(Z)},74229:function(t,e,n){"use strict";var r=n(89552),o=n(67294),a=n(7085),i=o.createElement;e.Z=function(){return i("div",{className:"spinner"},i(r.default,{indicator:i(a.Z,{style:{fontSize:40}})}))}},37737:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return Ae}});var o,a=r(65400),i=r(94055),s=r(59361),c=r(51024),l=r(28140),d=r(809),u=r.n(d),p=r(92447),f=r(74047),h=r(4706),m=r(52700),v=r(33814),g=r(44102),y=r(20775),_=r(26265),x=r(64713),w=r(14321),b=r(56697),P=r(18446),T=r.n(P),S=r(65988),Z=r(67294),I=r(14494),k=r(7085),O=r(90631),D=r(84189),E=r(50161),C=r(7945),R=r(42768),L=r(49101),N=r(25592),A=r(83049),F=r(74229),W=r(50916),M=r(52390),j=r(28465),H=r(4863),U=r(74806),z=r(44908),q=r.n(z),K=r(87217),B=r(79508),V=r(48176),Y=r(31731),G=r(22318),$=r(95213),J=r(9669),Q=r.n(J),X=r(7145),tt=r.n(X),et=r(78598),nt=Z.createElement;function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){(0,_.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function at(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,y.Z)(t);if(e){var o=(0,y.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,g.Z)(this,n)}}var it,st=(0,K.Z)()(o=function(t){(0,v.Z)(n,t);var e=at(n);function n(t){var r;return(0,f.Z)(this,n),r=e.call(this,t),(0,_.Z)((0,h.Z)(r),"onDrop",(function(t){var e=t.file;r.setState({selectedFile:e,fileName:e.name});var n=r.props.t,o=new FileReader;o.readAsBinaryString(e),o.onload=function(t){var e=t.target.result,o=XLSX.read(e,{type:"binary"}),a=o.SheetNames[0],i=XLSX.utils.sheet_to_json(o.Sheets[a],{raw:!0,defval:null});if(0!=i.length){i=i.filter((function(t){var e=!1;return Object.keys(t).forEach((function(n){t[n]&&(e=!0)})),e}));var s=q()(i.filter((function(t){return!t["Kho g\u1ed1c"]&&t["T\xean kho g\u1ed1c"]||!t["Kho nh\u1eadn"]&&t["T\xean kho nh\u1eadn"]})).map((function(t){var e,n,o=[],a=null===(e=r.props.warehouses.find((function(e){return(0,$.Mle)(e.name)==(0,$.Mle)(t["T\xean kho g\u1ed1c"])})))||void 0===e?void 0:e.id;a?t["Kho g\u1ed1c"]=a:o.push('"'.concat(t["T\xean kho g\u1ed1c"],'"'));var i=null===(n=r.props.warehouses.find((function(e){return(0,$.Mle)(e.name)==(0,$.Mle)(t["T\xean kho nh\u1eadn"])})))||void 0===n?void 0:n.id;if(i?t["Kho nh\u1eadn"]=i:o.push('"'.concat(t["T\xean kho nh\u1eadn"],'"')),o.length>0)return o})).filter((function(t){return t})).flat()).join(", ");if(s)return G.Z.error(n("error"),"Kh\xf4ng t\xecm th\u1ea5y kho ".concat(s)),void r.setState({selectedFile:!1,fileName:null});var c=r.mergeWarehouseDuplicate(i);r.setState({dataTransfer:c})}else r.setState({selectedFile:!1,fileName:null}),G.Z.error(n("components.transferWarehouseImportExcel.errorImportFile"),n("components.transferWarehouseImportExcel.empty"))}})),(0,_.Z)((0,h.Z)(r),"mergeWarehouseDuplicate",(function(t){var e=null,n=null,r={},o=!1;return t.map((function(t,a){e=t["Kho g\u1ed1c"]?t["Kho g\u1ed1c"]:e,n=t["Kho nh\u1eadn"]?t["Kho nh\u1eadn"]:n,0!=a||e&&n||(o=!0),o||(e&&n?r["".concat(e,"_").concat(n)]?r["".concat(e,"_").concat(n)].push({"M\xe3 SP":t["M\xe3 SP"],"M\xe3 m\u1eabu":t["M\xe3 m\u1eabu"],"S\u1ed1 l\u01b0\u1ee3ng":t["S\u1ed1 l\u01b0\u1ee3ng"],"D\xf2ng":a+2}):r["".concat(e,"_").concat(n)]=[ot(ot({},t),{},{"D\xf2ng":a+2})]:r["".concat(e,"_").concat(n)].push({"M\xe3 SP":t["M\xe3 SP"],"M\xe3 m\u1eabu":t["M\xe3 m\u1eabu"],"S\u1ed1 l\u01b0\u1ee3ng":t["S\u1ed1 l\u01b0\u1ee3ng"],"D\xf2ng":a+2}))})),r=Object.values(r).flat(),o&&G.Z.error("L\u1ed7i","D\xf2ng \u0111\u1ea7u ti\xean kh\xf4ng t\u1ed3n t\u1ea1i kho"),r})),(0,_.Z)((0,h.Z)(r),"handleImport",(function(){r.setState({isUpdating:!0,importedCount:0},(function(){r.sendRequest(0)}))})),(0,_.Z)((0,h.Z)(r),"sendRequest",function(){var t=(0,p.Z)(u().mark((function t(e){var n,o,a,i,s,c,l,d,p,f,h,m,v,g,y,_,x,w,b,P,T,S;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e>0&&r.scrollUpdatingInfo(),o=r.props,a=o.accessToken,i=o.shopId,s=o.t,c=r.state,l=c.dataTransfer,d=c.importedCount,p=c.dataError,f=c.modalVisible,h=c.isUpdating,!(e>l.length-1)){t.next=5;break}return t.abrupt("return");case 5:if(m=l[e],v={line_number:m["D\xf2ng"],from_warehouse_id:m["Kho g\u1ed1c"].toString(),to_warehouse_id:m["Kho nh\u1eadn"].toString(),shop_id:i,status:0,note:m["Ghi ch\xfa"]},m["Kho g\u1ed1c"]&&m["Kho nh\u1eadn"]){t.next=10;break}return p.push(v),t.abrupt("return",r.sendRequest(e+1));case 10:if(g={line_number:m["D\xf2ng"],imported_price:0,product_id:m["M\xe3 SP"],quantity:m["S\u1ed1 l\u01b0\u1ee3ng"]||0,variation_id:m["M\xe3 m\u1eabu"]},y=r.validateFields(e,m),!y){t.next=23;break}return t.next=16,r.getProductNextLine([g],e+1,1);case 16:return _=t.sent,x=_.items,w=_.count,r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:y,success:!1}]},importedCount:{$set:d+w}})),v=ot(ot({},v),{},{items:x}),p.push(v),t.abrupt("return",r.sendRequest(e+w));case 23:return t.next=25,r.getProductNextLine([g],e+1,1);case 25:if(b=t.sent,P=b.items,T=b.count,!(P.length<T)){t.next=33;break}return r.setState({importedCount:d+T}),v=ot(ot({},v),{},{items:P}),p.push(v),t.abrupt("return",r.sendRequest(e+T));case 33:if(v=ot(ot({},v),{},{items:P}),v=Object.assign({},v),0!=(null===(n=v.items)||void 0===n?void 0:n.length)){t.next=39;break}return r.setState(tt()(r.state,{updatingInfo:{$push:[{id:m["D\xf2ng"]-1,message:s("components.transferWarehouseImportExcel.itemsNotEmpty"),success:!1}]},importedCount:{$set:d+T}})),p.push(v),t.abrupt("return",r.sendRequest(e+T));case 39:f&&h&&(S="".concat((0,$.LpH)(),"/shops/").concat(i,"/transfers/create_from_excel?access_token=").concat(a),Q()({method:"post",url:S,data:{transfer:v}}).then((function(t){if(t.data){var n=t.data;if(n.success)r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:s("components.transferWarehouseImportExcel.successInsert"),success:!0}]}}));else{var o=n.message||"";o=o.split(";"),p.push(ot(ot({},v),{},{log_items:n.log_items,message:n.message})),r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:o,success:!1}]}}))}}else p.push(v),r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:s("components.transferWarehouseImportExcel.errorInsert"),success:!1}]}}));return r.setState({importedCount:d+T}),r.sendRequest(e+T)})).catch((function(t){p.push(v),r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:s("components.transferWarehouseImportExcel.errorInsert"),success:!1}]},importedCount:{$set:d+T}})),r.sendRequest(e+T)})));case 40:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,_.Z)((0,h.Z)(r),"getProductNextLine",(function(t,e,n){var o=r.state.dataTransfer,a=o[e];if(e>o.length-1||a["Kho g\u1ed1c"])return{items:t,count:n};var i=r.validateFields(e,a);if(i)return r.setState(tt()(r.state,{updatingInfo:{$push:[{id:e,message:i,success:!1}]}})),r.getProductNextLine(t,e+1,n+1);var s={line_number:a["D\xf2ng"],imported_price:0,product_id:a["M\xe3 SP"],quantity:a["S\u1ed1 l\u01b0\u1ee3ng"]||0,variation_id:a["M\xe3 m\u1eabu"]};return r.getProductNextLine(t.concat(s),e+1,n+1)})),(0,_.Z)((0,h.Z)(r),"validateFields",(function(t,e){var n=r.props.t,o="".concat(n("components.productImportExcel.index.errorNumber")," ").concat(e["D\xf2ng"],": ");return e["S\u1ed1 l\u01b0\u1ee3ng"]&&(!Number.isInteger((0,$.WNN)(e["S\u1ed1 l\u01b0\u1ee3ng"]))||e["S\u1ed1 l\u01b0\u1ee3ng"]<0)&&(o+=n("components.transferWarehouseImportExcel.errorQuantity")),e["M\xe3 SP"]&&e["M\xe3 m\u1eabu"]||(o+=n("components.transferWarehouseImportExcel.errorItem")),e["Kho g\u1ed1c"]&&e["Kho nh\u1eadn"]&&e["Kho g\u1ed1c"].toString().trim()==e["Kho nh\u1eadn"].toString().trim()&&(o+=n("components.transferWarehouseImportExcel.errorWarehouseDuplicate")),o!="".concat(n("components.productImportExcel.index.errorNumber")," ").concat(e["D\xf2ng"],": ")&&o})),(0,_.Z)((0,h.Z)(r),"renderResults",(function(){var t=r.state,e=t.importedCount,n=t.updatingInfo,o=t.dataTransfer,a=r.props.t,i=n.filter((function(t){return 1==t.success})).length,s=n.filter((function(t){return 0==t.success})).length;return nt("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},nt(U.default,{type:"circle",percent:Math.floor(100*e/o.length)}),e>0&&e==o.length?nt("h4",null,nt("span",{style:{color:"#00a854"}},"".concat(a("updateSuccess")," ").concat(i," ").concat(a("components.transferWarehouseImportExcel.billCreateWarehouse"))),nt("span",{style:{color:"#f04134"}},"".concat(s>0?", ".concat(a("pages.admin.failure")," ").concat(s," ").concat(a("components.transferWarehouseImportExcel.billCreateWarehouse")):""))):nt("div",null,nt("h4",{style:{color:"#096dd9"}},nt(k.Z,null)," ","".concat(a("components.transferWarehouseImportExcel.updating"),"..."))),nt("div",{id:"updating-transfer-warehouse-from-excel",className:"updating-info"},n.map((function(t,e){if(null!=t.success)return nt("div",{key:e,style:{display:"flex"}},nt("span",null,nt("strong",{className:t.success?"success":"fail"},"#".concat(t.transferId||t.id+1))),"\xa0",nt("span",{className:t.success?"success":"fail"},Array.isArray(t.message)?t.message.map((function(t){return nt("div",null,t)})):t.message))}))))})),(0,_.Z)((0,h.Z)(r),"exportProductDefect",(function(){var t=r.props.t,e=r.state.dataError,n=new ExcelJS.Workbook,o=n.addWorksheet("Sheet 1");return o.columns=[{header:t("importTranslate.STT"),key:"STT",width:20},{header:t("pages.shop.product.transfer.fromWarehouse"),key:"KHO_GOC",width:20},{header:t("pages.shop.product.transfer.toWarehouse"),key:"KHO_NHAN",width:20},{header:t("pages.shop.product.transfer.note"),key:"GHI_CHU",width:20},{header:t("productId"),key:"MA_SAN_PHAM",width:20},{header:t("defaultPrint.variationId"),key:"MA_MAU_MA",width:20},{header:t("importTranslate.SO_LUONG"),key:"SO_LUONG",width:20},{header:t("components.productVariationCard.actualRemain"),key:"TON_KHO",width:20},{header:t("error"),key:"Loi",width:20}],e.map((function(t){t.items.map((function(e,n){var r=(t.log_items||[]).find((function(t){return t.line_number==e.line_number}));o.addRow({STT:0==n?t.line_number-1:"",KHO_GOC:t.from_warehouse_id,KHO_NHAN:t.to_warehouse_id,GHI_CHU:t.note,MA_SAN_PHAM:e.product_id,MA_MAU_MA:e.variation_id,SO_LUONG:e.quantity,TON_KHO:null===r||void 0===r?void 0:r.current_quantity,Loi:(null===r||void 0===r?void 0:r.message)||t.message})}))})),n.xlsx.writeBuffer().then((function(t){(0,et.saveAs)(new Blob([t],{type:"application/octet-stream"}),"error.xlsx")}))})),r.state={modalVisible:!1,isUpdating:!1,updatingInfo:[],dataTransfer:[],dataConvert:[],dataError:[]},r}return(0,m.Z)(n,[{key:"scrollUpdatingInfo",value:function(){var t=document.getElementById("updating-transfer-warehouse-from-excel");t.scrollTop=t.scrollHeight}},{key:"render",value:function(){var t=this,e=this.state,n=e.modalVisible,r=e.isUpdating,o=e.fileName,i=e.dataError,s=this.props,c=s.t,l=s.isButton,d=s.title;return nt("div",{style:{display:"inline"}},nt(Y.Z,{title:d,icon:nt(D.Z,null),onClick:function(){return t.setState({modalVisible:!0})},isButton:l}),n&&nt(b.Z,{footer:nt("div",null,r&&i.length>0&&nt(a.default,{onClick:function(){return t.exportProductDefect()},danger:!0},c("components.transferWarehouseImportExcel.exportExcelProductError")),!r&&nt(a.default,{type:"primary",onClick:function(){return t.handleImport()},disabled:!this.state.selectedFile||r},c("start"))),wrapClassName:r?"modal-updating":"transfer-warehouse-info-import-modal",title:c(r?"components.transferWarehouseImportExcel.updating":"components.transferWarehouseImportExcel.importFileExcel"),visible:n,width:800,onCancel:function(){t.setState({modalVisible:!1,updatingInfo:[],isUpdating:!1,selectedFile:!1,fileName:null}),t.props.fetchTransfersAfterCreate()},destroyOnClose:!0,maskClosable:!1},!r&&nt("div",null,nt("div",{style:{marginTop:20,marginBottom:15,borderBottom:"1px solid #d9d9d9"}},nt("div",null,nt(H.default,{message:c("notes"),description:nt("div",{style:{fontSize:14}},nt("p",null,"- ","".concat(c("components.transferWarehouseImportExcel.warehouseIsCode")))),type:"warning",showIcon:!0})),nt("div",{style:{marginTop:10}},nt("b",null,c("components.transferWarehouseImportExcel.sampleFileByOutputFile")," (",nt("a",{target:"_blank",href:"/static/files/import_transfer.xlsx"},c("components.transferWarehouseImportExcel.sampleFile")),")"))),nt("div",null,nt("b",null,c("components.transferWarehouseImportExcel.chooseFile")),nt(j.Z,{style:{marginLeft:10},accept:".xlsx",showUploadList:!1,multiple:!1,customRequest:this.onDrop.bind(this)},nt(a.default,{style:{width:"100%"}},o?nt("span",null,nt(B.Z,null)," ",o):nt("span",null,nt(V.Z,null)," ",c("components.transferWarehouseImportExcel.selectFile")))))),r&&this.renderResults()))}}]),n}(Z.Component))||o,ct=r(44309),lt=r(43745),dt=r(31059),ut=r(32292),pt=r(64749),ft=r(93425),ht=r.n(ft),mt=r(31432),vt=r(49485),gt=r(15443),yt=r.n(gt),_t=Z.createElement;function xt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){(0,_.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Tt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,y.Z)(t);if(e){var o=(0,y.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,g.Z)(this,n)}}var St,Zt=pt.default.Option,It={type:"pattern",pattern:"solid",fgColor:{argb:"FFF5F5F5"},bgColor:{argb:"FFF5F5F5"}},kt=(0,K.Z)()(it=function(t){(0,v.Z)(n,t);var e=Tt(n);function n(t){var r;(0,f.Z)(this,n),r=e.call(this,t),(0,_.Z)((0,h.Z)(r),"columnOptions",(function(){var t=r.props.t;return[{title:t("components.orderExportExcel.index"),label:t("components.orderExportExcel.index"),disabled:!1,key:"STT"},{title:t("pages.shop.product.transfer.warehouseTransferId"),label:t("pages.shop.product.transfer.warehouseTransferId"),disabled:!1,key:"ID"},{title:t("pages.shop.product.transfer.fromWarehouse"),label:t("pages.shop.product.transfer.fromWarehouse"),disabled:!1,key:"FROM WAREHOUSE"},{title:t("pages.shop.product.transfer.fromWarehouseName"),label:t("pages.shop.product.transfer.fromWarehouseName"),disabled:!1,key:"FROM WAREHOUSE NAME"},{title:t("pages.shop.product.transfer.toWarehouse"),label:t("pages.shop.product.transfer.toWarehouse"),disabled:!1,key:"TO WAREHOUSE"},{title:t("pages.shop.product.transfer.toWarehouseName"),label:t("pages.shop.product.transfer.toWarehouseName"),disabled:!1,key:"TO WAREHOUSE NAME"},{title:t("pages.shop.product.transfer.note"),label:t("pages.shop.product.transfer.note"),disabled:!1,key:"NOTE"},{title:t("pages.shop.product.transfer.shippingFee"),label:t("pages.shop.product.transfer.shippingFee"),disabled:!1,key:"SHIPPING FEE"},{title:t("pages.shop.product.transfer.productName"),label:t("pages.shop.product.transfer.productName"),disabled:!1,key:"PRODUCT NAME"},{title:t("pages.shop.product.transfer.productId"),label:t("pages.shop.product.transfer.productId"),disabled:!1,key:"PRODUCT ID"},{title:t("pages.shop.product.transfer.variationId"),label:t("pages.shop.product.transfer.variationId"),disabled:!1,key:"VARIATION ID"},{title:t("pages.shop.product.transfer.quantity"),label:t("pages.shop.product.transfer.quantity"),disabled:!1,key:"QUANTITY"},{title:"Barcode",label:"Barcode",disabled:!1,key:"BARCODE"},{title:t("pages.shop.product.transfer.completionDate"),label:t("pages.shop.product.transfer.completionDate"),disabled:!1,key:"COMPLETED AT"},{title:t("pages.shop.product.stocktaking.status"),label:t("pages.shop.product.stocktaking.status"),disabled:!1,key:"STATUS"},{title:t("pages.shop.product.transfer.totalRetailPrice"),label:t("pages.shop.product.transfer.totalRetailPrice"),disabled:!1,key:"RETAIL PRICE"},{title:t("pages.shop.product.transfer.totalImportPrice"),label:t("pages.shop.product.transfer.totalImportPrice"),disabled:!1,key:"IMPORTED PRICE"},{title:t("pages.shop.product.transfer.insertedAt"),label:t("pages.shop.product.transfer.insertedAt"),disabled:!1,key:"INSERTED AT"}]})),(0,_.Z)((0,h.Z)(r),"takeValue",(function(t,e,n,o){var a,i,s,c,l,d,u,p,f,h,m,v,g=r.props.timezone,y=r.state.valueFormatDateTime,_=e.items[o];switch(t){case"PRODUCT NAME":return null===(a=_.variation)||void 0===a||null===(i=a.product)||void 0===i?void 0:i.name;case"PRODUCT ID":return(null===(s=_.variation)||void 0===s||null===(c=s.product)||void 0===c?void 0:c.custom_id)||(null===(l=_.variation)||void 0===l||null===(d=l.product)||void 0===d?void 0:d.display_id);case"VARIATION ID":return(null===(u=_.variation)||void 0===u?void 0:u.custom_id)||(null===(p=_.variation)||void 0===p?void 0:p.display_id);case"QUANTITY":return _.quantity;case"RETAIL PRICE":return(_.variation.retail_price||0)*_.quantity;case"IMPORTED PRICE":return(_.variation.last_imported_price||0)*_.quantity;case"BARCODE":return(null===(f=_.variation)||void 0===f?void 0:f.barcode)||"".concat(null===(h=_.variation)||void 0===h||null===(m=h.product)||void 0===m?void 0:m.display_id,"-").concat(null===(v=_.variation)||void 0===v?void 0:v.display_id)}if(0==o)switch(t){case"STT":return++n;case"ID":return e.display_id;case"FROM WAREHOUSE":return e.from_warehouse_id;case"FROM WAREHOUSE NAME":return e.from_warehouse_name;case"TO WAREHOUSE":return e.to_warehouse_id;case"TO WAREHOUSE NAME":return e.to_warehouse_name;case"NOTE":return e.note;case"SHIPPING FEE":return e.shipping_fee;case"COMPLETED AT":return 2==e.status&&e.updated_status_at?(0,$.o0x)(g,e.updated_status_at,!1,y):"";case"INSERTED AT":return(0,$.o0x)(g,e.inserted_at,!1,y);case"STATUS":return(0,$.uzL)()[e.status].text}return null})),(0,_.Z)((0,h.Z)(r),"getFormFields",(function(){var t=r.state,e=t.exportKeys,n=t.exportOptions;switch(t.form){case 1:var o=["STT","ID","FROM WAREHOUSE","FROM WAREHOUSE NAME","TO WAREHOUSE","TO WAREHOUSE NAME","NOTE","SHIPPING FEE","PRODUCT NAME","PRODUCT ID","VARIATION ID","QUANTITY","BARCODE","COMPLETED AT","STATUS","RETAIL PRICE","IMPORTED PRICE","INSERTED AT"];return n.filter((function(t){return o.includes(t.key)}));case 3:return e.filter((function(t){return-1!=n.findIndex((function(e){return e.key===t}))})).map((function(t){var e=n.find((function(e){return e.key===t}));return{label:e.label,key:e.key}}))}})),(0,_.Z)((0,h.Z)(r),"transformExports",(function(t,e){var n=r.state.form,o=r.getFormFields(n),a=[],i=!![3].includes(n)&&r.state.exportOneLine,s=!![3].includes(n)&&r.state.exportDetail,c=o.find((function(t){return["STT","ID","PRODUCT NAME","PRODUCT NAME"].includes(t.key)})),l=function(t,e,n){var i={};o.forEach((function(o){var a=o.key,s=o.label;i=Pt(Pt({},i),{},(0,_.Z)({},s,r.takeValue(a,t,e,n)))})),n||(t.transformIndex=a.length),a.push(i)},d=[];t.forEach((function(t,n){if(0==t.items.length||i?d.push(n+e+1):i||t.items.forEach((function(t){return d.push(n+e+1)})),t.items.length&&c)if(i){var s={};o.forEach((function(o){var a=o.key,i=o.label,c=t.items.map((function(o,i){return r.takeValue(a,t,n+e,i)})),l=["PRODUCT NAME","PRODUCT ID","VARIATION ID","QUANTITY","RETAIL PRICE","IMPORTED PRICE","BARCODE"].findIndex((function(t){return t==a}));s=Pt(Pt({},s),{},(0,_.Z)({},i,-1!=l?c.join("; "):c.join("")))})),a.push(s)}else t.items.forEach((function(r,o){l(t,n+e,o)}));else l(t,n+e)})),s&&d.forEach((function(t,e){d[e]==d[e-1]&&a[e]&&Object.keys(a[e]).forEach((function(t){if(!a[e]["".concat(t)]||""===a[e]["".concat(t)])return a[e]["".concat(t)]=a[e-1]["".concat(t)]}))})),r.transformedExports=r.transformedExports.concat(a),r.arrRows=r.arrRows.concat(d)})),(0,_.Z)((0,h.Z)(r),"handleFetchData",(function(){var t=r.props,e=t.accessToken,n=t.shopId,o=t.selectedRowKeys,a=Pt(Pt({},t.filter),{},{page:1,page_size:30,transfer_ids:o,is_variation:!0});r.setState({isDownloading:!0});var i=[],s="".concat((0,$.LpH)(),"/shops/").concat(n,"/transfers?access_token=").concat(e);return function t(e){return Q()({method:"get",url:s,params:e}).then((function(n){if(n.data.success){var o=n.data.data;return i=i.concat(o),0==o.length||i.length>=n.data.total_entries?(r.setState({transfers:i}),i.length==n.data.total_entries&&r.setState({isLoading:!1}),i):(e.page+=1,t(e))}return i})).catch($.s0o)}(a).then((function(t){t?r.setState({transfers:t,isDownloading:!1},(function(){return r.handleExportExcel()})):r.setState({isDownloading:!1})}))})),(0,_.Z)((0,h.Z)(r),"handleExportExcel",(0,p.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=r.state.transfers).length){t.next=6;break}return t.next=4,r.handleFetchData();case 4:t.next=7;break;case 6:setTimeout((0,p.Z)(u().mark((function t(){var n,o,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.transformedExports=[],r.arrRows=[],r.transformExports(e,0),n=r.getFormFields(),o=function(t,e){var n=new ExcelJS.Workbook,o=new Date;n.created=o,n.modified=o;var a=n.addWorksheet("sheet");a.columns=t,Array.isArray(r.arrRows)&&r.arrRows.length!=e.length&&(r.arrRows=uniq(r.arrRows));var i,s=xt(e.entries());try{for(s.s();!(i=s.n()).done;){var c=(0,ut.Z)(i.value,2),l=(c[0],c[1]);l.buffer&&delete l.buffer;a.addRow(l)}}catch(u){s.e(u)}finally{s.f()}var d=[];return r.arrRows=d.concat(r.arrRows),a.eachRow((function(t,e){e>1&&r.arrRows[e-2]%2!=0&&(a.getRow(e).fill=It)})),n.xlsx.writeBuffer().then((function(t){(0,et.saveAs)(new Blob([t],{type:"application/octet-stream"}),"export_transfer.xlsx")}))},a=n.map((function(t){var e=r.transformedExports[0]&&r.transformedExports[0][t.label],n=e?1.33*e.toString().length:20;return{header:t.label,key:t.label,width:n>60?60:n>=30?n:20}})),o(a,r.transformedExports),r.setState({isDownloading:!1});case 8:case"end":return t.stop()}}),t)}))));case 7:case"end":return t.stop()}}),t)})))),(0,_.Z)((0,h.Z)(r),"onChangeExportOptionsDrag",(function(t){!t.includes("STT")&&!t.includes("ID")&&!t.includes("PRODUCT ID")&&t.unshift("PRODUCT NAME"),localStorage.setItem("export_transfer_columns",JSON.stringify({exportKeys:t})),r.setState({exportKeys:t})})),(0,_.Z)((0,h.Z)(r),"renderSettingCustomForm",(function(){var t=r.props.t,e=r.state,n=e.exportKeys,o=e.exportOptions,a=e.exportOneLine,s=e.exportDetail,c=o.map((function(t){return{title:t.label,dataIndex:t.key}})),l=(0,$.HUL)(c),d=l.translate,u=l.allColumns;return _t("div",{className:"export-excel-setting"},_t("div",{className:"check-save",style:{display:"flex",justifyContent:"space-between",padding:"0px 16px 17px 16px"}},_t("div",{style:{display:"grid"}},_t(i.default,{title:t("pages.shop.product.exportAccessories.exportDetailsForEachAccessory")},_t("span",{style:{float:"left",marginTop:5,fontSize:14,cursor:"pointer"}},_t(dt.default,{checked:s,onChange:function(t){var e=t.target.checked;localStorage.setItem("exportTransferDetail",e),r.setState({exportDetail:e}),e&&(localStorage.setItem("exportTransferOneLine",!1),r.setState({exportOneLine:!1}))}},t("components.orderExportExcel.showDetailsOfEachProduct")))),_t(i.default,{title:t("components.orderExportExcel.showDetailOrderInOneLineTip")},_t("span",{style:{float:"left",marginTop:5,fontSize:14,cursor:"pointer"}},_t(dt.default,{checked:a,onChange:function(t){var e=t.target.checked;localStorage.setItem("exportTransferOneLine",e),r.setState({exportOneLine:e}),e&&(localStorage.setItem("exportTransferDetail",!1),r.setState({exportDetail:!1}))}},t("components.orderExportExcel.showDetailOrderInOneLine")))))),_t(vt.Z,{t:t,isExportExcel:!0,translate:d,defaultCheckedList:[],displayColumns:n,addOptionColumns:u.filter((function(t){return!n.includes(t)})),dataSearch:o,onChangeExportOptionsDrag:r.onChangeExportOptionsDrag}))})),(0,_.Z)((0,h.Z)(r),"handleFormatDateTime",(function(t){r.setState({valueFormatDateTime:t}),localStorage.setItem("formatTimeTransferNew",t)})),(0,_.Z)((0,h.Z)(r),"renderModalFooter",(function(){var t=r.state,e=t.isDownloading,n=t.form,o=t.valueFormatDateTime,i=r.props.t,s={display:"flex",justifyContent:"space-between"};return _t("div",{style:3==n?Pt(Pt({},s),{},{padding:"10px 10px 10px 0px"}):{padding:"10px 10px 10px 0px",textAlign:"right"}},3==n&&_t("div",{style:Pt(Pt({},s),{},{width:350})},_t("div",{style:{fontWeight:500,paddingTop:3,marginLeft:3}},i("components.customerExportExcel.formatDateTime"),":"),_t(pt.default,{style:{width:190},defaultValue:o,onChange:function(t){return r.handleFormatDateTime(t)}},_t(Zt,{value:"DD-MM-YYYY"},"DD-MM-YYYY "),_t(Zt,{value:"HH:mm YYYY-MM-DD"},"HH:mm YYYY-MM-DD"))),_t("div",null,_t(a.default,{className:"order-action-button",disabled:e,type:"primary",onClick:function(){return r.handleExportExcel()}},_t("span",null,_t(e?k.Z:O.Z,null)," ",i("components.customerExportExcel.download")))))})),(0,_.Z)((0,h.Z)(r),"onChangeForm",(function(t){r.setState({form:t}),localStorage.setItem("export_transfer",t)})),(0,_.Z)((0,h.Z)(r),"renderContent",(function(){var t=r.props,e=t.currentShop,n=t.t,o=r.state.form,a=(0,$.odE)();return _t("div",{className:"export-excel-container"},1==e.type&&_t("div",{className:"export-excel-header",style:{paddingBottom:0}},_t("div",{style:{display:"flex"}},_t("div",{style:{display:"grid",paddingTop:10}},_t("span",{className:"span-export"},n("components.exportPurchase.chooseDownloadTemplate")),_t(pt.default,{style:{width:350,marginTop:5},value:o,onChange:r.onChangeForm},a.map((function(t){return _t(Zt,{value:t.value,key:t.value},t.label)}))))),r.renderModalFooter()),3==o&&r.renderSettingCustomForm())})),(0,_.Z)((0,h.Z)(r),"renderTitle",(function(){var t=r.props,e=t.selectedRowKeys,n=t.t;return"".concat(n("components.transferWarehouseExportExcel.download")," ").concat(e.length>0?"".concat(e.length," ").concat(n("pages.shop.product.transfer.selected")):n("components.transferWarehouseExportExcel.downloadAllTransferWarehouse"))}));var o=[{label:t.t("components.orderExportExcel.index"),key:"STT"},{label:"ID",key:"ID"},{label:t.t("components.productCreatorFirstStep.nameProduct"),key:"PRODUCT NAME"}],s=localStorage.getItem("export_transfer_columns")?JSON.parse(localStorage.getItem("export_transfer_columns")).exportKeys:o.map((function(t){return t.key})),c=JSON.parse(localStorage.getItem("export_transfer"));return r.state={transfers:[],isDownloading:!1,modalVisible:!1,form:c||1,exportOptions:ht()(r.columnOptions(),{$apply:function(t){return t.map((function(t){var e=o.find((function(e){return e.key===t.key}));return e?Pt(Pt({},t),{},{label:e.label}):t}))}}),exportKeys:s,listExportForm:[],exportOneLine:JSON.parse(localStorage.getItem("exportTransferOneLine"))||!1,exportDetail:JSON.parse(localStorage.getItem("exportTransferDetail"))||!1,valueFormatDateTime:localStorage.getItem("formatTimeTransferNew")||"DD-MM-YYYY"},r.transformedExports=[],r.arrRows=[],r}return(0,m.Z)(n,[{key:"render",value:function(){var t=this,e=this.props,n=e.t,r=e.isButton,o=e.title,a=e.selectedRowKeys,i=this.state.modalVisible;return _t("div",{style:{display:"inline"}},_t(Y.Z,{title:o,icon:_t(O.Z,null),onClick:function(){return t.setState({modalVisible:!0})},isButton:r,tooltip:a.length>0?n("components.customerExportExcel.download")+" "+a.length+" "+n("pages.shop.product.export_excel.selectedExport"):n("pages.shop.product.export.exportToExcel")}),_t(b.Z,{wrapClassName:"update-order-tool",visible:i,title:this.renderTitle(),width:800,footer:null,onCancel:function(){return t.setState({modalVisible:!1,transfers:[]})}},this.renderContent()),_t("style",{dangerouslySetInnerHTML:{__html:yt()}}))}}]),n}(Z.Component))||it,Ot=(0,I.$j)((function(t){return{currentShop:t.shop.currentShop,timezone:t.navigation.user.timezone,users:t.user.users,warehouses:(0,mt.op)(t)}}),{})(kt),Dt=r(65644),Et=r(92902),Ct=r(50361),Rt=r.n(Ct),Lt=r(89734),Nt=r.n(Lt),At=r(74298),Ft=function(t,e,n,r){var o=r.find((function(e){return e.id==t.from_warehouse_id}))||{},a=r.find((function(e){return e.id==t.to_warehouse_id}))||{},i=Nt()(t.items,"display_id"),s=e.use_warehouse_position?Nt()(Rt()(t.items),(function(e){var n,r,o,a,i,s,c=((null===e||void 0===e||null===(n=e.variation)||void 0===n?void 0:n.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t.from_warehouse_id}))||{},l=((null===e||void 0===e||null===(r=e.variation)||void 0===r?void 0:r.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t.to_warehouse_id}))||{},d=c.shelf_position||l.shelf_position;return d?(0,$.pjl)(d):(null===e||void 0===e||null===(o=e.variation)||void 0===o||null===(a=o.product)||void 0===a?void 0:a.custom_id)||(0,$.pyT)(null===e||void 0===e||null===(i=e.variation)||void 0===i||null===(s=i.product)||void 0===s?void 0:s.display_id)})):i,c=[653531],l=[2166282],d=[2166282];return'<div class="transfer-printer">\n      <div class="title">\n        <strong style="text-transform: uppercase;">'.concat(At.ZP.t("pages.shop.product.transfer.print.warehouseTransferBill"),'</strong>\n      </div>\n      <div class="info">\n        <div style="display: grid; grid-template-columns: 50% 50%">\n          <div>\n            ').concat(At.ZP.t("pages.shop.product.transfer.print.warehouseTransferId"),": <strong>").concat(t.display_id,"</strong>\n          </div>\n          <div>\n            ").concat(At.ZP.t("crm.creator"),": <strong>").concat(t.creator?t.creator.name:At.ZP.t("pages.admin.system"),"</strong>\n          </div>\n          <div>\n            ").concat(At.ZP.t("crm.inserted_at"),": ").concat((0,$.o0x)(n||7,t.inserted_at,!1,"DD/MM/YYYY HH:mm"),'\n          </div>\n        </div>\n        <div>\n          <div style="margin-top: 4px; font-weight: 600">\n          <i style="text-transform: uppercase;">').concat(At.ZP.t("pages.shop.product.transfer.warehouseTransfer"),'</i>\n          </div>\n          <div style="display: grid; grid-template-columns: 50% 50%">\n            <div>\n              ').concat(At.ZP.t("crm.name"),": <strong>").concat(null===o||void 0===o?void 0:o.name,"</strong>\n            </div>\n            <div>\n              ").concat(At.ZP.t("crm.phone"),": ").concat((null===o||void 0===o?void 0:o.phone_number)||"","\n            </div>\n          </div>\n          <div>\n            ").concat(At.ZP.t("address"),": ").concat((null===o||void 0===o?void 0:o.full_address)||"",'\n          </div>\n        </div>\n        <div>\n          <div style="margin-top: 4px; font-weight: 600">\n          <i style="text-transform: uppercase";>').concat(At.ZP.t("pages.shop.product.transfer.warehouseReceive"),'</i>\n          </div>\n          <div style="display: grid; grid-template-columns: 50% 50%">\n            <div>\n              ').concat(At.ZP.t("crm.name"),": <strong>").concat((null===a||void 0===a?void 0:a.name)||"","</strong>\n            </div>\n            <div>\n              ").concat(At.ZP.t("crm.phone"),": ").concat((null===a||void 0===a?void 0:a.phone_number)||"","\n            </div>\n          </div>\n          <div>\n            ").concat(At.ZP.t("address"),": ").concat((null===a||void 0===a?void 0:a.full_address)||"",'\n          </div>\n        </div>\n      </div>\n      <div class="note-transfer">\n        ').concat(t.note?'<div style="margin-top: 4px;">\n            <span style="font-weight: 600"><i style="text-transform: uppercase";>'.concat(At.ZP.t("pages.shop.product.transfer.note"),": </i></span> <span><i>").concat(t.note,"</i></span>\n          </div>"):"<div></div>",'\n      </div>\n      <table class="table" ><tbody>\n        <thead>\n          <tr style="text-align: center; height: 25px">\n            <th width="5%" >#</th>\n            <th width="13%">').concat(At.ZP.t("pages.shop.product.transfer.productId"),'</th>\n            <th width="13%">').concat(At.ZP.t("pages.shop.product.transfer.variationId"),'</th>\n            <th style="display: ').concat(c.includes(e.id)?"none":"",'">').concat(At.ZP.t("defaultPrint.variationName"),"</th>\n            ").concat(e.use_warehouse_position&&!d.includes(e.id)?'<th width="10%">'.concat(At.ZP.t("pages.shop.product.transfer.print.oldShelfPosition"),"</th>"):'<th style="display: none;"></th>',"\n            ").concat(e.use_warehouse_position&&!d.includes(e.id)?'<th width="10%">'.concat(At.ZP.t("pages.shop.product.transfer.print.newShelfPosition"),"</th>"):'<th style="display: none;"></th>','\n            <th style="display: ').concat(l.includes(e.id)?"none":"",'" width="10%">').concat(At.ZP.t("pages.shop.product.transfer.fromWarehouse"),'</th>\n            <th style="display: ').concat(l.includes(e.id)?"none":"",'" width="10%">').concat(At.ZP.t("pages.shop.product.transfer.toWarehouse"),'</th>\n            <th width="10%">').concat(At.ZP.t("systemLogs.quantity"),"</th>\n          </tr>\n        </thead>\n        ").concat(s.map((function(n,r){var o,a,i,s,u,p,f,h,m=((null===n||void 0===n||null===(o=n.variation)||void 0===o?void 0:o.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t.from_warehouse_id}))||{},v=((null===n||void 0===n||null===(a=n.variation)||void 0===a?void 0:a.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t.to_warehouse_id}))||{};return'<tr>\n                <td style="text-align: center; height: 25px ">'.concat(r+1,"</td>\n                <td>").concat((null===n||void 0===n||null===(i=n.variation)||void 0===i||null===(s=i.product)||void 0===s?void 0:s.custom_id)||(0,$.pyT)(null===n||void 0===n||null===(u=n.variation)||void 0===u||null===(p=u.product)||void 0===p?void 0:p.display_id),"</td>\n                <td>").concat((null===n||void 0===n||null===(f=n.variation)||void 0===f?void 0:f.custom_id)||(0,$.pyT)(null===n||void 0===n||null===(h=n.variation)||void 0===h?void 0:h.display_id),'</td>\n                <td style="text-transform: uppercase; height: 25px; text-indent: 20px; display: ').concat(c.includes(e.id)?"none":"",'">\n                  ').concat(n.product_name," ").concat(n.variation_fields?n.variation_fields.map((function(t){return"".concat(t.value)})).join(" - "):"","\n                </td>\n                ").concat(e.use_warehouse_position&&!d.includes(e.id)?"<td>".concat(m.shelf_position||"","</td>"):'<td style="display: none;"></td>',"\n                ").concat(e.use_warehouse_position&&!d.includes(e.id)?"<td>".concat(v.shelf_position||"","</td>"):'<td style="display: none;"></td>','\n                <td style="display: ').concat(l.includes(e.id)?"none":"",'"></td>\n                <td style="display: ').concat(l.includes(e.id)?"none":"",'"></td>\n                <td class="display-number">').concat((0,$.ufS)(n.quantity,e.currency,!1),"</td>\n              </tr>")})).join(""),"\n        <tr>\n        ").concat(e.use_warehouse_position&&!d.includes(e.id)?'<th colspan="'.concat(c.includes(e.id)?7:l.includes(e.id)?6:8,'" style=" height: 25px ">').concat(At.ZP.t("crm.crmOverview.total"),"</th>"):'<th colspan="'.concat(c.includes(e.id)?5:l.includes(e.id)?4:6,'" style=" height: 25px ">').concat(At.ZP.t("crm.crmOverview.total"),"</th>"),'\n          <th style=" height: 25px; text-align: right; text-indent: 2px">\n            ').concat((0,$.ufS)(t.items.reduce((function(t,e){return t+e.quantity}),0),e.currency,!1),'\n          </th>\n        </tr>\n      </tbody></table>\n      <div style="display: flex; justify-content: space-around; margin-top: 10px;">\n        <div>\n          <div>').concat(At.ZP.t("pages.shop.product.transfer.creator"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n        <div>\n          <div>").concat(At.ZP.t("pages.shop.product.transfer.print.deliver"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n        <div>\n          <div>").concat(At.ZP.t("pages.shop.product.transfer.print.receiver"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n        <div>\n          <div>").concat(At.ZP.t("pages.shop.product.transfer.print.stocker"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n        <div>\n          <div>").concat(At.ZP.t("pages.shop.product.transfer.print.chiefAccountant"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n        <div>\n          <div>").concat(At.ZP.t("pages.shop.product.transfer.print.director"),'</div>\n          <div style="font-size: 10px;">(').concat(At.ZP.t("pages.shop.product.transfer.print.sign"),")</div>\n        </div>\n      </div>\n    </div>\n  ")},Wt=r(96981),Mt=r.n(Wt),jt=r(36934),Ht=r(7690),Ut=r(97705),zt=r(37508),qt=r(30381),Kt=r.n(qt),Bt=r(74018),Vt=r(2307),Yt=r(62443),Gt=r(84960),$t=r(20838),Jt=r(7739),Qt=r.n(Jt),Xt=r(99562),te=r(67724),ee=r(76629),ne=r(7859),re=r(96129),oe=r(9010),ae=r.n(oe),ie=Z.createElement;function se(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ce(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(Object(n),!0).forEach((function(e){(0,_.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ue(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,y.Z)(t);if(e){var o=(0,y.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,g.Z)(this,n)}}var pe=["index","product_id","display_id","variation_display_id","name","variation","images","from_warehouses","warehouses","quantity","batchPosition","shelfPosition","batchPositionFrom","shelfPositionFrom","actual_remain_quantity","last_imported_price","price_list"],fe=["index","product_id","variation_display_id","name","variation","images","from_warehouses","warehouses","quantity"],he=[],me=$t.default.TabPane,ve={page:1,page_size:30},ge="table-printer-products",ye=function(t){return"history"==t?".table-printer-products-history .ant-table-body colgroup":".table-printer-products .ant-table-body colgroup"},_e=(0,K.Z)()(St=function(e){(0,v.Z)(r,e);var n=ue(r);function r(e){var o,c;(0,f.Z)(this,r),c=n.call(this,e),(0,_.Z)((0,h.Z)(c),"fetchListOfPrintedTransferProducts",(0,p.Z)(u().mark((function t(){var e,n,r,o,a,i,s=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:ve,n=c.props,r=n.fetchListOfPrintedTransferProducts,o=n.accessToken,a=n.shopId,c.setState({loadingPrintedProducts:!0}),e=de({},e),t.next=6,r(o,a,e);case 6:i=t.sent,c.setState({historiesPrinted:(null===i||void 0===i?void 0:i.data)||[],totalPrintedProducts:(null===i||void 0===i?void 0:i.total_entries)||null,loadingPrintedProducts:!1});case 8:case"end":return t.stop()}}),t)})))),(0,_.Z)((0,h.Z)(c),"columns",[{title:c.props.t("components.orderExportExcel.index"),dataIndex:"index",ellipsis:!0},{title:c.props.t("components.productComboDetail.productId"),dataIndex:"product_id",ellipsis:!0},{title:c.props.t("components.productComboDetail.transferWarehouseId"),dataIndex:"display_id",ellipsis:!0},{title:c.props.t("components.productComboDetail.variationId"),dataIndex:"variation_display_id",ellipsis:!0},{title:c.props.t("products.title"),dataIndex:"name",ellipsis:!0},{title:c.props.t("components.productComboDetail.infoProduct"),dataIndex:"variation",ellipsis:!0},{title:c.props.t("pages.shop.product.variation.image"),dataIndex:"images",align:"center"},{title:c.props.t("pages.shop.product.inventoryHistory.type.transferFromWarehouse"),dataIndex:"from_warehouses",ellipsis:!0},{title:c.props.t("pages.shop.product.inventoryHistory.type.toWarehouse"),dataIndex:"warehouses",ellipsis:!0},{title:c.props.t("pages.shop.product.exportAccessories.quantity"),dataIndex:"quantity",align:"right",ellipsis:!0},{title:"T\u1ed3n kho",dataIndex:"actual_remain_quantity",ellipsis:!0},{title:c.props.t("pages.shop.product.variation.lastImportPrice"),dataIndex:"last_imported_price",ellipsis:!0},{title:c.props.t("pages.shop.product.variation.retailPrice"),dataIndex:"price_list",ellipsis:!0}].concat(c.props.currentShop.use_warehouse_position?[{title:c.props.t("components.printedListProduct.batchPositionTo"),dataIndex:"batchPosition",ellipsis:!0},{title:c.props.t("components.printedListProduct.shelfPositionTo"),dataIndex:"shelfPosition",ellipsis:!0},{title:c.props.t("components.printedListProduct.batchPositionFrom"),dataIndex:"batchPositionFrom",ellipsis:!0},{title:c.props.t("components.printedListProduct.shelfPositionFrom"),dataIndex:"shelfPositionFrom",ellipsis:!0}]:[])),(0,_.Z)((0,h.Z)(c),"handleProductExcel",(function(){c.props.t;!function(t,e){var n=new ExcelJS.Workbook,r=n.addWorksheet("DS San pham");r.columns=t;var o,a=se(e.entries());try{for(a.s();!(o=a.n()).done;){var i,s,c,l,d=(0,ut.Z)(o.value,2),u=d[0],p=d[1];r.addRow({index:u+1,product_id:p.product_id,variation_display_id:p.variation_display_id,name:p.name,variation:p.variation,display_id:p.displayIds&&(null===(i=p.displayIds)||void 0===i?void 0:i.length)>0?null===(s=p.displayIds)||void 0===s?void 0:s.join(", "):"",warehouses:p.warehouses,from_warehouses:p.from_warehouses,quantity:p.quantity,batchPosition:p.batchPosition,shelfPosition:p.shelfPosition,shelfPositionFrom:p.shelfPositionFrom,batchPositionFrom:p.batchPositionFrom,actual_remain_quantity:p.actual_remain_quantity,images:null!==p&&void 0!==p&&p.images&&(null===(c=p.images)||void 0===c?void 0:c.length)>0?null===(l=p.images)||void 0===l?void 0:l[0]:"",last_imported_price:p.last_imported_price,price_list:p.price_list})}}catch(f){a.e(f)}finally{a.f()}n.xlsx.writeBuffer().then((function(t){(0,et.saveAs)(new Blob([t],{type:"application/octet-stream"}),"Export.xlsx")}))}(c.state.checkedListProduct.map((function(t){return c.columns.find((function(e){return e.dataIndex==t}))})).map((function(t){return{header:t.title,key:t.dataIndex,width:25}})),c.getProductData(c.state.listProduct))})),(0,_.Z)((0,h.Z)(c),"handleFetchTransfer",(function(){(0,c.props.fetch)().then((function(){c.state.modalVisible&&c.setState({isLoadingProduct:!1},(function(){c.getListProduct(),(0,$.oSE)(ge)}))}))})),(0,_.Z)((0,h.Z)(c),"cancelFetch",(function(){var t=c.props.cancelLoadingTransfers;c.setState({modalVisible:!1},(function(){c.setState({isLoadingProduct:!0})})),t()})),(0,_.Z)((0,h.Z)(c),"printProduct",(function(t){var e=c.props.t,n=c.state.checkedListProduct.map((function(t){return c.columns.find((function(e){return e.dataIndex==t}))})),r=0;t.forEach((function(t){return r+=t.quantity}));var o=Object.keys(c.columnWidth).reduce((function(t,e){return t+(parseFloat(c.columnWidth[e])||0)}),0);return'<div>\n      <div style="margin-top: 50px"><h1 style="text-align: center">'.concat(e("components.listProduct"),'</h1></div>\n      <div style="margin-top: 10px">\n        <span style="margin-left: 47%">').concat(e("components.printedListProduct.totalTransferWarehouses"),": ").concat(r,',</span>\n        <span style="margin-left: 5px">').concat(e("components.printedListProduct.insertedAt"),": ").concat(Kt()().format("HH:mm DD/MM/YYYY"),'</span>\n      </div>\n      <table style="margin-top: 20px; width: 90%; margin-left: 30px; table-layout: fixed">\n        <thead>\n          <tr>\n            ').concat(n.map((function(t){var e=t.dataIndex,n=t.title;return'<th style="width:'.concat(100*c.columnWidth[e]/o,'px">').concat(n,"</th>")})).join(""),"\n          </tr>\n        </thead>\n        <tbody>\n          ").concat(t.map((function(t,e){return"<tr>\n                    ".concat(n.map((function(n){var r,a,i,s=n.dataIndex,l=100*c.columnWidth[s]/o;switch(s){case"index":return'<td style="width: '.concat(l,'%;">').concat(e+1,"</td>");case"images":return'<td style="width: '.concat(l,'%;">').concat(null!==(r=t.images)&&void 0!==r&&r.length?'<img src="'.concat(t.images[0],'" style="width: 50px; height: 50px; margin: 2px"></img>'):'<div style="width: 50px; height: 50px; margin: 2px"></div>',"</td>");case"display_id":return'<td style="width: '.concat(l,'%;">').concat(t.displayIds&&(null===(a=t.displayIds)||void 0===a?void 0:a.length)>0?null===(i=t.displayIds)||void 0===i?void 0:i.join(", "):"","</td>");default:return'<td style="width: '.concat(l,'%;">').concat(t[s]||"","</td>")}})).join(""),"\n                  </tr>")})).join(""),'\n        </tbody>\n        <tfoot>\n          <tr>\n            <th scope="row" colspan="').concat(n.length-1,'" style="text-align: right" >').concat(c.props.t("pages.shop.statistic.transport.total"),'</th>\n            <td style="text-align: right">').concat(r,"</td>\n          </tr>\n        </tfoot>\n      </table>\n      <style>\n        table,th,td {\n        border: 1px solid black;\n        border-collapse: collapse;\n        padding: 5px\n        }\n      </style>\n    </div>")})),(0,_.Z)((0,h.Z)(c),"handlePrint",(function(){return c.setState({isPrinting:!0},(function(){var t=document.getElementById(c.printDivId).innerHTML,e=document.createElement("iframe");e.name="frame1",e.style.position="absolute",e.style.top="-1000000px",document.body.appendChild(e);var n=c.props.t,r=e.contentWindow?e.contentWindow:e.contentDocument.document?e.contentDocument.document:e.contentDocument;r.document.open(),r.document.write("<!DOCTYPE html>\n      <head>\n        <title>".concat(n("components.listProduct"),"</title>\n        <style type='text/css'>\n          @media print {\n            @page {\n              size: auto;\n              margin: 0;\n              padding: 0;\n            }\n          }\n\n          table {\n            page-break-inside: auto;\n            page-break-after:always;\n          }\n\n          thead {\n            display: table-header-group;\n          }\n\n          tr {\n            page-break-inside: avoid;\n            page-break-after: auto;\n          }\n\n          td {\n            word-wrap: break-word;\n          }\n        </style>\n      </head>\n      <body>\n        ").concat(t,"\n      </body>\n    </html>")),r.document.close(),setTimeout((function(){window.frames.frame1.focus(),window.frames.frame1.print(),document.body.removeChild(e)}),500),c.setState({isPrinting:!1}),c.createHistotiesPrinted()}))})),(0,_.Z)((0,h.Z)(c),"createHistotiesPrinted",(function(){var t=c.props,e=t.accessToken,n=t.shopId,r=t.transfers,o=t.user;(0,t.createHistoriesPrintedTransferProducts)(e,n,{transfers:r.length>0?r.map((function(t){return t.id})):-1,creator_id:o.uid})})),(0,_.Z)((0,h.Z)(c),"getProducts",(function(t){var e=[];return t.map((function(t){var n,r={id:t.to_warehouse_id||"",name:t.to_warehouse_name},o={id:t.from_warehouse_id||"",name:t.from_warehouse_name};null!==(n=t.items)&&void 0!==n&&n.length&&t.items.map((function(t){var n={product:t,warehouses:r,from_warehouses:o};e.push(n)}))})),e})),(0,_.Z)((0,h.Z)(c),"getListProduct",(function(){var t=c.props.transfers;c.setState({listProduct:c.getProducts(t)})})),(0,_.Z)((0,h.Z)(c),"conditionGroupData",(function(t,e){return t.variation_id==e.product.variation_id&&t.warehouse_id==e.warehouses.id&&t.from_warehouse_id==e.from_warehouses.id})),(0,_.Z)((0,h.Z)(c),"getProductData",(function(t){t=t||c.state.listProduct;for(var e=[],n=function(n){var r,o,a,i,s,l,d,u,p,f,h="",m=[];null!==(r=t[n].product)&&void 0!==r&&null!==(o=r.variation)&&void 0!==o&&o.fields&&null!==(a=t[n].product)&&void 0!==a&&null!==(i=a.variation)&&void 0!==i&&i.fields.length&&(null===(d=t[n].product)||void 0===d||null===(u=d.variation)||void 0===u||u.fields.map((function(t){h="".concat(h?"".concat(h,", "):""," ").concat(t.name,": ").concat(t.value)})));null!==(s=t[n].product)&&void 0!==s&&null!==(l=s.variation)&&void 0!==l&&l.detail&&(h=null===(p=t[n].product)||void 0===p||null===(f=p.variation)||void 0===f?void 0:f.detail);if(t[n].product.variation){var v,g,y,_,x,w,b,P,T,S,Z,I,k,O,D,E,C,R,L;if(m.push((null===(v=t[n].product)||void 0===v||null===(g=v.variation)||void 0===g?void 0:g.retail_price)||0),m.push((null===(y=t[n].product)||void 0===y||null===(_=y.variation)||void 0===_?void 0:_.retail_price_original)||0),m.push((null===(x=t[n].product)||void 0===x||null===(w=x.variation)||void 0===w?void 0:w.wholesale_price)||0),null!==(b=t[n].product)&&void 0!==b&&null!==(P=b.variation)&&void 0!==P&&P.wholesale_price2&&(null===(T=t[n].product)||void 0===T||null===(S=T.variation)||void 0===S?void 0:S.wholesale_price2.length)>0)null===(E=t[n].product)||void 0===E||null===(C=E.variation)||void 0===C||C.wholesale_price2.forEach((function(t){return m.push(parseInt(t.wholesalePrices||0))}));if(null!==(Z=t[n].product)&&void 0!==Z&&null!==(I=Z.variation)&&void 0!==I&&I.wholesale_price_original&&(null===(k=t[n].product)||void 0===k||null===(O=k.variation)||void 0===O||null===(D=O.wholesale_price_original)||void 0===D?void 0:D.length)>0)null===(R=t[n].product)||void 0===R||null===(L=R.variation)||void 0===L||L.wholesale_price_original.forEach((function(t){return m.push(parseInt(t.wholesalePrices||0))}))}if(0===e.filter((function(e){return c.conditionGroupData(e,t[n])})).length){var N,A,F,W,M=0,j="",H="",U="",z="",q="",K="",B="",V=c.props.transfers.filter((function(e){var r;return-1!==(null===(r=e.items)||void 0===r?void 0:r.findIndex((function(r){return c.conditionGroupData({variation_id:r.variation_id,warehouse_id:e.to_warehouse_id,from_warehouse_id:e.from_warehouse_id},t[n])})))})).map((function(t){return(null===t||void 0===t?void 0:t.custom_id)||(null===t||void 0===t?void 0:t.display_id)}));t.map((function(e){if(c.conditionGroupData({variation_id:e.product.variation_id,warehouse_id:e.warehouses.id,from_warehouse_id:e.from_warehouses.id},t[n])){var r,o;M+=e.product.quantity,j=t[n].warehouses.name,B=t[n].from_warehouses.name;var a=((null===(r=t[n].product.variation)||void 0===r?void 0:r.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t[n].warehouses.id})),i=((null===(o=t[n].product.variation)||void 0===o?void 0:o.variations_warehouses)||[]).find((function(e){return e.warehouse_id==t[n].from_warehouses.id}));if(a&&(H=null===a||void 0===a?void 0:a.batch_position,U=null===a||void 0===a?void 0:a.shelf_position,K="".concat(j,": ").concat((0,$.oH6)(a.actual_remain_quantity))),i&&(z=null===i||void 0===i?void 0:i.batch_position,q=null===i||void 0===i?void 0:i.shelf_position),e.warehouses.id!=t[n].warehouses.id){var s,l=((null===(s=t[n].product.variation)||void 0===s?void 0:s.variations_warehouses)||[]).find((function(t){return t.warehouse_id==e.warehouses.id}));l&&(H=null!=H?"".concat(H," ").concat(H?",":""," ").concat(l.batch_position):"",U=null!=U?"".concat(U," ").concat(U?",":""," ").concat(l.shelf_position):"",K="".concat(K," ").concat(K?",":""," ").concat(e.warehouses.name,": ").concat((0,$.oH6)(l.actual_remain_quantity))),j="".concat(j,", ").concat(e.warehouses.name),B="".concat(B,", ").concat(e.from_warehouses.name)}}}));var Y={displayIds:V,product_id:t[n].product.product_display_id,variation_id:t[n].product.variation_id,name:t[n].product.product_name,variation:h,quantity:M,images:t[n].product.images,variation_display_id:null===(N=t[n].product.variation)||void 0===N?void 0:N.custom_id,from_warehouses:B,warehouses:j,warehouse_id:t[n].warehouses.id,from_warehouse_id:t[n].from_warehouses.id,item_id:t[n].product.id,batchPosition:H,shelfPosition:U,shelfPositionFrom:q,batchPositionFrom:z,sort_variation_attributes:(null===(A=t[n].product.variation_info)||void 0===A?void 0:A.sort_variation_attributes)||"",actual_remain_quantity:K,last_imported_price:(null===(F=t[n].product)||void 0===F||null===(W=F.variation)||void 0===W?void 0:W.last_imported_price)+""||"0",price_list:m.filter((function(t){return t>0})).join(", ")||"0"};e.push(Y)}},r=0;r<t.length;r++)n(r);return Nt()(e,(function(t){return[t.warehouse_id,t.from_warehouse_id,t.product_id]}))})),(0,_.Z)((0,h.Z)(c),"getData",(function(t){return c.getProductData(t).map((function(t,e){var n,r;return{key:e,product_id:t.product_id&&ie(s.default,{color:"green"},t.product_id),index:e+1,variation_display_id:t.variation_display_id&&ie(s.default,{color:"pink"},t.variation_display_id),name:t.name,variation:t.variation,images:c.renderImages(t.images||[]),quantity:ie("span",null,ie("strong",null,(0,$.oH6)(t.quantity))),warehouses:t.warehouses,from_warehouses:t.from_warehouses,variation_id:t.variation_id,item_id:t.item_id,batchPosition:t.batchPosition,shelfPosition:t.shelfPosition,batchPositionFrom:t.batchPositionFrom,shelfPositionFrom:t.shelfPositionFrom,actual_remain_quantity:t.actual_remain_quantity,display_id:t.displayIds&&(null===(n=t.displayIds)||void 0===n?void 0:n.length)>0?null===(r=t.displayIds)||void 0===r?void 0:r.join(", "):"",last_imported_price:t.last_imported_price,price_list:t.price_list,from_warehouse_id:t.from_warehouse_id,warehouse_id:t.warehouse_id}}))})),(0,_.Z)((0,h.Z)(c),"renderImages",(function(t){return ie("div",null,0==t.length?ie("div",null,ie(Gt.ZP,{icon:ie(Xt.Z,null)})):ie(Yt.default,{content:ie("img",{src:t[0],width:350,height:"auto"}),overlayClassName:"popover-image"},ie("img",{style:{borderRadius:"50%",cursor:"pointer"},src:t[0],height:30,width:30})))})),(0,_.Z)((0,h.Z)(c),"removeChildColGroup",(function(t){var e=document.querySelectorAll("".concat(ye(c.state.activePane)).concat(t?" col":" .col-add"));if(e)for(var n=0;n<e.length;n++){var r=e[n];r&&r.parentNode&&r.parentNode.removeChild(r)}})),(0,_.Z)((0,h.Z)(c),"appendChildColumns",(function(t){(t=t||document.querySelector(ye(c.state.activePane)))&&c.calcUpdateColumn(!1).map((function(e){var n=e.width,r=document.createElement("col");r.style.width="".concat(n,"px"),r.style.minWidth="".concat(n,"px"),r.className="col-add",t.appendChild(r)}))})),(0,_.Z)((0,h.Z)(c),"renderStatusTransfer",(function(t,e,n,r){return ie("span",{onClick:function(t){return t.stopPropagation()}},ie(ct.Z,{accessToken:e,shopId:n,transfer:r}))})),(0,_.Z)((0,h.Z)(c),"expandedTransferRowRender",(function(t){var e=c.props,n=e.t,r=e.transfers,o=e.accessToken,a=e.shopId,i=e.timezone,s=e.handleTransferClick,l=[{title:"ID",dataIndex:"display_id",align:"center"},{title:n("pages.shop.order.insertedAt"),dataIndex:"inserted_at",align:"center"},{title:n("pages.shop.product.exportAccessories.quantity"),dataIndex:"missing_quantity",align:"right"},{title:n("status"),dataIndex:"status",align:"center"}],d=r.filter((function(e){return-1!==e.items.findIndex((function(n){var r={variation_id:n.variation_id,warehouse_id:e.to_warehouse_id,from_warehouse_id:e.from_warehouse_id},o={product:{variation_id:t.variation_id},warehouses:{id:t.warehouse_id},from_warehouses:{id:t.from_warehouse_id}};return c.conditionGroupData(r,o)}))}));if(c.state.expandedVariationRowList.length){var u=document.querySelector(ye(c.state.activePane)),p=document.querySelector("".concat(ye(c.state.activePane)," .col-add"));if(u&&!p){c.appendChildColumns(u);try{setTimeout((function(){u.childNodes&&"ant-table-expand-icon-col"==u.childNodes[0].className&&u.removeChild(u.childNodes[0])}),10)}catch(h){console.log(h)}}}var f=[];return d.forEach((function(e){var n=e.items.find((function(e){return e.variation_id===t.variation_id})),r=n&&n.quantity||0;f.push({display_id:e.display_id,inserted_at:(0,re.Dz)({time:(0,$.o0x)(i||7,e.inserted_at),fb_id:!(!e||!e.creator)&&e.creator.fb_id,name:e&&e.creator?e.creator.name:e("pages.shop.order.system")}),missing_quantity:ie("span",null,ie("strong",null,(0,$.oH6)(r))),status:c.renderStatusTransfer(e,o,a,d[0]),id:e.id,transfer:e})})),ie(Vt.Z,{bordered:!1,columns:l,style:{wordBreak:"keep-all !important"},size:"small",rowClassName:function(){return"height-table-row row-variation"},dataSource:f,pagination:!1,rowKey:"id",onRow:function(t){return{onClick:function(e){return s(t.transfer)}}}})})),(0,_.Z)((0,h.Z)(c),"handleVariationClick",(function(t){var e=c.state.expandedVariationRowList;e=e.includes(t)?e.filter((function(e){return e!==t})):e.concat([t]),c.setState({expandedVariationRowList:e})})),(0,_.Z)((0,h.Z)(c),"onChangeTableDisplay",(function(){var t=c.getProductData(c.state.listProduct),e=c.state,n=e.typeShow,r=e.expandedVariationRowList;switch(n){case 0:n=1,r=t.map((function(t,e){return e}));break;case 1:n=0,r=[]}var o={typeShow:n,expandedVariationRowList:r};0==n&&(o.isLoadingProduct=!0),c.setState(o,(function(){return c.setState({isLoadingProduct:!1},(function(){return(0,$.oSE)(ge)}))}))})),(0,_.Z)((0,h.Z)(c),"addRowTable",(function(){var t=c.props,e=t.t,n=t.currentShop,r=c.state.checkedListProduct,o=c.columns.reduce((function(t,e){var n=e.dataIndex,r=e.title;return t[n]=r,t}),{}),a=pe.filter((function(t){return!r.includes(t)}));return a=n.use_warehouse_position?a:a.filter((function(t){return!["batchPosition","shelfPosition"].includes(t)})),ie("div",{style:{marginLeft:10}},ie(vt.Z,{t:e,title:e("pages.shop.order.titleSettingTag"),translate:o,defaultCheckedList:he,isIcon:!1,displayColumns:r,onChange:c.onChangeColumns,addOptionColumns:a}))})),(0,_.Z)((0,h.Z)(c),"onChangeColumns",(function(t){var e=c.state.expandedVariationRowList,n=!1;t.length==c.state.checkedListProduct.length?c.state.checkedListProduct.forEach((function(e){t.find((function(t){return t==e}))||(n=!0)})):n=!0;var r={checkedListProduct:t};n&&(c.columnWidth={},r.widthColumns=c.columnWidth);var o=document.querySelector(ye(c.state.activePane));if(o&&e.length)for(;o.firstChild;)o.removeChild(o.lastChild);e.length||c.removeChildColGroup(),c.setState(r),localStorage.setItem("product_transfer_columns",JSON.stringify({checkedListProduct:t}))})),(0,_.Z)((0,h.Z)(c),"onResize",(function(t,e){var n,r=c.state.checkedListProduct,o=r.findIndex((function(e){return e==t}));if(-1!=o){var a=r[o+1];if(a){var i=e-c.columnWidth[t],s=c.columnWidth[t]+i,l=c.columnWidth[a]-i,d=c.columnWidth[t]+c.columnWidth[a];s<=20&&(s=20,l=d-20),l<=20&&(l=20,s=d-20),c.columnWidth=de(de({},c.columnWidth),{},(n={},(0,_.Z)(n,t,s),(0,_.Z)(n,a,l),n)),c.setState({widthColumns:c.columnWidth},(function(){return localStorage.setItem("columns_width_list_product",JSON.stringify(c.columnWidth))}))}}})),(0,_.Z)((0,h.Z)(c),"calcUpdateColumn",(function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=c.state,r=n.checkedListProduct,o=n.widthColumns,a=n.expandedVariationRowList,i=c.getProductData().map((function(t,e){return de(de({},t),{},{index:e+1})})),s="undefined"!==typeof document&&(null===(t=document.getElementsByClassName("ant-modal-body")[0])||void 0===t?void 0:t.offsetWidth)-48,l=Object.keys(c.columnWidth).reduce((function(t,e){return t+=parseFloat(c.columnWidth[e])}),0);s!=l&&(c.columnWidth={});var d=r.map((function(t){var e=c.columns.find((function(e){return e.dataIndex==t}));if(c.columnWidth[e.dataIndex])e.width=c.columnWidth[e.dataIndex];else{var n=(0,re.MJ)(i,e.dataIndex,e.title,{windowWidth:c.state.windowWidth});e.width=n,c.columnWidth[e.dataIndex]=n}return o&&o[e.dataIndex]&&(e.width=o[e.dataIndex]),e})),u=(d=d.map((function(t,n){return de(de({},t),{},{render:function(e){return"quantity"==t.dataIndex?ie("span",{style:{marginRight:10}},e):e},onHeaderCell:function(t){return{id:t.dataIndex,width:a.length&&e?void 0:t.width,tableClassName:ge,columnNotResize:d.length-1==n&&t.dataIndex,onResize:c.onResize,expanded:!!a.length}}})}))).reduce((function(t,e){return t+parseFloat(e.width)}),0);return u!=s&&(localStorage.removeItem("columns_width_list_product"),d=d.map((function(t,n){var r=parseFloat(t.width)/u*100*s/100;return c.columnWidth[t.dataIndex]=r,d.length==n+1&&localStorage.setItem("columns_width_list_product",JSON.stringify(c.columnWidth)),t.width=r,a.length&&e&&delete t.width,t}))),d})),(0,_.Z)((0,h.Z)(c),"renderTableProducts",(function(t){var e=c.props.t,n=c.state,r=n.listProduct,o=n.expandedVariationRowList,i=n.listProductPrinted,s=0,l=t?i:r;c.getProductData(l).forEach((function(t){return s+=t.quantity}));var d=c.calcUpdateColumn(),u={header:{cell:ne.Z}};return ie(Z.Fragment,null,ie(Vt.Z,{components:u,columns:d,dataSource:c.getData(l),className:"".concat(ge).concat(t?" table-printer-products-history":""),pagination:!1,bordered:!0,size:"small",style:{maxHeight:"calc(100vh - 250px)",overflowY:"auto"},expandable:{expandedRowRender:o.length?c.expandedTransferRowRender:void 0,expandedRowKeys:o},onRow:function(t){return{onClick:function(e){return c.handleVariationClick(t.key)}}},rowClassName:function(){return"row-variation"},scroll:{y:"calc(100vh - ".concat(t?350:410,"px)")}}),ie("div",{className:"flex-between",style:{padding:"10px 0px"}},ie("div",null,t&&ie(a.default,{size:"small",type:"primary",ghost:!0,onClick:function(){return c.setState({isOpenListProduct:!1,expandedVariationRowList:[]})}},ie(te.Z,null),e("components.printedListProduct.back"))),ie("div",{className:"fw600",style:{fontSize:15}},e("pages.shop.statistic.transport.total"),": ",ie("span",null,(0,$.oH6)(s)))))})),(0,_.Z)((0,h.Z)(c),"columnsPrintedProducts",[{title:c.props.t("components.printedListProduct.stt"),dataIndex:"index",ellipsis:!0,align:"center"},{title:c.props.t("components.printedListProduct.totalOrders"),dataIndex:"orders_length",ellipsis:!0,align:"center"},{title:c.props.t("components.printedListProduct.creator"),dataIndex:"creator",ellipsis:!0,align:"center"},{title:c.props.t("components.printedListProduct.insertedAt"),dataIndex:"inserted_at",ellipsis:!0,align:"center"}]),(0,_.Z)((0,h.Z)(c),"getDataPrintedProducts",(function(){return c.state.historiesPrinted.map((function(e,n){var r,o,a,s,l,d,u;return{index:n+1,orders_length:e.transfers.length,creator:ie("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},ie("span",null,null===(r=e.creator)||void 0===r?void 0:r.name),null!==(o=e.creator)&&void 0!==o&&o.fb_id||null!==(a=e.creator)&&void 0!==a&&a.id?ie(W.Z,{allowHover:!0,seed:null===(s=e.creator)||void 0===s?void 0:s.id,avatar_url:null===(l=e.creator)||void 0===l?void 0:l.avatar_url,name:null===(d=e.creator)||void 0===d?void 0:d.name,id:null===(u=e.creator)||void 0===u?void 0:u.fb_id,size:[20,20],style:{marginLeft:5}}):ie(W.Z,{allowHover:!0,name:t("pages.admin.system"),color:"#00707f",size:[20,20],style:{marginLeft:5}})),inserted_at:ie(i.default,{title:(0,$.o0x)(c.props.timezone||7,e.inserted_at)},(0,$.o0x)(c.props.timezone||7,e.inserted_at))}}))})),(0,_.Z)((0,h.Z)(c),"handleTableChange",(function(t){var e;(e=de({},ve)).page=t.current,c.fetchListOfPrintedTransferProducts(e)})),(0,_.Z)((0,h.Z)(c),"fetchListOfTransfer",(function(t){var e=c.props,n=e.shopId,r=e.accessToken,o="".concat((0,$.LpH)(),"/shops/").concat(n,"/transfers?access_token=").concat(r),a={page:1,page_size:t.length,status:-1,transfer_ids:t,is_variation:!0};c.setState({isLoadingItem:!0});var i=[];Q()({method:"get",url:o,params:a}).then((function(t){var e=t.data.data;i=i.concat(e),i=c.getProducts(i),c.setState({listProductPrinted:i,isLoadingItem:!1})}))})),(0,_.Z)((0,h.Z)(c),"handlePrintedHistoryClick",(function(t){var e,n=null===(e=c.state.historiesPrinted[t.index-1])||void 0===e?void 0:e.transfers;c.setState({isOpenListProduct:!0}),n&&n.length&&c.fetchListOfTransfer(n)})),(0,_.Z)((0,h.Z)(c),"renderTableHistory",(function(){var t=c.props.t,e=c.state,n=e.loadingPrintedProducts,r=e.totalPrintedProducts,o=e.isLoadingItem,a=e.isOpenListProduct;return ie(Z.Fragment,null,a&&!o?c.renderTableProducts(!0):ie(Vt.Z,{bordered:!0,size:"small",className:"table-printer-products",rowClassName:function(){return"row-variation"},dataSource:c.getDataPrintedProducts(),columns:c.columnsPrintedProducts,style:{borderCollapse:"collapse",maxHeight:"calc(100vh - 250px)",overflowY:"hidden"},scroll:{y:"calc(100vh - 350px)"},pagination:{size:"small",pageSize:30,total:r},onChange:c.handleTableChange,onRow:function(t){return{onClick:function(e){return c.handlePrintedHistoryClick(t)}}},loading:n,locale:{emptyText:t("components.printedListProduct.noneHistory")}}))})),(0,_.Z)((0,h.Z)(c),"getListProductPrinted",(function(){var t=Rt()(c.state.listTransferPrinted),e=[];t.map((function(t){var n={id:t.warehouse_id||"",name:t.warehouse_info&&t.warehouse_info.name||""};t.items.length&&t.items.map((function(t){var r={product:t,warehouses:n};e.push(r)}))})),c.setState({listProductPrinted:e})})),(0,_.Z)((0,h.Z)(c),"renderButton",(function(){var t=c.props.t;return ie("div",{style:{justifyContent:"flex-end",display:"flex",cursor:"pointer"}},ie("div",null,ie(a.default,{onClick:c.cancelFetch},t("cancel")),ie(a.default,{type:"primary",onClick:c.handlePrint},t("components.print"))))})),(0,_.Z)((0,h.Z)(c),"handleChangeTabHistory",(function(t){var e=c.props.histories;c.setState({activePane:t,expandedVariationRowList:[]}),"history"==t&&(e.total_entries>0?c.setState({historiesPrinted:e.data,totalPrintedProducts:e.total_entries}):c.fetchListOfPrintedTransferProducts())})),(0,_.Z)((0,h.Z)(c),"groupPrintProducts",(function(){var t=c.state.listProduct,e=Qt()(c.getProductData(t),(function(t){return"".concat(t.warehouse_id,"_").concat(t.from_warehouse_id)}));return Object.values(e)}));var l=e.isServer?fe:localStorage.getItem("product_transfer_columns")?JSON.parse(localStorage.getItem("product_transfer_columns")).checkedListProduct:fe;l=null!==(o=e.currentShop)&&void 0!==o&&o.use_warehouse_position?l:l.filter((function(t){return!["batchPosition","shelfPosition","batchPositionFrom","shelfPositionFrom"].includes(t)}));var d=e.isServer?null:localStorage.getItem("columns_width_list_product")?JSON.parse(localStorage.getItem("columns_width_list_product")):null;return c.state={modalVisible:!1,listProduct:[],isLoadingProduct:!0,expandedVariationRowList:[],typeShow:0,checkedListProduct:l,widthColumns:d,windowWidth:window.innerWidth,activePane:"print",historiesPrinted:[],totalPrintedProducts:null,loadingPrintedProducts:!1,isLoadingItem:!1,listTransferPrinted:[],isOpenListProduct:!1,listProductPrinted:[],isPrinting:!1},c.columnWidth={},c.printDivId=(0,$.uuG)(),c}return(0,m.Z)(r,[{key:"componentDidMount",value:function(){var t=this.props,e=t.isServer,n=t.currentShop;if(e){var r=localStorage.getItem("product_transfer_columns"),o=localStorage.getItem("columns_width_list_product");if(r){var a=JSON.parse(r).checkedListProduct;n.use_warehouse_position||(a=a.filter((function(t){return!["batchPosition","shelfPosition","batchPositionFrom","shelfPositionFrom"].includes(t)}))),this.setState({checkedListProduct:a})}o&&(o=JSON.parse(o),this.setState({widthColumns:o}),this.columnWidth=o)}}}]),(0,m.Z)(r,[{key:"render",value:function(){var t=this,e=this.props,n=e.t,r=e.isButton,o=this.state,a=o.modalVisible,i=o.isLoadingProduct,s=o.activePane,c=o.isPrinting,l=this.groupPrintProducts();return ie("div",{style:{display:"inline"}},ie(Y.Z,{title:n("components.printListProduct"),icon:ie(R.Z,null),onClick:function(){var e={modalVisible:!0};t.state.expandedVariationRowList.length&&(e.expandedVariationRowList=[]),t.setState(e),t.handleFetchTransfer()},isButton:r}),ie(b.Z,{title:ie("div",{style:{display:"flex"}},ie("strong",{style:{marginTop:3}},n("components.listProduct")),ie(A.Z,{disabled:i,style:{marginLeft:10},icon:ie(ee.Z,null),color:!i&&"#09c529",title:n("pages.shop.order.detailedMode"),onClick:function(){return t.onChangeTableDisplay()}}),"history"!=s&&ie("div",{style:{display:"flex"}},ie(A.Z,{icon:ie(O.Z,null),color:"#00d1b2",style:{marginLeft:10},title:n("pages.shop.order.exportToExcel"),onClick:this.handleProductExcel,disabled:i}),this.addRowTable())),visible:a,width:1200,wrapClassName:"print-list-transfer",footer:"history"==s?null:this.renderButton(),onCancel:this.cancelFetch},ie($t.default,{activeKey:s,onChange:function(e){return t.handleChangeTabHistory(e)}},ie(me,{key:"print",tab:n("components.printedListProduct.printingList")},ie("div",null,this.state.isLoadingProduct?ie("span",null,ie(k.Z,null)," ",n("components.productComboDetail.loadingListProduct")):this.renderTableProducts())),ie(me,{key:"history",tab:n("components.printedListProduct.historiesPrinted")},this.renderTableHistory()))),c&&ie("div",{id:this.printDivId,className:"print-div"},l.map((function(e){return ie("div",{key:(0,$.uuG)()},ie("div",{dangerouslySetInnerHTML:{__html:t.printProduct(e)}}),ie("style",{dangerouslySetInnerHTML:{__html:ae()}}))}))),ie("style",{dangerouslySetInnerHTML:{__html:ae()}}))}}]),r}(Z.Component))||St,xe=(0,I.$j)((function(t){return{user:t.navigation.user,histories:t.product.historiesPrintedTransferProducts,currentShop:t.shop.currentShop,warehouses:t.warehouse.warehouses}}),{fetchPrintLabels:jt.H2B,cancelLoadingTransfers:jt.CnA,createHistoriesPrintedTransferProducts:jt.q4p,fetchListOfPrintedTransferProducts:jt.oIU,fetchTransfers:jt.xx0})(_e),we=r(24781),be=r(41850),Pe=r(45812),Te=r(48519),Se=Z.createElement;function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ze(Object(n),!0).forEach((function(e){(0,_.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ke(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,y.Z)(t);if(e){var o=(0,y.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,g.Z)(this,n)}}var Oe=["30","50","100"],De={page:1,page_size:30,status:-1},Ee=b.Z.confirm,Ce=w.default.RangePicker,Re=x.default.Group,Le=x.default.Button,Ne=function(t){(0,v.Z)(n,t);var e=ke(n);function n(t){var r;return(0,f.Z)(this,n),r=e.call(this,t),(0,_.Z)((0,h.Z)(r),"fetchTransfers",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie({},De),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=r.props,o=n.accessToken,a=n.shopId,i=n.getTransferCounter,s=n.fetchTransfers;t=Ie(Ie({},r.state.params),t),r.setState({params:t,isLoading:e}),r.getTotalTransferQuantity(t),i(o,a,t),s(o,a,t).then((function(t){return r.setState({isLoading:!1})}))})),(0,_.Z)((0,h.Z)(r),"getTotalTransferQuantity",(function(t){var e=r.props,n=e.accessToken,o=e.shopId,a="".concat((0,$.LpH)(),"/shops/").concat(o,"/transfers/total_quantity_transfer?access_token=").concat(n);Q().get(a,{params:t}).then((function(t){t.data.success&&r.setState({totalTransferQuantity:t.data.data.total_quantity_transfer})}))})),(0,_.Z)((0,h.Z)(r),"onChangeFilterDate",(function(t,e){var n=r.state,o=n.params,a=n.filterTags,i=a.findIndex((function(t){return t.key==e}));if(t&&t.length>0){var s=t[0].startOf("day").unix(),c=t[1].endOf("day").unix(),l={key:e,value:{startDate:t[0].startOf("day"),endDate:t[1].endOf("day")}};i>-1?a[i]=l:a.push(l),"inserted"==e?(o.startDate=s,o.endDate=c):(o.startUpdatedTime=s,o.endUpdatedTime=c)}else"inserted"==e?(o.startDate=void 0,o.endDate=void 0):(o.startUpdatedTime=void 0,o.endUpdatedTime=void 0),i>-1&&a.splice(i,1);(0,$.iAs)(e,"".concat(r.props.shopId,"_filter_transfer_source_count")),r.setState({params:o,filterTags:a},(function(){return r.fetchTransfers(o)}))})),(0,_.Z)((0,h.Z)(r),"columns",(function(){return[{title:"ID",dataIndex:"id",width:(0,$.A8U)(r.props.transfers.data,"ID",{windowWidth:r.state.windowWidth},"display_id"),ellipsis:!0,fixed:"left"},{title:r.props.t("pages.shop.product.transfer.creator"),dataIndex:"creator",ellipsis:!0,width:"12%"},{title:r.props.t("pages.shop.product.transfer.note"),dataIndex:"note",ellipsis:!0},{title:r.props.t("pages.shop.product.transfer.fromWarehouse"),dataIndex:"from",width:"13%",ellipsis:!0},{title:r.props.t("pages.shop.product.transfer.toWarehouse"),dataIndex:"to",width:"13%",ellipsis:!0},{title:r.props.t("pages.shop.product.transfer.insertedAt"),dataIndex:"inserted_at",width:"10%",align:"right",ellipsis:!0},{title:r.props.t("pages.shop.product.transfer.updatedStatusAt"),dataIndex:"updated_status_at",width:"14%",align:"right",ellipsis:!0},{title:r.props.t("pages.shop.product.transfer.totalQuantityTransfer"),dataIndex:"total_quantity_transfer",width:"14%",align:"right",ellipsis:!0},{title:r.props.t("status"),dataIndex:"status",align:"center",width:"160px",fixed:"right",render:function(t,e){return Se("span",{onClick:function(t){return t.stopPropagation()}},Se(ct.Z,{accessToken:r.props.accessToken,shopId:r.props.shopId,transfer:e.source}))}}]})),(0,_.Z)((0,h.Z)(r),"getOptions",(function(){var t=r.props,e=t.t,n=t.accessToken,o=t.shopId,a=t.currentShop,i=t.warehouses,s=r.state,c=s.searchResult,d=s.searchResultProduct,u=r.optionUserFilter("creator_id"),p=r.optionUserFilter("last_editor_id"),f=r.optionDateTimeFilter("inserted"),h=r.optionDateTimeFilter("last_updated"),m=[u,p,{value:"from_warehouse_id",label:e("pages.shop.product.transfer.warehouseTransfer"),children:i.map((function(t){return{value:t.id,label:t.name}}))},{value:"to_warehouse_id",label:e("pages.shop.product.transfer.warehouseReceive"),children:i.map((function(t){return{value:t.id,label:t.name}}))},f,h,{value:"variation",label:e("pages.shop.statistic.statisticItem.product"),children:[{value:"id",label:e("pages.shop.statistic.statisticItem.variation"),children:[{value:"search-variation",label:Se("div",{onClick:function(t){return t.stopPropagation()}},Se(Ut.Z,{accessToken:n,searchResult:c,combo_by:"variation",searchOnly:!0,shopId:o,callback:function(t){return r.setState({searchResult:t})},is_filter:!0}))}].concat((0,l.Z)(c.map((function(t,n){return{value:"variation-".concat(n),label:Se("div",{onClick:function(e){e.stopPropagation(),r.handleSelectItem(t.id,"variation")}},Se(zt.Z,{width:448,t:e,key:n,currentShop:a,combo_by:"variation",item:t,warehouses:i}))}}))))},{value:"product_id",label:e("pages.shop.statistic.statisticItem.product"),children:[{value:"search-product",label:Se("div",{onClick:function(t){return t.stopPropagation()}},Se(Ut.Z,{accessToken:n,searchResult:d,combo_by:"product",searchOnly:!0,shopId:o,callback:function(t){return r.setState({searchResultProduct:t})},is_filter:!0}))}].concat((0,l.Z)(d.map((function(t,n){return{value:"variation-".concat(n),label:Se("div",{onClick:function(e){e.stopPropagation(),r.handleSelectItem(t.id,"product")}},Se(zt.Z,{width:300,t:e,key:n,currentShop:a,combo_by:"product",item:t,warehouses:i}))}}))))}]}];return(0,$.QIx)(m,"".concat(r.props.shopId,"_filter_transfer_source_count"))})),(0,_.Z)((0,h.Z)(r),"handleSelectItem",(function(t,e){if("no-result"!=t){var n,o=r.state,a=o.searchResult,i=o.searchResultProduct,s=o.params;if("variation"==e)n={key:"variation_id",value:a.find((function(e){return e.id==t}))},r.fetchTransfers(Ie(Ie({},s),{},{variation_id:t}));else n={key:"product_id",value:i.find((function(e){return e.id==t}))},r.fetchTransfers(Ie(Ie({},s),{},{product_id:t}));(0,$.iAs)(e,"".concat(r.props.shopId,"_filter_transfer_source_count")),r.onSelectTag(n)}})),(0,_.Z)((0,h.Z)(r),"optionUserFilter",(function(t){var e=r.props,n=e.t,o=e.users,a=e.employeeList,i=a&&a.length?a.findIndex((function(t){return"creator_id"==t.which&&"transferFilter"==t.type})):-1,s=-1==i?o:a[i].users,l=i>-1?a[i].text:void 0,d=n("creator_id"==t?"pages.shop.product.purchase.creator":"pages.shop.product.transfer.lastEditingStaff"),u=s.map((function(t){var e=t.user_id;return{value:e,label:(0,$.q$s)(e,s)}}));return{value:t,label:d,children:[{value:100,label:Se("div",{onClick:function(t){return t.stopPropagation()}},Se(c.default,{onChange:function(e){return r.handleSearchEmployee(e,t)},value:l,placeholder:n("components.orderAdvanceFilter.enterEmployee"),allowClear:!0}))},{value:"created_by_user",label:Se("div",null,n("pages.shop.product.purchase.createdByUser"))},{value:"created_by_system",label:Se("div",null,n("pages.shop.product.purchase.createdBySystem"))}].concat(u)}})),(0,_.Z)((0,h.Z)(r),"optionDateTimeFilter",(function(t){var e,n=r.state.params,o=r.props.t,a=o("inserted"==t?"pages.shop.product.transfer.createTime":"pages.shop.product.transfer.lastUpdateTime"),i=n?"inserted"==t?n.startDate:n.startUpdatedTime:void 0,s=n?"inserted"==t?n.endDate:n.endUpdatedTime:void 0;return{value:t,label:a,children:[{value:t,label:Se("span",{onClick:function(t){return t.stopPropagation()}},Se(Ce,{ranges:(e={},(0,_.Z)(e,o("pages.shop.statistic.yesterday"),[Kt()().add(-1,"days").startOf("day"),Kt()().add(-1,"days").endOf("day")]),(0,_.Z)(e,o("pages.shop.statistic.today"),[Kt()().startOf("day"),Kt()().endOf("day")]),(0,_.Z)(e,o("pages.shop.statistic.lastWeek"),[Kt()().add(-7,"days").startOf("day"),Kt()().endOf("day")]),(0,_.Z)(e,o("pages.shop.statistic.lastMonth"),[Kt()().add(-30,"days").startOf("day"),Kt()().endOf("day")]),(0,_.Z)(e,o("pages.shop.statistic.thisMonth"),[Kt()().startOf("month").startOf("day"),Kt()().endOf("month").endOf("day")]),e),value:i&&s?[Kt()(i,"X"),Kt()(s,"X")]:[],format:"DD/MM/YYYY",style:{width:300,marginRight:10},onChange:function(e){return r.onChangeFilterDate(e,t)}}))}]}})),(0,_.Z)((0,h.Z)(r),"handleSearchEmployee",(function(t,e){var n=t.target?t.target.value:t;r.props.pushUsersTextSearch(n,r.props.users,e,"transferFilter")})),(0,_.Z)((0,h.Z)(r),"onSelectTag",(function(t){var e=r.state.filterTags,n=e.findIndex((function(e){return e.key==t.key}));-1!=n?e[n].value=t.value:e.push(t),(0,$.iAs)(t.key,"".concat(r.props.shopId,"_filter_transfer_source_count")),r.setState({filterTags:e})})),(0,_.Z)((0,h.Z)(r),"renderVariationTag",(function(t){var e=t&&t.product.name,n={product_display_id:t&&(t.product.custom_id||(0,$.pyT)(t.product.display_id,0)),var_display_id:t&&(t.custom_id||(0,$.pyT)(t.display_id,0)),name:e};return Se("div",{className:"tag-variation"},n.product_display_id?Se(s.default,{color:"green",style:{marginRight:3}},n.product_display_id):"",n.var_display_id?Se(s.default,{color:"pink",style:{marginRight:3}},n.var_display_id):"",Se("b",null,n.name))})),(0,_.Z)((0,h.Z)(r),"renderDateTag",(function(t){var e=r.props,n=e.timezone,o=e.t,a=(0,$.o0x)(n,t.startDate||"",!1,"DD/MM/YYYY"),i=(0,$.o0x)(n,t.endDate||"",!1,"DD/MM/YYYY");return"".concat(o("pages.shop.product.purchase.from")," ").concat(a," - ").concat(o("pages.shop.product.purchase.to")," ").concat(i)})),(0,_.Z)((0,h.Z)(r),"onChangeCascader",(function(t,e){if(1==e.length&&e[0].isRoot)e[1]&&e[1].value;else{var n=r.state,o=n.filterTags,a=n.params,i={key:t[0],value:t[1]};r.onSelectTag(i),r.fetchTransfers(Ie(Ie({},a),{},(0,_.Z)({},i.key,i.value))),r.setState({filterTags:o})}})),(0,_.Z)((0,h.Z)(r),"renderUserTag",(function(t){var e,n=r.props,o=n.users,a=n.t;return"created_by_system"==t?a("pages.shop.product.purchase.createdBySystem"):"created_by_user"==t?a("pages.shop.product.purchase.createdByUser"):null===(e=o.find((function(e){return e.user_id==t})))||void 0===e?void 0:e.user.name})),(0,_.Z)((0,h.Z)(r),"renderTag",(function(t,e){var n,o=r.props,a=o.t,i=o.warehouses,c=i&&i.length>0&&(null===(n=i.find((function(e){return e.id==t.value}))||{})||void 0===n?void 0:n.name),l="",d="";switch(t.key){case"creator_id":d=a("pages.shop.product.purchase.creator"),l=r.renderUserTag(t.value);break;case"last_editor_id":d="NV ch\u1ec9nh s\u1eeda cu\u1ed1i",l=r.renderUserTag(t.value);break;case"variation_id":d=a("pages.shop.statistic.statisticItem.product"),l=r.renderVariationTag(t.value);break;case"product_id":d=a("pages.shop.statistic.statisticItem.product"),l=r.renderProductTag(t.value);break;case"from_warehouse_id":d="Chuy\u1ec3n t\u1eeb kho",l=Se("b",null,"\xa0",c);break;case"to_warehouse_id":d="Kho nh\u1eadn h\xe0ng",l=Se("b",null,"\xa0",c);break;case"inserted":d=Se("strong",null,a("pages.shop.product.purchase.time")),l=r.renderDateTag(t.value);break;case"last_updated":d=Se("strong",null,"C\u1eadp nh\u1eadt cu\u1ed1i"),l=r.renderDateTag(t.value)}return Se(s.default,{key:"".concat(e,"_").concat(l),closable:!0,onClose:function(){return r.onCloseTag(e)}},Se("span",{className:"content-tag"},d,": ",l))})),(0,_.Z)((0,h.Z)(r),"onCloseTag",(function(t){var e=r.state,n=e.filterTags,o=e.params,a=n[t].key;n.splice(t,1),"inserted"==a&&(o.startDate=void 0,o.endDate=void 0),"last_updated"==a&&(o.startUpdatedTime=void 0,o.endUpdatedTime=void 0),r.setState({filterTags:n}),r.fetchTransfers(Ie(Ie({},o),{},(0,_.Z)({},a,undefined)))})),(0,_.Z)((0,h.Z)(r),"handleDeleteFilter",(function(){T()(r.state.params,De)||r.setState({params:Ie({},De),filterTags:[]},(function(){r.fetchTransfers(r.state.params)}))})),(0,_.Z)((0,h.Z)(r),"getData",(function(){return r.props.transfers.data.map((function(t){return{key:t.id,source:t,id:(0,$.pyT)(t.display_id,0),creator:t.creator?Se(W.Z,{seed:t.creator.id,avatar_url:t.creator.avatar_url,id:t.creator.fb_id,size:[20,20],style:{marginRight:5,float:"left"},name:t.creator.name,showName:!0}):Se(s.default,{color:"#00707f"},r.props.t("pages.admin.system")),from:Se(i.default,{title:t.from_warehouse_name},Se("strong",null,t.from_warehouse_name)),to:Se(i.default,{title:t.to_warehouse_name},Se("strong",null,t.to_warehouse_name)),total_quantity_transfer:Se("div",null,(0,$.oH6)(t.total_quantity,r.props.currentShop.currency)),note:Se(i.default,{title:t.note},t.note),action:t,inserted_at:(0,$.o0x)(r.props.timezone||7,t.inserted_at),updated_status_at:t.updated_status_at?(0,$.o0x)(r.props.timezone||7,t.updated_status_at):""}}))})),(0,_.Z)((0,h.Z)(r),"handleTableChange",(function(t){var e=r.state.params;e.page=t.current,r.setState({pageSize:t.pageSize},(function(){localStorage.setItem("transferPageSize",t.pageSize),e.page_size=t.pageSize,r.fetchTransfers(e)})),document.querySelector(".ant-table-body").scrollTop=0})),(0,_.Z)((0,h.Z)(r),"handleRowClick",(function(t){var e=t.action;r.setState({modalDetailVisible:!0,selectedTransfer:e})})),(0,_.Z)((0,h.Z)(r),"handlePrintTransfer",(function(){var t=r.props,e=t.accessToken,n=t.shopId,o={page:1,page_size:30,status:-1,transfer_ids:r.state.selectedRowKeys,is_variation:!0},a="".concat((0,$.LpH)(),"/shops/").concat(n,"/transfers?access_token=").concat(e),i=[];return function t(e){return Q().get(a,{params:e}).then((function(n){var o=n.data.data;return o.length,i=i.concat(o),r.setState({isLoading:!1}),0==o.length||i.length>=n.data.total_entries?i:(e.page+=1,t(e))}))}(o).then((function(t){r.setState({transferPrints:t}),r.handlePrint()}))})),(0,_.Z)((0,h.Z)(r),"handlePrint",(function(){return r.setState({isPrinting:!0},(function(){var t=document.getElementById(r.printDivId).innerHTML,e=document.createElement("iframe");e.name="frame1",e.style.position="absolute",e.style.top="-1000000px",document.body.appendChild(e);var n=e.contentWindow?e.contentWindow:e.contentDocument.documnet?e.contentDocument.document:e.contentDocument;n.document.open(),n.document.write("\n      <!DOCTYPE html>\n            <head>\n                <style type='text/css'>\n                  @media print {\n                    @page {\n                      size: auto;\n                      margin: 6mm;\n                    }\n                  }\n                </style>\n            </head>\n            <body>\n              ".concat(t,"\n            </body>\n        </html>\n      ")),n.document.close(),setTimeout((function(){window.frames.frame1.focus(),window.frames.frame1.print(),document.body.removeChild(e)}),500),r.setState({isPrinting:!1})}))})),(0,_.Z)((0,h.Z)(r),"setTransfer",(function(){var t=r.props,e=t.shopId,n=t.t,o=JSON.parse(localStorage.getItem("product_transfer_shop_".concat(e)))||null;localStorage.getItem("product_transfer_shop_".concat(e))?Ee({title:n("containers.productCreator.alert"),content:n("containers.productCreator.contentTransfer"),okText:n("containers.productCreator.continous"),cancelText:n("containers.productCreator.delete"),onOk:function(){return r.setState({selectedTransfer:o,modalDetailVisible:!0})},onCancel:function(){r.setState({selectedTransfer:null,modalDetailVisible:!0}),localStorage.removeItem("product_transfer_shop_".concat(e))}}):r.setState({selectedTransfer:o,modalDetailVisible:!0})})),(0,_.Z)((0,h.Z)(r),"renderProductTag",(function(t){var e=t&&t.name,n={product_display_id:t&&(t.custom_id||(0,$.pyT)(t.display_id,0)),name:e};return Se("div",{className:"tag-variation"},n.product_display_id?Se(s.default,{color:"green",style:{marginRight:3}},n.product_display_id):"",Se("b",null,n.name))})),(0,_.Z)((0,h.Z)(r),"transferTableHeighStyle",(function(t){return t?Se(S.default,{id:"4121834279"},[".transfer-table .ant-table-body,.transfer-table .ant-table-body-inner{min-height:calc(100vh - 250px);}"]):Se(S.default,{id:"626787310"},[".transfer-table .ant-table-body,.transfer-table .ant-table-body-inner{min-height:calc(100vh - 212px);}"])})),(0,_.Z)((0,h.Z)(r),"callbackFetchSelectedTransfer",(function(t){return r.setState({selectedTransfer:t})})),(0,_.Z)((0,h.Z)(r),"handleCloseModal",(function(){return r.setState({modalDetailVisible:!1})})),(0,_.Z)((0,h.Z)(r),"fetchListTransfers",(function(t){var e=r.props,n=e.accessToken,o=e.shopId,a=Ie(Ie({},r.state.params),{},{transfer_ids:t,isPrintProduct:!0,page:1}),i="".concat((0,$.LpH)(),"/shops/").concat(o,"/transfers?access_token=").concat(n),s=[];return function t(e){return Q()({method:"get",url:i,params:e}).then((function(n){var o=n.data.data;return s=s.concat(o),0==o.length||s.length>=n.data.total_entries?(r.setState({transferList:s}),s):(e.page+=1,t(e))}))}(a)})),(0,_.Z)((0,h.Z)(r),"renderStatus",(function(){var t=r.state,e=t.params,n=t.isLoading,o=r.props,a=o.transfers,i=o.t,c=a.counters,l=c&&c.length>0?c.reduce((function(t,e){return t+e.count}),0):0,d=function(t){var e=c&&c.length>0?c.find((function(e){return e.status==t})):0;return e?e.count:0},u=[{text:i("commons.all"),value:-1,count:l},{text:i("tool.waitForDelivery"),value:0,count:d(0)},{text:i("tool.shipping"),value:1,count:d(1)},{text:i("tool.completed"),value:2,count:d(2)},{text:i("tool.cancelled"),value:3,count:d(3)}];return Se("div",{className:"status-dropdown"},Se(Re,{id:"status-group",onChange:function(t){return r.fetchTransfers({status:t.target.value},!0)},value:e.status},u.map((function(t){return Se(Le,{value:t.value,key:t.value},t.text,Se(s.default,{key:t.value},n&&e.status==t.value?Se(k.Z,null):t.count))}))))})),(0,_.Z)((0,h.Z)(r),"getListActionTools",(function(){var t=r.props,e=t.accessToken,n=t.shopId,o=t.warehouses,a=t.t,i=t.transfers,s=t.isServer,c=r.state,l=c.selectedRowKeys,d=c.transferList,u=c.selectedTransfers,p=c.params;return[{icon:Se(O.Z,null),title:a("pages.shop.statistic.inventory.exportExcel"),key:"export_excel",content:function(t){return Se(Ot,{shopId:n,accessToken:e,selectedRowKeys:l,selectedTransfers:u,isButton:t,filter:p,title:a("pages.shop.statistic.inventory.exportExcel")})}},{icon:Se(D.Z,null),title:a("pages.shop.actionTools.importExcel"),key:"import_excel",content:function(t){return Se(st,{shopId:n,accessToken:e,fetchTransfersAfterCreate:function(){return r.fetchTransfers()},warehouses:o,isButton:t,title:a("pages.shop.actionTools.importExcel")})}},{icon:Se(E.Z,null),title:a("pages.shop.actionTools.quickUpdate"),key:"update_status_transfer",content:function(t){return Se(lt.Z,{shopId:n,accessToken:e,selectedRowKeys:l,selectedData:u,clearSelectedKeys:function(){return r.setState({selectedRowKeys:[],selectedTransfers:[]})},handleCallbackFetchData:function(){return r.fetchTransfers()},name:"transfer",isButton:t,title:a("pages.shop.actionTools.quickUpdate")})}},{icon:Se(C.Z,null),title:a("pages.shop.product.transfer.printTransfer"),key:"transfer_printer",content:function(t){return Se(Y.Z,{icon:Se(C.Z,null),title:a("pages.shop.product.transfer.printTransfer"),accessToken:e,shopId:n,selectedRowKeys:l,onClick:r.handlePrintTransfer,isButton:t})}},{icon:Se(R.Z,null),title:a("components.printListProduct"),key:"transfer_product_printer",content:function(t){return Se(xe,{key:"6",accessToken:e,shopId:n,transfers:d,printListTransfer:i,isServer:s,handleTransferClick:function(t){return r.handleRowClick({action:t})},isButton:t,fetch:function(){return r.fetchListTransfers(l)}})}}]})),(0,_.Z)((0,h.Z)(r),"onSelectRow",(function(){var t=r.props,e=t.shopId,n=t.accessToken,o=r.state.params,a="".concat((0,$.LpH)(),"/shops/").concat(e,"/transfers?access_token=").concat(n);r.setState({loadingData:!0});(function t(e){return Q().get(a,{params:e}).then((function(n){var o=r.state,a=o.loadingData,i=o.selectedRowKeys,s=n.data.data,c=s.map((function(t){return t.id})),l=i.filter((function(t){return!c.includes(t)})).concat(c);return a&&r.onChangeSelectRowKey(l,s),(l||[]).length>=n.data.total_entries||0==s.length||!a?void 0:(e.page+=1,t(e))}))})(Ie(Ie({},o),{},{page:1})).then((function(t){return r.setState({loadingData:!1})}))})),(0,_.Z)((0,h.Z)(r),"onChangeSelectRowKey",(function(t,e){var n=r.props.transfers,o=r.state,a=o.selectedRowKeys,i=o.selectedTransfers,s=e&&e.length>0?e:n.data,c=i.concat(t.filter((function(t){return!a.includes(t)})).map((function(t){return s.find((function(e){return e.id==t}))}))).filter((function(e){return t.includes(e.id)}));r.setState({selectedRowKeys:t,selectedTransfers:c})})),(0,_.Z)((0,h.Z)(r),"getTotalTransfers",(function(t){var e=0;return!t||t&&0==t.length||t.forEach((function(t){return e+=t.total_quantity})),e})),r.state={isLoading:!1,params:Ie({},De),modalDetailVisible:!1,selectedTransfer:null,selectedRowKeys:[],transferPrints:[],isPrinting:!1,pageSize:parseInt(localStorage.getItem("transferPageSize")||30),filterTags:[],searchResult:[],searchResultProduct:[],transferList:[],windowWidth:window.innerWidth,loadingData:!1,selectedTransfers:[],totalTransferQuantity:0},r.printDivId=(0,$.uuG)(),r}return(0,m.Z)(n,null,[{key:"getInitialProps",value:function(){var t=(0,p.Z)(u().mark((function t(e,n){var r,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.store.dispatch,o=e.query.shopId,!e.isServer){t.next=8;break}return t.next=4,r((0,jt.xx0)(n,o,De));case 4:return t.next=6,r((0,jt.P3w)(n,o));case 6:t.next=10;break;case 8:return t.next=10,r((0,jt.P3w)(n,o));case 10:return t.next=12,r((0,jt.A56)(n,o));case 12:return t.abrupt("return",{});case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),(0,m.Z)(n,[{key:"componentDidMount",value:function(){var t=this.state,e=t.params,n=t.pageSize;e.page_size=n,this.fetchTransfers(e)}},{key:"render",value:function(){var t=this,e={pageBreakInside:"avoid",minHeight:"190mm",padding:"1mm"},n=this.props,r=n.transfers.total_entries,o=n.accessToken,i=n.shopId,s=n.timezone,c=n.warehouses,l=n.currentShop,d=n.t,u=this.state,p=u.isLoading,f=u.params,h=u.modalDetailVisible,m=u.selectedTransfer,v=u.selectedRowKeys,g=u.pageSize,y=u.isPrinting,_=u.transferPrints,x=u.filterTags,w=u.loadingData,b=u.totalTransferQuantity,P=u.selectedTransfers,T=(l?(0,Te.zE)(l.role):{}).xem_baocao,S=P.length>0?this.getTotalTransfers(P):b;return Se(Dt.Z,{className:"product-transfer"},Se("div",{className:"tools-container",style:{marginBottom:10}},Se(A.Z,{icon:Se(L.Z,null),color:"#096DD9",title:d("pages.shop.product.transfer.createBill"),onClick:function(){return t.setTransfer()}}),Se(Y.Z,{icon:Se(N.Z,null),disabled:p,title:d("pages.shop.orderControlInfo.sync"),onClick:function(){return t.fetchTransfers()},isButton:!0}),Se(we.Z,{listActionTools:this.getListActionTools(),defaultActiveKeys:this.getListActionTools().map((function(t){return t.key})),keyView:"transfer"}),Se(Pe.Z,{selectedLength:v.length,loadingData:w,total:r,onClick:function(){return t.setState({loadingData:!1,selectedRowKeys:[],selectedTransfers:[]})}}),Se("div",{className:"filter"},Se(Bt.Z,{params:f,shopId:i,accessToken:o,fetch:function(e){return t.setState({params:e},(function(){return t.fetchTransfers(e)}))}}),Se("div",{style:{display:"flex"}},x.length>0&&Se(a.default,{danger:!0,onClick:function(){return t.handleDeleteFilter()}},d("pages.shop.statistic.customer.deleteFilter")),"\xa0",Se(Ht.Z,{options:this.getOptions(),popupClassName:"cascader-filter-customer",onChange:this.onChangeCascader}))),x&&x.length>0&&Se("div",{className:"tags-filter"},x.map(this.renderTag))),y&&Se("div",{id:this.printDivId,className:"print-div"},_.map((function(t){return Se("div",{key:t.id,style:e},Se("div",{dangerouslySetInnerHTML:{__html:Ft(t,l,s,c)}}),Se("style",{dangerouslySetInnerHTML:{__html:Mt()}}))}))),this.renderStatus(),T&&Se("div",{style:{position:"absolute",zIndex:100,left:10,bottom:10,display:"flex"}},Se("div",{style:{display:"flex",alignItems:"center"}},Se("span",null,d("pages.shop.product.transfer.totalQuantityTransfer"),":"),"\xa0",Se("span",{style:{color:"rgb(0, 168, 84)",fontWeight:600}},(0,$.oH6)(S)))),Se(be.Z,{className:"transfer-table ".concat(p?"blur-when-loading":""),size:"small",dataSource:this.getData(),columns:this.columns(),pagination:{size:"small",pageSize:g,total:r,current:f.page,pageSizeOptions:Oe,showSizeChanger:!0},scroll:{x:1100,y:x&&x.length>0?"calc(100vh - 250px)":"calc(100vh - 212px)"},onChange:this.handleTableChange,onRow:function(e){return{onClick:function(n){return t.handleRowClick(e)}}},rowSelection:{selectedRowKeys:v,onChange:function(e){return t.onChangeSelectRowKey(e)},preserveSelectedRowKeys:!0,isSelection:!0,onSelectRow:this.onSelectRow}}),Se(M.Z,{visible:h,close:function(){return t.handleCloseModal()},transfer:m,accessToken:o,shopId:i,fetchSelectedTransfer:function(e){return t.callbackFetchSelectedTransfer(e)},isTransfer:!0,isServer:this.props.isServer}),p&&Se(F.Z,null),this.transferTableHeighStyle(x&&x.length>0))}}]),n}(Z.Component);(0,_.Z)(Ne,"pageInfo",{title:"pages.shop.product.transfer.transfer",sassStyle:Mt()});var Ae=(0,I.$j)((function(t){return Ie(Ie({timezone:t.navigation.user.timezone,warehouses:t.warehouse.warehouses},(0,mt.hn)(t)),{},{users:t.user.users,employeeList:t.user.filterEmployeeList})}),{showTransfers:jt.FZV,fetchTransfers:jt.xx0,pushUsersTextSearch:jt.mw6,fetchPrintBarcodes:jt.P3w,getTransferCounter:jt.tUl,fetchMaterials:jt.A56})((0,Et.Z)(Ne))},94124:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/product/transfer",function(){return n(37737)}])}},function(t){t.O(0,[5460,2902,4517,3745,9774,2888,179],(function(){return e=94124,t(t.s=e);var e}));var e=t.O();_N_E=e}]);