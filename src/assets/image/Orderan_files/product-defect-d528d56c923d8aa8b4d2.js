(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1307],{15440:function(t){!function(){"use strict";t.exports=".modal-update-status-transfer .ant-modal-body{background-color:#ededed}.modal-update-status-transfer .ant-modal-body .updating-info{background:#fff}.modal-update-status-transfer .tag-transfer{font-size:24px;line-height:28px}.modal-update-status-transfer .ant-modal-content .config .config-first{display:grid;background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px;height:-webkit-max-content;height:-moz-max-content;height:max-content;padding:10px}.modal-update-status-transfer .ant-modal-content .config .scan{display:grid;background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px;height:-webkit-max-content;height:-moz-max-content;height:max-content;padding:10px;margin-top:10px}.modal-update-status-transfer .ant-modal-content .config .scan-product{display:flex;align-items:center;justify-content:space-between;padding:0px 9px}.modal-update-status-transfer .ant-modal-content .config .scan-transfer{border:1px solid #d9d9d9;border-radius:2px;padding:5px;margin-top:10px;background:#f7f7f7;max-height:50vh;overflow:overlay}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .title{display:flex;justify-content:space-around}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .item-transfer{background:#fff;border:1px solid #d9d9d9;display:flex;margin-top:5px}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .item-transfer .close-div{padding:5px 8px;cursor:pointer;border-right:1px solid #d9d9d9}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .item-transfer .close-div:hover{color:#f04134}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .item-transfer .transfer-content{flex:1;padding:5px 10px;display:flex;justify-content:space-between;align-items:center}.modal-update-status-transfer .ant-modal-content .config .scan-transfer .item-transfer .transfer-status{padding:3px 10px;border-radius:2px;text-align:center;font-size:12px;color:#fff}"}()},51563:function(t){!function(){"use strict";t.exports=".product-export{overflow:visible !important}.product-export .ant-tabs-nav-wrap{line-height:2.3;border-left:1px solid #e8e5e5}.product-export .ant-tabs-nav{border-bottom:unset;position:absolute;top:-54px;z-index:1000}.product-export .ant-tabs{overflow:visible}.product-export .ant-tabs-tab{padding:14px 15px 9px 15px !important}.product-export .ant-table-wrapper-by-variation{margin-top:10px}.product-export .ant-table-wrapper-by-variation .ant-table-body{min-height:calc(100vh - 179px);max-height:calc(100vh - 179px) !important}.product-export .ant-table-wrapper .ant-table-header{padding-right:0}.product-export .ant-table-wrapper .ant-table-body .ant-table-row{cursor:pointer}"}()},7690:function(t,e,n){"use strict";var a,o=n(71535),r=n(65400),i=n(74047),c=n(52700),s=n(4706),u=n(33814),d=n(44102),l=n(20775),p=n(26265),f=n(65988),h=n(67294),v=n(99069),g=n(17405),m=n(57254),y=n(87217),_=n(95213),x=n(20920),b=h.createElement;function w(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,l.Z)(t);if(e){var o=(0,l.Z)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}var k="btn-filter",S=(0,y.Z)()(a=function(t){(0,u.Z)(n,t);var e=w(n);function n(t){var a;return(0,i.Z)(this,n),a=e.call(this,t),(0,p.Z)((0,s.Z)(a),"handleClickOutSideFilter",(function(t){var e=a.state.popupVisible,n=a.props,o=n.popupClassName,r=n.id,i=n.field;t.stopPropagation();var c=document.getElementsByClassName(o)[0],s=document.getElementById("advance-filter-".concat(null===i||void 0===i?void 0:i.name));if(c){var u=c.getBoundingClientRect();if(u.left<t.x&&t.x<u.right&&u.top<t.y&&t.y<u.bottom)return}var d=document.getElementsByClassName("ant-picker-dropdown-range")[0],l=r?document.getElementById(r):document.getElementById(k);c&&(c.contains(t.target)||l.contains(t.target)||d&&d.contains(t.target)||s&&s.contains(t.target)||e&&a.setPopupVisible(!1))})),(0,p.Z)((0,s.Z)(a),"setPopupVisible",(function(t){return a.setState({popupVisible:t})})),(0,p.Z)((0,s.Z)(a),"handleFilter",(function(){var t=a.props,e=t.field,n=t.callBackField,o=t.type,r=(t.popupClassName,a.state.popupVisible);a.setPopupVisible(!r),o&&n(e)})),(0,p.Z)((0,s.Z)(a),"styleModal",(function(t){var e=a.props,n=e.columnsWidth,o=e.field,r=e.dataSource,i=n[o.name];return i=(i=i||(0,_.IQS)(r,o.type==(0,x.Rt)().boolean.id?o.label:o.name))&&(i.toString().includes("em")?i:"".concat(i,"px")),b(f.default,{id:"2766829989",dynamic:[t,i,t]},[".".concat(t," .ant-cascader-menu:first-child{width:").concat(i,";min-width:150px;max-width:285px;}"),".".concat(t," .ant-cascader-menu-item-disabled{position:-webkit-sticky;position:sticky;top:-4px;padding-top:5px;z-index:900;background-color:#fff;}")])})),(0,p.Z)((0,s.Z)(a),"getButton",(function(){var t=a.props,e=t.t,n=t.label,o=t.type,i=t.field,c=t.popupClassName,s=t.id,u=t.noIcon;return n?b("span",{id:s||k,className:"btn-advance-filter",onClick:a.handleFilter},n):o?b("span",{id:"advance-filter-".concat(i.name),onClick:function(){return a.handleFilter()},style:{width:20}},a.styleModal(c),b(v.Z,{style:{color:"#949494"},className:"field-icon"})):b(r.default,{id:s||k,icon:u?null:b(g.Z,null),onClick:function(){return a.handleFilter()},className:"btn-advance-filter"},e("crm.addFilter"),b(m.Z,null))})),a.state={popupVisible:!1},a}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this),document.addEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"componentWillUnmount",value:function(){this.props.onRef&&this.props.onRef(null),document.removeEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"render",value:function(){var t=this.props,e=t.options,n=t.popupClassName,a=t.onChange,r=t.changeOnSelect,i=t.loadData,c=t.disabled,s=t.displayRender,u=t.type,d=this.state.popupVisible;return b(o.Z,{defaultValue:u?["$customize"]:"",popupVisible:d,popupClassName:n,options:e,popupPlacement:"bottomRight",changeOnSelect:r,onChange:a,loadData:i,disabled:c,displayRender:s},this.getButton())}}]),n}(h.Component))||a;e.Z=S},45812:function(t,e,n){"use strict";var a=n(65400),o=n(74806),r=n(67294),i=n(54549),c=n(74298),s=r.createElement;e.Z=function(t){var e=t.loadingData,n=t.selectedLength,r=t.total,u=t.onClick;return 0!=n||e?s(a.default,{onClick:u},e&&s(o.default,{type:"circle",percent:Math.round(n/(r||1)*100),width:18,strokeWidth:16,format:function(){return null},style:{marginRight:4}}),s("b",null,n),"\xa0",c.ZP.t("pages.shop.order.selectedOrder"),"  ",s(i.Z,null)):null}},65644:function(t,e,n){"use strict";var a=n(74047),o=n(52700),r=n(4706),i=n(33814),c=n(44102),s=n(20775),u=n(26265),d=n(67294),l=n(14494),p=n(36934),f=d.createElement;function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,s.Z)(t);if(e){var o=(0,s.Z)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var m=function(t){(0,i.Z)(n,t);var e=g(n);function n(t){var o;return(0,a.Z)(this,n),o=e.call(this,t),(0,u.Z)((0,r.Z)(o),"listenMeronpan",(function(){var t=o.props,e=t.extension,n=t.dispatch;null==e&&(o.unlistenMeronpan(),window.addEventListener("message",o.listenMeronpanHandler.bind((0,r.Z)(o),n)),window.postMessage({type:"CHECK_EXTENSION_VERSION",from:"WEBPAGE"},"*"),window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*"))})),(0,u.Z)((0,r.Z)(o),"listenMeronpanHandler",(function(t,e){if("WEBPAGE"!=e.data.from)switch(e.data.type){case"EXTENSION_LOADED":window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*");break;case"REPORT_EXTENSION_STATUS":t((0,p.GoT)(e.data.connectionStatus));break;case"EXTENSION_VERSION":t((0,p.HfQ)(e.data.version))}})),(0,u.Z)((0,r.Z)(o),"unlistenMeronpan",(function(){window.removeEventListener("message",o.listenMeronpanHandler)})),o}return(0,o.Z)(n,[{key:"componentWillUnmount",value:function(){this.unlistenMeronpan()}},{key:"componentDidMount",value:function(){this.listenMeronpan()}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.children,a=t.onScroll,o=t.style,r=t.top,i=t.height;return f("div",{id:"container-layout",onScroll:a,style:this.props.fullScreen?v(v(v({},y),o),{},{top:0,height:"calc(100%)"}):v(v(v({},y),o),{},{top:r||49,height:i||"calc(100% - ".concat(r||49,"px)")}),className:"__container-layout ".concat(e||"")},n)}}]),n}(d.Component),y={overflowY:"overlay",overflowX:"hidden",position:"absolute",height:"calc(100% - 49px)",width:"100%",padding:"10px 0",top:49,left:0};e.Z=(0,l.$j)((function(t){return{fullScreen:t.navigation.fullScreen,extension:t.shop.extension}}),null)(m)},36339:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ht}});var a=n(20838),o=n(65400),r=n(59361),i=n(94055),c=n(26265),s=n(64713),u=n(56697),d=n(50361),l=n.n(d),p=n(65988),f=n(67294),h=n(14494),v=n(65644),g=n(92902),m=n(24814),y=n(97177),_=n(83049),x=n(31731),b=n(7085),w=n(49101),k=n(25592),S=n(51563),O=n.n(S),E=n(36934),D=n(95213),Z=n(20920),I=n(50916),C=n(31432),P=n(74018),N=n(20051),j=n(2307),R=n(54549),z=n(64749),T=n(50161),q=n(9669),B=n.n(q),M=n(15440),Y=n.n(M),A=n(7463),K=n(22318),F=f.createElement;function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){(0,c.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H=z.default.Option,W=(0,h.$j)((function(t){return V(V({currentShop:t.shop.currentShop,defect_export_items:t.product.defect_export_items,warehouses:(0,C.op)(t),timezone:t.navigation.user.timezone},(0,C.zN)(t)),{},{users:t.user.users})}),{})((function(t){var e=t.selectedRowKeys,n=t.t,a=t.shopId,r=t.accessToken,i=t.selectedRowDatas,c=t.supplier_products,s=t.currentShop,d=t.fetchCallback,p=(0,f.useState)(!1),h=p[0],v=p[1],g=(0,f.useState)(!1),m=g[0],y=g[1],_=(0,f.useState)(void 0),b=_[0],w=_[1],k=(0,f.useState)(i),S=k[0],O=k[1];(0,f.useEffect)((function(){O(i)}),[i]);var E=function(){v(!1),w(void 0),y(!1)};return F(f.Fragment,null,F(x.Z,{wrapClassName:"update-status-tool",title:n("pages.shop.actionTools.quickUpdate"),isButton:!0,icon:F(T.Z,null),onClick:function(){e.length>0&&v(!0)}}),h&&F(u.Z,{className:"modal-update-status-transfer",title:n("pages.shop.product.productDefect.quickUpdateDefectProduct"),visible:h,width:"80%",onCancel:function(){return E()},footer:F("div",null,F(o.default,{onClick:function(){return E()}},n("cancel")),F(o.default,{disabled:!b||0==i.length||m,type:"primary",onClick:function(){return function(){if(y(!0),b){var t=S.filter((function(t){return t.quantity_to_update})).map((function(t){return{key:t.key,quantity:t.quantity_to_update,variation_id:t.variation_id,supplier_products_id:t.export.supplier_products_id,warehouse_id:t.export.warehouse_id}}));if(0==t.length)return y(!1),K.Z.error(n("error"),"Kh\xf4ng \u0111\u1ee7 s\u1ed1 l\u01b0\u1ee3ng \u0111\u1ec3 \u0111i\u1ec1u ch\u1ec9nh");t={data:t,typeUpdate:b};var e="".concat((0,D.LpH)(),"/shops/").concat(a,"/export/create_export_by_variation?access_token=").concat(r);return B()({method:"post",url:e,params:t}).then((function(t){var e,a;v(!1),y(!1),d(),null!==t&&void 0!==t&&null!==(e=t.data)&&void 0!==e&&e.success?K.Z.success(n("success"),n("updateSuccess")):K.Z.error(n("error"),(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||n("action.updateFailed"))})).catch((function(t){v(!1),y(!1),console.log(t,"ERROR"),K.Z.error(n("error"),n("action.unknownError"))}))}}()}},n("systemLogs.UPDATE")))},F("div",{className:"config"},F("div",{className:"config-first"},F("div",{style:{display:"grid"}},F("span",null,F(T.Z,null)," ",n("components.orderReturnedActions.updateType"),":"),F(z.default,{placeholder:"Ch\u1ecdn h\xecnh th\u1ee9c c\u1eadp nh\u1eadt",style:{width:"100%"},value:b,onChange:function(t){var e;switch(t){case"defect-key":case"cancel-defect":e="defect_quantity";break;case"cancel-elimination":case"elimination-key":e="elimination_quantity"}var n=S.map((function(t){return V(V({},t),{},{quantity_to_update:e?t[e]:0})}));O(n),w(t)}},F(H,{key:"defect-key",value:"defect-key"},n("pages.shop.product.productDefect.addProductIntoDefectExport")),F(H,{key:"elimination-key",value:"elimination-key"},n("pages.shop.product.productDefect.addProductIntoEliminationExport")),F(H,{key:"cancel-defect",value:"cancel-defect"},n("pages.shop.product.productDefect.cancelDefectExport")),F(H,{key:"cancel-elimination",value:"cancel-elimination"},n("pages.shop.product.productDefect.cancelEliminationExport"))))),F("div",{style:{marginTop:10}},F(j.Z,{size:"small",columns:function(){var t=[{title:n("products.title"),dataIndex:"product_name",ellipsis:!0},{title:n("pages.shop.product.productDefect.productId"),dataIndex:"product_id",width:"15%",ellipsis:!0},{title:n("pages.shop.product.productDefect.variationId"),dataIndex:"variation_id",width:"15%",align:"right",ellipsis:!0},{title:n("pages.shop.product.productDefect.warehouse"),dataIndex:"warehouse_id",width:"13%",align:"right",ellipsis:!0},{title:n("pages.shop.product.productDefect.defectQuantity"),dataIndex:"defect_quantity",width:"8%",align:"right",ellipsis:!0},{title:n("pages.shop.product.productDefect.eliminationQuantity"),dataIndex:"elimination_quantity",width:"8%",align:"right",ellipsis:!0},{title:n("pages.shop.product.productDefect.supplierProducts"),dataIndex:"supplier_product_id",width:"13%",align:"right",ellipsis:!0}];return b&&t.push({title:n("pages.shop.product.productDefect.quantity"),dataIndex:"quantity",width:"15%",align:"right",ellipsis:!0}),t}(),dataSource:S.map((function(e){var n,a;return{key:e.key,product_name:e.variation.product.name,product_id:e.variation.product.custom_id||e.variation.product.display_id,variation_id:e.variation.custom_id||e.variation.display_id,warehouse_id:null===(n=t.warehouses.find((function(t){return t.id==e.export.warehouse_id})))||void 0===n?void 0:n.name,defect_quantity:e.defect_quantity,elimination_quantity:e.elimination_quantity,supplier_product_id:(null===c||void 0===c||null===(a=c.data.find((function(t){var n;return t.id==(null===(n=e.export)||void 0===n?void 0:n.supplier_products_id)})))||void 0===a?void 0:a.name)||"",quantity:F(A.default,{currency:s.currency,min:0,isMoney:!1,value:e.quantity_to_update||0,callBack:function(t){return function(t,e){var n=l()(S),a=n.findIndex((function(t){return t.key==e}));n[a].quantity_to_update=t,O(n)}(t,e.key)}})}})),pagination:!1,scroll:{y:500}})))),F("style",{dangerouslySetInnerHTML:{__html:Y()}}))})),U=f.createElement;function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){(0,c.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Q=(0,h.$j)((function(t){var e,n,a=t.shop.currentShop,o=t.navigation.user,r=t.user.users,i=(0,D.nkB)(null===(e=t.product)||void 0===e||null===(n=e.supplier_products)||void 0===n?void 0:n.data,null===a||void 0===a?void 0:a.shop_departments,o,r);return{currentShop:a,defect_export_items:t.product.defect_export_items,warehouses:(0,C.op)(t),timezone:t.navigation.user.timezone,users:r,supplier_products:i}}),{fetchDefectExportItems:E._PG,showDefectExport:E.EKO})((function(t){var e=t.shopId,n=t.accessToken,a=t.t,s=t.supplier_products,u=t.users,d=t.warehouses,h=t.timezone,v=["30","50","100"],g={page:1,page_size:30,status:"-1",type:1},m=(0,f.useState)(!1),y=m[0],x=m[1],b=(0,f.useState)(t.params),w=b[0],S=b[1],O=(0,f.useState)(t.filters),E=O[0],Z=O[1],I=(0,f.useState)([]),C=I[0],z=I[1],T=(0,f.useState)([]),q=T[0],B=T[1];(0,f.useEffect)((function(){M(G(G({},w),{},{page:1})),z([]),B([])}),[]);var M=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G({},g);x(!0),S(a),t.fetchDefectExportItems(n,e,a).then((function(){return x(!1)}))},Y=function(t){var e={};Object.keys(g).map((function(t){e=G(G({},e),{},(0,c.Z)({},t,w[t]))}));var n=["variation_id","product_id"];t.length&&t.map((function(t){"inserted_at"==t.key?(e.start_date=t.value.startDate.unix(),e.end_date=t.value.endDate.unix()):("supplier_products_id"==t.key?e[t.key]?e[t.key].push(t.value):e[t.key]=[t.value]:e[t.key]=t.value,n.includes(t.key)&&(e[t.key]=t.id))})),Z(t),M(e)},A=[{title:a("products.title"),dataIndex:"product_name",ellipsis:!0},{title:a("pages.shop.product.productDefect.productId"),dataIndex:"product_id",width:"15%",ellipsis:!0},{title:a("pages.shop.product.productDefect.variationId"),dataIndex:"variation_id",width:"15%",align:"right",ellipsis:!0},{title:a("pages.shop.product.productDefect.warehouse"),dataIndex:"warehouse_id",width:"15%",align:"right",ellipsis:!0},{title:a("pages.shop.product.productDefect.supplierProducts"),dataIndex:"supplier_product_id",width:"15%",align:"left",ellipsis:!0},{title:a("pages.shop.product.productDefect.defectQuantity"),dataIndex:"defect_quantity",width:"10%",align:"right",ellipsis:!0},{title:a("pages.shop.product.productDefect.eliminationQuantity"),dataIndex:"elimination_quantity",width:"10%",align:"right",ellipsis:!0}],K=function(){var e,n;return null===(e=t.defect_export_items)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(t){var e,n,o,r,c,u,l,p,f,h,v,g,m,y,_,x,b;return{key:"".concat(t.variation_id," ").concat(t.export.warehouse_id," ").concat(t.export.supplier_products_id||""),product_name:U(i.default,{title:t.product_name||(null===(e=t.variation)||void 0===e||null===(n=e.product)||void 0===n?void 0:n.name)||"S\u1ea3n ph\u1ea9m \u0111\xe3 xo\xe1"},U("span",null,t.product_name||(null===(o=t.variation)||void 0===o||null===(r=o.product)||void 0===r?void 0:r.name)||"S\u1ea3n ph\u1ea9m \u0111\xe3 xo\xe1")),product_id:U(i.default,{title:(null===(c=t.variation)||void 0===c||null===(u=c.product)||void 0===u?void 0:u.custom_id)||(null===(l=t.variation)||void 0===l||null===(p=l.product)||void 0===p?void 0:p.display_id)},U("span",null,(null===(f=t.variation)||void 0===f||null===(h=f.product)||void 0===h?void 0:h.custom_id)||(null===(v=t.variation)||void 0===v||null===(g=v.product)||void 0===g?void 0:g.display_id)||"")),variation_id:U(i.default,{title:(null===(m=t.variation)||void 0===m?void 0:m.custom_id)||(null===(y=t.variation)||void 0===y?void 0:y.display_id)},U("span",null,(null===(_=t.variation)||void 0===_?void 0:_.custom_id)||(null===(x=t.variation)||void 0===x?void 0:x.display_id)||"")),defect_quantity:t.defect_quantity,elimination_quantity:t.elimination_quantity,supplier_product_id:(null===s||void 0===s||null===(b=s.find((function(e){var n;return e.id==(null===(n=t.export)||void 0===n?void 0:n.supplier_products_id)})))||void 0===b?void 0:b.name)||"",warehouse_id:t.export.warehouse_id?d.find((function(e){return e.id==t.export.warehouse_id}))?d.find((function(e){return e.id==t.export.warehouse_id})).name:a("pages.shop.product.productDefect.delete"):"",action:t}}))},F=function(t){var e=l()(w);e.page=t.pageSize!=w.page_size?1:t.current,e.page_size=t.pageSize,M(e)},L={selectedRowKeys:C,onChange:function(t,e){B(e.map((function(t){return G(G({},t.action),{},{key:t.key})}))),z(t)},preserveSelectedRowKeys:!0},V=function(t,e){var n,o,i;if(!["search"].includes(t.key)){var c,p;switch(t.key){case"supplier_products_id":p=a("pages.shop.product.variation.supplierProducts"),c=null===s||void 0===s||null===(n=s.data.find((function(e){return e.id==t.value})))||void 0===n?void 0:n.name;break;case"inserted_at":p=a("pages.shop.debt.insertedAt"),c=function(t){var e=(0,D.o0x)(h,t.startDate||"",!1,"DD/MM/YYYY"),n=(0,D.o0x)(h,t.endDate||"",!1,"DD/MM/YYYY");return"".concat(a("pages.shop.product.purchase.from")," ").concat(e," - ").concat(a("pages.shop.product.purchase.to")," ").concat(n)}(t.value);break;case"creator_id":p=a("pages.shop.debt.creator"),c="created_by_system"==t.value?a("pages.shop.product.purchase.createdBySystem"):"created_by_user"==t.value?a("pages.shop.product.purchase.createdByUser"):null===(o=u.find((function(e){return e.user_id==t.value})))||void 0===o?void 0:o.user.name;break;case"warehouse_id":var f=d&&d.length>0&&(null===(i=d.find((function(e){return e.id==t.value}))||{})||void 0===i?void 0:i.name);p=a("pages.shop.setting.conditionWarehouse"),c=f;break;case"variation_id":p=a("pages.shop.statistic.variation"),c=t.value;break;case"product_id":p=a("products.title"),c=t.value}return U(r.default,{key:e,closable:!0,onClose:function(){return function(t){var e=l()(E);e.splice(t,1),Y(e)}(e)}},U("div",null,U("strong",null,p),": ",c))}};return U("div",null,U("div",{className:"tools-container"},U(_.Z,{icon:U(k.Z,null),title:a("components.syncListExport"),onClick:function(){return M(w)}}),U(W,{selectedRowKeys:C,shopId:e,accessToken:n,t:a,selectedRowDatas:q,fetchCallback:function(){return M()}}),C.length>0&&U(o.default,{onClick:function(){return z([])},type:"dashed"},U("b",null,C.length),"\xa0",a("pages.shop.order.selectedOrder"),"  ",U(R.Z,null)),U("div",{className:"filter"},U(P.Z,{params:w,shopId:e,accessToken:n,fetch:function(t){return M(t)}}),E&&E.length>0&&U(o.default,{className:"delete",danger:!0,onClick:function(){return Z([]),void M()}},a("pages.shop.debt.deleteFilter")),U(N.Z,{className:"product-defect-variation",id:"search-product-defect-variation",accessToken:n,shopId:e,fetch:function(t){return Y(t)},filters:E,params:w,supplier_products:s||[]}))),U("div",{className:"show-filter"},E.map((function(t,e){return V(t,e)}))),function(e){return U("div",null,U(j.Z,{loading:y,columns:A,dataSource:K(),className:"defect-table",pagination:{size:"small",pageSize:w.page_size,total:t.defect_export_items.total_entries,pageSizeOptions:v,current:w.page,showSizeChanger:!0},rowSelection:L,scroll:{y:e&&e.length>0?"calc(100vh - 250px)":"calc(100vh - 212px)"},onChange:F}))}(E),E&&E.length>0?U(p.default,{id:"2128136217"},[".defect-table .ant-table-body,.defect-table .ant-table-body-inner{min-height:calc(100vh - 250px);}"]):U(p.default,{id:"1834922348"},[".defect-table .ant-table-body,.defect-table .ant-table-body-inner{min-height:calc(100vh - 212px);}"]))})),$=n(48519),J=n(41850),tt=n(45812),et=n(62391),nt=n(21037),at=n(54320),ot=n(7859),rt=f.createElement;function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){(0,c.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var st=u.Z.confirm,ut=s.default.Group,dt=s.default.Button,lt="defect-table",pt="exportAt",ft=function(t){var e=t.t,n=t.accessToken,s=t.shopId,u=t.currentShop,d=t.defect_export_list.total_entries,h=t.defect_export_list,g=t.supplier_products,S=t.users,O=t.warehouses,E=t.timezone,C=t.dispatch,j={note:"",export_items:[],warehouse:{},supplier_products_id:null,status:0,type:1},R={page:1,page_size:30,status:"-1",type:1},z=JSON.parse(localStorage.getItem("columns_width_defect_product"))||{},T=["30","50","100"],q=(0,f.useState)(30),M=q[0],Y=q[1],A=(0,f.useState)(1),K=A[0],F=A[1],L=(0,f.useState)(!1),V=L[0],H=L[1],W=(0,f.useState)({page:1,page_size:30,status:"-1",type:1}),U=W[0],X=W[1],G=(0,f.useState)([]),it=G[0],ft=G[1],ht=(0,f.useState)(!1),vt=ht[0],gt=ht[1],mt=(0,f.useState)(null),yt=mt[0],_t=mt[1],xt=(0,f.useState)("defect"),bt=xt[0],wt=xt[1],kt=(0,f.useState)([]),St=kt[0],Ot=kt[1],Et=(0,f.useState)([]),Dt=Et[0],Zt=Et[1],It=(0,f.useState)(!1),Ct=It[0],Pt=It[1],Nt=(0,f.useState)(z),jt=Nt[0],Rt=Nt[1];(0,f.useEffect)((function(){H(!0),t.fetchDefectExport(n,s,U).then((function(){return H(!1)})),t.fetchCountStatusExport(n,s,U),(0,D.oSE)(lt)}),[]),(0,f.useEffect)((function(){zt(ct(ct({},U),{},{page_size:M,page:K}))}),[M,K]);var zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct({},R);X(e),H(!0),t.fetchDefectExport(n,s,e).then((function(){return H(!1)})),t.fetchCountStatusExport(n,s,e)},Tt=[{title:"ID",dataIndex:"id",width:"4%",ellipsis:!0},{title:e("pages.shop.product.export.creator"),dataIndex:"creator",ellipsis:!0},{title:e("warehouse"),dataIndex:"warehouse",ellipsis:!0},{title:e("note"),dataIndex:"note",ellipsis:!0},{title:e("pages.shop.product.export.supplier"),dataIndex:"supplierProductsName",align:"right",ellipsis:!0},{title:e("pages.shop.product.export.totalQuantity"),dataIndex:"total",align:"right",ellipsis:!0},{title:e("pages.shop.product.export.totalPrice"),dataIndex:"totalPrice",align:"right",ellipsis:!0},{title:e("pages.shop.product.export.exportAt"),dataIndex:"exportAt",align:"right",ellipsis:!0},{title:"",dataIndex:"action",align:"center",fixed:"right",ellipsis:!0,render:function(t){return rt("span",{onClick:function(t){return t.stopPropagation()}},rt(y.Z,{accessToken:n,shopId:s,exportList:t}))}}],qt=function(e){var n=t.supplier_products;return n&&n.length>0&&e&&n.filter((function(t){return t.id==e})).length>0?n.filter((function(t){return t.id==e}))[0].name:""},Bt=function(){var n;return((null===(n=t.defect_export_list)||void 0===n?void 0:n.data)||[]).map((function(n){return{key:n.display_id,id:rt(i.default,{title:(0,D.pyT)(n.display_id,0)},(0,D.pyT)(n.display_id,0)),creator:n.user?rt(I.Z,{seed:n.user.id,avatar_url:n.user.avatar_url,id:n.user.fb_id,size:[20,20],style:{marginRight:5,float:"left"},name:n.user.name,showName:!0}):rt(r.default,{color:"#00707f"},e("pages.admin.system")),warehouse:rt(i.default,{title:n.warehouse.name},n.warehouse.name),note:rt(i.default,{title:n.note},n.note),supplierProductsName:rt(i.default,{title:qt(n.supplier_products_id)},qt(n.supplier_products_id)),total:n.export_items&&n.export_items.length>0?(0,D.oH6)(n.export_items.reduce((function(t,e){return t+e.quantity}),0),u.currency):0,exportAt:(0,D.o0x)(t.timezone||7,n.inserted_at),action:n,totalPrice:n.export_items&&n.export_items.length>0?(0,D.ufS)(n.export_items.reduce((function(t,e){return t+e.quantity*((null===e||void 0===e?void 0:e.imported_price)||0)}),0),u.currency):0}}))},Mt=function(t){Y(t.pageSize),F(t.current)},Yt=function(t){var e={};Object.keys(R).map((function(t){e=ct(ct({},e),{},(0,c.Z)({},t,U[t]))}));var n=["variation_id","product_id"];t.length&&t.map((function(t){"inserted_at"==t.key?(e.start_date=t.value.startDate.unix(),e.end_date=t.value.endDate.unix()):("supplier_products_id"==t.key?e[t.key]?e[t.key].push(t.value):e[t.key]=[t.value]:e[t.key]=t.value,n.includes(t.key)&&(e[t.key]=t.id))})),ft(t),zt(e)},At=function(t,n){var a,o,i;if(!["search"].includes(t.key)){var c,s;switch(t.key){case"supplier_products_id":s=e("pages.shop.product.variation.supplierProducts"),c=null===g||void 0===g||null===(a=g.data.find((function(e){return e.id==t.value})))||void 0===a?void 0:a.name;break;case"inserted_at":s=e("pages.shop.debt.insertedAt"),c=function(t){var n=(0,D.o0x)(E,t.startDate||"",!1,"DD/MM/YYYY"),a=(0,D.o0x)(E,t.endDate||"",!1,"DD/MM/YYYY");return"".concat(e("pages.shop.product.purchase.from")," ").concat(n," - ").concat(e("pages.shop.product.purchase.to")," ").concat(a)}(t.value);break;case"creator_id":s=e("pages.shop.debt.creator"),c="created_by_system"==t.value?e("pages.shop.product.purchase.createdBySystem"):"created_by_user"==t.value?e("pages.shop.product.purchase.createdByUser"):null===(o=S.find((function(e){return e.user_id==t.value})))||void 0===o?void 0:o.user.name;break;case"warehouse_id":var u=O&&O.length>0&&(null===(i=O.find((function(e){return e.id==t.value}))||{})||void 0===i?void 0:i.name);s=e("pages.shop.setting.conditionWarehouse"),c=u;break;case"variation_id":s=e("pages.shop.statistic.variation"),c=t.value;break;case"product_id":s=e("products.title"),c=t.value}return rt(r.default,{key:n,closable:!0,onClose:function(){return function(t){var e=l()(it);e.splice(t,1),Yt(e)}(n)}},rt("div",null,rt("strong",null,s),": ",c))}},Kt=function(){var n=t.defect_export_list.counters,a=function(t){var e;return"-1"==t?(n||[]).reduce((function(t,e){return t+e.count}),0):(null===(e=(n||[]).find((function(e){return e.status==t})))||void 0===e?void 0:e.count)||0},o=[{text:e("commons.all"),value:"-1",count:a("-1")}];return Object.keys((0,Z.tw)()).map((function(t){o.push({text:(0,Z.tw)()[t].text,value:t,count:a(t)})})),rt("div",{className:"status-dropdown"},rt(ut,{value:U.status},o.map((function(t){return rt(dt,{key:t.value,value:t.value,onChange:function(t){return e=t.target.value,void zt(ct(ct({},l()(U)),{},{status:e}));var e}},t.text,rt(r.default,{key:t.value},V&&U.status==t.value?rt(b.Z,null):t.count))}))))},Ft=function(t,e){var n=e&&e.length>0?e:(null===h||void 0===h?void 0:h.data)||[],a=Dt.concat(t.filter((function(t){return!St.includes(t)})).map((function(t){return n.find((function(e){return e.display_id==t}))}))).filter((function(e){return t.includes(null===e||void 0===e?void 0:e.display_id)}));Ot(t),Zt(a)},Lt=function(){var t="".concat((0,D.LpH)(),"/shops/").concat(s,"/export?access_token=").concat(n);Pt(!0);(function(e){return B().get(t,{params:e}).then((function(t){var e=t.data.data,n=e.map((function(t){return t.display_id})),a=St.filter((function(t){return!n.includes(t)})).concat(n);Ft(a,e)}))})(ct(ct({},U),{},{page:-1})).then((function(){return Pt(!1)}))},Vt=function(t,e){var n;t==pt&&(e=((null===jt||void 0===jt?void 0:jt.inc)||0)+e-((null===(n=document.getElementsByClassName(t)[0])||void 0===n?void 0:n.offsetColumnsWidth)||0));t=t==pt?"inc":t;var a=ct(ct({},jt),{},(0,c.Z)({},t,e));Rt(a),localStorage.setItem("columns_width_defect_product",JSON.stringify(jt))},Ht=function(t,e){var n=Tt.map((function(t){return jt&&jt[t.dataIndex]?t.width=jt[t.dataIndex]:"action"==t.dataIndex?t.width=150:t.width=160,t}));if(n.map((function(t){return t.dataIndex==pt&&t.width&&delete t.width,t})),n=n.map((function(t){return ct(ct({},t),{},{onHeaderCell:function(t){return{id:t.dataIndex,width:t.width,tableClassName:lt,onResize:Vt,isInc:t.dataIndex==pt}}})})),!(u?(0,$.zE)(u.role):{}).view_imported_price){var a=n.findIndex((function(t){return"totalPrice"==t.dataIndex}));a>-1&&n.splice(a,1)}var o={header:{cell:ot.Z}};return rt("div",null,Kt(),rt(J.Z,{size:"small",dataSource:Bt(),columns:n,loading:V,className:lt,pagination:{size:"small",pageSize:M||30,total:d,pageSizeOptions:T,showSizeChanger:!0,current:K},onChange:Mt,onRow:function(t){return{onClick:function(){return function(t){var e=t.action;gt(!0),_t(e)}(t)}}},rowSelection:{selectedRowKeys:St,onChange:function(t){return Ft(t)},preserveSelectedRowKeys:!0,onSelectRow:Lt,isSelection:!0},components:o,scroll:{y:t&&t.length>0?"calc(100vh - 250px)":"calc(100vh - 212px)"}}))};return rt(v.Z,{className:"product-export"},rt(a.default,{activeKey:bt,onChange:function(t){zt(ct(ct({},U),{},{page:1})),wt(t)},animated:!1,className:"header-tabs"},rt(a.default.TabPane,{tab:e("pages.shop.product.productDefect.byExport"),key:"defect"},rt("div",null,rt("div",{className:"tools-container"},rt(_.Z,{icon:rt(w.Z,null),title:e("pages.shop.product.productDefect.createExportDefect"),onClick:function(){localStorage["draft_export_shop_".concat(s,"_").concat(j.type)]?st({title:e("pages.shop.product.purchase.alert"),content:e("pages.shop.product.export.contentExport"),okText:e("pages.shop.product.export.yes"),cancelText:e("pages.shop.product.export.delete"),onOk:function(){try{var t=JSON.parse(localStorage.getItem("draft_export_shop_".concat(s,"_").concat(j.type)))||j;_t(t),gt(!0)}catch(e){console.log(e)}},onCancel:function(){gt(!0),_t(j),localStorage.removeItem("draft_export_shop_".concat(s,"_").concat(j.type))}}):(gt(!0),_t(j))}}),rt(x.Z,{icon:rt(k.Z,null),title:e("pages.shop.orderControlInfo.sync"),onClick:function(){return zt(U)},isButton:!0}),rt(et.Z,{shopId:s,accessToken:n,selectedExports:Dt,selectedRowKeys:St,dispatch:C,isButton:!0,params:U,title:e("pages.shop.statistic.inventory.exportExcel"),type:"product defect"}),rt(nt.Z,{accessToken:n,shopId:s,isButton:!0,title:e("pages.shop.actionTools.importExcel"),type:1,fetch:function(){return zt(U)}}),rt(at.Z,{accessToken:n,shopId:s,isButton:!0,selectedRowKeys:St,selectedData:Dt,keys:"product_defect"}),rt(tt.Z,{selectedLength:St.length,loadingData:Ct,total:d,onClick:function(){Pt(!1),Ot([]),Zt([])}}),rt("div",{className:"filter"},rt(P.Z,{params:U,shopId:s,accessToken:n,fetch:function(t){return zt(t)}}),rt("div",{style:{display:"flex"}},it&&it.length>0&&rt(o.default,{className:"delete",danger:!0,onClick:function(){return ft([]),void zt()}},e("pages.shop.debt.deleteFilter")),rt(N.Z,{className:"product-defect",id:"search-product-defect",accessToken:n,shopId:s,fetch:function(t){return Yt(t)},filters:it,params:U,supplier_products:g||[]}))),rt("div",{className:"show-filter"},it.map((function(t,e){return At(t,e)})))),rt(m.Z,{visible:vt,close:function(){gt(!1),_t(null)},export_list:yt,accessToken:n,shopId:s,supplier_products:g||[],type:1}),Ht(it),function(t){return t?rt(p.default,{id:"2128136217"},[".defect-table .ant-table-body,.defect-table .ant-table-body-inner{min-height:calc(100vh - 250px);}"]):rt(p.default,{id:"1834922348"},[".defect-table .ant-table-body,.defect-table .ant-table-body-inner{min-height:calc(100vh - 212px);}"])}(it&&it.length>0))),rt(a.default.TabPane,{tab:e("pages.shop.product.productDefect.byVariation"),key:"defect-items"},rt(Q,{filters:it,params:U,shopId:s,accessToken:n,t:e}))))};ft.pageInfo={title:"pages.shop.product.productDefect.name",sassStyle:O()};var ht=(0,h.$j)((function(t){var e,n,a=t.shop.currentShop,o=t.navigation.user,r=t.user.users,i=(0,D.nkB)(null===(e=t.product)||void 0===e||null===(n=e.supplier_products)||void 0===n?void 0:n.data,null===a||void 0===a?void 0:a.shop_departments,o,r);return{currentShop:a,defect_export_list:t.product.defect_export_list,warehouses:(0,C.op)(t),users:r,supplier_products:i}}),{fetchDefectExport:E.Ev4,fetchCountStatusExport:E.wvz})((0,g.Z)(ft))},7577:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/product/product-defect",function(){return n(36339)}])}},function(t){t.O(0,[5460,2902,2653,2391,4560,9774,2888,179],(function(){return e=7577,t(t.s=e);var e}));var e=t.O();_N_E=e}]);