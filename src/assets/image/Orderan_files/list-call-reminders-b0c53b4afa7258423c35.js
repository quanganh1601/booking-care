(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8798],{36364:function(e){!function(){"use strict";e.exports=".call-reminders-container .tools-container{display:flex;justify-content:space-between;border-bottom:1px solid #e9e9e9;padding:0 24px 16px 24px !important}.call-reminders-container .call-reminder-row{cursor:pointer}.call-reminders-container .call-reminder-row:hover{background:#f0f5ff}.call-reminders-container .call-reminder-row:hover .call-reminder-item-content .btn-reminders{display:flex}.call-reminders-container .call-reminder-header{background:#f5f5f5;border-bottom:1px solid #d9d9d9;border-top:1px solid #d9d9d9}.call-reminders-container .call-reminder-header .title-header{color:rgba(0,0,0,.85)}.call-reminders-container .call-reminder-content{overflow:auto}.call-reminders-container .call-reminder-content::-webkit-scrollbar{width:5px !important}.call-reminders-container .call-reminder-item{min-height:64px}.call-reminders-container .call-reminder-item .call-reminder-item-content{display:flex;align-items:center;width:100%}.call-reminders-container .call-reminder-item .call-reminder-item-content .content-id{color:#096dd9}.call-reminders-container .call-reminder-item .call-reminder-item-content .content-avatar,.call-reminders-container .call-reminder-item .call-reminder-item-content .page-customer{display:flex;align-items:center}.call-reminders-container .call-reminder-item .call-reminder-item-content .btn-reminders{justify-content:center;display:none;align-items:center}.call-reminders-container .call-reminder-item .call-reminder-item-content .btn-reminders .btn-edit{margin-right:9px}.call-reminders-container .call-reminder-item .call-reminder-item-content .btn-reminders .btn-delete:hover{border:1px solid #ffa39e;color:#eb5757}.call-reminders-container .call-reminder-item .call-reminder-item-content .btn-reminders .btn-edit,.call-reminders-container .call-reminder-item .call-reminder-item-content .btn-reminders .btn-delete{border:1px solid #d9d9d9}.call-reminders-container .call-reminder-item .call-reminder-item-content .page-customer{margin-top:5px}.call-reminders-container .call-reminder-item .call-reminder-item-content .content-time-status{margin-top:5px}.call-reminders-container .call-reminder-item .call-reminder-item-content .tag-status{border-radius:2px;font-size:12px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.call-reminders-container .call-reminder-item .call-reminder-item-content .tag-called-at{background:#f0f5ff;border:1px solid #adc6ff}.call-reminders-container .call-reminder-item .call-reminder-item-content .tag-not-listening{background:#fff1f0;border:1px solid #ffa39e}.call-reminders-container .call-reminder-item .call-reminder-item-content .tag-calling{background:#f6ffed;border-color:#b7eb8f}.call-reminders-container .call-reminder-table .ant-table-cell{padding:8px !important}.text-font-color{color:#000000a6}.item-tag{font-size:12px}.font-weight-500{font-weight:500}.list-call-reminders{padding:0 24px}.list-call-reminders .pagination-call-reminder{display:flex;align-items:center;justify-content:flex-end;padding:5px 0px;position:fixed;bottom:0;right:24px}.list-call-reminders .tab-call-remainders{background:#fff;border:1px solid #d9d9d9;border-radius:2px}.list-call-reminders .tab-call-remainders .ant-tabs-nav{margin-bottom:0px !important;height:54px}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-ink-bar{display:none}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-nav-wrap{padding:0px 4px}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-tab{padding:16px 12px 16px 16px;color:rgba(0,0,0,.45)}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-tab .tab-name{font-weight:500}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-tab .tab-name .name{margin-right:4px}.list-call-reminders .tab-call-remainders .ant-tabs-nav .ant-tabs-tab-active{color:#096dd9}.list-call-reminders .tab-call-remainders .pane-call-remainders .des-small{min-height:300px}.list-call-reminders .ant-list-bordered{border:unset}.pane-center{display:flex;align-items:center}.pane-justify-content{justify-content:center}.no-data{display:flex;align-items:center;justify-content:center;padding:0px !important;height:100%}.no-data .box-no-data{display:grid}.no-data .box-no-data .image-no-message{-o-object-fit:contain;object-fit:contain;max-width:100%;max-height:100%;width:auto;height:auto}.no-data .box-no-data .text-no-data{color:#8c8c8c;display:flex;justify-content:center;margin-top:10px}.modal-call-reminder .ant-modal-content{border-radius:2px}.modal-call-reminder .ant-modal-content .ant-modal-header{background-color:#f0f0f0;border-radius:2px 2px 0 0;height:48px;padding:12px 24px;border-bottom:1px solid #d9d9d9}.modal-call-reminder .ant-modal-content .ant-modal-header .ant-modal-title{color:rgba(0,0,0,.85)}"}()},7690:function(e,t,n){"use strict";var a,r=n(71535),l=n(65400),i=n(74047),s=n(52700),o=n(4706),c=n(33814),d=n(44102),u=n(20775),p=n(26265),m=n(65988),f=n(67294),h=n(99069),g=n(17405),v=n(57254),y=n(87217),b=n(95213),_=n(20920),x=f.createElement;function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var r=(0,u.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}var w="btn-filter",C=(0,y.Z)()(a=function(e){(0,c.Z)(n,e);var t=Z(n);function n(e){var a;return(0,i.Z)(this,n),a=t.call(this,e),(0,p.Z)((0,o.Z)(a),"handleClickOutSideFilter",(function(e){var t=a.state.popupVisible,n=a.props,r=n.popupClassName,l=n.id,i=n.field;e.stopPropagation();var s=document.getElementsByClassName(r)[0],o=document.getElementById("advance-filter-".concat(null===i||void 0===i?void 0:i.name));if(s){var c=s.getBoundingClientRect();if(c.left<e.x&&e.x<c.right&&c.top<e.y&&e.y<c.bottom)return}var d=document.getElementsByClassName("ant-picker-dropdown-range")[0],u=l?document.getElementById(l):document.getElementById(w);s&&(s.contains(e.target)||u.contains(e.target)||d&&d.contains(e.target)||o&&o.contains(e.target)||t&&a.setPopupVisible(!1))})),(0,p.Z)((0,o.Z)(a),"setPopupVisible",(function(e){return a.setState({popupVisible:e})})),(0,p.Z)((0,o.Z)(a),"handleFilter",(function(){var e=a.props,t=e.field,n=e.callBackField,r=e.type,l=(e.popupClassName,a.state.popupVisible);a.setPopupVisible(!l),r&&n(t)})),(0,p.Z)((0,o.Z)(a),"styleModal",(function(e){var t=a.props,n=t.columnsWidth,r=t.field,l=t.dataSource,i=n[r.name];return i=(i=i||(0,b.IQS)(l,r.type==(0,_.Rt)().boolean.id?r.label:r.name))&&(i.toString().includes("em")?i:"".concat(i,"px")),x(m.default,{id:"2766829989",dynamic:[e,i,e]},[".".concat(e," .ant-cascader-menu:first-child{width:").concat(i,";min-width:150px;max-width:285px;}"),".".concat(e," .ant-cascader-menu-item-disabled{position:-webkit-sticky;position:sticky;top:-4px;padding-top:5px;z-index:900;background-color:#fff;}")])})),(0,p.Z)((0,o.Z)(a),"getButton",(function(){var e=a.props,t=e.t,n=e.label,r=e.type,i=e.field,s=e.popupClassName,o=e.id,c=e.noIcon;return n?x("span",{id:o||w,className:"btn-advance-filter",onClick:a.handleFilter},n):r?x("span",{id:"advance-filter-".concat(i.name),onClick:function(){return a.handleFilter()},style:{width:20}},a.styleModal(s),x(h.Z,{style:{color:"#949494"},className:"field-icon"})):x(l.default,{id:o||w,icon:c?null:x(g.Z,null),onClick:function(){return a.handleFilter()},className:"btn-advance-filter"},t("crm.addFilter"),x(v.Z,null))})),a.state={popupVisible:!1},a}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this),document.addEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"componentWillUnmount",value:function(){this.props.onRef&&this.props.onRef(null),document.removeEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"render",value:function(){var e=this.props,t=e.options,n=e.popupClassName,a=e.onChange,l=e.changeOnSelect,i=e.loadData,s=e.disabled,o=e.displayRender,c=e.type,d=this.state.popupVisible;return x(r.Z,{defaultValue:c?["$customize"]:"",popupVisible:d,popupClassName:n,options:t,popupPlacement:"bottomRight",changeOnSelect:l,onChange:a,loadData:i,disabled:s,displayRender:o},this.getButton())}}]),n}(f.Component))||a;t.Z=C},65644:function(e,t,n){"use strict";var a=n(74047),r=n(52700),l=n(4706),i=n(33814),s=n(44102),o=n(20775),c=n(26265),d=n(67294),u=n(14494),p=n(36934),m=d.createElement;function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,o.Z)(e);if(t){var r=(0,o.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,s.Z)(this,n)}}var v=function(e){(0,i.Z)(n,e);var t=g(n);function n(e){var r;return(0,a.Z)(this,n),r=t.call(this,e),(0,c.Z)((0,l.Z)(r),"listenMeronpan",(function(){var e=r.props,t=e.extension,n=e.dispatch;null==t&&(r.unlistenMeronpan(),window.addEventListener("message",r.listenMeronpanHandler.bind((0,l.Z)(r),n)),window.postMessage({type:"CHECK_EXTENSION_VERSION",from:"WEBPAGE"},"*"),window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*"))})),(0,c.Z)((0,l.Z)(r),"listenMeronpanHandler",(function(e,t){if("WEBPAGE"!=t.data.from)switch(t.data.type){case"EXTENSION_LOADED":window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*");break;case"REPORT_EXTENSION_STATUS":e((0,p.GoT)(t.data.connectionStatus));break;case"EXTENSION_VERSION":e((0,p.HfQ)(t.data.version))}})),(0,c.Z)((0,l.Z)(r),"unlistenMeronpan",(function(){window.removeEventListener("message",r.listenMeronpanHandler)})),r}return(0,r.Z)(n,[{key:"componentWillUnmount",value:function(){this.unlistenMeronpan()}},{key:"componentDidMount",value:function(){this.listenMeronpan()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,a=e.onScroll,r=e.style,l=e.top,i=e.height;return m("div",{id:"container-layout",onScroll:a,style:this.props.fullScreen?h(h(h({},y),r),{},{top:0,height:"calc(100%)"}):h(h(h({},y),r),{},{top:l||49,height:i||"calc(100% - ".concat(l||49,"px)")}),className:"__container-layout ".concat(t||"")},n)}}]),n}(d.Component),y={overflowY:"overlay",overflowX:"hidden",position:"absolute",height:"calc(100% - 49px)",width:"100%",padding:"10px 0",top:49,left:0};t.Z=(0,u.$j)((function(e){return{fullScreen:e.navigation.fullScreen,extension:e.shop.extension}}),null)(v)},42323:function(e,t,n){"use strict";n.r(t);var a=n(56697),r=n(51024),l=n(69843),i=n(65400),s=n(59361),o=n(809),c=n.n(o),d=n(92447),u=n(74047),p=n(52700),m=n(4706),f=n(33814),h=n(44102),g=n(20775),v=n(26265),y=n(20838),b=n(56590),_=n(14321),x=n(18446),Z=n.n(x),w=n(44908),C=n.n(w),k=n(57557),N=n.n(k),R=n(23279),O=n.n(R),S=n(67294),E=n(92902),T=n(14494),P=n(65644),I=n(36364),D=n.n(I),j=n(7085),M=n(8212),V=n(73171),B=n(49101),F=n(25592),z=n(76570),H=n(36934),L=n(83049),A=n(31731),U=n(95213),Y=n(20920),X=n(96129),W=n(50916),G=n(7690),$=n(30381),K=n.n($),Q=n(9669),q=n.n(Q),J=n(49677),ee=n(66745),te=S.createElement;function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,g.Z)(e);if(t){var r=(0,g.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,h.Z)(this,n)}}var le=_.default.RangePicker,ie=b.default.Item,se=y.default.TabPane,oe=["30","50","100"],ce=function(e){(0,f.Z)(n,e);var t=re(n);function n(e){var o;return(0,u.Z)(this,n),o=t.call(this,e),(0,v.Z)((0,m.Z)(o),"getCallReminders",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.props,a=n.accessToken,r=n.shopId,l=n.fetchCallLaters;o.setState((0,v.Z)({},e,ae(ae({},o.state[e]),{},{loading:!0,data:[]}))),l(a,r,t=["overdue","completed"].includes(e)?ae({key:e,page_number:o.state[e].page_number,page_size:o.state[e].page_size||30},t):ae({key:e,page_number:"-1"},t)).then((function(n){if(n&&n.success){var a=!!n.data.length;o.setState((0,v.Z)({},e,ae(ae(ae({},t),n),{},{loading:a})))}}))})),(0,v.Z)((0,m.Z)(o),"onSync",(function(){o.state.show.map((function(e){var t=ae({},o.state[e]);t.data=[],o.getCallReminders(e,t)}))})),(0,v.Z)((0,m.Z)(o),"assignedUser",(function(e){var t=o.props.t,n=e.need_notify_users||[];if(n.includes("4efcf783-ad0d-4a79-aad2-fda430dcc10e"))return t("commons.all");var a=n.length>0?o.props.users.filter((function(e){return n.includes(e.user_id)})):[];if(!a.length)return te("div",{style:{display:"flex",alignItems:"center"}},te(W.Z,{name:o.props.user.name,avatar_url:o.props.user.avatar_url,id:o.props.user.id,uid:o.props.user.uid,seed:o.props.user.uid,size:[20,20]}),te("span",{className:"text-font-color",style:{marginLeft:5}},o.props.user.name));if(1==a.length){var r=a[0].user;return te("div",{style:{display:"flex",alignItems:"center"}},te(W.Z,{name:r.name,avatar_url:r.avatar_url,id:r.fb_id,uid:r.id,seed:r.id,size:[20,20]}),te("span",{className:"text-font-color",style:{marginLeft:5}},r.name))}var l=[];return a.map((function(e){return l.push(e.user)})),(0,X.n1)(l,{size:20})})),(0,v.Z)((0,m.Z)(o),"fetchOrder",(function(e){var t=o.props,n=t.accessToken,a=t.shopId,r="".concat((0,U.LpH)(),"/shops/").concat(a,"/orders/").concat(e,"?access_token=").concat(n);return q().get(r).then(function(){var e=(0,d.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.props.openForm({data:t.data.data});case 2:o.setState({formBoxVisible:!0});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),(0,v.Z)((0,m.Z)(o),"onChangeTab",(function(e){o.setState({tab:e})})),(0,v.Z)((0,m.Z)(o),"renderTab",(function(e){var t=o.props.t,n=o.state[e];return te("div",{className:"tab-name"},te("span",{className:"name"},t("pages.shop.callReminders.".concat(e))),te("b",null,"(",n.total_entries?n.total_entries:n.data.length,")"))})),(0,v.Z)((0,m.Z)(o),"renderStatus",(function(e){var t=o.props,n=t.t,a=t.timezone;if("note"==e.type&&e.called_at)return te("span",{className:"text-font-color",style:{display:"grid"}},te("span",null,n("pages.shop.callReminders.announcedAt")),te("span",null,(0,U.o0x)(a,e.called_at)));if("call"==e.type)switch(e.status){case 0:return e.is_canceled?te(s.default,{className:"tag-status",color:"#bfbfbf",style:{marginRight:0}},n("pages.shop.statistic.canceled")):void 0;case 1:return te(s.default,{className:"tag-status tag-called-at"},n("components.orderCallLater.calledAt")," ",(0,U.o0x)(a,e.called_at));case 2:return te(s.default,{className:"tag-status tag-not-listening"},n("components.orderCallLater.notListening"));case 3:return e.is_canceled?te(s.default,{className:"tag-status",color:"#bfbfbf",style:{marginRight:0}},n("pages.shop.statistic.canceled")):te(s.default,{className:"tag-status tag-calling"},n("components.orderCallLater.calling"));default:return}})),(0,v.Z)((0,m.Z)(o),"handleOpenModal",(function(e,t){var n,a=null===(n=o.state[t])||void 0===n?void 0:n.data.find((function(t){return t.id==e}));(a=ae(ae({},a),{},{isShowPopup:!0}))&&o.props.showCallReminder(a)})),(0,v.Z)((0,m.Z)(o),"renderContent",(function(){var e=o.props,t=e.t,n=e.timezone,a=e.accessToken,r=o.state,c=r.tags,d=r.tab,u=c.filter((function(e){return"key"==e.key})),p=u.length>0?u.reduce((function(e,t){return e.push(t.value),e}),[]):o.state.show;return te("div",{className:"list-call-reminders"},te(y.default,{activeKey:d||p[0],onChange:o.onChangeTab,className:"tab-call-remainders"},C()(p).map((function(e){var r,l,d=o.state[e];return te(se,{tab:o.renderTab(e),key:e,className:"pane-call-remainders"},0==d.data.length&&te("div",{className:"des-small pane-center pane-justify-content"},d.loading?te("div",null,te(j.Z,null),"\xa0",t("pages.shop.callReminders.loading",{data:t("pages.shop.callReminders.appointment")})):te("div",{className:"no-data"},te("span",{className:"box-no-data"},te("span",null,te("img",{className:"image-no-message",src:"/static/img/no-data-icon.svg"})),te("span",{className:"text-no-data"},t("pages.shop.callReminders.noData"))))),(null===(r=d.data)||void 0===r?void 0:r.length)>0&&te(b.default,{style:{background:"#fff"},bordered:!0},te(ie,{className:"call-reminder-item call-reminder-header",key:"columns"},te("div",{className:"call-reminder-item-content"},te("div",{className:"title-header font-weight-500",style:{width:"10%"}},t("pages.shop.callReminders.orderId")),te("div",{className:"title-header font-weight-500",style:{display:"grid",width:"15%"}},t("pages.shop.callReminders.at")),te("div",{className:"title-header font-weight-500",style:{width:"15%"}},t("pages.shop.callReminders.status")),te("div",{className:"title-header font-weight-500",style:{width:"20%"}},t("pages.shop.callReminders.content")),te("div",{className:"title-header font-weight-500",style:{width:"15%"}},t("pages.shop.callReminders.assignedUser")),te("div",{className:"title-header font-weight-500",style:{width:"15%"}},t("pages.shop.callReminders.creator")),te("div",{className:"title-header font-weight-500",style:{width:"10%"}}))),te("div",{className:"call-reminder-content",style:{maxHeight:"calc(100vh - ".concat((null===c||void 0===c?void 0:c.length)>0?((null===(l=document.getElementsByClassName("tags-filter")[0])||void 0===l?void 0:l.offsetHeight)||0)+280:280,"px)")}},d.data.map((function(r){var l,c=(null===r||void 0===r||null===(l=r.conversation)||void 0===l?void 0:l.customers)||[],d=null!==c&&void 0!==c&&c.length?c[0]:null;return d=ae(ae({},d),{},{page_id:r.page_id}),te(ie,{className:"call-reminder-item call-reminder-row",key:r.id,onClick:function(){return o.handleOpenModal(r.id,e)}},te("div",{className:"call-reminder-item-content"},te("div",{className:"content-id",style:{width:"10%"}},r.order_id?te("a",{className:"font-weight-500",onClick:function(){return o.fetchOrder(r.order_id)}},r.order_display_id):r.psid&&r.page_id?te("div",null,te("a",{className:"font-weight-500",onClick:function(){return window.open("".concat((0,U.Thw)(),"/").concat(r.page_id,"?c_id=").concat(r.psid))}},t("pages.shop.callReminders.conversation")),d&&te("div",{className:"page-customer"},te(W.Z,{name:d.name,id:"".concat(r.page_id,"_").concat(d.fb_id),seed:d.id,avatar_url:(0,Y.E$)(d,a),size:[25,25]})," \xa0",te("span",{className:"avatar-name text-font-color"},d.name))):"-"),te("div",{style:{display:"grid",width:"15%"}},te("span",null,"note"==r.type?te(s.default,{color:"#597EF7"},t("pages.shop.callReminders.tagNotifi")):te(s.default,{color:"#D46B08"},t("pages.shop.callReminders.tagCall"))),te("span",{style:{marginTop:5}},(0,U.o0x)(n,r.needs_call_at,!0))),te("div",{style:{width:"15%"}},o.renderStatus(r)),te("div",{className:"text-font-color",style:{width:"20%"}},r.notice_created?r.notice_created:null),te("div",{style:{width:"15%"}},o.assignedUser(r)),te("div",{className:"content-avatar",style:{width:"15%"}},te(W.Z,{name:r.creator.name,id:r.creator.fb_id,avatar_url:r.creator.avatar_url,uid:r.creator.id,size:[20,20],seed:r.creator.id,style:{marginRight:5}}),te("span",{className:"avatar-name text-font-color"},r.creator.name)),te("div",{className:"btn-reminders",style:{width:"10%"}},0==r.status&&te(i.default,{className:"btn-edit",icon:te(M.Z,null),onClick:function(t){t.stopPropagation(),o.handleEdit(r.id,e)}}),te(i.default,{className:"btn-delete",icon:te(V.Z,null),onClick:function(e){e.stopPropagation(),o.handleDelete([r.id])}}))))})))))}))),o.state.overdue.total_pages>1&&"overdue"==d&&te(l.default,{onChange:function(e,t){return o.getCallReminders("overdue",{page_number:e,page_size:t})},pageSize:o.state.overdue.page_size,current:o.state.overdue.page_number,total:o.state.overdue.total_entries,pageSizeOptions:oe,className:"pagination-call-reminder"}))})),(0,v.Z)((0,m.Z)(o),"handleSearchEmployee",(function(e,t){var n=e.target?e.target.value:e;o.props.pushUsersTextSearch(n,o.props.users,t,"callRemindFilter")})),(0,v.Z)((0,m.Z)(o),"renderUsers",(function(e,t){var n=o.props,a=(n.t,n.employeeList),r=n.users,l=(null===a||void 0===a?void 0:a.length)>0?a.findIndex((function(t){return t.which==e&&"callRemindFilter"==t.type})):-1,i=-1==l?r:a[l].users,s=l>-1?a[l].text:void 0,c=i.map((function(e){var t=e.user_id;return{value:t,label:(0,U.q$s)(t,i)}}));return t?s:c})),(0,v.Z)((0,m.Z)(o),"showOptionsFilter",(function(){var e,t=o.props,n=t.shopId,a=t.t,l=o.state,i=l.endNeedsCall,s=l.startNeedsCall,c=[{value:"creator_id",label:a("pages.shop.callReminders.creator"),children:[{value:100,label:te("div",{onClick:function(e){return e.stopPropagation()}},te(r.default,{onChange:function(e){return o.handleSearchEmployee(e,"creator_id")},value:o.renderUsers("creator_id",!0),placeholder:a("components.orderAdvanceFilter.enterEmployee"),allowClear:!0}))}].concat(o.renderUsers("creator_id",!1))},{value:"need_notify_users",label:a("pages.shop.callReminders.assignedUser"),children:[{value:100,label:te("div",{onClick:function(e){return e.stopPropagation()}},te(r.default,{onChange:function(e){return o.handleSearchEmployee(e,"need_notify_users")},value:o.renderUsers("need_notify_users",!0),placeholder:a("components.orderAdvanceFilter.enterEmployee"),allowClear:!0}))}].concat(o.renderUsers("need_notify_users",!1))},{value:"tag",label:a("pages.shop.callReminders.tag"),children:[{value:"call",label:a("pages.shop.callReminders.tagCall")},{value:"notification",label:a("pages.shop.callReminders.tagNotifi")}]},{value:"key",label:a("pages.shop.callReminders.show"),children:[{value:"today",label:a("pages.shop.callReminders.today")},{value:"upcoming",label:a("pages.shop.callReminders.upcoming")},{value:"overdue",label:a("pages.shop.callReminders.overdue")},{value:"completed",label:a("pages.shop.callReminders.completed")}]},{value:"time_needs_call",label:a("pages.shop.callReminders.needCallAt"),children:[{value:"needs_call_at",label:te("span",{onClick:function(e){return e.stopPropagation()}},te(le,{ranges:(e={},(0,v.Z)(e,a("pages.shop.statistic.yesterday"),[K()().add(-1,"days").startOf("day"),K()().add(-1,"days").endOf("day")]),(0,v.Z)(e,a("pages.shop.statistic.today"),[K()().startOf("day"),K()().endOf("day")]),(0,v.Z)(e,a("pages.shop.statistic.lastWeek"),[K()().add(-7,"days").startOf("day"),K()().endOf("day")]),(0,v.Z)(e,a("pages.shop.statistic.lastMonth"),[K()().add(-30,"days").startOf("day"),K()().endOf("day")]),(0,v.Z)(e,a("pages.shop.statistic.thisMonth"),[K()().startOf("month").startOf("day"),K()().endOf("month").endOf("day")]),e),className:"needs-call-at-range-picker",value:s&&i?[K()(s,"X"),K()(i,"X")]:[],format:"DD/MM/YYYY HH:mm",style:{width:300,marginRight:10},onChange:o.onChangeFilterNeedsCallAt,allowClear:!0,showTime:{defaultValue:[K()("00:00:00","HH:mm"),K()("23:59:59","HH:mm")]}}))}]}];return(0,U.QIx)(c,"".concat(n,"_filter_call_remind_count"))})),(0,v.Z)((0,m.Z)(o),"onChangeFilterNeedsCallAt",(function(e){var t=o.state,n=t.shopId,a=t.tags,r=a.filter((function(e){return"key"==e.key})),l=r.length>0?r.reduce((function(e,t){return e.push(t.value),e}),[]):o.state.show,i=null!==e&&void 0!==e&&e.length?e[0].startOf("day").unix():null,s=null!==e&&void 0!==e&&e.length?e[1].endOf("day").unix():null;C()(l).map((function(e){var t=ae({},o.state[e]);t.start_needs_call=i,t.end_needs_call=s,t.data=[],o.getCallReminders(e,t)}));var c=a.findIndex((function(e){return"needs_call_at"==e.key}));if(null!==e&&void 0!==e&&e.length){var d={key:"needs_call_at",value:{startNeedsCall:e[0].startOf("day"),endNeedsCall:e[1].endOf("day")}};c>-1?a[c]=d:a.push(d)}else c>-1&&a.splice(c,1);(0,U.iAs)("needs_call_at","".concat(n,"_filter_call_remind_count")),o.setState({tags:a,startNeedsCall:i,endNeedsCall:s})})),(0,v.Z)((0,m.Z)(o),"onClickMenuItem",(function(e){var t=o.state,n=t.tags,a=t.shopId,r=e[1],l=e[0],i=n.filter((function(e){return"key"==e.key})),s=i.length>0?i.reduce((function(e,t){return e.push(t.value),e}),[]):o.state.show;if("key"!=l)C()(s).map((function(e){var t=ae({},o.state[e]);if("need_notify_users"==l){var n=t[l]||[];n.findIndex((function(e){return e==r}))<0&&n.push(r),t[l]=n}else t[l]=r;t.data=[],o.getCallReminders(e,t)}));else{var c=ae({},o.state[r]);c.data=[],o.getCallReminders(r,c)}var d=n.findIndex((function(e){return e.key==l}));d>-1&&!["need_notify_users","key"].includes(l)?n[d]={key:l,value:r}:n.findIndex((function(e){return e.key==l&&e.value==r}))<0&&n.push({key:l,value:r});(0,U.iAs)(l,"".concat(a,"_filter_call_remind_count")),o.setState({tags:n})})),(0,v.Z)((0,m.Z)(o),"onChangeSearchText",(function(e){e.persist();var t=e.target.value;o.setState({search:t},(function(){return o.delaySearch()}))})),(0,v.Z)((0,m.Z)(o),"delaySearch",O()((function(){var e=o.state,t=e.search,n=e.tags.filter((function(e){return"key"==e.key})),a=n.length>0?n.reduce((function(e,t){return e.push(t.value),e}),[]):o.state.show;C()(a).map((function(e){var n=o.state[e];n=ae(ae({},n),{},{data:[],search:t}),o.getCallReminders(e,n)}))}),800)),(0,v.Z)((0,m.Z)(o),"renderShow",(function(e){var t=o.props.t;switch(e){case"today":return t("pages.shop.callReminders.today");case"upcoming":return t("pages.shop.callReminders.upcoming");case"overdue":return t("pages.shop.callReminders.overdue");case"completed":return t("pages.shop.callReminders.completed")}})),(0,v.Z)((0,m.Z)(o),"renderDateTag",(function(e){var t=o.props,n=t.timezone,a=t.t,r=(0,U.o0x)(n,e.startNeedsCall||"",!1,"DD/MM/YYYY HH:mm"),l=(0,U.o0x)(n,e.endNeedsCall||"",!1,"DD/MM/YYYY HH:mm");return"".concat(a("pages.shop.product.purchase.from")," ").concat(r," - ").concat(a("pages.shop.product.purchase.to")," ").concat(l)})),(0,v.Z)((0,m.Z)(o),"handleShowTags",(function(e,t){var n=o.props,a=n.users,r=n.t,l="",i="";switch(e.key){case"creator_id":l=r("pages.shop.callReminders.creator"),i=a.find((function(t){return t.user_id==e.value})).user.name;break;case"need_notify_users":l=r("pages.shop.callReminders.assignedUser"),i=a.find((function(t){return t.user_id==e.value})).user.name;break;case"tag":l=r("pages.shop.callReminders.tag"),i="call"==e.value?r("pages.shop.callReminders.tagCall"):r("pages.shop.callReminders.tagNotifi");break;case"key":l=r("pages.shop.callReminders.show"),i=o.renderShow(e.value);break;case"needs_call_at":l=r("pages.shop.callReminders.needCallAt"),i=o.renderDateTag(e.value)}return te(s.default,{key:"".concat(e.key,"_").concat(e.value,"}"),closable:!0,onClose:function(){return o.handleCloseTag(t)}},te("span",{style:{color:"#434343"}},"".concat(l,":")," ",te("span",{style:{fontWeight:600}},i)))})),(0,v.Z)((0,m.Z)(o),"handleDelete",(function(e){var t=o.props.t;a.Z.confirm({title:t("pages.shop.callReminders.confirmDeleteCallReminders"),content:t("pages.shop.callReminders.delete",{data:e.length}),okText:t("delete"),cancelText:t("cancel"),onOk:function(){var t=o.props,n=t.accessToken,a=t.shopId;(0,t.deleteCallLater)(n,a,{ids:e}).then((function(){o.onSync()}))}})})),(0,v.Z)((0,m.Z)(o),"handleCloseTag",(function(e){var t=o.state.tags,n=t[e].key,a=t[e].value;t.splice(e,1);var r=t.filter((function(e){return"key"==e.key})),l=r.length>0?r.reduce((function(e,t){return e.push(t.value),e}),[]):o.state.show;C()(l).map((function(e){var t=ae({},o.state[e]);if("need_notify_users"==n){var r=t[n]||[];t=(r=r.filter((function(e){return e!=a}))).length>0?ae(ae({},t),{},(0,v.Z)({},n,r)):N()(t,n)}else"needs_call_at"==n?(t=N()(t,"end_needs_call"),t=N()(t,"start_needs_call")):t=t[n]?N()(t,n):t;t.data=[],o.getCallReminders(e,t)})),o.setState({tags:t,startNeedsCall:null,endNeedsCall:null})})),(0,v.Z)((0,m.Z)(o),"handleClearFilter",(function(){o.state.show.map((function(e){o.getCallReminders(e,{data:[],page_number:1,loading:!0})})),o.setState({tags:[],search:"",startNeedsCall:null,endNeedsCall:null,tab:null})})),(0,v.Z)((0,m.Z)(o),"onCancel",(function(){return o.setState({modalVisible:!1,editCallReminder:null})})),(0,v.Z)((0,m.Z)(o),"handleEdit",(function(e,t){var n=o.state[t].data.find((function(t){return t.id==e}));o.setState({modalVisible:!0,editCallReminder:n})})),(0,v.Z)((0,m.Z)(o),"renderModalCallReminder",(function(){var e=o.state,t=e.modalVisible,n=e.editCallReminder,r=o.props,l=r.t,i=r.accessToken,s=r.shopId;return te(a.Z,{title:te("div",null,l("pages.shop.callReminders.addNew")),visible:t,onCancel:function(){return o.onCancel()},width:600,footer:null,className:"modal-call-reminder"},te(ee.Z,{accessToken:i,shopId:s,onSync:function(){return o.onSync()},setSt:function(e){return o.setState(e)},editCallReminder:n}))})),o.state={show:["today","upcoming","overdue"],today:{data:[],page_number:1,loading:!0},upcoming:{data:[],page_number:1,loading:!0},overdue:{data:[],page_number:1,loading:!0,page_size:30},completed:{entries:[],page_number:1,loading:!0},search:"",tags:[],isSave:!1,formBoxVisible:!1,endNeedsCall:null,startNeedsCall:null,tab:null,editCallReminder:null,modalVisible:!1},o}return(0,p.Z)(n,[{key:"componentDidUpdate",value:function(e){Z()(e.showOrder,this.props.showOrder)||this.setState({formBoxVisible:!1})}},{key:"componentDidMount",value:function(){this.onSync()}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,a=t.shopId,l=t.accessToken,s=this.state,o=s.search,c=s.tags,d=s.formBoxVisible;return te(P.Z,{className:"container-layout call-reminders-container",style:{overflow:"visible"}},te("div",{className:"tools-container"},te("div",null,te(L.Z,{title:n("pages.shop.callReminders.addNew"),icon:te(B.Z,null),onClick:function(){return e.setState({modalVisible:!0})}}),te(A.Z,{title:n("pages.shop.orderControlInfo.sync"),icon:te(F.Z,null),onClick:this.onSync,isButton:!0})),te("div",{className:"filter"},te(r.default,{placeholder:"".concat(n("pages.shop.callReminders.orderId")),onChange:this.onChangeSearchText,prefix:te(z.Z,null),value:o}),te("div",{className:"group-filter"},te("div",{style:{display:"flex",justifyContent:"flex-end"}},te(G.Z,{options:this.showOptionsFilter(),popupClassName:"cascader-filter-call-reminder",onChange:this.onClickMenuItem}),"\xa0",(null===c||void 0===c?void 0:c.length)>0&&te(i.default,{className:"delete-filter",onClick:function(){return e.handleClearFilter()}},n("pages.shop.statistic.customer.deleteFilter"))),(null===c||void 0===c?void 0:c.length)>0&&te("div",{className:"tags-filter",style:{paddingRight:10}},c.map(this.handleShowTags)))),this.renderModalCallReminder()),this.renderContent(),d&&te(J.Z,{accessToken:l,shopId:a,visible:d,onOk:function(){return e.setState({formBoxVisible:!1})},onCancel:function(){return e.setState({formBoxVisible:!1})}}))}}]),n}(S.Component);(0,v.Z)(ce,"pageInfo",{title:"pages.shop.setting.listCallReminders",sassStyle:D()});t.default=(0,T.$j)((function(e){return{currentShop:e.shop.currentShop,users:e.user.users,user:e.navigation.user,employeeList:e.user.filterEmployeeList}}),{fetchCallLaters:H.iGD,pushUsersTextSearch:H.mw6,openForm:H.BQi,showCallReminder:H.DXt,deleteCallLater:H.WCL})((0,E.Z)(ce))},37097:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/list-call-reminders",function(){return n(42323)}])}},function(e){e.O(0,[5460,2902,9774,2888,179],(function(){return t=37097,e(e.s=t);var t}));var t=e.O();_N_E=t}]);