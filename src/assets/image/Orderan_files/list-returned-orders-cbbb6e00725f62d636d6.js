(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2150],{87723:function(e){!function(){"use strict";e.exports=".order-returned-actions .ant-modal-body{background-color:#ededed;border-radius:2px;padding:10px !important}.order-returned-actions .ant-modal-body .containers{display:flex;flex-direction:column;width:100%}.order-returned-actions .ant-modal-body .containers .order-returned-info{display:grid;width:100%;margin:6px 0px;background-color:#fff;border-radius:2px;font-size:14px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15)}.order-returned-actions .ant-modal-body .containers .order-returned-info .button-update{display:flex;justify-content:flex-end;align-items:center;padding:0px 10px 10px 0px}.order-returned-actions .ant-modal-body .containers .order-returned-info .item-info{width:50%;display:grid;padding:10px;align-items:center;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.order-returned-actions .ant-modal-body .containers .order-returned-info .item-info .title-label{margin-bottom:5px;font-weight:500}.order-returned-actions .ant-modal-body .containers .scan-orders{box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px;padding:5px;margin-top:10px;background:#f7f7f7}.order-returned-actions .ant-modal-body .containers .scan-orders .title{display:flex;justify-content:space-around}.order-returned-actions .ant-modal-body .containers .scan-orders .item-order{background:#fff;border:1px solid #d9d9d9;display:flex;margin-top:5px}.order-returned-actions .ant-modal-body .containers .scan-orders .item-order .close-div{padding:5px 8px;cursor:pointer;border-right:1px solid #d9d9d9}.order-returned-actions .ant-modal-body .containers .scan-orders .item-order .close-div:hover{color:#f04134}.order-returned-actions .ant-modal-body .containers .scan-orders .item-order .order-content{flex:1;padding:5px 10px;display:flex;justify-content:space-between;align-items:center}.order-returned-actions .ant-modal-body .containers .scan-orders .item-order .status{margin-left:5px;padding:3px 10px;border-radius:2px;text-align:center;font-size:12px;color:#fff}.order-returned-actions .ant-modal-body .containers .scan-orders .ant-progress-bg{height:12px}.order-returned-actions .ant-modal-body .containers .scan-orders .ant-progress-text .anticon{font-size:16px}.update-order-tool{background-color:#fff;padding:10px}.update-order-tool .progress{display:flex;flex-direction:column;align-items:center}.order-returned-options .ant-cascader-menu{min-width:370px}.setting-options .ant-cascader-menu-item{border-bottom:1px dashed #d9d9d9}"}()},61074:function(e){!function(){"use strict";e.exports=".tools-container .filter{display:flex}.tools-container .filter .ant-input-affix-wrapper{width:50vw}.container-layout .show-filter{width:100%;display:flex;flex-direction:row-reverse;flex-wrap:wrap}.container-layout .show-filter .ant-tag{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:8px 0 0 8px;border-radius:2px !important;display:flex;align-items:center;height:30px;background:#fff}.ant-table-wrapper .ant-table-body .ant-table-row{cursor:pointer}.ant-table-wrapper .ant-table-body .ant-table-tbody .ant-table-cell{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ant-table-wrapper .ant-table-body .ant-table-tbody .ant-table-cell-ellipsis,.ant-table-wrapper .ant-table-body .ant-table-tbody .ant-table-cell-fix-right{overflow:unset !important}.ant-select-dropdown-menu{max-height:198px !important}.dropdown-box-product-select.ant-select-dropdown{z-index:1000}ul.ant-dropdown-menu{overflow:auto;max-height:300px}"}()},78598:function(e,t,r){var n,o=o||function(e){"use strict";if(!("undefined"===typeof e||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,a=/constructor/i.test(e.HTMLElement)||e.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),i=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},u=function(e){setTimeout((function(){"string"===typeof e?r().revokeObjectURL(e):e.remove()}),4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,c){c||(t=l(t));var p,f=this,h="application/octet-stream"===t.type,g=function(){!function(e,t,r){for(var n=(t=[].concat(t)).length;n--;){var o=e["on"+t[n]];if("function"===typeof o)try{o.call(e,r||e)}catch(a){i(a)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,o)return p=r().createObjectURL(t),void setTimeout((function(){n.href=p,n.download=d,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(n),g(),u(p),f.readyState=f.DONE}));!function(){if((s||h&&a)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=s?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,g()},n.readAsDataURL(t),void(f.readyState=f.INIT)}(p||(p=r().createObjectURL(t)),h)?e.location.href=p:e.open(p,"_blank")||(e.location.href=p);f.readyState=f.DONE,g(),u(p)}()},c=d.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(c.abort=function(){},c.readyState=c.INIT=0,c.WRITING=1,c.DONE=2,c.error=c.onwritestart=c.onprogress=c.onwrite=c.onabort=c.onerror=c.onwriteend=null,function(e,t,r){return new d(e,t||e.name||"download",r)})}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==r.amdD&&null!==r.amdO&&(void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n))},60175:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Zt}});var n,o=r(65400),a=r(51024),s=r(32292),i=r(28140),u=r(59361),l=r(82891),d=r(62443),c=r(94055),p=r(809),f=r.n(p),h=r(92447),g=r(74047),m=r(4706),v=r(52700),y=r(33814),_=r(44102),b=r(20775),S=r(26265),O=r(14321),x=r(12386),Z=r(64713),w=r(89734),k=r.n(w),R=r(18446),C=r.n(R),I=r(23279),D=r.n(I),T=r(50361),E=r.n(T),L=r(67294),j=r(92902),F=r(61074),P=r.n(F),N=r(14494),A=r(65644),B=r(79508),M=r(7085),z=r(90631),K=r(50161),U=r(24616),H=r(49101),q=r(25592),V=r(76570),W=r(78338),X=r(83049),$=r(31731),G=r(36934),J=r(31432),Y=r(50916),Q=r(95213),ee=r(20920),te=r(96129),re=r(57254),ne=r(87217),oe=L.createElement;function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ie(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var ue,le=(0,ne.Z)()(n=function(e){(0,y.Z)(r,e);var t=ie(r);function r(e){var n;return(0,g.Z)(this,r),n=t.call(this,e),(0,S.Z)((0,m.Z)(n),"getMenu",(function(){var e=n.state.isLoading,t=n.getStatus();return oe(x.default,{className:"dropdown-container",onClick:n.onClick},t.map((function(t){var r=(0,ee.ix)()[t];return oe(x.default.Item,{disabled:e,key:t},r.icon," ",r.text)})))})),(0,S.Z)((0,m.Z)(n),"getStatus",(function(){if(!n.props.order_returned.id)return[0,1,2];switch(n.state.status){case 0:return[2,1,4];case 1:return[];case 2:return[1,4];default:return[]}})),(0,S.Z)((0,m.Z)(n),"onClick",(function(e){var t=e.key;if(!n.state.isLoading){n.setState({isLoading:!0});var r=n.props,o=r.order_returned,a=r.updateOrderReturned,s=r.createOrderReturned,i=r.accessToken,u=r.shopId;o.id?a(i,u,se(se({},o),{},{status:t})).then((function(){n.setState({isLoading:!1,status:parseInt(n.props.order_returned.status)})})):s(i,u,se(se({},o),{},{status:t})).then((function(){n.setState({isLoading:!1,status:parseInt(n.props.order_returned.status)})}))}})),n.state={status:e.order_returned.status,isLoading:!1},n}return(0,v.Z)(r,[{key:"componentDidUpdate",value:function(e){C()(e.order_returned.status,this.props.order_returned.status)||this.setState({status:this.props.order_returned.status})}},{key:"render",value:function(){var e=this.props,t=e.order_returned,r=e.size,n=this.state.isLoading,a=(0,ee.ix)()[t.status],s=this.getStatus();return oe("div",null,oe(d.default,{placement:"bottom",content:this.getMenu(),overlayClassName:"order-action-list"},oe(o.default,{type:"primary",style:{fontSize:"large"==r?14:12,width:"large"==r?170:130,height:"large"==r?32:22,background:a.bgColor,borderColor:a.bgColor,position:"relative",overflow:"hidden",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"}},a.text,s.length>0&&oe(re.Z,{size:"small",style:{position:"absolute",right:5,top:"calc((100% / 2) - 6px)"}}),n?oe(M.Z,{style:{position:"absolute",left:5,top:"calc((100% / 2) - 6px)"}}):null)))}}]),r}(L.Component))||n,de=(0,N.$j)((function(e){return{currentShop:e.shop.currentShop,user:e.navigation.user,users:e.user.users}}),{createOrderReturned:G.Iji,updateOrderReturned:G.lqB})(le),ce=r(7690),pe=r(9669),fe=r.n(pe),he=L.createElement;function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var ye,_e=(0,ne.Z)()(ue=function(e){(0,y.Z)(r,e);var t=ve(r);function r(e){var n;return(0,g.Z)(this,r),n=t.call(this,e),(0,S.Z)((0,m.Z)(n),"onChangeCascader",(function(e,t){var r;if(!(!e||1==(null===t||void 0===t?void 0:t.length)&&(null===(r=t[0])||void 0===r?void 0:r.isRoot)||"warehouse_orders"==t[0].value&&2==(null===t||void 0===t?void 0:t.length)))if("order_sources"!=t[0].value){var o,a,s=E()(n.state.filters);switch(e.length){case 2:o=e[0],a=e[1];break;case 3:o=e[1],a=e[2]}"partner_id"==o&&(s="-1"==a?s.filter((function(e){return e.key!=o||e.key==o&&e.value==a})):s.filter((function(e){return e.key!=o||e.key==o&&"-1"!=e.value}))),"orders_returned_new"==o&&(s=s.filter((function(e){return e.key!=o}))),"warehouse_orders"==t[0].value&&t.length>2&&(s=s.filter((function(e){return e.key!=o})));var i={key:o,value:a},u=s.findIndex((function(e){return e.key==o&&e.value==a}));-1!=u?s.splice(u,1):("shop_customer_id"==o&&(i=me(me({},i),{},{customer_info:t[1].customer_info})),s.push(i)),n.setState({filters:s}),n.props.fetch({filters:s})}else{var l=n.state.paramMultipeSource,d=n.props.isFilterMultipleSource;(0,Q.$lX)({selectedOptions:t,paramMultipeSource:l,isFilterMultipleSource:d,callbackState:n.callbackState})}})),(0,S.Z)((0,m.Z)(n),"handleBeforeFilterSources",(function(){var e=n.state.paramMultipeSource;n.props.isFilterMultipleSource&&(null===e||void 0===e?void 0:e.length)>0?n.handleFilterOrderSource():n.handleFilterByOrderSources()})),(0,S.Z)((0,m.Z)(n),"handleFilterOrderSource",(function(){var e=E()(n.state.filters),t=(n.state.paramMultipeSource||[]).filter((function(e){return e.length>0}));e=e.filter((function(e){return"order_sources"!=e.key})),t.map((function(t){e.find((function(e){return"order_sources"==e.key&&(1==t.length&&1==e.value.length&&e.value[0]==t[0]||2==t.length&&2==e.value.length&&e.value[0]==t[0]&&e.value[1]==t[1])}))||e.push({key:"order_sources",value:t})})),n.setState({filters:e},(function(){n.props.fetch({filters:n.state.filters})}))})),(0,S.Z)((0,m.Z)(n),"handleFilterByOrderSources",(function(){var e=E()(n.state.filters),t="order_sources",r=E()(n.state.orderSources),o=r.findIndex((function(e){return e.includes("search_")}));if(o>-1){var a=r[o].split("_")[1];r[o]=a}var s={key:t,value:r},i=e.findIndex((function(e){return e.key==t}));-1!=i?e[i]={key:t,value:r}:e.push(s),n.setState({filters:e},(function(){n.props.fetch({filters:n.state.filters})}))})),(0,S.Z)((0,m.Z)(n),"renderUser",(function(e){var t,r,n,o;return he("span",{style:{display:"flex",justifyItems:"center"}},he(Y.Z,{id:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.fb_id,size:[20,20],seed:null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.id,name:null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.name}),"\xa0",he("span",null,null===e||void 0===e||null===(o=e.user)||void 0===o?void 0:o.name))})),(0,S.Z)((0,m.Z)(n),"onChangeSearchCustomer",D()((function(e){var t=n.props,r=t.accessToken,o=t.shopId,a="".concat((0,Q.LpH)(),"/shops/").concat(o,"/customers?access_token=").concat(r);fe()({method:"get",url:a,params:{search:e}}).then((function(e){n.setState({shopCustomers:e.data.data})}))}),500)),(0,S.Z)((0,m.Z)(n),"renderLabelShopCustomer",(function(e){var t=n.props.t;return he("div",{style:{borderBottom:"1px dashed #d9d9d9",paddingBottom:5}},he("div",null,he(Y.Z,{avatar_url:(0,ee.E$)(e,n.props.accessToken),id:e.fb_id,name:e.name,size:[20,20],seed:e.id}),he("span",{style:{marginLeft:5}},e.name)),e.shop_customer&&he("div",{style:{borderLeft:"2px solid #ff3860",paddingLeft:5}},he("div",null,t("containers.customerInfo.purchased"),": ",e.shop_customer.order_count," ",t("containers.customerInfo.count")),he("div",null,t("phoneNumber"),": ",e.shop_customer.phone_numbers[0])))})),(0,S.Z)((0,m.Z)(n),"callbackState",(function(e,t){var r=Object.keys(e);r.includes("isFilterMultipleSource")&&(n.props.propsState({isFilterMultipleSource:e.isFilterMultipleSource}),localStorage.setItem("isFilterMultipleSourceOrderReturn",e.isFilterMultipleSource)),r.includes("isFilterExcludeSource")&&(n.props.propsState({isFilterExcludeSource:e.isFilterExcludeSource}),localStorage.setItem("isFilterExcludeSourceOrderReturn",e.isFilterExcludeSource)),delete e.isFilterMultipleSource,delete e.isFilterExcludeSource,n.setState(e,(function(){t&&t.isLeaf&&100!=t.value&&n.handleFilterByOrderSources()}))})),(0,S.Z)((0,m.Z)(n),"callBack",(function(){return n.handleBeforeFilterSources()})),(0,S.Z)((0,m.Z)(n),"getOptions",(function(){var e,t=n.props,r=t.users,o=t.t,s=t.currentShop,i=t.warehouses,u=t.userShops,l=t.user,d=t.isFilterMultipleSource,c=t.isFilterExcludeSource,p=n.state.shopCustomers,f=[];(0,Q.OfN)(s).map((function(e){f.push(me(me({},e),{},{label:n.renderLabel("partner_id",e.value,e.label)}))}));var h=i.map((function(e){var t=e.name;return{value:e.id,label:t}})),g=null===(e=u.find((function(e){return e.user_id==l.uid})))||void 0===e?void 0:e.app_warehouse,m=(0,ee.rV)({callbackState:n.callbackState,callBack:n.callBack,showFilterMultiple:!0,restState:me(me({},n.state),{},{isFilterMultipleSource:d,isFilterExcludeSource:c})});return[{value:"creator_id",label:o("pages.shop.returnedOrders.creator"),isRoot:!0,children:r.map((function(e){return{value:e.user_id,label:n.renderLabel("creator_id",e.user_id,n.renderUser(e))}}))},{value:"partner_id",label:o("pages.shop.returnedOrders.partner"),isRoot:!0,children:f},{value:"shop_customer_id",label:o("customers.title"),isRoot:!0,children:[{value:"input",label:he("span",{onClick:function(e){return e.stopPropagation()}},he(a.default,{onChange:function(e){return n.onChangeSearchCustomer(e.target.value)},style:{width:400},onClick:function(e){return e.target.focus()},placeholder:o("components.customerSearchBar.enterCustomerNameOrPhoneNumber")}))}].concat(p.map((function(e){var t,r;return{value:null===(t=e.shop_customer)||void 0===t?void 0:t.id,label:n.renderLabel("shop_customer_id",null===(r=e.shop_customer)||void 0===r?void 0:r.id,n.renderLabelShopCustomer(e)),customer_info:e}})))},{value:"original_creator_id",label:o("pages.shop.returnedOrders.originalCreator"),isRoot:!0,children:r.map((function(e){return{value:e.user_id,label:n.renderLabel("original_creator_id",e.user_id,n.renderUser(e))}}))},{value:"orders_returned_new",label:o("pages.shop.returnedOrders.orderReturnedNew"),isRoot:!0,children:[{value:!0,label:o("pages.shop.returnedOrders.yes")},{value:!1,label:o("pages.shop.returnedOrders.no")}]},{value:"warehouse_orders",label:o("pages.shop.returnedOrders.wareHouseOrder"),isRoot:!0,children:g?[{value:"warehouse_order_original_id",label:o("pages.shop.returnedOrders.wareHouseOrderOrigin"),children:h}]:[{value:"warehouse_order_returned_id",label:o("pages.shop.returnedOrders.wareHouseOrderReturn"),children:h},{value:"warehouse_order_original_id",label:o("pages.shop.returnedOrders.wareHouseOrderOrigin"),children:h}]},{value:"order_sources",label:o("components.orderAdvanceFilter.orderSource"),isRoot:!0,children:m}]})),(0,S.Z)((0,m.Z)(n),"renderLabel",(function(e,t,r){var o=n.state.filters;return he("div",{style:{display:"flex",justifyContent:"space-between"}},he("div",null,r),o.find((function(r){return r.key==e&&r.value==t}))&&he("div",{style:{marginLeft:10}},he(B.Z,{style:{color:"#096dd9"}})))})),(0,S.Z)((0,m.Z)(n),"handleDeleteFilter",(function(){n.setState({paramMultipeSource:[]}),n.props.clearFilter()})),n.state={filters:[],shopCustomers:[],visibleFilterOrderSources:!1,orderSources:[],searchPageId:null,paramMultipeSource:[]},n}return(0,v.Z)(r,[{key:"componentDidUpdate",value:function(e){C()(this.props.filters,e.filters)&&C()(this.state.filters,e.filters)||this.setState({filters:this.props.filters})}},{key:"render",value:function(){return he("div",null,he(ce.Z,{options:this.getOptions(),popupClassName:"cascader-filter-order-returned",onChange:this.onChangeCascader,changeOnSelect:!0}))}}]),r}(L.Component))||ue,be=(0,N.$j)((function(e){return{currentShop:e.shop.currentShop,timezone:e.navigation.user.timezone,users:e.user.users,warehouses:e.warehouse.warehouses,userShops:e.user.users,user:e.navigation.user}}),{})(_e),Se=r(74806),Oe=r(44908),xe=r.n(Oe),Ze=r(78598),we=L.createElement;function ke(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return Re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Re(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw a}}}}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function De(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var Te,Ee={horizontal:"center",vertical:"middle"},Le=(0,ne.Z)()(ye=function(e){(0,y.Z)(r,e);var t=De(r);function r(e){var n;return(0,g.Z)(this,r),n=t.call(this,e),(0,S.Z)((0,m.Z)(n),"handleExportExcel",(function(){n.setState({isDownloading:!0});var e=n.props,t=e.accessToken,r=e.currentShop,o=e.params,a=e.selectedRowKeys,u=e.warehouses,l=e.timezone,d="".concat((0,Q.LpH)(),"/shops/").concat(r.id,"/orders_returned/export?access_token=").concat(t),c=Ie(Ie({},E()(o)),{},{order_returned_ids:a,page:1,page_size:100}),p=[];(function e(t){return fe().post(d,t).then((function(r){var o=r.data.data;return p=p.concat(o),n.setState({lengthCurrentData:p.length}),0==o.length||p.length>=r.data.total_entries?p:(t.page+=1,e(t))}))})(c).then((function(e){n.setState({isDownloading:!1});var t=[],o=Q.cvg.includes(r.currency)?1:100;e.map((function(e,a){var s,i,d,c,p,f,h,g,m=u.find((function(t){return t.id==e.warehouse_id}))||{},v=n.props.users.find((function(t){return t.user_id==e.creator_id})),y=e.order,_=n.props.users.find((function(e){return e.user_id==(null===y||void 0===y?void 0:y.creator_id)})),b={"M\xe3 \u0111\u01a1n":e.display_id,"Tr\u1ea1ng th\xe1i":(0,ee.ix)()[e.status].text,"Ng\u01b0\u1eddi t\u1ea1o":v?v.user.name:""};null!==(s=r.user_shop)&&void 0!==s&&null!==(i=s.department)&&void 0!==i&&i.is_hide_customer_order_info||(b=Ie(Ie({},b),{},{"Kh\xe1ch h\xe0ng":(null===(p=e.customer)||void 0===p?void 0:p.name)||"","S\u0110T":(0,Q.xAZ)(e.bill_phone_number||(null===(f=e.customer)||void 0===f||null===(h=f.shop_customer)||void 0===h||null===(g=h.phone_numbers)||void 0===g?void 0:g[0]))||""}));b=Ie(Ie({},b),{},{"Kho h\xe0ng":m.name||"","Ph\xed tr\u1ea3 h\xe0ng":e.returned_fee||0,"Gi\u1ea3m gi\xe1":e.discount||0,"Gi\xe1 tr\u1ecb h\xe0ng tr\u1ea3":(0,te.GS)(e)/o,"T\u1ed5ng s\u1ed1 l\u01b0\u1ee3ng":e.returned_items.reduce((function(e,t){return e+t.returned_quantity}),0),"T\u1ed5ng ti\u1ec1n tr\u1ea3":((0,te.GS)(e)+e.returned_fee-e.discount-(e.discount_from_order_to_returned||0))/o,"\u0110\u01a1n \u0111\u1ed5i":(null===y||void 0===y?void 0:y.custom_id)||(null===y||void 0===y?void 0:y.display_id),"Ng\xe0y t\u1ea1o":(0,Q.o0x)(l,e.inserted_at),"Ng\xe0y c\u1eadp nh\u1eadt":(0,Q.o0x)(l,e.updated_at),"\u0110\u01a1n g\u1ed1c":(null===(d=e.order_to_returned)||void 0===d?void 0:d.custom_id)||(null===(c=e.order_to_returned)||void 0===c?void 0:c.display_id),"Ngu\u1ed3n \u0111\u01a1n g\u1ed1c":y?(0,te.lt)(y):"","NV t\u1ea1o \u0111\u01a1n g\u1ed1c":null===_||void 0===_?void 0:_.user.name}),e.returned_items.length>0?e.returned_items.map((function(r,n){var a={"S\u1ea3n ph\u1ea9m":r.variation_info.name,"M\xe3 SP":r.variation_info.product_id,"M\xe3 m\u1eabu m\xe3":r.variation_info.id,"S\u1ed1 l\u01b0\u1ee3ng":r.returned_quantity,"\u0110\u01a1n gi\xe1":r.variation_info.retail_price/o,"Gi\xe1":r.returned_quantity*r.variation_info.retail_price/o,Barcode:r.variation_info.barcode||""};if(0==n){var s={COD:e.order_to_returned.cod>0?e.order_to_returned.cod/o:0,"T\u1ed5ng ti\u1ec1n":(0,te.H_)(e.order_to_returned)/o};a=Ie(Ie({},a),s)}b=Ie(n?{}:Ie({},b),a),t.push(b)})):t.push(b)}));var a=[];t.map((function(e){return a.push(Object.keys(e))}));var d=a[0];d=(d||[]).reduce((function(e,t){return Ie(Ie({},e),{},(0,S.Z)({},t,t))}),{}),a=a.flat(),a=(a=xe()(a)).map((function(e){var r=t[0][e],n=r?r.toString().length:25;return{header:e,key:e,width:n>=60?n:20}})),t=[d].concat((0,i.Z)(t)),function(e,t){var r=new ExcelJS.Workbook,n=r.addWorksheet("DataSheet 1");n.columns=e,n.mergeCells("A1:M1"),n.mergeCells("N1:W1"),n.getCell("A1").value="\u0110\u01a1n \u0111\u1ed5i tr\u1ea3",n.getCell("N1").value="\u0110\u01a1n g\u1ed1c",n.getRow(1).alignment={horizontal:"center"},n.getRow(1).font={bold:!0,size:14};var o,a=ke(t.entries());try{for(a.s();!(o=a.n()).done;){var i=(0,s.Z)(o.value,2),u=(i[0],i[1]);n.addRow(u).alignment=Ee}}catch(l){a.e(l)}finally{a.f()}r.xlsx.writeBuffer().then((function(e){(0,Ze.saveAs)(new Blob([e],{type:"application/octet-stream"}),"order_returned.xlsx")}))}(a,t)}))})),(0,S.Z)((0,m.Z)(n),"getProgress",(function(){return n.props.totalEntries&&0!=n.props.totalEntries?Math.floor(100*n.state.lengthCurrentData/n.props.totalEntries):0})),(0,S.Z)((0,m.Z)(n),"renderContent",(function(){var e=n.props.t,t=n.state.isDownloading;return we("div",null,we(o.default,{type:"primary",style:{width:"100%",borderRadius:2},icon:we(z.Z,null),onClick:function(){return n.handleExportExcel()},disabled:t},e("components.orderReturnedExportExcel.download")),t&&we(Se.default,{percent:n.getProgress()}))})),n.state={isDownloading:!1,lengthCurrentData:0},n}return(0,v.Z)(r,[{key:"render",value:function(){var e=this.props,t=e.t,r=e.selectedRowKeys,n=e.title,o=e.isButton;return we(d.default,{title:t("components.orderReturnedExportExcel.title"),trigger:"click",content:this.renderContent()},we($.Z,{icon:we(z.Z,null),title:n,isButton:o,tooltip:"\n            ".concat(t("components.orderReturnedExportExcel.export")," ").concat(r.length>0?r.length:t("components.orderReturnedExportExcel.all")," ").concat(t("components.orderReturnedExportExcel.orderReturned"),"\n          ")}))}}]),r}(L.Component))||ye,je=(0,N.$j)((function(e){return{timezone:e.navigation.user.timezone,warehouses:e.warehouse.warehouses,currentShop:e.shop.currentShop,users:e.user.users}}),null)(Le),Fe=r(56697),Pe=r(89552),Ne=r(71535),Ae=r(64749),Be=r(54549),Me=r(25449),ze=r(22263),Ke=r(95642),Ue=r(73171),He=r(22353),qe=r(87723),Ve=r.n(qe),We=r(48519),Xe=L.createElement;function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}Ae.default.Option;var Ye=(0,ne.Z)()(Te=function(e){(0,y.Z)(r,e);var t=Je(r);function r(e){var n;return(0,g.Z)(this,r),n=t.call(this,e),(0,S.Z)((0,m.Z)(n),"reCal",(function(){var e=document.getElementById("virtualize-list");e&&n.setState({getWidthCart:e.offsetWidth-1.5}),window.addEventListener("resize",(function(){document.getElementById("virtualize-list")&&n.setState({getWidthCart:document.getElementById("virtualize-list").offsetWidth-2})}))})),(0,S.Z)((0,m.Z)(n),"handleFetchOrderReturned",(function(){n.setState({isLoading:!0,selectedRowKeys:n.props.selectedRowKeys,isInit:!1});var e=n.props,t=e.shopId,r=e.accessToken,o=e.params,a=e.selectedRowKeys,s="".concat((0,Q.LpH)(),"/shops/").concat(t,"/orders_returned/export?access_token=").concat(r),i=Ge(Ge({},E()(o)),{},{order_returned_ids:a.length>0?a:null,page:1,page_size:30}),u=[];(function e(t){return fe().post(s,t).then((function(r){var o=r.data.data;return u=u.concat(o),n.setState({lengthCurrentData:u.length}),0==o.length||u.length>=r.data.total_entries?u:(t.page+=1,e(t))}))})(i).then((function(e){n.setState({isLoading:!1,ordersReturned:e})}))})),(0,S.Z)((0,m.Z)(n),"handleRemoveOrder",(function(e){var t=n.state.ordersReturned;t.splice(t.findIndex((function(t){return t.id==e})),1),n.setState({ordersReturned:t,isInit:!1})})),(0,S.Z)((0,m.Z)(n),"renderListOrder",(function(e){var t=n.props.timezone,r=(0,ee.ix)()[e.status];return Xe("div",{key:e.id,className:"item-order"},Xe("div",{className:"close-div"},Xe(Be.Z,{onClick:function(){return n.handleRemoveOrder(e.id)}})),Xe("div",{className:"order-content"},Xe("span",null,Xe(Me.Z,null)," ",e.display_id," - ",(0,Q.o0x)(t,e.inserted_at)),Xe("span",{style:{display:"flex",flexDirection:"row"}},Xe("div",{className:"status",style:{background:r.bgColor}},r.text))))})),(0,S.Z)((0,m.Z)(n),"handleOpenCloseModal",(function(e){n.state.updating&&n.props.fetchOrderReturned(),n.setState({modalVisible:e,isInit:!0,updating:!1,updatingInfo:[],currentDataUpdating:0,ordersReturned:[]})})),(0,S.Z)((0,m.Z)(n),"optionsCascaderType",[{value:"status",label:Xe("span",null,Xe(ze.Z,null)," ",n.props.t("components.orderReturnedActions.updateStatus"))},{value:"tags",label:n.props.t("components.orderReturnedActions.orderTags"),children:[{value:"add_tags",label:Xe("span",null,Xe(Ke.Z,null)," ",n.props.t("components.orderReturnedActions.addOrderTags"))},{value:"delete_tags",label:Xe("span",null,Xe(Ue.Z,null)," ",n.props.t("components.orderReturnedActions.deleteOrderTags"))}]}]),(0,S.Z)((0,m.Z)(n),"displayRender",(function(e){return e[e.length-1]})),(0,S.Z)((0,m.Z)(n),"onChangeCascaderType",(function(e){n.setState({paramsType:e,paramsValue:void 0})})),(0,S.Z)((0,m.Z)(n),"getLabelAction",(function(){var e=n.state.paramsType,t=n.props.t,r="";switch(e[e.length-1]){case"status":r=Xe("span",null,Xe(U.Z,null)," ",t("components.orderReturnedActions.configureStatus"));break;case"add_tags":r=Xe("span",null,Xe(Ke.Z,null)," ",t("components.orderReturnedActions.addTags"));break;case"delete_tags":r=Xe("span",null,Xe(Ue.Z,null)," ",t("components.orderReturnedActions.deleteTags"))}return r})),(0,S.Z)((0,m.Z)(n),"renderPlaceHolder",(function(){var e=n.state.paramsType,t=n.props.t;return t("status"==e[e.length-1]?"components.orderReturnedActions.selectStatus":"components.orderReturnedActions.selectTags")})),(0,S.Z)((0,m.Z)(n),"getOptionsCascaderActions",(function(){var e=n.state.paramsType,t=n.props.currentShop,r=[],o=(0,We.zE)(t.role);switch(e[e.length-1]){case"status":r=(0,ee.ne)().map((function(e){var t=(0,ee.ix)()[e];return{value:e.toString(),label:t.text}}));break;case"add_tags":case"delete_tags":var a=2!=t.type?(0,Q.DXf)():(0,Q.P1X)(),s=Object.keys(a).concat(t.order_tags.map((function(e){return e.id.toString()})));o.for_control_orders||(s=s.filter((function(e){return!["4","5","6","26","27"].includes(e)})));var i=Object.keys((0,Q.DXf)()).map((function(e){return e}));t.turn_off_system_tags&&(s=s.filter((function(e){return!i.includes(e)||["4","5","6","26","27"].includes(e)})));var u=[];s.forEach((function(e){if(a[e])return u.push({id:e,name:a[e].text});if(!t.order_tag_groups.find((function(t){return t.tags.includes(e)}))){var r=t.order_tags.find((function(t){return t.id==e}));u.push({id:e,name:r.name})}})),r=u.map((function(e){return{value:e.id,label:e.name}}))}return r})),(0,S.Z)((0,m.Z)(n),"onChangeCascader",(function(e,t){n.setState({paramsValue:e})})),(0,S.Z)((0,m.Z)(n),"getProgress",(function(){return n.props.totalEntries&&0!=n.props.totalEntries?n.state.selectedRowKeys.length>0?Math.floor(100*n.state.lengthCurrentData/n.state.selectedRowKeys.length):Math.floor(100*n.state.lengthCurrentData/n.props.totalEntries):0})),(0,S.Z)((0,m.Z)(n),"getPercentUpdatingInfo",(function(){var e=n.state,t=e.ordersReturned,r=e.currentDataUpdating;return 0==t.length?0:Math.floor(100*r/t.length)})),(0,S.Z)((0,m.Z)(n),"handleSave",(function(){n.setState({updating:!0});var e=n.state,t=e.ordersReturned,r=e.paramsType,o=e.paramsValue,a=n.props,s=a.accessToken,i=a.shopId,u=a.currentShop,l=a.t,d=r[0],c=parseInt(o[o.length-1]);!function e(o){var a=t[o];if(a){var p="".concat((0,Q.LpH)(),"/shops/").concat(i,"/orders_returned/").concat(a.id,"?access_token=").concat(s),f=a.tags||[];if("tags"==d&&("add_tags"==r[r.length-1]?f.push(c):f.filter((function(e){return e!=c}))),a.order&&"tags"==d){var h=E()(a.order);h=(0,G.x7x)(h,u);var g=-1==(h=(0,G.Qwc)(h)).tags?[]:h.tags||[];f="add_tags"==r[r.length-1]?(0,te.Dg)(g,c,u.order_tag_groups):g.filter((function(e){return e!=c})),a=Ge(Ge({},a),{},{order_additional:Ge(Ge({},h),{},{tags:xe()(f)})})}a=Ge(Ge({},a),{},(0,S.Z)({},d,"tags"==d?xe()(f):c)),fe()({method:"put",url:p,data:(0,Q.D$T)(a)}).then((function(r){n.setState({currentDataUpdating:n.state.currentDataUpdating+1,updatingInfo:n.state.updatingInfo.concat([{id:a.display_id,success:r.data.success,message:r.data.success?l("components.orderReturnedActions.success"):r.data.message||l("components.orderReturnedActions.updateFailed")}])},(function(){if(n.state.currentDataUpdating<t.length)return e(o+1)}))})).catch((function(e){n.setState({updatingInfo:n.state.updatingInfo.concat([{id:a.display_id,success:!1,message:"Kh\xf4ng x\xe1c \u0111\u1ecbnh"}])})}))}}(0)})),(0,S.Z)((0,m.Z)(n),"renderContent",(function(){var e=n.state,t=e.isLoading,r=e.getWidthCart,a=e.ordersReturned,s=e.paramsValue,i=e.paramsType,u=n.props.t;return Xe("div",{className:"containers"},Xe("div",{className:"order-returned-info"},Xe("div",{className:"item-info"},Xe("span",{className:"title-label"},u("components.orderReturnedActions.updateType")),Xe(Ne.Z,{popupClassName:"order-returned-options",options:n.optionsCascaderType,displayRender:n.displayRender,placeholder:"Ch\u1ecdn thao t\xe1c",value:i,onChange:n.onChangeCascaderType})),Xe("div",{className:"button-update"},Xe(o.default,{type:"primary",disabled:!i||0==i.length||!s||0==s.length||0==a.length,onClick:function(){return n.handleSave()}},u("components.orderReturnedActions.update")))),Xe("div",{className:"order-returned-info"},Xe("div",{className:"item-info"},Xe("span",{className:"title-label"},n.getLabelAction()),Xe(Ne.Z,{popupClassName:"order-returned-options setting-options",options:n.getOptionsCascaderActions(),displayRender:n.displayRender,placeholder:n.renderPlaceHolder(),value:s,onChange:n.onChangeCascader}))),Xe("div",{className:"scan-orders",style:{marginTop:6,padding:10}},t?Xe("div",null,Xe(Se.default,{status:"active",percent:n.getProgress()})):Xe("div",null,Xe("div",null,Xe(B.Z,null)," ","".concat(a.length," ").concat(u("components.orderReturnedActions.selected"))),Xe("div",{id:"virtualize-list"},a.length>0&&(0,ee.ng)(r,(a.length>9?420:42*a.length)>.5*window.innerHeight?.4*window.innerHeight:a.length>9?420:42*a.length,a.length,42,n.renderListOrder,a)),Xe("div",null,0==a.length&&Xe(o.default,{onClick:function(){return n.handleFetchOrderReturned()},icon:Xe(He.Z,null)},u("components.orderReturnedActions.chooseAll"))))))})),(0,S.Z)((0,m.Z)(n),"renderUpdating",(function(){var e=n.state,t=e.updatingInfo,r=e.currentDataUpdating,o=e.ordersReturned,a=n.props.t,s=t.filter((function(e){return e.success})).length,i=t.filter((function(e){return!e.success})).length;return Xe("div",{className:"update-order-tool"},Xe("div",{className:"progress"},Xe(Se.default,{type:"circle",percent:n.getPercentUpdatingInfo()}),Xe("div",{style:{marginTop:10}},r==o.length?Xe("span",null,Xe("span",{style:{color:"#00a854"}},"".concat(a("components.orderReturnedActions.updateSuccess")," ").concat(s)),Xe("span",{style:{color:"#f04134"}},"".concat(i>0?", ".concat(a("pages.admin.failure")," ").concat(i):""))):Xe("span",null,Xe(Pe.default,{indicator:Xe(M.Z,{style:{fontSize:14},spin:!0}),size:"small"})," ",a("components.orderReturnedActions.updatingReturnedOrder")))),Xe("div",{className:"updating-info"},t.map((function(e){return Xe("div",{className:e.success?"success":"fail"},Xe("strong",null,"#",e.id),"\xa0",Xe("span",null,e.message))}))))})),n.state={modalVisible:!1,paramsType:["status"],paramsValue:void 0,ordersReturned:[],isLoading:!1,lengthCurrentData:0,selectedRowKeys:n.props.selectedRowKeys,getWidthCart:600,isInit:!0,updating:!1,currentDataUpdating:0,updatingInfo:[]},n}return(0,v.Z)(r,[{key:"componentDidMount",value:function(){this.reCal()}},{key:"componentDidUpdate",value:function(e,t){this.state.isInit&&this.props.selectedRowKeys.length>0&&(!C()(this.props.selectedRowKeys,this.state.selectedRowKeys)||0==this.state.ordersReturned.length)&&this.state.modalVisible&&!this.state.isLoading&&this.handleFetchOrderReturned(),C()(this.state.isLoading,t.isLoading)||this.reCal()}},{key:"render",value:function(){var e=this,t=this.state,r=t.modalVisible,n=t.updating,o=this.props,a=o.t,s=o.isButton,i=o.title;return Xe(L.Fragment,null,Xe($.Z,{icon:Xe(K.Z,null),title:i,onClick:function(){return e.handleOpenCloseModal(!0)},isButton:s}),r&&Xe(Fe.Z,{wrapClassName:"order-returned-actions",visible:r,title:a("components.orderReturnedActions.title"),width:800,onCancel:function(){return e.handleOpenCloseModal(!1)},footer:null,maskClosable:!1},n?this.renderUpdating():this.renderContent()),Xe("style",{dangerouslySetInnerHTML:{__html:Ve()}}))}}]),r}(L.Component))||Te,Qe=(0,N.$j)((function(e){return{timezone:e.navigation.user.timezone,warehouses:e.warehouse.warehouses,currentShop:e.shop.currentShop}}),{parseOrderBeforeUpdate:G.x7x,parseItemBeforeUpdate:G.Qwc})(Ye),et=r(38004),tt=r(11163),rt=r(30381),nt=r.n(rt),ot=r(81014),at=r(68157),st=r(49485),it=r(24781),ut=r(41850),lt=r(45812),dt=L.createElement;function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ft(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,b.Z)(e);if(t){var o=(0,b.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var ht=Z.default.Group,gt=Z.default.Button,mt=x.default.SubMenu,vt={page:1,page_size:30,status:"-1",search:null,start_time:null,end_time:null},yt=O.default.RangePicker,_t=["id","status","phone_number","product"],bt=["id","creator","tag","product","customer","phone_number","returned_fee","discount","returned_sub_total","inserted_at","cod","internal_note","creator_returned_order","product_new_order","order_id","status"],St=["id","creator","tag","product","customer","phone_number","returned_fee","discount","returned_sub_total","inserted_at","cod","internal_note","creator_returned_order","status"],Ot=["customer","phone_number"],xt=function(e){(0,y.Z)(r,e);var t=ft(r);function r(e){var n;(0,g.Z)(this,r),n=t.call(this,e),(0,S.Z)((0,m.Z)(n),"fetchListReturnedOrders",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=n.props,r=t.accessToken,o=t.shopId;n.setState({params:e,isLoading:!0}),n.props.fetchListReturnedOrders(r,o,e).then((function(){return n.setState({isLoading:!1})})),n.props.fetchCountOrderReturned(r,o,e)})),(0,S.Z)((0,m.Z)(n),"onSyncClick",(function(){n.fetchListReturnedOrders(n.state.params)})),(0,S.Z)((0,m.Z)(n),"onAddClick",(function(){var e=n.props.shopId;tt.default.push({pathname:"/shop/returned-orders",query:{shopId:e}},"/shop/".concat(e,"/returned-orders"))})),(0,S.Z)((0,m.Z)(n),"handleSearchInputChange",(function(e){var t=E()(n.state.params);t.search=e,t.page=1,n.fetchListReturnedOrders(t)})),(0,S.Z)((0,m.Z)(n),"handleBarcode",(function(e){return n.setState({onScreenBarcode:e})})),(0,S.Z)((0,m.Z)(n),"columns",(function(){var e=n.props,t=e.accessToken,r=e.shopId;return[{title:"ID",dataIndex:"id",ellipsis:!0,fixed:"left"},{title:n.props.t("pages.shop.returnedOrders.creator"),dataIndex:"creator",align:"left"},{title:n.props.t("pages.shop.returnedOrders.tag"),dataIndex:"tag",align:"left",className:"order-tag-column",ellipsis:!0},{title:n.props.t("products.title"),dataIndex:"product",align:"left"},{title:n.props.t("pages.shop.returnedOrders.productNewOrder"),dataIndex:"product_new_order",align:"left"},{title:n.props.t("customers.title"),dataIndex:"customer",align:"left"},{title:n.props.t("pages.shop.returnedOrders.phoneNumber"),dataIndex:"phone_number",align:"left",ellipsis:!0},{title:"",dataIndex:"temp",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.returnedFee"),dataIndex:"returned_fee",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.discount"),dataIndex:"discount",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.returnedSubtotal"),dataIndex:"returned_sub_total",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.insertedAt"),dataIndex:"inserted_at",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.codExchangedOrders"),dataIndex:"cod",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.internalNote"),dataIndex:"internal_note",align:"left",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.creatorReturnedOrder"),dataIndex:"creator_returned_order",align:"left",ellipsis:!0},{title:n.props.t("pages.shop.returnedOrders.hasOrderId"),dataIndex:"order_id",align:"left",ellipsis:!0},{title:n.props.t("status"),dataIndex:"status",align:"center",fixed:"right",width:"150px",render:function(e,n){return dt("span",{onClick:function(e){return e.stopPropagation()}},dt(de,{accessToken:t,shopId:r,order_returned:n.action,size:"small"}))}}]})),(0,S.Z)((0,m.Z)(n),"getItemDetail",(function(e){return"".concat(e.variation_info.name," x ").concat(e.returned_quantity||e.quantity)})),(0,S.Z)((0,m.Z)(n),"renderProduct",(function(e){var t=n.props.t;if(!e||0==e.length)return dt(c.default,{title:t("orderNotProduct")},dt("span",{style:{color:"#ff3860",fontWeight:500}},t("notYetProduct")));if(1==e.length)return dt(c.default,{placement:"topLeft",title:n.getItemDetail(e[0])},n.getItemDetail(e[0]));var r=dt(x.default,null,e.map((function(e,t){return dt(x.default.Item,{key:t},n.getItemDetail(e))})));return dt(d.default,{content:r,overlayClassName:"order-action-list",placement:"right"},dt("span",{style:{color:"#096dd9",fontWeight:500}},t("manyProduct")))})),(0,S.Z)((0,m.Z)(n),"contentAddTags",(function(e){var t=n.props,r=t.currentShop,o=t.t,a=e.tags?e.tags.map((function(t,n){var o=(0,Q.DXf)()[t],a="",s=e.partner?e.partner.extend_update:null;if(null!==s){for(var i=0;i<s.length;i++)"Kh\xf4ng giao \u0111\u01b0\u1ee3c h\xe0ng"==s[i].status&&(a=s[i].note);o&&(o=Object.assign(o,{reason:a}))}return o||(o=r.order_tags.find((function(e){return e.id==t})))&&(o={text:o.name,color:o.tag_color||"#123123",allowRemove:!0}),o})).filter((function(e){return e})):null,s=(0,Q.ma3)(e,r),i=2!=r.type?(0,Q.DXf)():(0,Q.P1X)(),u=[],d={display:"flex",justifyContent:"space-between"},c={marginLeft:8,marginTop:3},p=s.length?k()(s,(function(e){return r.order_tags.length&&r.order_tags.map((function(e){return e.id})).includes(e)?-1:1})):[],f=!(1!=e.status&&p.length>0);return p.forEach((function(t){var n=!!e.tags.find((function(e){return e==t}));if(i[t])return n?u.unshift(dt(x.default.Item,{key:t,style:d},dt("div",null,i[t].text),dt(B.Z,{style:c}))):u.push(dt(x.default.Item,{key:t},i[t].text));if(!r.order_tag_groups.find((function(e){return e.tags.includes(t)}))){var o=r.order_tags.find((function(e){return e.id==t}));n?u.unshift(dt(x.default.Item,{key:t,style:d},dt("div",null,o.name),dt(B.Z,{style:c}))):u.push(dt(x.default.Item,{key:t},o.name))}})),r.order_tag_groups.forEach((function(t){u.push(dt(mt,{key:"group"+t.id,title:t.name},p.filter((function(e){return t.tags.includes(e)})).map((function(t){var n=r.order_tags.find((function(e){return e.id==t})),o=!!e.tags.find((function(e){return e==t}));return n||(n={name:(0,Q.DXf)()[t].text}),o&&!u.find((function(e){return e.key==t}))&&u.unshift(dt(x.default.Item,{key:t,style:d},dt("div",null,n.name),dt(B.Z,{style:c}))),dt(x.default.Item,{key:t,style:d},dt("div",null,n.name),o&&dt(B.Z,{style:c}))}))))})),a&&a.length&&u.push(dt(x.default.Item,{key:"delete-all",style:{display:"flex",justifyContent:"space-between",color:"#e03838",borderTop:"1px solid #d9d9d9"}},dt("div",null,o("containers.formBox.deleteAllTag")))),dt("div",null,dt(l.default,{getPopupContainer:function(e){return e.parentNode},overlay:f?dt("div",null):dt(x.default,{onClick:n.handleAddTag(e)},u)},a.length?dt("div",null,a.map((function(e,t){return dt(at.Z,{key:t,color:e.color,text:t==a.length-1?e.text:void 0,processing:e.processing})}))):f?dt("div",null):dt("div",{className:"add-order-tag"},"\xa0",o("containers.formBox.addTag"))))})),(0,S.Z)((0,m.Z)(n),"handleAddTag",(function(e){return function(t){var r=t.key,o=n.props,a=o.currentShop,s=o.updateTagsReturnedOrder,i=o.updateOrderReturned,u=o.accessToken,l=o.shopId;if("delete-all"==r)return s(e.display_id,[]),void i(u,l,pt(pt({},e),{},{tags:[]}));var d=parseInt(r),c=e.tags;if(c.find((function(e){return e==d}))){var p=(0,te.lT)(c,d,a.order_tag_groups);s(e.display_id,p),i(u,l,pt(pt({},e),{},{tags:p}))}else{var f=(0,te.Dg)(c,d,a.order_tag_groups);s(e.display_id,f),i(u,l,pt(pt({},e),{},{tags:f}))}}})),(0,S.Z)((0,m.Z)(n),"lengthData",(function(e){return(null===e||void 0===e?void 0:e.toString().length)||0})),(0,S.Z)((0,m.Z)(n),"getDataSource",(function(){var e=n.props,t=e.currentShop,r=e.accessToken,o=e.timezone,a=e.user,s=e.t,i=[],l=[];n.props.orders_returned.data.map((function(e){var c,p,f,h,g,m,v,y,_,b,S,O,x,Z,w,k,R,C=n.props.users.find((function(t){return t.user_id==e.creator_id})),I=e.order_to_returned?e.order_to_returned.creator:null;i.push({key:e.id,id:(0,Q.pyT)(e.display_id),creator:C?dt("span",{style:{display:"flex",alignItems:"center",float:"left"}},dt(Y.Z,{id:C.user.fb_id,seed:C.id,size:[20,20],name:C.user.name}),"\xa0",dt("span",null,C.user.name)):dt("span",null,dt(Y.Z,{allowHover:!0,name:s("pages.admin.system"),color:"#00707f",size:[20,20]}),"\xa0",dt("span",null,s("pages.admin.system"))),product:n.renderProduct(e.returned_items),product_new_order:n.renderProduct(null===(c=e.order)||void 0===c?void 0:c.items),customer:e.customer||e.bill_full_name?dt("span",{style:{display:"flex",alignItems:"center",float:"left"}},e.customer?dt("span",null,dt(Y.Z,{avatar_url:(0,ee.E$)(e.customer,r),seed:e.customer.id,id:e.customer.fb_id,size:[20,20],name:e.customer.name}),"\xa0",dt("span",null,e.customer.name)):dt("span",null,e.bill_full_name)):"",phone_number:e.customer||e.bill_phone_number?dt(ot.Z,{customer:e.customer,phone:e.bill_phone_number||(null===(p=e.customer)||void 0===p||null===(f=p.shop_customer)||void 0===f||null===(h=f.phone_numbers)||void 0===h?void 0:h[0])},(0,Q.xAZ)(e.bill_phone_number||(null===(g=e.customer)||void 0===g||null===(m=g.shop_customer)||void 0===m||null===(v=m.phone_numbers)||void 0===v?void 0:v[0]))||""):"",returned_fee:(0,Q.ufS)(e.returned_fee,t.currency),discount:(0,Q.ufS)(e.discount,t.currency),returned_sub_total:(0,Q.ufS)((0,te.GS)(e),t.currency),inserted_at:(0,Q.o0x)(o,e.inserted_at),cod:(0,Q.ufS)((null===(y=e.order)||void 0===y?void 0:y.cod)||0,t.currency),internal_note:dt(d.default,{content:null===(_=e.order)||void 0===_?void 0:_.note},null===(b=e.order)||void 0===b?void 0:b.note),creator_returned_order:I?dt("span",{style:{display:"flex",alignItems:"center",float:"left"}},dt(Y.Z,{id:I.fb_id,seed:I.id,size:[20,20],name:I.name}),"\xa0",dt("span",null,I.name)):"",order_id:e.order_id?dt(u.default,{color:"green"},s("pages.shop.returnedOrders.yes")):dt(u.default,{color:"red"},s("pages.shop.returnedOrders.no")),tag:dt("div",{style:e.tags.length?{}:"en"==a.locale?{width:72}:{width:83},onClick:function(e){return e.stopPropagation()}},n.contentAddTags(e)),action:e}),l.push({id:n.lengthData((0,Q.pyT)(e.display_id))+5,creator:n.lengthData(null===C||void 0===C||null===(S=C.user)||void 0===S?void 0:S.name)+15,customer:n.lengthData(null===e||void 0===e||null===(O=e.customer)||void 0===O?void 0:O.name)+10,phone_number:n.lengthData((null===e||void 0===e||null===(x=e.customer)||void 0===x||null===(Z=x.shop_customer)||void 0===Z||null===(w=Z.phone_numbers)||void 0===w?void 0:w[0])||"0")+10,returned_fee:n.lengthData(e.returned_fee),discount:n.lengthData(e.discount),inserted_at:n.lengthData((0,Q.o0x)(o,e.inserted_at)),cod:n.lengthData((null===(k=e.order)||void 0===k?void 0:k.cod)||"0"),internal_note:n.lengthData(null===(R=e.order)||void 0===R?void 0:R.note),creator_returned_order:n.lengthData(I||"")+5,order_id:n.lengthData(e.order_id)})}));var c=(0,Q.Owf)(l,n.columns());return[i,c]})),(0,S.Z)((0,m.Z)(n),"handleTableChange",(function(e){var t=n.state.params;t.page=e.current,t.page_size=e.pageSize,n.fetchListReturnedOrders(t)})),(0,S.Z)((0,m.Z)(n),"handleRowClick",function(){var e=(0,h.Z)(f().mark((function e(t){var r,o,a,s,i,u,l,d,c,p;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.action,o=n.props,a=o.openReturnedForm,s=o.openOrderFormInReturnedForm,i=(0,Q.uuG)("showform"),e.next=5,a({data:r,key:i});case 5:return u={},r.order?u=pt(pt({},r.order),{},{customer:(null===r||void 0===r||null===(l=r.order)||void 0===l?void 0:l.customer)||(null===r||void 0===r?void 0:r.customer)||{id:null,name:"",global_id:null,fb_id:null}}):(c=(null===(d=r.order_to_returned)||void 0===d?void 0:d.shipping_address)||{},Object.values(c).length>0&&Object.values(c).find((function(e){return e}))&&(p=c),p&&(u={shipping_address:p})),e.next=9,s({data:u,key:i});case 9:n.setState({formBoxVisible:!0,selectedReturnedOrderId:r.id,activeKey:i});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,S.Z)((0,m.Z)(n),"handleOnChangeStatus",(function(e){var t=E()(n.state.params);t.status=e,n.fetchListReturnedOrders(t)})),(0,S.Z)((0,m.Z)(n),"renderStatus",(function(){var e=n.props,t=e.t,r=e.orders_returned.counters,o=n.state,a=o.isLoading,s=o.params,i=function(e){var t;return"-1"==e?(r||[]).reduce((function(e,t){return e+t.count}),0):(null===(t=(r||[]).find((function(t){return t.status==e})))||void 0===t?void 0:t.count)||0},l=[{text:t("commons.all"),value:"-1",count:i("-1")}];return(0,ee.ne)().map((function(e){l.push({text:(0,ee.ix)()[e].text,value:e,count:i(e)})})),dt("div",{className:"status-dropdown"},dt(ht,{value:s.status},l.map((function(e){return dt(gt,{key:e.value,value:e.value,onChange:function(e){return n.handleOnChangeStatus(e.target.value)}},e.text,dt(u.default,{key:e.value},a&&s.status==e.value?dt(M.Z,null):e.count))}))))})),(0,S.Z)((0,m.Z)(n),"renderFilter",(function(e,t){var r,o,a=n.props,s=a.users,i=a.currentShop,l=a.t,d=a.warehouses,c=a.orderSourcesCustom,p=n.state.filters,f=d.find((function(t){return(null===t||void 0===t?void 0:t.id)==e.value}));switch(e.key){case"creator_id":var h=s.find((function(t){return t.user_id==e.value}));if(!h)return;o=dt("div",{style:{display:"flex"}},dt("span",null,"".concat(l("components.orderAdvanceFilter.creator"))),"\xa0",dt("span",{style:{display:"flex",alignItems:"center"}},dt(Y.Z,{avatar_url:(0,ee.E$)(h,n.props.accessToken),id:h.user.fb_id,name:h.user.name,size:[15,15],seed:h.user.id}),dt("strong",{style:{marginLeft:5}},h.user.name)));break;case"partner_id":o=dt("div",{style:{display:"flex"}},dt("span",null,"V\u1eadn chuy\u1ec3n:"),"\xa0",dt("strong",null,(0,Q.Prj)(e.value,i)));break;case"is_wholesale":o=dt("div",null,dt("b",null,e.value?l("components.orderAdvanceFilter.wholesale"):l("components.orderAdvanceFilter.retail")));break;case"shop_customer_id":var g=p.find((function(t){return t.key==e.key&&t.value==e.value})).customer_info;o=dt("div",{style:{display:"flex"}},dt("span",null,l("customers.title"),":"),"\xa0\xa0",dt("span",{style:{display:"flex",alignItems:"center"}},dt(Y.Z,{avatar_url:(0,ee.E$)(g,n.props.accessToken),id:g.fb_id,name:g.name,size:[15,15],seed:g.id}),dt("strong",{style:{marginLeft:5}},g.name)));break;case"original_creator_id":var m=s.find((function(t){return t.user_id==e.value}));if(!m)return;o=dt("div",{style:{display:"flex"}},dt("span",null,"".concat(l("components.orderAdvanceFilter.originalCreator"))),"\xa0",dt("span",{style:{display:"flex",alignItems:"center"}},dt(Y.Z,{avatar_url:(0,ee.E$)(m,n.props.accessToken),id:m.user.fb_id,name:m.user.name,size:[15,15],seed:m.user.id}),dt("strong",{style:{marginLeft:5}},m.user.name)));break;case"orders_returned_new":o=dt("div",{style:{display:"flex"}},dt("span",null,l("pages.shop.returnedOrders.orderReturnedNew"),":"),"\xa0",dt("strong",null,e.value?l("pages.shop.returnedOrders.yes"):l("pages.shop.returnedOrders.no")));break;case"warehouse_order_original_id":if(!f)return;o=dt("div",{style:{display:"flex"}},dt("span",null,l("pages.shop.returnedOrders.wareHouseOrderOrigin"),":"),"\xa0",dt("strong",null,f.name));break;case"warehouse_order_returned_id":if(!f)return;o=dt("div",{style:{display:"flex"}},dt("span",null,l("pages.shop.returnedOrders.wareHouseOrderReturn"),":"),"\xa0",dt("strong",null,f.name));break;case"order_sources":var v=(0,Q.K5C)(c,i),y=[];(0,Q.caL)(i).map((function(e){v.find((function(t){return t.id==e.id}))||y.push(e)}));var _=v.concat(y),b=_.findIndex((function(t){return t.id==e.value[0]||t.id&&t.id.toString()==e.value[0]})),S=b>-1?_[b].name:"",O=null;e.value.length>1&&(O=(((null===(r=_[b])||void 0===r?void 0:r.nodes)||[]).find((function(t){return t.custom_id==e.value[1]||t.id==e.value[1]}))||{}).name),o=dt("div",{style:{display:"flex"}},dt("span",null,l("components.orderAdvanceFilter.".concat("no_source"==e.value?"noSource":"orderSource")),"no_source"!=e.value?":":""),"\xa0",dt("strong",null,O?S+"/"+O:"-1"==e.value[0]&&e.value.length>1?S+"/"+e.value[1]:S))}return dt(u.default,{key:t,closable:!0,onClose:function(){return n.handleCloseTag(t)}},o)})),(0,S.Z)((0,m.Z)(n),"handleCloseTag",(function(e){var t=E()(n.state.filters);t.splice(e,1),n.handleAdvanceFilter({filters:t})})),(0,S.Z)((0,m.Z)(n),"onSelectRow",(function(){var e=n.props,t=e.shopId,r=e.accessToken,o=n.state.params,a="".concat((0,Q.LpH)(),"/shops/").concat(t,"/orders_returned?access_token=").concat(r);n.setState({loadingData:!0});(function e(t){return fe().get(a,{params:t}).then((function(r){var o=n.state,a=o.loadingData,s=o.selectedRowKeys,i=r.data.data,u=i.map((function(e){return e.id})),l=s.filter((function(e){return!u.includes(e)})).concat(u);return a&&n.setState({selectedRowKeys:l}),(l||[]).length>=r.data.total_entries||0==i.length||!a?void 0:(t.page+=1,e(t))}))})(pt(pt({},o),{},{page:1})).then((function(e){return n.setState({loadingData:!1})}))})),(0,S.Z)((0,m.Z)(n),"renderContent",(function(){var e,t=n.state,r=t.isLoading,o=t.params,a=t.filters,u=t.selectedRowKeys,l=n.props,d=l.orders_returned.total_entries,c=l.currentShop.user_shop,p=(0,i.Z)(n.state.checkedListReturnedOrder);p=null!==c&&void 0!==c&&null!==(e=c.department)&&void 0!==e&&e.is_hide_customer_order_info?p.filter((function(e){return!Ot.includes(e)})):p;var f=n.getDataSource(),h=(0,s.Z)(f,2),g=h[0],m=h[1],v=[];p.map((function(e){var t=n.columns().find((function(t){return e==t.dataIndex}));t.width=m[t.dataIndex]||"150px",v.push(t)}));var y=(0,Q.f2Q)(v);v.map((function(e){return"product"==e.dataIndex&&delete e.width,e}));var _=a.length>0?"calc(100vh - 250px)":"calc(100vh - 220px)",b={selectedRowKeys:u,onChange:function(e){return n.setState({selectedRowKeys:e})},preserveSelectedRowKeys:!0,isSelection:!0,onSelectRow:n.onSelectRow};return dt("div",null,n.renderStatus(),dt(ut.Z,{className:"order-returned-container",columns:v,dataSource:g,style:{margin:"0px auto"},loading:r,size:"small",pagination:{size:"small",pageSize:o.page_size,total:d,current:o.page},onChange:n.handleTableChange,onRow:function(e){return{onClick:function(t){return n.handleRowClick(e)}}},rowSelection:b,scroll:{x:y,y:_}}),(0,te.NP)(a.length>0,n.props.orders_returned.data.length>0))})),(0,S.Z)((0,m.Z)(n),"onChangeFilterByTime",(function(e){n.props.timezone;var t=E()(n.state.params);t.start_time=e&&e[0]?e[0].startOf("day"):null,t.end_time=e&&e[1]?e[1].endOf("day"):null,n.fetchListReturnedOrders(t)})),(0,S.Z)((0,m.Z)(n),"renderPopoverFilterByTime",(function(){var e,t=n.props.t,r=n.state.params;return dt("div",null,dt("div",null,dt(yt,{format:"DD/MM/YYYY",style:{width:350},ranges:(e={},(0,S.Z)(e,t("pages.shop.statistic.yesterday"),[nt()().add(-1,"days"),nt()().add(-1,"days")]),(0,S.Z)(e,t("pages.shop.statistic.today"),[nt()(),nt()()]),(0,S.Z)(e,t("pages.shop.statistic.lastWeek"),[nt()().add(-7,"days"),nt()()]),(0,S.Z)(e,t("pages.shop.statistic.lastMonth"),[nt()().add(-30,"days"),nt()()]),(0,S.Z)(e,t("pages.shop.statistic.thisMonth"),[nt()().startOf("month"),nt()().endOf("month")]),e),value:r.start_time&&r.end_time?[nt()(r.start_time),nt()(r.end_time)]:void 0,onChange:n.onChangeFilterByTime})))})),(0,S.Z)((0,m.Z)(n),"handleDeleteFilter",(function(){C()(n.state.params,vt)||n.setState({params:pt({},vt),searchTerm:"",filters:[],paramMultipeSource:[]},(function(){n.fetchListReturnedOrders(n.state.params)}))})),(0,S.Z)((0,m.Z)(n),"handleAdvanceFilter",(function(e){var t=e.filters,r=n.state,o=r.isFilterMultipleSource,a=r.isFilterExcludeSource,s=E()(n.state.params),i={};Object.keys(vt).map((function(e){i=pt(pt({},i),{},(0,S.Z)({},e,s[e]))})),s=i;var u={};t.length&&(t.map((function(e){["orders_returned_new"].includes(e.key)?u[e.key]=e.value:u[e.key]?u[e.key].push(e.value):u[e.key]=[e.value]})),s=pt(pt(pt({},s),u),{},{is_filter_exclude_source:a,is_filter_multiple_source:o})),n.setState({filters:t}),n.fetchListReturnedOrders(s)})),(0,S.Z)((0,m.Z)(n),"onCancel",(function(){var e=n.state,t=e.activeKey;e.onScreenBarcode||(n.setState({formBoxVisible:!1}),n.props.deleteReturnForm(t),n.props.deleteForm(t))})),(0,S.Z)((0,m.Z)(n),"onChangeColumns",(function(e){-1!=e.findIndex((function(e){return"id"==e}))&&-1!=e.findIndex((function(e){return"status"==e}))&&-1!=e.findIndex((function(e){return"phone_number"==e}))&&-1!=e.findIndex((function(e){return"product"==e}))&&(n.setState({checkedListReturnedOrder:e}),localStorage.setItem("columnsListReturnedOrder",JSON.stringify({checkedListReturnedOrder:e})))})),(0,S.Z)((0,m.Z)(n),"getListActionTools",(function(){var e,t=n.state.selectedRowKeys,r=n.props,o=r.accessToken,a=r.shopId,s=r.t,u=r.orders_returned.total_entries,l=r.currentShop.user_shop,d=n.columns().reduce((function(e,t){return e[t.dataIndex]=t.title,e}),{status:s("status")}),c=null===l||void 0===l||null===(e=l.department)||void 0===e?void 0:e.is_hide_customer_order_info,p=(0,i.Z)(n.state.checkedListReturnedOrder),f=bt.filter((function(e){return!p.includes(e)}));return f=c?f.filter((function(e){return!Ot.includes(e)})):f,p=c?p.filter((function(e){return!Ot.includes(e)})):p,[{icon:dt(z.Z,null),title:s("pages.shop.statistic.inventory.exportExcel"),key:"export_excel",content:function(e){return dt(je,{accessToken:o,selectedRowKeys:t,params:n.state.params,totalEntries:u,isButton:e,title:s("pages.shop.statistic.inventory.exportExcel")})}},{icon:dt(K.Z,null),title:s("pages.shop.actionTools.quickUpdate"),key:"quick_update",content:function(e){return dt(Qe,{accessToken:o,shopId:a,selectedRowKeys:t,params:n.state.params,totalEntries:u,isButton:e,fetchOrderReturned:function(){return n.fetchListReturnedOrders(n.state.params)},title:s("pages.shop.actionTools.quickUpdate")})}},{icon:dt(U.Z,null),title:s("pages.shop.setting.crmProfile.columnsSetting"),key:"setting_column",content:function(e){return dt(st.Z,{defaultCheckedList:_t,onChange:n.onChangeColumns,translate:d,t:s,displayColumns:p,addOptionColumns:f,title:s("pages.shop.setting.crmProfile.columnsSetting"),isButton:e,isTools:!0})}}]}));var o=e.isServer?St:localStorage.getItem("columnsListReturnedOrder")?JSON.parse(localStorage.getItem("columnsListReturnedOrder")).checkedListReturnedOrder:St;return n.state={params:pt({},vt),isLoading:!1,selectedReturnedOrderId:null,formBoxVisible:!1,onScreenBarcode:!1,searchTerm:"",filters:[],activeKey:null,selectedRowKeys:[],checkedListReturnedOrder:o,loadingData:!1,isFilterMultipleSource:!1,isFilterExcludeSource:!1},n.handleSearchInputChange=D()(n.handleSearchInputChange,400),n}return(0,v.Z)(r,null,[{key:"getInitialProps",value:function(){var e=(0,h.Z)(f().mark((function e(t,r){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.store.dispatch,o=t.query.shopId,!t.isServer){e.next=10;break}return e.next=4,(0,G.iXq)(r,o,vt);case 4:return e.next=6,(0,G.qC2)(r,o,vt);case 6:return e.next=8,n((0,G.H2B)(r,o));case 8:e.next=13;break;case 10:(0,G.iXq)(r,o,vt),(0,G.qC2)(r,o,vt),n((0,G.H2B)(r,o));case 13:return e.abrupt("return",{});case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),(0,v.Z)(r,[{key:"componentDidMount",value:function(){var e=this.props.isServer;if(this.fetchListReturnedOrders(),e){var t=localStorage.getItem("columnsListReturnedOrder");t&&this.setState({checkedListReturnedOrder:JSON.parse(t).checkedListReturnedOrder})}localStorage.getItem("isFilterMultipleSourceOrderReturn")&&this.setState({isFilterMultipleSource:JSON.parse(localStorage.getItem("isFilterMultipleSourceOrderReturn"))}),localStorage.getItem("isFilterExcludeSourceOrderReturn")&&this.setState({isFilterExcludeSource:JSON.parse(localStorage.getItem("isFilterExcludeSourceOrderReturn"))})}},{key:"render",value:function(){var e=this,t=this.state,r=t.formBoxVisible,n=t.onScreenBarcode,s=t.searchTerm,i=t.selectedRowKeys,u=t.filters,l=t.loadingData,c=t.isFilterMultipleSource,p=t.isFilterExcludeSource,f=this.props,h=f.accessToken,g=f.shopId,m=f.t,v=f.orders_returned.total_entries;return dt(A.Z,{className:"container-layout",style:{overflow:"visible"}},r&&dt(et.Z,{accessToken:h,shopId:g,visible:r,onOk:function(){return e.setState({formBoxVisible:!1})},onCancel:function(){return e.onCancel()},barcode:n,onScreenBarcode:this.handleBarcode,isOriginal:!0}),dt("div",{className:"tools-container"},dt(X.Z,{title:m("pages.shop.returnedOrders.createOrderReturned"),icon:dt(H.Z,null),onClick:this.onAddClick}),dt($.Z,{title:m("pages.shop.orderControlInfo.sync"),icon:dt(q.Z,null),onClick:this.onSyncClick,isButton:!0}),dt(it.Z,{listActionTools:this.getListActionTools(),defaultActiveKeys:this.getListActionTools().map((function(e){return e.key})),keyView:"order-returned"}),dt(lt.Z,{selectedLength:i.length,loadingData:l,total:v,onClick:function(){return e.setState({loadingData:!1,selectedRowKeys:[]})}}),dt("div",{className:"filter"},dt(a.default,{className:"input-filter",style:{left:300},placeholder:m("pages.shop.returnedOrders.search"),value:s,prefix:dt(V.Z,null),onChange:function(t){e.setState({searchTerm:t.target.value}),e.handleSearchInputChange(t.target.value)}}),!C()(this.state.params,vt)&&dt(o.default,{className:"delete",danger:!0,onClick:function(){return e.handleDeleteFilter()}},m("pages.shop.debt.deleteFilter")),dt(d.default,{trigger:"click",content:this.renderPopoverFilterByTime(),title:"Th\u1eddi gian t\u1ea1o",placement:"bottomLeft"},dt(X.Z,{icon:dt(W.Z,null),title:m("pages.shop.customer.filterByPeriod")})),dt(be,{accessToken:h,shopId:g,fetch:function(t){return e.handleAdvanceFilter(t)},filters:this.state.filters,orderSourcesCustom:this.props.orderSourcesCustom,clearFilter:function(){return e.handleDeleteFilter()},defaultParams:vt,params:this.state.params,isFilterMultipleSource:c,isFilterExcludeSource:p,propsState:function(t){return e.setState(t)}})),dt("div",{className:"show-filter"},u.map((function(t,r){return e.renderFilter(t,r)})))),this.renderContent())}}]),r}(L.Component);(0,S.Z)(xt,"pageInfo",{title:"pages.shop.returnedOrders.listOrderReturned",sassStyle:P()});var Zt=(0,N.$j)((function(e){return{timezone:e.navigation.user.timezone,users:e.user.users,orders_returned:e.orderReturned.orders_returned,warehouses:(0,J.op)(e),currentShop:e.shop.currentShop,user:e.navigation.user,orderSourcesCustom:(0,J.ME)(e)}}),{fetchListReturnedOrders:G.iXq,openReturnedForm:G.O2q,openOrderFormInReturnedForm:G.hgu,fetchCountOrderReturned:G.qC2,deleteReturnForm:G.NiK,deleteForm:G.dIC,updateTagsReturnedOrder:G.Nhs,updateOrderReturned:G.lqB})((0,j.Z)(xt))},33396:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/list-returned-orders",function(){return r(60175)}])}},function(e){e.O(0,[5460,2902,4517,9774,2888,179],(function(){return t=33396,e(e.s=t);var t}));var t=e.O();_N_E=t}]);