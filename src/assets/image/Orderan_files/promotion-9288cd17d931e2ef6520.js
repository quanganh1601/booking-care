(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3636],{45760:function(t){!function(){"use strict";t.exports=".promotion-advance-modal .ant-modal-body{padding:16px !important;background-color:#ededed}.promotion-advance-modal .ant-modal-body .promotion-advance-detail{display:flex;width:100%}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info{width:100%;margin:0 6px;background-color:#fff;border-radius:2px;font-size:14px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info:first-child{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info span{font-weight:500;white-space:nowrap}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .display-custom{display:flex !important;justify-content:space-between !important;align-items:center !important}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info{width:100%;display:grid;padding:8px;align-items:center;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .ant-picker input{text-align:center}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .ant-input{border-radius:2px !important}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .box-input-number-wrapper{height:32px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .box-input-number-wrapper input{height:30px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .box-input-number-wrapper .ant-input-suffix{top:2px !important}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .item-info-detail{display:flex;align-items:center;text-align:right;max-width:calc(100% - 300px)}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .item-info-detail .ant-input-prefix{top:52% !important}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .item-info-detail .ant-input-suffix{top:1px !important}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .list-level-promotion .btn-add-level-promotion{display:flex;position:relative;top:4px;right:5px;justify-content:flex-end;z-index:1;height:0px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .custom-cascader-promotion_advance{border:1px solid #d9d9d9;width:100%;min-height:32px;cursor:text;border-radius:2px;display:flex;flex-wrap:wrap;align-items:center}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .item-info .custom-cascader-promotion_advance:hover{border-color:#40a9ff}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .level-list-item .level-item-content{padding:0px 5px 5px 5px;border:1px solid #d4d4d4;border-radius:2px;background:#ededed}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .level-list-item .level-item-content .anticon-close:hover{color:red}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items{margin-top:5px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;max-height:95px;overflow:auto}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .load-bonus-items{display:flex;justify-content:center}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items{background:#ededed;border-radius:2px;border:1px solid #d4d4d4;padding:5px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items .info-bonus-item{display:flex;justify-content:space-between;align-items:center;width:100%}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items .info-bonus-item .icon-close:hover{color:red}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items .info-bonus-item .box-input-number-wrapper{width:65px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items .info-bonus-item .box-input-number-wrapper .ant-input-number{height:23px}.promotion-advance-modal .ant-modal-body .promotion-advance-detail .promotion-advance-info .list-bonus-items .bonus-items .info-bonus-item .box-input-number-wrapper .ant-input-number .ant-input-number-input-wrap input{height:23px !important}.promotion-advance-modal .containers .card{border:1px solid rgba(0,0,0,.125);box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);display:flex;flex-direction:column;justify-content:space-between;height:205px;background-color:#fff}.promotion-advance-modal .containers .card .card-body{display:flex;flex-direction:column;padding:10px}.promotion-advance-modal .containers .card .card-footer{text-align:center;cursor:pointer;background-color:rgba(0,0,0,.02);border-top:1px solid rgba(0,0,0,.125);padding:10px;height:39px}.promotion-advance-modal .containers .card .card-footer :hover{background-color:#eff2f6}.table-promotion-advance{margin-top:40px}.table-promotion-advance .ant-table-title{padding:0px !important}.table-promotion-advance .ant-table-title .tabs-group{height:39px}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-nav{position:unset}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-nav-wrap{line-height:0 !important;padding-left:0px !important}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-tab-active .ant-tag{background-color:#096dd9;border-color:transparent}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-tab-active .ant-tag .ant-tag-text{color:#fff}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-bar{margin:1px 0;border:0}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-bar .ant-tabs-tab{margin-right:0;padding:8px 15px}.table-promotion-advance .ant-table-title .tabs-group .ant-tabs-bar .ant-tabs-tab .ant-tag{margin-left:0;margin-right:5px;color:#fff;background-color:#096dd9;border-color:transparent}.table-promotion-advance .inserted-column{text-align:right;max-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.table-promotion-advance .height-table-row{height:35.5px}.table-promotion-advance .ant-table-header .inserted-column{padding-right:37px}"}()},95127:function(t){!function(){"use strict";t.exports=".table-promotion-advance .ant-table-content .ant-table-body{min-height:calc(100vh - 212px)}.table-promotion-advance .ant-table-content .ant-table-body .ant-table-row{cursor:pointer !important}.product-promotion{overflow:visible !important}.product-promotion .tools-container{padding:0}.product-promotion .tools-container .tools-content{padding:0 10px}.product-promotion .tools-container .ant-tabs-nav-wrap{line-height:2.3;border-left:1px solid #e8e5e5;padding-left:5px;z-index:999}.product-promotion .tools-container .ant-tabs-nav{border-bottom:unset;position:absolute;top:-54px}.product-promotion .tools-container .ant-tabs{overflow:visible}.product-promotion .tools-container .ant-tabs-ink-bar{width:92px}.product-promotion .tools-container .filter .ant-input-affix-wrapper{width:30vw;position:absolute;top:-48px;z-index:1000;border:0;border-radius:0;border-left:1px solid #d9d9d9;height:48px;left:410px !important}.product-promotion .tools-container .filter .ant-input-affix-wrapper .ant-input-prefix{font-size:16px;font-weight:bold;margin-left:10px}.product-promotion .tools-container .filter .ant-input-affix-wrapper .ant-input{border:none;font-size:15px !important;background:#fff}.product-promotion .tools-container .filter .ant-input-affix-wrapper .ant-input:focus{box-shadow:none}.product-promotion .tools-container .filter .ant-select{width:150px;margin-left:10px}.product-promotion .tools-container .filter .clear-filter{margin-right:0}@media screen and (max-width: 740px){.product-promotion .tools-container .filter{float:none;margin-top:10px}.product-promotion .tools-container .filter .ant-input-search{width:100%}.product-promotion .tools-container .filter .ant-select{width:50%}}.product-promotion .ant-table-wrapper{margin-top:10px}.product-promotion .ant-table-wrapper .ant-table-header{padding-right:0}.product-promotion .ant-table-wrapper .ant-table-body{min-height:calc(100vh - 212px)}.product-promotion .ant-table-wrapper .ant-table-body .ant-table-row{cursor:pointer}.product-promotion-detail .ant-modal-body{display:flex;flex-direction:column}.product-promotion-detail .ant-modal-body .promotion-info{flex:1;display:flex;padding-bottom:10px;padding-top:10px;border-bottom:1px dashed #d9d9d9;align-items:center;justify-content:space-between}@media screen and (max-width: 700px){.product-promotion-detail .ant-modal-body .promotion-info{flex-direction:column}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper:last-child{margin-top:10px}}.product-promotion-detail .ant-modal-body .promotion-info .combo-discount-amount{width:100%;padding-left:20px}.product-promotion-detail .ant-modal-body .promotion-info .combo-discount-amount div{text-align:right}.product-promotion-detail .ant-modal-body .promotion-info .promotion-percent{display:flex;width:60%}.product-promotion-detail .ant-modal-body .promotion-info .promotion-percent .ant-input-suffix{top:0%}.product-promotion-detail .ant-modal-body .promotion-info .promotion-chart-product{display:flex;width:60%}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper{flex:1}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper .ant-input-prefix{font-size:14px}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper .ant-input-suffix{font-size:14px}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper:first-child{margin-right:10px}.product-promotion-detail .ant-modal-body .promotion-info .ant-input-affix-wrapper input{text-align:right}.product-promotion-detail .ant-modal-body .loading-list-product{display:inline-block;font-size:14px;text-align:center;color:#096dd9}.product-promotion-detail .ant-modal-body .promotion-table{overflow:hidden}.product-promotion-detail .ant-modal-body .promotion-table .ant-table-wrapper input{text-align:right}.product-promotion-detail .ant-modal-body .promotion-table .ant-table-wrapper .ant-table-body{min-height:195px}.ant-select-filter-type-promotion .ant-select-selection{border-radius:2px !important}"}()},78598:function(t,o,e){var n,r=r||function(t){"use strict";if(!("undefined"===typeof t||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var o=t.document,e=function(){return t.URL||t.webkitURL||t},n=o.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,a=/constructor/i.test(t.HTMLElement)||t.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),c=function(o){(t.setImmediate||t.setTimeout)((function(){throw o}),0)},p=function(t){setTimeout((function(){"string"===typeof t?e().revokeObjectURL(t):t.remove()}),4e4)},s=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},d=function(o,d,u){u||(o=s(o));var l,m=this,h="application/octet-stream"===o.type,f=function(){!function(t,o,e){for(var n=(o=[].concat(o)).length;n--;){var r=t["on"+o[n]];if("function"===typeof r)try{r.call(t,e||t)}catch(a){c(a)}}}(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,r)return l=e().createObjectURL(o),void setTimeout((function(){n.href=l,n.download=d,function(t){var o=new MouseEvent("click");t.dispatchEvent(o)}(n),f(),p(l),m.readyState=m.DONE}));!function(){if((i||h&&a)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var o=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(o,"_blank")||(t.location.href=o),o=void 0,m.readyState=m.DONE,f()},n.readAsDataURL(o),void(m.readyState=m.INIT)}(l||(l=e().createObjectURL(o)),h)?t.location.href=l:t.open(l,"_blank")||(t.location.href=l);m.readyState=m.DONE,f(),p(l)}()},u=d.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(t,o,e){return o=o||t.name||"download",e||(t=s(t)),navigator.msSaveOrOpenBlob(t,o)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,o,e){return new d(t,o||t.name||"download",e)})}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);t.exports?t.exports.saveAs=r:null!==e.amdD&&null!==e.amdO&&(void 0===(n=function(){return r}.call(o,e,o,t))||(t.exports=n))},7690:function(t,o,e){"use strict";var n,r=e(71535),a=e(65400),i=e(74047),c=e(52700),p=e(4706),s=e(33814),d=e(44102),u=e(20775),l=e(26265),m=e(65988),h=e(67294),f=e(99069),g=e(17405),v=e(57254),_=e(87217),y=e(95213),x=e(20920),b=h.createElement;function P(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,u.Z)(t);if(o){var r=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)}}var I="btn-filter",S=(0,_.Z)()(n=function(t){(0,s.Z)(e,t);var o=P(e);function e(t){var n;return(0,i.Z)(this,e),n=o.call(this,t),(0,l.Z)((0,p.Z)(n),"handleClickOutSideFilter",(function(t){var o=n.state.popupVisible,e=n.props,r=e.popupClassName,a=e.id,i=e.field;t.stopPropagation();var c=document.getElementsByClassName(r)[0],p=document.getElementById("advance-filter-".concat(null===i||void 0===i?void 0:i.name));if(c){var s=c.getBoundingClientRect();if(s.left<t.x&&t.x<s.right&&s.top<t.y&&t.y<s.bottom)return}var d=document.getElementsByClassName("ant-picker-dropdown-range")[0],u=a?document.getElementById(a):document.getElementById(I);c&&(c.contains(t.target)||u.contains(t.target)||d&&d.contains(t.target)||p&&p.contains(t.target)||o&&n.setPopupVisible(!1))})),(0,l.Z)((0,p.Z)(n),"setPopupVisible",(function(t){return n.setState({popupVisible:t})})),(0,l.Z)((0,p.Z)(n),"handleFilter",(function(){var t=n.props,o=t.field,e=t.callBackField,r=t.type,a=(t.popupClassName,n.state.popupVisible);n.setPopupVisible(!a),r&&e(o)})),(0,l.Z)((0,p.Z)(n),"styleModal",(function(t){var o=n.props,e=o.columnsWidth,r=o.field,a=o.dataSource,i=e[r.name];return i=(i=i||(0,y.IQS)(a,r.type==(0,x.Rt)().boolean.id?r.label:r.name))&&(i.toString().includes("em")?i:"".concat(i,"px")),b(m.default,{id:"2766829989",dynamic:[t,i,t]},[".".concat(t," .ant-cascader-menu:first-child{width:").concat(i,";min-width:150px;max-width:285px;}"),".".concat(t," .ant-cascader-menu-item-disabled{position:-webkit-sticky;position:sticky;top:-4px;padding-top:5px;z-index:900;background-color:#fff;}")])})),(0,l.Z)((0,p.Z)(n),"getButton",(function(){var t=n.props,o=t.t,e=t.label,r=t.type,i=t.field,c=t.popupClassName,p=t.id,s=t.noIcon;return e?b("span",{id:p||I,className:"btn-advance-filter",onClick:n.handleFilter},e):r?b("span",{id:"advance-filter-".concat(i.name),onClick:function(){return n.handleFilter()},style:{width:20}},n.styleModal(c),b(f.Z,{style:{color:"#949494"},className:"field-icon"})):b(a.default,{id:p||I,icon:s?null:b(g.Z,null),onClick:function(){return n.handleFilter()},className:"btn-advance-filter"},o("crm.addFilter"),b(v.Z,null))})),n.state={popupVisible:!1},n}return(0,c.Z)(e,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this),document.addEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"componentWillUnmount",value:function(){this.props.onRef&&this.props.onRef(null),document.removeEventListener("click",this.handleClickOutSideFilter,!1)}},{key:"render",value:function(){var t=this.props,o=t.options,e=t.popupClassName,n=t.onChange,a=t.changeOnSelect,i=t.loadData,c=t.disabled,p=t.displayRender,s=t.type,d=this.state.popupVisible;return b(r.Z,{defaultValue:s?["$customize"]:"",popupVisible:d,popupClassName:e,options:o,popupPlacement:"bottomRight",changeOnSelect:a,onChange:n,loadData:i,disabled:c,displayRender:p},this.getButton())}}]),e}(h.Component))||n;o.Z=S},90798:function(t,o,e){"use strict";var n,r=e(71535),a=e(94055),i=e(74047),c=e(52700),p=e(4706),s=e(33814),d=e(44102),u=e(20775),l=e(26265),m=e(50361),h=e.n(m),f=e(67294),g=e(14494),v=e(87217),_=e(95213),y=f.createElement;function x(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function b(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?x(Object(e),!0).forEach((function(o){(0,l.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):x(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function P(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,u.Z)(t);if(o){var r=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,d.Z)(this,e)}}var I=(0,v.Z)()(n=function(t){(0,s.Z)(e,t);var o=P(e);function e(t){var n;return(0,i.Z)(this,e),n=o.call(this,t),(0,l.Z)((0,p.Z)(n),"loopChildren",(function(t,o,e,r){var a=[];t.map((function(t){var e;o.push(t.value),!((null===(e=t.children)||void 0===e?void 0:e.length)>0)||t.children.map((function(t){a.push(t)}))})),a.length?n.loopChildren(a,o,e,r):n.onSelectMenuItem(e,o,r)})),(0,l.Z)((0,p.Z)(n),"onSelectMenuItem",(function(t,o,e){var r=n.props.isType,a=h()(n.props.tags),i=t.length-1,c=t[0];o.unshift(t[i]);var p={key:c,value:o},s=null!==a&&void 0!==a&&a.length?"order"==r?a.findIndex((function(t){return t.key==c})):a.findIndex((function(t){return t.key==c&&t.value==o})):-1;s>-1&&a.splice(s,1);var d={key:c,value:t[i]};if("promotion"!=r&&(d=b(b({},d),{},{info:e})),a.push(d),"order"==r)n.props.handleFilter(p),n.props.handleTags(a);else{var u=h()(n.props.keyTagFilter),l=[];t.map((function(t,o){o>0&&o<i&&l.push(t)})),u=u.filter((function(t){return!l.includes(t)})),o.map((function(t){-1==u.findIndex((function(o){return o==t}))&&u.push(t)})),n.props.handleTags(d,u)}})),(0,l.Z)((0,p.Z)(n),"onChangeCascaderCategory",(function(t,o){var e=n.props,r=e.isType,a=e.tagKey;if(t.length&&o.length){var i=o.length-1,c=h()(t);"inventory"==r?c.unshift("categoryId"):c.unshift(a||"category_id"),n.loopChildren(o[i].children,[],c,o[i]),"order"==r&&n.props.categoriesSelect(o[o.length-1]),n.setState({searchCategory:t})}else n.setState({searchCategory:[]});document.getElementsByClassName("category-options")[0].getElementsByClassName("ant-cascader-input")[0].focus()})),(0,l.Z)((0,p.Z)(n),"handleFocus",(function(){document.getElementsByClassName("category-options")[0].getElementsByClassName("ant-cascader-input")[0].focus()})),(0,l.Z)((0,p.Z)(n),"dropdownRenderCategory",(function(t){var o,e=t.props&&(null===(o=t.props.options)||void 0===o?void 0:o.filter((function(t){return t.__IS_FILTERED_OPTION})));if(null!==e&&void 0!==e&&e.length)return y("div",null,t)})),(0,l.Z)((0,p.Z)(n),"getCategoryOptions",(function(t){var o=[];return t.map((function(t){var e;o.push({label:t.text,value:t.id.toString(),key:t.id,children:(null===(e=t.nodes)||void 0===e?void 0:e.length)>0?n.getCategoryOptions(t.nodes):[]})})),o})),n.state={searchCategory:[]},n}return(0,c.Z)(e,[{key:"render",value:function(){var t=this,o=this.props,e=o.t,n=o.isType,i=o.categoryOptions,c=this.state.searchCategory,p="inventory"==n?i:"accessories"==n?this.getCategoryOptions(this.props.accessoriesCategories):this.getCategoryOptions(this.props.categories),s=function(t,o,e,n){var r=o.map((function(o,n){var r=o.label,a=(0,_.Mle)(t),i=(0,_.Mle)(r).indexOf(a)>-1?function(t,o,e){var n=(0,_.Mle)(t).indexOf(o);if(n>-1){var r=t.substr(0,n),a=t.substr(n,o.length),i=t.substr(n+o.length,t.length);return y("span",null,r,y("span",{className:"".concat(e,"-menu-item-keyword")},a),i)}return t}(r,a,e):r;return 0===n?i:[" / ",i]})),i=o.map((function(t){return t.label})).join(" / ");return y(a.default,{title:i},r)};return y("div",{onClick:function(t){return t.stopPropagation()}},y(r.Z,{className:"category-options",popupClassName:"category-popup",options:p,placeholder:e("pages.shop.product.management.searchCategory"),value:c,onChange:this.onChangeCascaderCategory,changeOnSelect:!0,showSearch:{filter:function(t,o){return o.some((function(o){return(0,_.Mle)(o.label).indexOf((0,_.Mle)(t))>-1}))},render:s,sort:function(){return 0}},autoFocus:!0,dropdownRender:this.dropdownRenderCategory,onClick:function(){return t.handleFocus()}}))}}]),e}(f.Component))||n;o.Z=(0,g.$j)((function(t){return{categories:t.product.categories}}),null)(I)},45812:function(t,o,e){"use strict";var n=e(65400),r=e(74806),a=e(67294),i=e(54549),c=e(74298),p=a.createElement;o.Z=function(t){var o=t.loadingData,e=t.selectedLength,a=t.total,s=t.onClick;return 0!=e||o?p(n.default,{onClick:s},o&&p(r.default,{type:"circle",percent:Math.round(e/(a||1)*100),width:18,strokeWidth:16,format:function(){return null},style:{marginRight:4}}),p("b",null,e),"\xa0",c.ZP.t("pages.shop.order.selectedOrder"),"  ",p(i.Z,null)):null}},65644:function(t,o,e){"use strict";var n=e(74047),r=e(52700),a=e(4706),i=e(33814),c=e(44102),p=e(20775),s=e(26265),d=e(67294),u=e(14494),l=e(36934),m=d.createElement;function h(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?h(Object(e),!0).forEach((function(o){(0,s.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function g(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,p.Z)(t);if(o){var r=(0,p.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)}}var v=function(t){(0,i.Z)(e,t);var o=g(e);function e(t){var r;return(0,n.Z)(this,e),r=o.call(this,t),(0,s.Z)((0,a.Z)(r),"listenMeronpan",(function(){var t=r.props,o=t.extension,e=t.dispatch;null==o&&(r.unlistenMeronpan(),window.addEventListener("message",r.listenMeronpanHandler.bind((0,a.Z)(r),e)),window.postMessage({type:"CHECK_EXTENSION_VERSION",from:"WEBPAGE"},"*"),window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*"))})),(0,s.Z)((0,a.Z)(r),"listenMeronpanHandler",(function(t,o){if("WEBPAGE"!=o.data.from)switch(o.data.type){case"EXTENSION_LOADED":window.postMessage({type:"CHECK_EXTENSION",from:"WEBPAGE"},"*");break;case"REPORT_EXTENSION_STATUS":t((0,l.GoT)(o.data.connectionStatus));break;case"EXTENSION_VERSION":t((0,l.HfQ)(o.data.version))}})),(0,s.Z)((0,a.Z)(r),"unlistenMeronpan",(function(){window.removeEventListener("message",r.listenMeronpanHandler)})),r}return(0,r.Z)(e,[{key:"componentWillUnmount",value:function(){this.unlistenMeronpan()}},{key:"componentDidMount",value:function(){this.listenMeronpan()}},{key:"render",value:function(){var t=this.props,o=t.className,e=t.children,n=t.onScroll,r=t.style,a=t.top,i=t.height;return m("div",{id:"container-layout",onScroll:n,style:this.props.fullScreen?f(f(f({},_),r),{},{top:0,height:"calc(100%)"}):f(f(f({},_),r),{},{top:a||49,height:i||"calc(100% - ".concat(a||49,"px)")}),className:"__container-layout ".concat(o||"")},e)}}]),e}(d.Component),_={overflowY:"overlay",overflowX:"hidden",position:"absolute",height:"calc(100% - 49px)",width:"100%",padding:"10px 0",top:49,left:0};o.Z=(0,u.$j)((function(t){return{fullScreen:t.navigation.fullScreen,extension:t.shop.extension}}),null)(v)},33367:function(t,o,e){"use strict";e.r(o),e.d(o,{default:function(){return Lo}});var n,r=e(51024),a=e(56697),i=e(40987),c=e(809),p=e.n(c),s=e(92447),d=e(74047),u=e(4706),l=e(52700),m=e(33814),h=e(44102),f=e(20775),g=e(26265),v=e(20838),_=e(23279),y=e.n(_),x=e(67294),b=e(92902),P=e(14494),I=e(95127),S=e.n(I),A=e(65644),E=e(83049),Z=e(31731),w=e(2307),k=e(5789),C=e(65400),O=e(31059),D=e(94055),T=e(42378),N=e(8799),B=e(28140),R=e(18446),L=e.n(R),j=e(87217),M=e(73218),q=e(92104),F=e(24616),U=e(49101),z=e(67724),Q=e(95213),K=e(22318),V=e(31432),W=e(7463),H=e(9669),G=e.n(H),X=e(36934),$=e(97705),Y=x.createElement;function J(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function tt(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?J(Object(e),!0).forEach((function(o){(0,g.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):J(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function ot(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,f.Z)(t);if(o){var r=(0,f.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)}}var et,nt=v.default.TabPane,rt={name:"",is_free_shipping:!1,discount_amount:0,promotion_percent:0,max_promotion_by_percent:0,is_use_percent:!1,total_orders:0,is_active:!1,start_price_product:0,end_price_product:0,char_name_product:"",categories:[],arr_level_promotion:[],quantity_product:0,brands:[],product_tags:[],quantity_same_product:0,arr_promotion_products:[]},at=(0,j.Z)()(n=function(t){(0,m.Z)(e,t);var o=ot(e);function e(t){var n;return(0,d.Z)(this,e),n=o.call(this,t),(0,g.Z)((0,u.Z)(n),"handleNameChange",(function(t){var o=tt({},n.state.promotion);o.name=t.target.value,n.setState({promotion:o})})),(0,g.Z)((0,u.Z)(n),"handleFreeShippingChange",(function(t){var o=tt({},n.state.promotion);o.is_free_shipping=t.target.checked,localStorage.setItem("is_free_shipping",t.target.checked),n.setState({promotion:o})})),(0,g.Z)((0,u.Z)(n),"handleInputNumberChange",(function(t,o){var e=tt({},n.state.promotion);switch(o){case"discount_amount":e[o]=t,n.setState({promotion:e});break;case"promotion_percent":e[o]=t,e.discount_amount=0,n.setState({promotion:e},(function(){if(0!=n.state.promotion.promotion_percent)n.setState({disableMaxPromotion:!1});else{var t=tt({},n.state.promotion);t.max_promotion_by_percent=0,n.setState({disableMaxPromotion:!0,promotion:t})}}));break;case"max_promotion_by_percent":case"total_orders":case"start_price_product":case"end_price_product":case"quantity_product":e[o]=t,n.setState({promotion:e});break;case"quantity_same_product":e[o]=t,n.setState({promotion:e})}})),(0,g.Z)((0,u.Z)(n),"handleInputStringChange",(function(t){return function(o){var e=tt({},n.state.promotion),r=o.target.value;switch(t){case"char_name_product":e[t]=r,n.setState({promotion:e})}}})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsUsePercent",(function(t){n.setState({isUsePromotionByPercent:t}),localStorage.setItem("isUsePromotionByPercent",t);var o=tt({},n.state.promotion);o.is_use_percent=n.props.promotion?n.props.promotion.is_use_percent:t,o.discount_promotion=n.props.promotion?n.props.promotion.discount_promotion:0,o.max_promotion_by_percent=n.props.promotion?n.props.promotion.max_promotion_by_percent:0,n.setState({promotion:o})})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsUseTotalOrder",(function(t){n.setState({isUseTotalOrder:t}),localStorage.setItem("isUseTotalOrders",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsByQuantityProduct",(function(t){n.setState({isByQuantityProduct:t}),localStorage.setItem("isByQuantityProduct",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsByQuantitySameProduct",(function(t){n.setState({isByQuantitySameProduct:t}),localStorage.setItem("isByQuantitySameProduct",t)})),(0,g.Z)((0,u.Z)(n),"onChangePromotionByTagProduct",(function(t){return n.setState({isByProductTag:t})})),(0,g.Z)((0,u.Z)(n),"handleSave",(function(){var t=n.props,o=t.t,e=t.accessToken,r=t.shopId,a=t.createPromotionProduct,i=t.updatePromotionProduct,c=t.close,p=n.state,s=p.promotion,d=p.isCreating,u=p.isUsePromotionByPercent,l=p.isUseTotalOrder,m=p.isUsePriceProduct,h=p.isUseCharOfNameProduct,f=p.isDiscountProductInCategories,g=p.isByQuantityProduct,v=p.isUseBrand,_=p.isByQuantitySameProduct,y=p.isByProductTag,x=p.isCategoriesDiscount;return s.is_use_percent=u,""==s.name?K.Z.error(o("error"),o("components.productPromotionDetail.notExistsPromotionName")):s.start_price_product>s.end_price_product?K.Z.error(o("error"),o("components.productPromotionDetail.errorPriceProduct")):(m||(s.start_price_product=0,s.end_price_product=0),h||(s.char_name_product=""),f||(s.categories=[]),0==l&&(s.total_orders=0),g||(s.quantity_product=0),v||(s.brands=[]),_||(s.quantity_same_product=0),y||(s.product_tags=[]),x||(s.discount_categories=[]),d?(a(e,r,s),c()):(i(e,r,s),c()),void n.setState({notSetup:!1}))})),(0,g.Z)((0,u.Z)(n),"handleAddLevelPromotion",(function(){var t=n.state.promotion,o=(0,B.Z)(n.state.promotion.arr_level_promotion);o.push({productQuantity:0,discountPerOneProduct:0,categories:""}),t.arr_level_promotion=o,n.setState({promotion:t})})),(0,g.Z)((0,u.Z)(n),"columnsLevelPromotion",[{title:n.props.t("components.productPromotionDetail.productQuantity"),dataIndex:"productQuantity",width:"10%",ellipsis:!0},{title:n.props.t("components.productPromotionDetail.discountPerOneProduct"),dataIndex:"discountPerOneProduct",width:"10%",ellipsis:!0},{title:n.props.t("components.productPromotionDetail.categories"),dataIndex:"categories",width:"10%",ellipsis:!0},{title:"",dataIndex:"delete",width:"4%",align:"center"}]),(0,g.Z)((0,u.Z)(n),"columnsPromotionalProducts",[{title:n.props.t("components.productPromotionDetail.productId"),dataIndex:"productId",width:"15%",ellipsis:!0},{title:n.props.t("components.productPromotionDetail.variationId"),dataIndex:"variationId",width:"15%",ellipsis:!0},{title:n.props.t("products.title"),dataIndex:"product",width:"30%",ellipsis:!0},{title:n.props.t("components.productPromotionDetail.quantity"),dataIndex:"quantity",width:"20%",align:"right"},{title:"",dataIndex:"delete",width:"4%",align:"center"}]),(0,g.Z)((0,u.Z)(n),"handleInputNumberPromotion",(function(t,o){return function(e){var r=n.state.promotion,a=(0,B.Z)(n.state.promotion.arr_level_promotion);if(a.length>0)switch(o){case"productQuantity":a[t].productQuantity=e;break;case"discountPerOneProduct":a[t].discountPerOneProduct=e}r.arr_level_promotion=a,n.setState({promotion:r})}})),(0,g.Z)((0,u.Z)(n),"handleChangeCategories",(function(t,o){var e=n.state.promotion,r=(0,B.Z)(n.state.promotion.arr_level_promotion);r[t].categories=o,e.arr_level_promotion=r,n.setState({promotion:e})})),(0,g.Z)((0,u.Z)(n),"handleChangeBrands",(function(t,o){var e=n.state.promotion,r=(0,B.Z)(n.state.promotion.arr_level_promotion);r[t].brands=o,e.arr_level_promotion=r,n.setState({promotion:e})})),(0,g.Z)((0,u.Z)(n),"getCategoryOptions",(function(t){var o=[];return(t||n.props.categories).map((function(t){o.push({title:t.text,value:t.id.toString(),key:t.id,children:t.nodes.length>0?n.getCategoryOptions(t.nodes):[]})})),o})),(0,g.Z)((0,u.Z)(n),"getData",(function(){return n.state.promotion.arr_level_promotion.map((function(t,o){return{key:o,productQuantity:Y(N.Z,{style:{width:150},value:t.productQuantity,formatter:function(t){return(0,Q.oH6)(t,n.props.currentShop.currency)},parser:function(t){return t.replace(/(\.|\,)/g,"")},onChange:n.handleInputNumberPromotion(o,"productQuantity")}),discountPerOneProduct:Y(W.default,{style:{width:150},value:t.discountPerOneProduct,currency:n.props.currentShop.currency,min:0,isMoney:!0,callBack:n.handleInputNumberPromotion(o,"discountPerOneProduct")}),categories:Y(T.ZP,{value:t.categories,allowClear:!0,treeDefaultExpandAll:!0,style:{width:150},treeData:n.getCategoryOptions(),onChange:function(t){n.handleChangeCategories(o,t)},filterTreeNode:function(t,o){return(0,Q.Mle)(o.props.title).indexOf((0,Q.Mle)(t))>=0},placeholder:n.props.t("components.productPromotionDetail.categoriesName"),dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14}}),delete:Y(M.Z,{style:{color:"rgb(255, 56, 96)",cursor:"pointer"},onClick:function(){var t=n.state.promotion,e=(0,B.Z)(n.state.promotion.arr_level_promotion);e.splice(o,1),t.arr_level_promotion=e,n.setState({promotion:t})}})}}))})),(0,g.Z)((0,u.Z)(n),"handleInputNumberChangeProduct",(function(t,o){var e=n.state.promotion,r=(0,B.Z)(n.state.promotion.arr_promotion_products);r[o].quantity=t,e.arr_promotion_products=r,n.setState({promotion:e})})),(0,g.Z)((0,u.Z)(n),"handleDeletePromotionProduct",(function(t){var o=n.state.promotion,e=(0,B.Z)(n.state.promotion.arr_promotion_products);e.splice(t,1),o.arr_promotion_products=e,n.setState({promotion:o})})),(0,g.Z)((0,u.Z)(n),"getPromotionalProducts",(function(){var t=n.state.promotion;return t.arr_promotion_products&&t.arr_promotion_products.length>0?t.arr_promotion_products.map((function(t,o){return{key:o,productId:Y(D.default,{placement:"top",title:t.variation_info.product_id},t.variation_info.product_id),variationId:Y(D.default,{placement:"top",title:t.variation_info.id},t.variation_info.id),product:Y(D.default,{placement:"top",title:t.variation_info.name},t.variation_info.name),quantity:Y("div",{className:"input-quantity"},Y(W.default,{currency:n.props.currentShop.currency,min:1,isMoney:!1,value:t.quantity,callBack:function(t){return n.handleInputNumberChangeProduct(t,o)}})),delete:Y(M.Z,{style:{color:"rgb(255, 56, 96)",cursor:"pointer"},onClick:function(){return n.handleDeletePromotionProduct(o)}})}})):[]})),(0,g.Z)((0,u.Z)(n),"onChangeActivePromotion",(function(t){var o=tt({},n.state.promotion);o.is_active=JSON.parse(t),n.setState({promotion:o})})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsUsePriceProduct",(function(t){n.setState({isUsePriceProduct:t}),localStorage.setItem("isUsePriceProduct",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsUseCharOfNameProduct",(function(t){n.setState({isUseCharOfNameProduct:t}),localStorage.setItem("isUseCharOfNameProduct",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsDiscountProductInCategories",(function(t){n.setState({isDiscountProductInCategories:t}),localStorage.setItem("isDiscountProductInCategories",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxisCategoriesDiscount",(function(t){n.setState({isCategoriesDiscount:t}),localStorage.setItem("isCategoriesDiscount",t)})),(0,g.Z)((0,u.Z)(n),"onChangeCheckBoxIsUseBrand",(function(t){n.setState({isUseBrand:t}),localStorage.setItem("isUseBrand: ",t)})),(0,g.Z)((0,u.Z)(n),"onChangeKey",(function(t){"2"==t&&n.setState({notSetup:!0}),n.setState({activeKey:t})})),(0,g.Z)((0,u.Z)(n),"handleSelectPromotionProduct",(function(t){var o=n.state.searchResult,e=o.findIndex((function(o){return o.id==t}));if(e>-1){var r=n.state.promotion,a=n.state.promotion.arr_promotion_products?(0,B.Z)(n.state.promotion.arr_promotion_products):[],i=a.findIndex((function(o){return o.variation_id==t}));i<0?(a.push({key:o[e].id,images:o[e].images,discount_each_product:0,is_discount_percent:!1,one_time_product:!1,product_id:o[e].product.id,quantity:1,variation_id:o[e].id,variations_warehouses:o[e].variations_warehouses,price_original:o[e].retail_price,variation_info:tt(tt({},o[e].product),{},{fields:o[e].fields,id:o[e].custom_id||o[e].display_id,product_id:o[e].product.custom_id||o[e].product.display_id,retail_price:0})}),r.arr_promotion_products=a):a[i].quantity++,n.setState({promotion:r,searchResult:[]})}})),n.state={promotion:t.promotion||rt,variations:t.variations,isCreating:!1,isUsePromotionByPercent:!1,disableMaxPromotion:!0,isUseTotalOrder:!1,isUsePriceProduct:!1,isUseCharOfNameProduct:!1,isDiscountProductInCategories:!1,visiableSubModal:!1,isByQuantityProduct:!1,isUseBrand:!1,isByQuantitySameProduct:!1,searchResult:[],visiblePromotion:!1,activeKey:null,notSetup:!1,isByProductTag:!1,isCategoriesDiscount:!1},n}return(0,l.Z)(e,[{key:"componentDidUpdate",value:function(t,o){var e=this;L()(t,this.props)||this.setState({promotion:this.props.promotion||rt,isCreating:!this.props.promotion,isUsePromotionByPercent:!!this.props.promotion&&this.props.promotion.is_use_percent,isUseTotalOrder:!(!this.props.promotion||0==this.props.promotion.total_orders)},(function(){if(e.state.promotion.id)e.state.promotion.is_use_percent&&e.setState({isUsePromotionByPercent:e.state.promotion.is_use_percent}),e.state.promotion.start_price_product>0?e.setState({isUsePriceProduct:!0}):e.setState({isUsePriceProduct:!1}),e.state.promotion.char_name_product&&""!==e.state.promotion.char_name_product?e.setState({isUseCharOfNameProduct:!0}):e.setState({isUseCharOfNameProduct:!1}),e.state.promotion.categories&&e.state.promotion.categories.length>0?e.setState({isDiscountProductInCategories:!0}):e.setState({isDiscountProductInCategories:!1}),e.state.promotion.discount_categories&&e.state.promotion.discount_categories.length>0?e.setState({isCategoriesDiscount:!0}):e.setState({isCategoriesDiscount:!1}),e.state.promotion.quantity_product>0?e.setState({isByQuantityProduct:!0}):e.setState({isByQuantityProduct:!1}),e.state.promotion.brands&&e.state.promotion.brands.length>0?e.setState({isUseBrand:!0}):e.setState({isUseBrand:!1}),e.state.promotion.quantity_same_product>0?e.setState({isByQuantitySameProduct:!0}):e.setState({isByQuantitySameProduct:!1}),e.state.promotion.product_tags&&e.state.promotion.product_tags.length>0?e.setState({isByProductTag:!0}):e.setState({isByProductTag:!1});else{if(localStorage.getItem("isUsePromotionByPercent")){var t=JSON.parse(localStorage.getItem("isUsePromotionByPercent"));e.setState({isUsePromotionByPercent:t})}if(localStorage.getItem("isUseTotalOrders")){var o=JSON.parse(localStorage.getItem("isUseTotalOrders"));e.setState({isUseTotalOrder:o})}if(localStorage.getItem("isUsePriceProduct")){var n=JSON.parse(localStorage.getItem("isUsePriceProduct"));e.setState({isUsePriceProduct:n})}if(localStorage.getItem("isUseCharOfNameProduct")){var r=JSON.parse(localStorage.getItem("isUseCharOfNameProduct"));e.setState({isUseCharOfNameProduct:r})}if(localStorage.getItem("isDiscountProductInCategories")){var a=JSON.parse(localStorage.getItem("isDiscountProductInCategories"));e.setState({isDiscountProductInCategories:a})}if(localStorage.getItem("isCategoriesDiscount")){var i=JSON.parse(localStorage.getItem("isCategoriesDiscount"));e.setState({isCategoriesDiscount:i})}if(localStorage.getItem("isByQuantityProduct")){var c=JSON.parse(localStorage.getItem("isByQuantityProduct"));e.setState({isByQuantityProduct:c})}}0!=e.state.promotion.promotion_percent?e.setState({disableMaxPromotion:!1}):e.setState({disableMaxPromotion:!0})}))}},{key:"render",value:function(){var t,o=this,e=this.props,n=e.visible,c=e.t,p=e.currentShop,s=e.accessToken,d=e.shopId,u=e.brands,l=e.product_tags,m=(e.categories,this.state),h=m.promotion,f=m.isCreating,g=m.isUsePriceProduct,_=m.isUseCharOfNameProduct,y=m.isDiscountProductInCategories,x=m.isUsePromotionByPercent,b=(m.disableMaxPromotion,m.isUseTotalOrder),P=m.visiableSubModal,I=m.isByQuantityProduct,S=m.isUseBrand,A=m.isByQuantitySameProduct,E=m.visiblePromotion,Z=m.activeKey,N=m.searchResult,B=m.isByProductTag,R=m.isCategoriesDiscount,L=u.map((function(t){return{title:t.name,value:t.id,key:t.id}})),j=l.map((function(t){return{title:t.note,value:t.id.toString(),key:t.id.toString()}}));return Y("div",null,n&&!P&&!E&&Y(a.Z,{wrapClassName:"product-promotion-detail",visible:n,width:748,onCancel:function(){o.setState({notSetup:!1}),o.props.close()},title:f?c("components.productPromotionDetail.new"):"#".concat((0,Q.pyT)(h.id,0)),footer:Y("div",{className:"promotion-footer",style:{display:"flex",alignItems:"center"}},Y("div",{style:{flex:1,textAlign:"left"}},Y(i.Z,{checked:h.is_active,onChange:function(t){return o.onChangeActivePromotion(t)}}),Y("strong",{style:{marginLeft:10}},c("components.productPromotionDetail.activePromotionDetail"))),Y("div",{style:{flex:1}},Y("div",null,Y(O.default,{style:{fontSize:14},checked:h.is_free_shipping,onClick:this.handleFreeShippingChange},c("components.productPromotionDetail.freeShip")),Y(C.default,{type:"primary",icon:Y(q.Z,null),onClick:this.handleSave},c(f?"components.productPromotionDetail.create":"components.productPromotionDetail.save")))))},Y("div",null,Y("div",{className:"promotion-info"},Y("div",{style:{width:"100%"}},Y("span",null,"".concat(c("components.productPromotionDetail.namePromotion"),": ")),Y(r.default,{placeholder:c("components.productPromotionDetail.enterName"),value:h.name,onChange:this.handleNameChange})),!x&&Y("div",{className:"combo-discount-amount"},Y("span",{style:{paddingLeft:"10px"}},"".concat(c("components.productPromotionDetail.discountPromotion"),": ")),Y(W.default,{currency:p.currency,value:h.discount_amount,callBack:function(t){return o.handleInputNumberChange(t,"discount_amount")},isMoney:!0,suffix:(0,Q.jKf)(p.currency)}))),Y("div",{className:"promotion-info"},Y("div",null,Y(O.default,{onChange:function(t){return o.onChangeCheckBoxIsUsePercent(t.target.checked)},checked:x},x?"".concat(c("components.productPromotionDetail.usePromotionByPercent")," :"):c("components.productPromotionDetail.usePromotionByPercent"))),x&&Y("div",{className:"promotion-percent"},Y(W.default,{currency:p.currency,value:h.promotion_percent,callBack:function(t){return o.handleInputNumberChange(t,"promotion_percent")},isMoney:!1,prefix:c("components.productPromotionDetail.promotionPercent"),suffix:"%"}),Y(W.default,{currency:p.currency,value:h.max_promotion_by_percent,callBack:function(t){return o.handleInputNumberChange(t,"max_promotion_by_percent")},isMoney:!0,prefix:c("components.productPromotionDetail.maxPromotion"),suffix:(0,Q.jKf)(p.currency)}))),Y("div",{className:"promotion-info"},Y("div",null,Y(O.default,{onChange:function(t){return o.onChangeCheckBoxIsUseTotalOrder(t.target.checked)},checked:b},b?"".concat(c("components.productPromotionDetail.useTotalOrder")," :"):c("components.productPromotionDetail.useTotalOrder"))),b&&Y("div",{style:{width:"60%",textAlign:"right"}},Y(W.default,{currency:p.currency,value:h.total_orders,callBack:function(t){return o.handleInputNumberChange(t,"total_orders")},isMoney:!0,prefix:c("components.productPromotionDetail.totalOrder"),suffix:(0,Q.jKf)(p.currency)}))),Y("div",{className:"promotion-info"},Y(k.default,{span:14},Y(O.default,{onChange:function(t){return o.onChangeCheckBoxIsByQuantityProduct(t.target.checked)},checked:I},I?"".concat(c("components.productPromotionDetail.byQuantityProduct")," :"):c("components.productPromotionDetail.byQuantityProduct"))),I&&Y(k.default,{span:10},Y(D.default,{title:"".concat(c("components.productPromotionDetail.activePromotionWhenBuy")," ").concat((0,Q.oH6)(h.quantity_product,p.currency,!1)," ").concat(c("components.productPromotionDetail.anyProduct"))},Y(W.default,{currency:p.currency,value:h.quantity_product,callBack:function(t){return o.handleInputNumberChange(t,"quantity_product")},isMoney:!1})))),Y("div",{className:"promotion-info"},Y(k.default,{span:10},Y(O.default,{checked:g,onChange:function(t){return o.onChangeCheckBoxIsUsePriceProduct(t.target.checked)}},g?"".concat(c("components.productPromotionDetail.priceProduct")," :"):c("components.productPromotionDetail.priceProduct"))),g&&Y("div",{style:{textAlign:"right",display:"flex"}},Y(k.default,{span:12},Y(W.default,{currency:p.currency,value:h.start_price_product,callBack:function(t){return o.handleInputNumberChange(t,"start_price_product")},isMoney:!0,prefix:c("components.productPromotionDetail.from"),suffix:(0,Q.jKf)(p.currency)})),Y(k.default,{span:12},Y(W.default,{currency:p.currency,value:h.end_price_product,callBack:function(t){return o.handleInputNumberChange(t,"end_price_product")},isMoney:!0,prefix:c("components.productPromotionDetail.to"),suffix:(0,Q.jKf)(p.currency)})))),Y("div",{className:"promotion-info"},Y(O.default,{checked:_,onChange:function(t){return o.onChangeCheckBoxIsUseCharOfNameProduct(t.target.checked)}},_?"".concat(c("components.productPromotionDetail.charNameProductExclude")," :"):c("components.productPromotionDetail.charNameProductExclude")),_&&Y(r.default,{className:"promotion-chart-product",style:{width:300},placeholder:c("components.productPromotionDetail.inputCharOfNameProduct"),value:h.char_name_product,onChange:this.handleInputStringChange("char_name_product")})),Y("div",{className:"promotion-info"},Y("div",null,Y(O.default,{checked:R,onChange:function(t){return o.onChangeCheckBoxisCategoriesDiscount(t.target.checked)}},R?"".concat(c("components.productPromotionDetail.categoriesPromotion")," :"):c("components.productPromotionDetail.categoriesPromotion"))),R&&Y("div",{className:"category-select"},Y(T.ZP,{value:null===(t=h.discount_categories)||void 0===t?void 0:t.map(String),multiple:!0,allowClear:!0,treeDefaultExpandAll:!0,style:{width:300},treeData:this.getCategoryOptions().filter((function(t){var o,e;return!(null!==(o=h.categories)&&void 0!==o&&o.includes(t.value))&&!(null!==(e=h.categories)&&void 0!==e&&e.includes(t.key))})),onChange:function(t){var e=tt({},o.state.promotion);e.discount_categories=t,o.setState({promotion:e})},filterTreeNode:function(t,o){return(0,Q.Mle)(o.props.title).indexOf((0,Q.Mle)(t))>=0},placeholder:c("components.productPromotionDetail.categoriesName"),dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14}}))),Y("div",{className:"promotion-info"},Y("div",null,Y(O.default,{checked:y,onChange:function(t){return o.onChangeCheckBoxIsDiscountProductInCategories(t.target.checked)}},y?"".concat(c("components.productPromotionDetail.categoriesNotPromotion")," :"):c("components.productPromotionDetail.categoriesNotPromotion"))),y&&Y("div",{className:"category-select"},Y(T.ZP,{value:h.categories.map(String),multiple:!0,allowClear:!0,treeDefaultExpandAll:!0,style:{width:300},treeData:this.getCategoryOptions().filter((function(t){var o,e;return!(null!==(o=h.discount_categories)&&void 0!==o&&o.includes(t.value))&&!(null!==(e=h.discount_categories)&&void 0!==e&&e.includes(t.key))})),onChange:function(t){var e=tt({},o.state.promotion);e.categories=t,o.setState({promotion:e})},filterTreeNode:function(t,o){return(0,Q.Mle)(o.props.title).indexOf((0,Q.Mle)(t))>=0},placeholder:c("components.productPromotionDetail.categoriesName"),dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14}}))),Y("div",{className:"promotion-info"},Y(O.default,{checked:S,onChange:function(t){return o.onChangeCheckBoxIsUseBrand(t.target.checked)}},S?"".concat(c("components.productPromotionDetail.useBrand")," :"):c("components.productPromotionDetail.useBrand")),S&&Y("div",{className:"category-select"},Y(T.ZP,{value:(h.brands||[]).map(String),multiple:!0,allowClear:!0,treeDefaultExpandAll:!0,style:{width:300},treeData:L,onChange:function(t){var e=tt({},o.state.promotion);e.brands=t,o.setState({promotion:e})},filterTreeNode:function(t,o){return(0,Q.Mle)(o.props.title).indexOf((0,Q.Mle)(t))>=0},placeholder:c("components.productPromotionDetail.categoriesName"),dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14}}))),Y("div",{className:"promotion-info"},Y(k.default,{span:14},Y(O.default,{onChange:function(t){return o.onChangeCheckBoxIsByQuantitySameProduct(t.target.checked)},checked:A},A?"".concat(c("components.productPromotionDetail.byQuantitySameProduct")," :"):c("components.productPromotionDetail.byQuantitySameProduct"))),A&&Y(k.default,{span:10},Y(D.default,{title:"".concat(c("components.productPromotionDetail.activePromotionWhenBuy")," ").concat((0,Q.oH6)(h.quantity_product,p.currency,!1)," ").concat(c("components.productPromotionDetail.anyProduct"))},Y(W.default,{currency:p.currency,value:h.quantity_same_product,callBack:function(t){return o.handleInputNumberChange(t,"quantity_same_product")},isMoney:!1})))),Y("div",{className:"promotion-info"},Y(k.default,{span:14},Y(O.default,{onChange:function(t){return o.onChangePromotionByTagProduct(t.target.checked)},checked:B},B?"".concat(c("components.productPromotionDetail.byProductTag")," :"):"".concat(c("components.productPromotionDetail.byProductTag")))),B&&Y(k.default,{span:10},Y("div",{className:"category-select"},Y(T.ZP,{value:(h.product_tags||[]).map(String),multiple:!0,allowClear:!0,treeDefaultExpandAll:!0,style:{width:300},treeData:j,onChange:function(t){var e=tt({},o.state.promotion);e.product_tags=t,o.setState({promotion:e})},filterTreeNode:function(t,o){return(0,Q.Mle)(o.props.title).indexOf((0,Q.Mle)(t))>=0},placeholder:c("components.productPromotionDetail.selectTags"),dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14}})))),Y("div",{className:"promotion-info"},Y("span",{style:{color:"#096dd9",cursor:"pointer"},onClick:function(){return o.setState({visiableSubModal:!0,activeKey:"1"})}},Y(F.Z,null)," ",c("components.productPromotionDetail.openLevelPromotion"))))),P&&Y(a.Z,{wrapClassName:"product-promotion-detail",visible:P,width:748,onCancel:function(){o.props.close(),o.setState({visiableSubModal:!1,notSetup:!1})},title:c("components.productPromotionDetail.openLevelPromotion"),footer:Y("div",{className:"promotion-footer",style:{display:"flex",alignItems:"center"}},("1"==Z||null==Z)&&Y("div",{style:{flex:1,textAlign:"left"}},Y(C.default,{icon:Y(U.Z,null),onClick:function(){return o.handleAddLevelPromotion()},type:"default"},c("components.productPromotionDetail.addLevelPromotion"))),Y("div",{style:{flex:1}},Y(C.default,{type:"primary",icon:Y(z.Z,null),onClick:function(){return o.setState({visiableSubModal:!1})}},c("components.productPromotionDetail.back"))))},Y("div",null,Y(v.default,{type:"card",defaultActiveKey:"1",onChange:function(t){return o.onChangeKey(t)}},Y(nt,{tab:c("components.productPromotionDetail.levelPromotion"),key:"1"},Y(w.Z,{columns:this.columnsLevelPromotion,dataSource:this.getData(),size:"small",pagination:!1})),Y(nt,{tab:c("components.productPromotionDetail.productPromotion"),key:"2"},Y($.Z,{accessToken:s,searchResult:N,shopId:d,onSelect:this.handleSelectPromotionProduct,callback:function(t){return o.setState({searchResult:t})}}),Y(w.Z,{columns:this.columnsPromotionalProducts,dataSource:this.getPromotionalProducts(),size:"small",pagination:!1}))))))}}]),e}(x.Component))||n,it=(0,P.$j)((function(t){return{currentShop:t.shop.currentShop,categories:(0,V.us)(t),brands:t.product.brands.data,product_tags:(0,V.o2)(t)}}),{createPromotionProduct:X.$x,updatePromotionProduct:X.v3m})(at),ct=e(43439),pt=e(22353),st=e(25592),dt=e(15873),ut=e(59465),lt=e(73171),mt=e(76570),ht=e(82891),ft=e(12386),gt=e(59361),vt=e(64713),_t=e(64749),yt=e(14321),xt=e(44908),bt=e.n(xt),Pt=e(50361),It=e.n(Pt),St=e(65988),At=e(7085),Et=e(98244),Zt=e(30381),wt=e.n(Zt),kt=e(45760),Ct=e.n(kt),Ot=e(20920),Dt=e(96129),Tt=e(50916),Nt=e(74806),Bt=e(28465),Rt=e(4863),Lt=e(7145),jt=e.n(Lt),Mt=e(90631),qt=e(84189),Ft=e(79508),Ut=e(48176),zt=e(78598),Qt=x.createElement;function Kt(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function Vt(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?Kt(Object(e),!0).forEach((function(o){(0,g.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Kt(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function Wt(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,f.Z)(t);if(o){var r=(0,f.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)}}var Ht,Gt=["discount_by_product","discount_by_order_price","fixed_prices","coupon","discount_by_coupon_id","double_reward_point","coupon_id_multiple_times","discount_by_attachment_products"],Xt=(0,j.Z)()(et=function(t){(0,m.Z)(e,t);var o=Wt(e);function e(t){var n;return(0,d.Z)(this,e),n=o.call(this,t),(0,g.Z)((0,u.Z)(n),"onDrop",(function(t){var o=t.file,e=n.props.t,r=new FileReader;r.readAsBinaryString(o),r.onload=function(t){var r=t.target.result,a=XLSX.read(r,{type:"binary"}),i=a.SheetNames[0],c=XLSX.utils.sheet_to_json(a.Sheets[i],{raw:!0});if(0!=c.length){var p=(0,Q.wOl)(a.Sheets[i]),s=n.checkFields(p);0!=s.length?(K.Z.error(e("error"),"".concat(e("components.orderImportExcel.fieldsNotFound"),": ").concat(s.join())),n.setState({promotionImportFile:[],fileName:"",disableImportBtn:!0,isImporting:!1,resultArr:[]})):n.setState({promotionImportFile:c,fileName:o.name,importedCount:0,disableImportBtn:!1,isImporting:!1})}else K.Z.error(e("error"),e("components.productImportExcel.index.fileExcelEmpty")),n.setState({disableImportBtn:!0,isImporting:!1,resultArr:[]})}})),(0,g.Z)((0,u.Z)(n),"checkFields",(function(t){return function(t){return[t("pages.shop.product.promotionAdvanceImportExcel.name"),t("pages.shop.product.promotionAdvanceImportExcel.type")]}(n.props.t).reduce((function(o,e){return-1==t.findIndex((function(t){return t==e}))&&o.push(e),o}),[])})),(0,g.Z)((0,u.Z)(n),"handleCloseModal",(function(){n.setState({modalVisible:!1,fileName:"",isImporting:!1,disableImportBtn:!0,stop:!1,resultArr:[],dataError:[]})})),(0,g.Z)((0,u.Z)(n),"confirmImport",(function(){n.setState({isShowResult:!0,disableImportBtn:!0,isImporting:!0,importedCount:0},(function(){n.sendRequest(0)}))})),(0,g.Z)((0,u.Z)(n),"handleDefineType",(function(t){var o=n.props.t,e=t;switch(t=t?(0,Q.Mle)(t):""){case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textDiscountByOrderPrice")):return"discount_by_order_price";case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textDiscountByProduct")):return"discount_by_product";case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textFixedPrice")):return"fixed_prices";case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textDoubleRewardPoint")):return"double_reward_point";case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textPromotionsByAttachmentProduct")):return"discount_by_attachment_products";case"coupon id":return"discount_by_coupon_id";case"coupon id multiple":return"coupon_id_multiple_times";case(0,Q.Mle)(o("pages.shop.product.promotionAdvance.textCoupon")):case"coupon":return"coupon";default:return e}})),(0,g.Z)((0,u.Z)(n),"handleIsVariation",(function(t){var o=n.props.t,e=t;switch(t=t?(0,Q.Mle)(t):""){case(0,Q.Mle)(o("products.title")):return!1;case(0,Q.Mle)(o("pages.shop.product.promotionAdvanceImportExcel.variation")):return!0;default:return e}})),(0,g.Z)((0,u.Z)(n),"handleIsBoolean",(function(t){var o=t;switch(t=t?(0,Q.Mle)(t):""){case"co":return"true";case"khong":return"false";case"yes":return"true";case"no":case"":return"false";default:return o}})),(0,g.Z)((0,u.Z)(n),"sendRequest",function(){var t=(0,s.Z)(p().mark((function t(o){var e,r,a,i,c,s,d,u,l,m,h,f,g,v,_,y,x,b,P,I,S,A,E,Z,w,k,C,O,D,T,N,B,R,L,j,M,q,F,U,z,K,V,W,H,X,$,Y,J,tt,ot,et,nt,rt,at,it,ct,pt,st;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.state,a=r.promotionImportFile,i=r.isImporting,c=r.importedCount,s=r.dataError,d=r.modalVisible,u=n.props,l=u.t,m=u.accessToken,h=u.shopId,f=u.createPromotionSuccess,g=u.updatePromotionSuccess,!(o>a.length-1)){t.next=5;break}return n.setState({stop:!0}),t.abrupt("return");case 5:if(v=a[o],_=n.handleDefineType(v[l("pages.shop.product.promotionAdvanceImportExcel.type")]),y=v[l("pages.shop.product.promotionAdvanceExportExcel.promotionId")],x=(v.STT||v[l("pages.shop.product.promotionAdvanceImportExcel.name")])&&v[l("pages.shop.product.promotionAdvanceImportExcel.warehouseId")]?v[l("pages.shop.product.promotionAdvanceImportExcel.warehouseId")].split(","):v[l("pages.shop.product.promotionAdvanceImportExcel.warehouseId")],b=(0,Q._MS)(v[l("pages.shop.product.promotionAdvanceImportExcel.startTime")]),P=(0,Q._MS)(v[l("pages.shop.product.promotionAdvanceImportExcel.endTime")]),I=n.handleIsVariation(v[l("pages.shop.product.promotionAdvanceImportExcel.promotionBy")]),S=v[l("pages.shop.product.promotionAdvanceImportExcel.orderSource")]?v[l("pages.shop.product.promotionAdvanceImportExcel.orderSource")].toString().trim().split(", "):null,A=v[l("pages.shop.product.promotionAdvanceImportExcel.promotionByTagsCustomer")]?v[l("pages.shop.product.promotionAdvanceImportExcel.promotionByTagsCustomer")].toString().trim().split(", "):null,E=v[l("pages.shop.product.promotionAdvanceImportExcel.applyAtShop")]?"co"==(0,Q.Mle)(v[l("pages.shop.product.promotionAdvanceImportExcel.applyAtShop")])?"offline":"online":null,Z=v[l("pages.shop.product.promotionAdvanceImportExcel.discountGeneral")]||0,w=n.handleIsBoolean(v[l("pages.shop.product.promotionAdvanceImportExcel.discountTypeGeneral")]),k=v[l("pages.shop.product.promotionAdvanceImportExcel.maxDiscountByPercent")]||0,C=v[l("pages.shop.product.promotionAdvanceImportExcel.name")]||"",C=["discount_by_coupon_id","coupon_id_multiple_times"].includes(_)&&!C?(0,Q.Cdi)():null===(e=C)||void 0===e?void 0:e.toString(),O={line_number:o+2,index:v.STT,warehouse_ids:x,start_date:b,end_date:P,name:C,type:_,is_variation:I,customer_tags:A},y&&(O=Vt(Vt({},O),{},{id:y})),["discount_by_coupon_id","coupon_id_multiple_times"].includes(_)?O=Vt(Vt({},O),{},{promo_code_info:{discount:Z,is_percent:w,max_discount_by_percent:k}}):(D=v[l("pages.shop.product.promotionAdvanceImportExcel.priority")],O=Vt(Vt({},O),{},{order_sources:S,priority_level:/^\d+$/.test(D)?D:void 0,discount_by_quantity:v[l("pages.shop.product.promotionAdvanceImportExcel.promotionByQtyProducts")],type_employee:E})),T=Vt(Vt({},T={line_number:o+2,product_id:v[l("pages.shop.product.promotionAdvanceImportExcel.productId")]?v[l("pages.shop.product.promotionAdvanceImportExcel.productId")].toString().trim():null,variation_id:v[l("pages.shop.product.promotionAdvanceImportExcel.variationId")]?v[l("pages.shop.product.promotionAdvanceImportExcel.variationId")].toString().trim():null}),{},"discount_by_attachment_products"==_?{discount_info_by_attachment_product:{discount:v[l("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]||0,is_percent:n.handleIsBoolean(v[l("pages.shop.product.promotionAdvanceImportExcel.isPercent")]),quantity:v[l("pages.shop.product.promotionAdvanceImportExcel.quantityDiscountedProduct")]||1},attachment_product_info:n.getAttachmentProductItems([v[l("pages.shop.product.promotionAdvanceExportExcel.productIdAttachment")]],o+1)}:{to_quantity:v[l("pages.shop.product.promotionAdvanceImportExcel.to")]?v[l("pages.shop.product.promotionAdvanceImportExcel.to")]:0,from_quantity:v[l("pages.shop.product.promotionAdvanceImportExcel.from")]?v[l("pages.shop.product.promotionAdvanceImportExcel.from")]:0,discount:v[l("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]?v[l("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]:0,is_percent:n.handleIsBoolean(v[l("pages.shop.product.promotionAdvanceImportExcel.isPercent")]),fixed_prices:v[l("pages.shop.product.promotionAdvanceImportExcel.fixedPrices")]?Math.round(v[l("pages.shop.product.promotionAdvanceImportExcel.fixedPrices")]):0,order_price_max:v[l("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]?v[l("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]:0,order_price_min:v[l("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]?v[l("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]:0}),N=null,"coupon"==_&&(B=v[l("pages.shop.product.promotionAdvanceImportExcel.brands")]?v[l("pages.shop.product.promotionAdvanceImportExcel.brands")].toString().trim().split(", "):null,R=v[l("pages.shop.product.promotionAdvanceImportExcel.categories")]?v[l("pages.shop.product.promotionAdvanceImportExcel.categories")].toString().trim().split(", "):null,L=v[l("pages.shop.product.promotionAdvanceImportExcel.toPrice")]||0,j=v[l("pages.shop.product.promotionAdvanceImportExcel.fromPrice")]||0,M=v[l("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship")]||0,q=v[l("pages.shop.product.promotionAdvanceImportExcel.byProductTags")]?v[l("pages.shop.product.promotionAdvanceImportExcel.byProductTags")].toString().trim().split(", "):null,F=v[l("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts")]||0,U=v[l("pages.shop.product.promotionAdvanceImportExcel.discountUperQty")]||0,z=v[l("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct")]||0,K=v[l("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")]||0,V=v[l("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")]||0,W=v[l("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel")]?v[l("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel")].toString().trim():null,K>0&&V>0&&(N={productQuantity:K,discountPerOneProduct:V,categories:W}),O=Vt(Vt({},O),{},{coupon_info:{discount:Z,is_percent:w},is_discount_in_birthday_customer:n.handleIsBoolean(v[l("pages.shop.product.promotionAdvanceImportExcel.birthday")])}),j>=0&&L>0&&(O.coupon_info.end_price_product=L,O.coupon_info.start_price_product=j),B&&(O.coupon_info.brand_ids=B),R&&(O.coupon_info.category_ids=R),M>0&&(O.coupon_info.quantity_to_freeship=M),q&&(O.coupon_info.product_tags=q),(F>0||U>0)&&(O.coupon_info.upper_product_index=F,O.coupon_info.upper_product_discount=U),z>0&&(O.coupon_info.quantity_same_product=z),T=Vt(Vt({},T),{},{coupon_item_info:{discount:v[l("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]||0,is_percent:n.handleIsBoolean(v[l("pages.shop.product.promotionAdvanceImportExcel.isPercent")])}})),H=n.validateFields(o,v,o),!H){t.next=47;break}return t.next=32,n.getVariationNextLine([T],o+1,1,!0,_);case 32:if(X=t.sent,$=X.items,Y=X.count,X.isError,n.setState(jt()(n.state,{resultArr:{$push:[{message:H,success:!1}]},importedCount:{$set:c+Y}})),O=Vt(Vt({},O),{},{items:$}),!N){t.next=45;break}return t.next=41,n.getArrLevelPromotion([N],o+1);case 41:J=t.sent,tt=J.itemLevels,J.isErrorLevel,O=Vt(Vt({},O),{},{arr_level_promotion:tt});case 45:return s.push(O),t.abrupt("return",n.sendRequest(o+Y));case 47:return t.next=49,n.getVariationNextLine([T],o+1,1,!1,_);case 49:if(ot=t.sent,et=ot.items,nt=ot.count,rt=ot.isError,!N){t.next=59;break}return t.next=56,n.getArrLevelPromotion([N],o+1);case 56:t.t0=t.sent,t.next=60;break;case 59:t.t0={itemLevels:[]};case 60:if(at=t.t0,it=at.itemLevels,ct=at.isErrorLevel,!rt&&!ct){t.next=68;break}return O=Vt(Vt({},O),{},{items:et,arr_level_promotion:it}),s.push(O),n.setState({importedCount:o+nt}),t.abrupt("return",n.sendRequest(o+nt));case 68:pt=et.filter((function(t){return["discount_by_product","fixed_prices","coupon","discount_by_attachment_products"].includes(_)&&(I&&t.product_id&&t.variation_id||!I&&t.product_id)||"discount_by_order_price"==_})),pt=["discount_by_order_price","discount_by_coupon_id","coupon_id_multiple_times","discount_by_product"].includes(_)?pt:n.handleMergeItemDuplicate(pt,I,_),O=Vt(Vt({},O),{},{arr_level_promotion:it,items:pt}),d&&i&&(st="".concat((0,Q.LpH)(),"/shops/").concat(h,"/promotion_advance/import?access_token=").concat(m),G().post(st,{promotion:O}).then((function(t){var e=t.data;return e.success?(n.setState(jt()(n.state,{resultArr:{$push:[{message:null,success:!0}]}})),y?g(e.data):f(e.data)):(s.push(O),n.setState(jt()(n.state,{resultArr:{$push:[{message:e.message,success:!1}]}}))),n.setState({importedCount:c+1}),n.sendRequest(o+nt)})).catch((function(t){s.push(O),n.setState(jt()(n.state,{resultArr:{$push:[{message:l("action.unknownError"),success:!1}]},importedCount:{$set:c+1}})),n.sendRequest(o+nt)})));case 72:case"end":return t.stop()}}),t)})));return function(o){return t.apply(this,arguments)}}()),(0,g.Z)((0,u.Z)(n),"handleMergeItemDuplicate",(function(t,o,e){var r=n.props.t;return t.reduce((function(t,a){var i;if((i=o?t.findIndex((function(t){return(0,Q.Mle)(t.product_id)==(0,Q.Mle)(a.product_id)&&(0,Q.Mle)(t.variation_id)==(0,Q.Mle)(a.variation_id)})):t.findIndex((function(t){return(0,Q.Mle)(t.product_id)==(0,Q.Mle)(a.product_id)})))<0)t.push(a);else{var c=o?"".concat(r("pages.shop.product.variation.variationId")," #").concat(a.variation_id," ").concat(r("pages.shop.product.promotionAdvanceImportExcel.ofProduct")," #").concat(a.product_id):"".concat(r("pages.shop.product.variation.productId")," #").concat(a.product_id);switch(c="".concat(r("components.productImportExcel.index.errorNumber")," ").concat(a.line_number,": ").concat(c," ").concat(r("pages.shop.product.promotionAdvanceImportExcel.duplicated")),e){case"coupon":t[i].coupon_item_info.is_percent==a.coupon_item_info.is_percent&&t[i].coupon_item_info.discount==a.coupon_item_info.discount&&(c=null);break;case"fixed_prices":t[i].fixed_prices==a.fixed_prices&&(c=null)}c&&function(t){n.setState(jt()(n.state,{resultArr:{$push:[{message:t,success:!1,title:"error"}]}}))}(c)}return t}),[])})),(0,g.Z)((0,u.Z)(n),"getArrLevelPromotion",(function(t,o){var e=n.props.t,r=n.state.promotionImportFile,a=r[o];if(o>r.length-1||a.STT||a[e("pages.shop.product.promotionAdvanceImportExcel.name")]||!a[e("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")])return{itemLevels:t};var i={productQuantity:a[e("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")]||0,discountPerOneProduct:a[e("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")]||0,categories:a[e("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel")]?a[e("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel")].toString().trim():null};return n.getArrLevelPromotion(t.concat(i),o+1)})),(0,g.Z)((0,u.Z)(n),"getAttachmentProductItems",(function(t,o){var e=n.state.promotionImportFile,r=n.props.t,a=e[o];return o>e.length-1||a.STT||a[r("pages.shop.product.promotionAdvanceImportExcel.productId")]?t:(t.push(a[r("pages.shop.product.promotionAdvanceExportExcel.productIdAttachment")]),n.getAttachmentProductItems(t,o+1))})),(0,g.Z)((0,u.Z)(n),"getVariationNextLine",(function(t,o,e,r,a){var i=n.state.promotionImportFile,c=n.props.t,p=i[o];if(o>i.length-1||p.STT||p[c("pages.shop.product.promotionAdvanceImportExcel.name")])return{items:t,count:e,isError:r};var s={line_number:o+2,product_id:p[c("pages.shop.product.promotionAdvanceImportExcel.productId")]?p[c("pages.shop.product.promotionAdvanceImportExcel.productId")].toString().trim():null,variation_id:p[c("pages.shop.product.promotionAdvanceImportExcel.variationId")]?p[c("pages.shop.product.promotionAdvanceImportExcel.variationId")].toString().trim():null};s=Vt(Vt({},s),{},"discount_by_attachment_products"==a?{discount_info_by_attachment_product:{discount:p[c("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]||0,is_percent:n.handleIsBoolean(p[c("pages.shop.product.promotionAdvanceImportExcel.isPercent")]),quantity:p[c("pages.shop.product.promotionAdvanceImportExcel.quantityDiscountedProduct")]||1},attachment_product_info:n.getAttachmentProductItems([p[c("pages.shop.product.promotionAdvanceExportExcel.productIdAttachment")]],o+1)}:{to_quantity:p[c("pages.shop.product.promotionAdvanceImportExcel.to")]?p[c("pages.shop.product.promotionAdvanceImportExcel.to")]:0,from_quantity:p[c("pages.shop.product.promotionAdvanceImportExcel.from")]?p[c("pages.shop.product.promotionAdvanceImportExcel.from")]:0,discount:p[c("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]?p[c("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]:0,is_percent:n.handleIsBoolean(p[c("pages.shop.product.promotionAdvanceImportExcel.isPercent")]),fixed_prices:p[c("pages.shop.product.promotionAdvanceImportExcel.fixedPrices")]?Math.round(p[c("pages.shop.product.promotionAdvanceImportExcel.fixedPrices")]):0,order_price_max:p[c("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]?p[c("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]:0,order_price_min:p[c("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]?p[c("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]:0}),"coupon"==a&&(s=Vt(Vt({},s),{},{coupon_item_info:{discount:p[c("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]||0,is_percent:n.handleIsBoolean(p[c("pages.shop.product.promotionAdvanceImportExcel.isPercent")])}}));var d=n.validateFields(o,p,null);return d?(n.setState(jt()(n.state,{resultArr:{$push:[{message:d,success:!1}]}})),n.getVariationNextLine(t.concat(s),o+1,e+1,!0,a)):n.getVariationNextLine(t.concat(s),o+1,e+1,r,a)})),(0,g.Z)((0,u.Z)(n),"validateFields",(function(t,o,e){var r=n.props,a=r.t,i=r.currentShop.currency,c=Q.cvg.includes(i),p="".concat(a("components.productImportExcel.index.errorNumber")," ").concat(t+2,": "),s=n.handleDefineType(o[a("pages.shop.product.promotionAdvanceImportExcel.type")]),d=n.handleIsVariation(o[a("pages.shop.product.promotionAdvanceImportExcel.promotionBy")]),u=n.handleIsBoolean(o[a("pages.shop.product.promotionAdvanceImportExcel.isPercent")]);return Gt.includes(s)||null==e||e.toString()!=t.toString()||(p+=a("pages.shop.product.promotionAdvanceImportExcel.errType")),o[a("pages.shop.product.promotionAdvanceImportExcel.name")]||null==e||e.toString()!=t.toString()||(p+=a("pages.shop.product.promotionAdvanceImportExcel.errNamePromotion")),(o[a("pages.shop.product.promotionAdvanceImportExcel.to")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.to")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.to")]<0)||o[a("pages.shop.product.promotionAdvanceImportExcel.from")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.from")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.from")]<0))&&(p+=a("components.productImportExcel.index.quantityValue")),o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]))&&c||o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]<0)&&(p+=a("pages.shop.product.promotionAdvanceImportExcel.inputPrice")),o[a("pages.shop.product.promotionAdvanceExportExcel.promotionId")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceExportExcel.promotionId")]))&&c||o[a("pages.shop.product.promotionAdvanceExportExcel.promotionId")]<0)&&(p+=a("pages.shop.product.promotionAdvanceImportExcel.errorId")),["discount_by_product","discount_by_order_price"].includes(s)&&!["false","true"].includes(u)&&(p+=a("pages.shop.product.promotionAdvanceImportExcel.errPercent")),null!=e&&e.toString()==t.toString()&&["discount_by_product","fixed_prices"].includes(s)&&"boolean"!=typeof d&&(p+=a("pages.shop.product.promotionAdvanceImportExcel.errPromotionBy")),null==e||e.toString()!=t.toString()||!["discount_by_product","fixed_prices"].includes(s)||!d||o[a("pages.shop.product.promotionAdvanceImportExcel.productId")]&&o[a("pages.shop.product.promotionAdvanceImportExcel.variationId")]||(p+=a("pages.shop.product.promotionAdvanceImportExcel.errCustomId")),null==e||e.toString()!=t.toString()||!["discount_by_product","fixed_prices"].includes(s)||d||o[a("pages.shop.product.promotionAdvanceImportExcel.productId")]||(p+=a("pages.shop.product.promotionAdvanceImportExcel.errProductId")),(o[a("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder")]<0)||o[a("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]&&(!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder")]<0))&&(p+=a("components.productImportExcel.index.inputPrice")),(o[a("pages.shop.product.promotionAdvanceImportExcel.toPrice")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.toPrice")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.toPrice")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.toPrice")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.fromPrice")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.fromPrice")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.fromPrice")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.fromPrice")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.discountUperQty")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.discountUperQty")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.discountUperQty")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.discountUperQty")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.discountPrice")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),(o[a("pages.shop.product.promotionAdvanceImportExcel.discountGeneral")]&&!Number.isInteger((0,Q.WNN)(o[a("pages.shop.product.promotionAdvanceImportExcel.discountGeneral")]))||o[a("pages.shop.product.promotionAdvanceImportExcel.discountGeneral")]<0)&&(p+="".concat(a("pages.shop.product.promotionAdvanceImportExcel.discountGeneral")," ").concat(a("pages.shop.product.promotionAdvanceImportExcel.errInteger"),". ")),p!="".concat(a("components.productImportExcel.index.errorNumber")," ").concat(t+2,": ")&&p})),(0,g.Z)((0,u.Z)(n),"renderError",(function(){return n.state.resultArr.map((function(t,o){var e=o+1;return t.success?void 0:Qt("div",{key:o,style:{width:"100%",color:"red"}},Qt("span",null," ",Qt("strong",null,"#".concat(e))," "),"\xa0",Qt("span",{className:"text-danger"}," ",t.message," "))}))})),(0,g.Z)((0,u.Z)(n),"renderSuccess",(function(){var t=n.state.resultArr,o=n.props.t;return t.map((function(t,e){var n=e+1;return t.success?Qt("div",{key:e,style:{width:"100%",color:"green"}},Qt("span",null," ",Qt("strong",null,"#".concat(n))," "),"\xa0",Qt("span",{className:"text-success"},o("success"))):void 0}))})),(0,g.Z)((0,u.Z)(n),"handleParseBoolean",(function(t){var o=n.props.i18n;switch(t){case"true":return"vi"==o.language?"c\xf3":"yes";case"false":return"vi"==o.language?"kh\xf4ng":"no";default:return t}})),(0,g.Z)((0,u.Z)(n),"downloadListError",(function(){var t=n.state.dataError,o=n.props,e=o.t,r=o.i18n,a=[];t.map((function(t){var o,i="";switch(t.type){case"discount_by_order_price":i=e("pages.shop.product.promotionAdvance.textDiscountByOrderPrice");break;case"discount_by_product":i=e("pages.shop.product.promotionAdvance.textDiscountByProduct");break;case"fixed_prices":i=e("pages.shop.product.promotionAdvance.textFixedPrice");break;case"coupon":i="coupon";break;case"discount_by_coupon_id":i="coupon id";break;case"coupon_id_multiple_times":i="coupon id multiple";break;case"double_reward_point":i=e("pages.shop.product.promotionAdvance.textDoubleRewardPoint");break;default:i=t.type}var c="";switch(t.is_variation){case!1:c=e("products.title");break;case!0:c=e("pages.shop.product.promotionAdvanceImportExcel.variation");break;default:c=t.is_variation}var p,s,d,u,l,m,h,f,v,_,y,x=(t.warehouse_ids||[]).join(","),b=t.type_employee?"offline"==t.type_employee?"vi"==r.language?"C\xf3":"yes":"vi"==r.language?"Kh\xf4ng":"no":"",P=(o={STT:t.index||""},(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.name"),t.name||""),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.warehouseId"),x||""),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.startTime"),t.start_date||""),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.endTime"),t.end_date||""),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.promotionBy"),c),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.type"),i||""),(0,g.Z)(o,e("pages.shop.product.promotionAdvanceImportExcel.promotionByTagsCustomer"),(t.customer_tags||[]).join(", ")),o);["discount_by_coupon_id","coupon_id_multiple_times"].includes(t.type)||(P=Vt(Vt({},P),{},(p={},(0,g.Z)(p,e("pages.shop.product.promotionAdvanceImportExcel.promotionByQtyProducts"),t.discount_by_quantity||""),(0,g.Z)(p,e("pages.shop.product.promotionAdvanceImportExcel.priority"),t.priority_level||""),(0,g.Z)(p,e("pages.shop.product.promotionAdvanceImportExcel.orderSource"),(t.order_sources||[]).join(", ")),(0,g.Z)(p,e("pages.shop.product.promotionAdvanceImportExcel.applyAtShop"),b),p)));"coupon"==t.type&&(P=Vt(Vt({},P),{},(y={},(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.birthday"),n.handleParseBoolean(t.is_discount_in_birthday_customer)),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.discountGeneral"),t.coupon_info.discount),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.discountTypeGeneral"),n.handleParseBoolean(t.coupon_info.is_percent)),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.fromPrice"),(null===(s=t.coupon_info)||void 0===s?void 0:s.start_price_product)||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.fromPrice"),(null===(d=t.coupon_info)||void 0===d?void 0:d.end_price_product)||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.brands"),((null===(u=t.coupon_info)||void 0===u?void 0:u.brand_ids)||[]).join(", ")),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.categories"),((null===(l=t.coupon_info)||void 0===l?void 0:l.category_ids)||[]).join(", ")),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship"),null===(m=t.coupon_info)||void 0===m?void 0:m.quantity_to_freeship),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.byProductTags"),((null===(h=t.coupon_info)||void 0===h?void 0:h.product_tags)||[]).join(", ")),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.byUperQtyProduts"),(null===(f=t.coupon_info)||void 0===f?void 0:f.upper_product_index)||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.discountUperQty"),(null===(v=t.coupon_info)||void 0===v?void 0:v.upper_product_discount)||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.qtySameProduct"),(null===(_=t.coupon_info)||void 0===_?void 0:_.quantity_same_product)||""),y)));t.items.map((function(o,r){var i=n.handleParseBoolean(o.is_percent);if(0==r){var c,p,s,d,u,l;if(P=Vt(Vt({},P),{},(c={},(0,g.Z)(c,e("pages.shop.product.promotionAdvanceImportExcel.productId"),o.product_id||""),(0,g.Z)(c,e("pages.shop.product.promotionAdvanceImportExcel.variationId"),o.variation_id||""),c)),"coupon"==t.type)P=Vt(Vt({},P),{},(u={},(0,g.Z)(u,e("pages.shop.product.promotionAdvanceImportExcel.discountPrice"),o.coupon_item_info.discount>0?o.coupon_item_info.discount:""),(0,g.Z)(u,e("pages.shop.product.promotionAdvanceImportExcel.isPercent"),n.handleParseBoolean(o.coupon_item_info.is_percent)),(0,g.Z)(u,e("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel"),null===(p=t.arr_level_promotion[r])||void 0===p?void 0:p.productQuantity),(0,g.Z)(u,e("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct"),null===(s=t.arr_level_promotion[r])||void 0===s?void 0:s.discountPerOneProduct),(0,g.Z)(u,e("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel"),null===(d=t.arr_level_promotion[r])||void 0===d?void 0:d.categories),u));else P=Vt(Vt({},P),{},(l={},(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.to"),o.to_quantity||""),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.from"),o.from_quantity||""),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.discountPrice"),o.discount||""),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.isPercent"),i),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.fixedPrices"),o.fixed_prices||""),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder"),o.order_price_max||""),(0,g.Z)(l,e("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder"),o.order_price_min||""),l));a.push(P)}else{var m,h,f,v,_,y,x=(m={},(0,g.Z)(m,e("pages.shop.product.promotionAdvanceImportExcel.productId"),o.product_id||""),(0,g.Z)(m,e("pages.shop.product.promotionAdvanceImportExcel.variationId"),o.variation_id||""),m);if("coupon"==t.type)x=Vt(Vt({},x),{},(_={},(0,g.Z)(_,e("pages.shop.product.promotionAdvanceImportExcel.discountPrice"),o.coupon_item_info.discount>0?o.coupon_item_info.discount:""),(0,g.Z)(_,e("pages.shop.product.promotionAdvanceImportExcel.isPercent"),n.handleParseBoolean(o.coupon_item_info.is_percent)),(0,g.Z)(_,e("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel"),null===(h=t.arr_level_promotion[r])||void 0===h?void 0:h.productQuantity),(0,g.Z)(_,e("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct"),null===(f=t.arr_level_promotion[r])||void 0===f?void 0:f.discountPerOneProduct),(0,g.Z)(_,e("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel"),null===(v=t.arr_level_promotion[r])||void 0===v?void 0:v.categories),_));else x=Vt(Vt({},x),{},(y={},(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.to"),o.to_quantity||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.from"),o.from_quantity||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.discountPrice"),o.discount||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.isPercent"),i),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.fixedPrices"),o.fixed_prices||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder"),o.order_price_max||""),(0,g.Z)(y,e("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder"),o.order_price_min||""),y));a.push(x)}}))}));var i={SheetNames:[],Sheets:{}},c=XLSX.utils.json_to_sheet(a);a.length&&(c["!cols"]=Object.keys(a[0]).map((function(t){var o=t?10*t.toString().length:150;return{wpx:o>120?o:120}})));XLSX.utils.book_append_sheet(i,c,"DataSheet 1");var p=XLSX.write(i,{bookType:"xlsx",bookSST:!1,type:"binary"});(0,zt.saveAs)(new Blob([(0,Q.$iI)(p)],{type:""}),"error_file_promotion_advance.xlsx")})),(0,g.Z)((0,u.Z)(n),"renderListFileError",(function(){var t=n.props.t;return Qt("div",{style:{textAlign:"center",paddingTop:10}},Qt("span",{style:{marginTop:10,fontSize:15}},"".concat(t("pages.shop.product.promotionAdvanceImportExcel.downloadErrorListFilePromotion"),": ")),Qt("strong",{style:{cursor:"pointer",color:"#f46e65",fontWeight:"bold"},onClick:function(){return n.downloadListError()}},Qt(Mt.Z,{style:{color:"#f46e65"}})," ",t("components.productPurchaseImportExcel.here")))})),n.state={modalVisible:!1,isImporting:!1,fileName:"",disableImportBtn:!0,promotionImportFile:[],resultArr:[],dataError:[],stop:!1},n}return(0,l.Z)(e,[{key:"render",value:function(){var t=this,o=this.props,e=(o.currentShop,o.t),n=o.i18n,r=this.state,i=r.isImporting,c=r.modalVisible,p=r.fileName,s=r.disableImportBtn,d=r.importedCount,u=r.promotionImportFile,l=r.stop,m=r.resultArr,h=r.dataError,f=m.filter((function(t){return t.success})).length,g=m.filter((function(t){return!t.success&&!t.title})).length,v=u.filter((function(t){return t.STT})).length||u.length,_="vi"==n.language?"/static/files/import_promotions.xlsx":"/static/files/import_promotions_english.xlsx";return Qt("div",{style:{display:"inline"}},Qt(Z.Z,{icon:Qt(qt.Z,null),title:e("pages.shop.product.promotionAdvanceImportExcel.importPromotionFormExcel"),onClick:function(){return t.setState({modalVisible:!0})},isButton:!0}),c&&Qt(a.Z,{title:e("pages.shop.product.promotionAdvanceImportExcel.importPromotionFormExcel"),footer:null,visible:c,onCancel:this.handleCloseModal},!i&&Qt("div",null,Qt(Rt.default,{message:e("notes"),description:Qt("div",{style:{fontSize:14}},Qt("p",null,"- ",e("pages.shop.product.promotionAdvanceImportExcel.writtenInTheCorrectFormatExport")," (",Qt("a",{target:"_blank",onClick:function(t){return t.stopPropagation()},href:_},e("pages.shop.product.promotionAdvanceImportExcel.sampleFile")),")")),type:"warning",showIcon:!0}),Qt("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10}},Qt(Bt.Z,{accept:".xlsx, .xls",showUploadList:!1,multiple:!1,customRequest:this.onDrop},Qt(C.default,{style:{maxWidth:150,textOverflow:"ellipsis",overflow:"hidden"}},p?Qt("span",null,Qt(Ft.Z,null),p):Qt("span",null,Qt(Ut.Z,null)," ",e("components.productPurchaseImportExcel.chooseFile")))),Qt(C.default,{type:"primary",onClick:this.confirmImport,disabled:s},e("components.productPurchaseImportExcel.start")))),Qt("div",null,d<u.length&&i?Qt("div",{style:{width:520,display:"flex",flexDirection:"column",alignItems:"center"}},Qt(Nt.default,{type:"circle",percent:Math.floor(100*d/v),style:{marginBottom:10}})):null,i&&d==u.filter((function(t){return void 0!=t.STT})).length&&d>0?Qt("h4",{style:{textAlign:"center"}},Qt("span",{style:{color:"#00a854"}},"".concat(e("components.productImportExcel.index.importSuccess")," ").concat(f," ").concat(e("pages.shop.product.promotionAdvanceImportExcel.promotion"))),Qt("span",{style:{color:"#f04134"}},"".concat(g>0?", ".concat(e("pages.admin.failure")," ").concat(g," ").concat(e("pages.shop.product.promotionAdvanceImportExcel.promotion")):""))):null,i?Qt("div",{style:{maxHeight:700,width:"100%",display:"flex",flexDirection:"column",border:"1px solid #d9d9d9",borderRadius:2,marginTop:10,padding:10,overflow:"auto"},id:"importing-info"},this.renderError(),this.renderSuccess()):null),Qt("div",null,l&&h&&h.length>0?this.renderListFileError():"")))}}]),e}(x.Component))||et,$t=(0,P.$j)((function(t){return{currentShop:t.shop.currentShop}}),{createPromotionSuccess:X.wPu,updatePromotionSuccess:X.UGz})(Xt),Yt=e(89734),Jt=e.n(Yt),to=x.createElement;function oo(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function eo(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?oo(Object(e),!0).forEach((function(o){(0,g.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):oo(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function no(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,f.Z)(t);if(o){var r=(0,f.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)}}var ro,ao=(0,j.Z)()(Ht=function(t){(0,m.Z)(e,t);var o=no(e);function e(t){var n;return(0,d.Z)(this,e),n=o.call(this,t),(0,g.Z)((0,u.Z)(n),"handleFetchData",(0,s.Z)(p().mark((function t(){var o,e,r,a,i,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.setState({isDownloading:!0,promotionAdvances:[]}),o=n.props,e=o.accessToken,r=o.shopId,o.t,a=o.selectedRowKeys,o.fetchPromotionAdvance,i={page:-1,selectedRowKeys:a,export:!0},c="".concat((0,Q.LpH)(),"/shops/").concat(r,"/promotion_advance?access_token=").concat(e),t.abrupt("return",G()({method:"get",url:c,params:i}).then((function(t){t.data.success&&n.setState({promotionAdvances:t.data.data,isDownloading:!1},(function(){return n.handleExportExcel()}))})));case 5:case"end":return t.stop()}}),t)})))),(0,g.Z)((0,u.Z)(n),"columns",(function(){var t=n.props.t;return[{header:"STT",key:"stt",width:10},{header:t("pages.shop.product.promotionAdvanceExportExcel.promotionId"),key:"id",width:10},{header:t("pages.shop.product.promotionAdvanceImportExcel.name"),key:"name_promotion",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.warehouseId"),key:"wh",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.startTime"),key:"start_date",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.endTime"),key:"end_date",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.promotionBy"),key:"by_promotion",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.type"),key:"type",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.applyAtShop"),key:"received_at_shop",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.priority"),key:"priority",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.orderSource"),key:"order_source",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.promotionByTagsCustomer"),key:"tags_customer",width:15},{header:t("pages.shop.product.promotionAdvanceImportExcel.promotionByQtyProducts"),key:"discount_by_quantity",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.discountGeneral"),key:"general_discount",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.discountTypeGeneral"),key:"general_percent",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.maxDiscountByPercent"),key:"max_discount_by_percent",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.quantityToFreeship"),key:"quantity_to_free_ship",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.categories"),key:"categories",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.birthday"),key:"is_discount_in_birthday_customer",width:20},{header:t("pages.shop.product.promotionAdvanceExportExcel.productName"),key:"product_name",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.productId"),key:"product_id",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.variationId"),key:"variation_id",width:20},{header:t("pages.shop.product.management.retailPrice"),key:"retail_price",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.minPriceOrder"),key:"min_price_order",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.maxPriceOrder"),key:"max_price_order",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.quantityDiscountedProduct"),key:"quantity_discounted_product",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.discountPrice"),key:"discount",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.isPercent"),key:"percent",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.from"),key:"from_quantity",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.to"),key:"to_quantity",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.fixedPrices"),key:"fixed",width:20},{header:t("pages.shop.product.promotionAdvanceExportExcel.productNameAttachment"),key:"product_name_attachment",width:20},{header:t("pages.shop.product.promotionAdvanceExportExcel.productIdAttachment"),key:"product_id_attachment",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.productQtyLevel"),key:"product_qty_level",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.discountOfProduct"),key:"discount_of_product",width:20},{header:t("pages.shop.product.promotionAdvanceImportExcel.categoriesLevel"),key:"categories_level",width:20},{header:t("pages.shop.product.promotionAdvanceExportExcel.freeShip"),key:"free_shipping",width:20}]})),(0,g.Z)((0,u.Z)(n),"handleExportExcel",(function(){var t=n.state.promotionAdvances,o=n.props.t,e=new ExcelJS.Workbook,r=e.addWorksheet("My Sheet");return r.columns=n.columns(),t.map((function(t,e){var a,i,c,p,s=null!==(a=t.warehouse_ids)&&void 0!==a&&a.length?n.props.warehouses.filter((function(o){return t.warehouse_ids.includes(o.id)})).filter((function(t){return t})):[],d=[];s.map((function(t){d.push(t.id)}));var u,l,m,h,f,g=(0,Ot.hq)(t.type,!0),v=[],_={};"coupon"==t.type&&(_=eo(eo({},_),{},{categories:null!==(u=t.coupon_info)&&void 0!==u&&u.categories?t.coupon_info.categories.map((function(t){return t.name})).join(", "):null,general_discount:(null===(l=t.coupon_info)||void 0===l?void 0:l.discount)||0,general_percent:null!==(m=t.coupon_info)&&void 0!==m&&m.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no"),max_discount_by_percent:(null===(h=t.coupon_info)||void 0===h?void 0:h.max_promotion_by_percent)||0,is_discount_in_birthday_customer:null!==(f=t.coupon_info)&&void 0!==f&&f.is_discount_in_birthday_customer?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no")}));null!==(i=t.items)&&void 0!==i&&i.length&&["discount_by_product","fixed_prices","coupon","discount_by_attachment_products"].includes(t.type)?Jt()(t.items,"inserted_at").map((function(e,n){if("discount_by_product"==t.type){var r=[];(e.level_info||[]).map((function(n){r.push({product_name:t.is_variation?e.variation.product.name:e.product.name,product_id:t.is_variation?e.variation.product.custom_id||e.variation.product.display_id:e.product.custom_id||e.product.display_id,variation_id:t.is_variation?e.variation.custom_id||e.variation.display_id:null,retail_price:t.is_variation?e.variation.retail_price:null,to_quantity:n.to_quantity,from_quantity:n.from_quantity,discount:n.discount,percent:n.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no")})})),v=v.concat(r)}var a,i;("fixed_prices"==t.type&&v.push({product_name:t.is_variation?e.variation.product.name:e.product.name,product_id:t.is_variation?e.variation.product.custom_id||e.variation.product.display_id:e.product.custom_id||e.product.display_id,variation_id:t.is_variation?e.variation.custom_id||e.variation.display_id:null,retail_price:t.is_variation?e.variation.retail_price:null,fixed:e.fixed_prices||0}),"coupon"==t.type)&&(_=n?{}:eo({},_),v.push(eo(eo({},_),{},{product_name:t.is_variation?e.variation.product.name:e.product.name,product_id:t.is_variation?e.variation.product.custom_id||e.variation.product.display_id:e.product.custom_id||e.product.display_id,variation_id:t.is_variation?e.variation.custom_id||e.variation.display_id:null,retail_price:t.is_variation?e.variation.retail_price:null,discount:(null===(a=e.coupon_item_info)||void 0===a?void 0:a.discount)||0,percent:null!==(i=e.coupon_item_info)&&void 0!==i&&i.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no")})));if("discount_by_attachment_products"==t.type){var c,p,s,d,u={product_name:e.product.name,product_id:e.product.custom_id||e.product.display_id,quantity_discounted_product:null===(c=e.discount_info_by_attachment_product)||void 0===c?void 0:c.quantity,discount:(null===(p=e.discount_info_by_attachment_product)||void 0===p?void 0:p.discount)||0,percent:null!==(s=e.discount_info_by_attachment_product)&&void 0!==s&&s.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no")};null!==(d=e.attachment_products)&&void 0!==d&&d.length?e.attachment_products.map((function(t,o){o?v.push({product_name_attachment:t.name,product_id_attachment:t.custom_id||t.display_id}):v.push(eo(eo({},u),{},{product_name_attachment:t.name,product_id_attachment:t.custom_id||t.display_id}))})):v.push(u)}})):"coupon"==t.type&&v.push(_);"coupon"==t.type&&null!==(c=t.arr_level_promotion)&&void 0!==c&&c.length&&t.arr_level_promotion.map((function(t,o){var e={product_qty_level:t.productQuantity,discount_of_product:t.discountPerOneProduct,categories_level:n.getCategoryName(n.props.categories,t.categories)};v[o]?v[o]=eo(eo({},v[o]),e):v.push(e)})),"discount_by_order_price"==t.type&&null!==(p=t.level_order_prices)&&void 0!==p&&p.length&&t.level_order_prices.map((function(t){v.push({max_price_order:t.order_price_max||0,min_price_order:t.order_price_min||0,discount:t.discount||0,percent:t.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no")})}));var y=function(t,e,n){var r,a,i,c,p,s,u={stt:n?null:e+1,id:n?null:t.display_id,wh:n?null:d?d.join(", "):null,name_promotion:n?null:t.name,start_date:n?null:t.start_time?wt()(t.start_time).format("DD/MM/YYYY HH:mm"):null,end_date:n?null:t.end_time?wt()(t.end_time).format("DD/MM/YYYY HH:mm"):null,by_promotion:n?null:t.is_variation?o("components.productPromotionDetail.variation"):o("products.title"),type:n?null:g,discount_by_quantity:n?null:t.discount_by_quantity,free_shipping:n?null:t.is_free_shipping?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no"),received_at_shop:n?null:"online"==t.type_employee?o("pages.shop.product.promotionAdvanceExportExcel.no"):o("pages.shop.product.promotionAdvanceExportExcel.yes"),priority:n?null:t.priority_level,order_source:n?null:(0,Q.wiK)(t.order_sources),tags_customer:n?null:(t.customer_tags||[]).join(", "),quantity_to_free_ship:n?null:(null===(r=t.coupon_info)||void 0===r?void 0:r.quantity_to_freeship)||""};["discount_by_coupon_id","coupon_id_multiple_times"].includes(t.type)&&(u=eo(eo({},u),{},{general_discount:n?null:(null===(a=t.promo_code_info)||void 0===a?void 0:a.discount)||0,general_percent:n?null:null!==(i=t.promo_code_info)&&void 0!==i&&i.is_percent?o("pages.shop.product.promotionAdvanceExportExcel.yes"):o("pages.shop.product.promotionAdvanceExportExcel.no"),max_discount_by_percent:n?null:(null===(c=t.promo_code_info)||void 0===c?void 0:c.max_promotion_by_percent)||0,min_price_order:n?null:(null===(p=t.promo_code_info)||void 0===p?void 0:p.order_price_min)||0,max_price_order:n?null:(null===(s=t.promo_code_info)||void 0===s?void 0:s.order_price_max)||0}));return u};v.length?v.map((function(o,n){r.addRow(eo(eo({},y(t,e,n)),o))})):r.addRow(y(t,e,0))})),r.getRow(1).font={size:12,bold:!0},e.xlsx.writeBuffer().then((function(t){(0,zt.saveAs)(new Blob([t],{type:"application/octet-stream"}),"export_promotion_advance.xlsx")}))})),(0,g.Z)((0,u.Z)(n),"getCategoryName",(function(t,o){var e=t.findIndex((function(t){return t.id==o}));if(e>-1)return t[e].text;var r=[];return t.map((function(t){var o;null!==(o=t.nodes)&&void 0!==o&&o.length&&(r=r.concat(t.nodes))})),r.length?n.getCategoryName(r,o):void 0})),n.state={isDownloading:!1,promotionAdvances:[]},n}return(0,l.Z)(e,[{key:"render",value:function(){var t=this.props.t,o=this.state.isDownloading;return to("div",{style:{display:"inline"}},to(Z.Z,{title:t("pages.shop.product.promotionAdvanceExportExcel.downloadPromotionAdvance"),icon:to(o?At.Z:Mt.Z,null),onClick:this.handleFetchData,disabled:o,isButton:!0}))}}]),e}(x.Component))||Ht,io=(0,P.$j)((function(t){return{warehouses:(0,V.op)(t),categories:t.product.categories}}),{})(ao),co=e(7690),po=e(37508),so=e(32745),uo=e(88460),lo=e(41850),mo=e(45812),ho=e(90798),fo=e(71586),go=x.createElement;function vo(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function _o(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?vo(Object(e),!0).forEach((function(o){(0,g.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):vo(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function yo(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,f.Z)(t);if(o){var r=(0,f.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)}}var xo=yt.default.RangePicker,bo=_t.default.Option,Po=vt.default.Group,Io=vt.default.Button,So=v.default.TabPane,Ao={name:"",start_time:null,end_time:null,warehouse_ids:["-1"],customer_tags:[],order_sources:[],type_employee:"all",type:"",level_order_prices:[],items:[],is_activated:!0,is_variation:!0,coupon_info:{discount:0,is_percent:!1},promo_code_info:{discount:0,is_percent:!1,max_discount_by_percent:0},is_free_shipping:!1,discount_by_quantity:0,bonus_items:[],is_discount_in_birthday_customer:!1,arr_level_promotion:[],total_quantity_bonus:0,priority_level:null,isLoadingItem:!1,post_ids:[],is_discount_first_buyer:!1,discount_by_customer_level:null,collapsedRadios:[]},Eo=["30","50","100"],Zo={page:1,page_size:30,type_promotion_selected:"all"},wo=(0,j.Z)()(ro=function(t){(0,m.Z)(e,t);var o=yo(e);function e(t){var n;return(0,d.Z)(this,e),n=o.call(this,t),(0,g.Z)((0,u.Z)(n),"handleSearchPromotionAdvance",y()((function(t){return n.fetchPromotionAdvance(t)}),400)),(0,g.Z)((0,u.Z)(n),"fetchPromotionAdvance",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o({},Zo);t=_o(_o({},t),{},{textSearch:n.props.textSearch,page_size:n.state.pageSize});var o=n.props,e=o.accessToken,r=o.shopId;n.setState({params:t,isLoading:!0}),n.props.fetchPromotionAdvance(e,r,t).then((function(){n.setState({isLoading:!1})})),n.props.fetchCountPromotionAdvance(e,r,t)})),(0,g.Z)((0,u.Z)(n),"columns",[{title:"ID",dataIndex:"display_id",width:"8%",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.isActive"),dataIndex:"isActive",width:"8%",ellipsis:!0,align:"center"},{title:n.props.t("pages.shop.product.promotionAdvance.promotions"),dataIndex:"name",width:"30%",ellipsis:!0},{title:n.props.t("pages.shop.product.promotionAdvance.promotionBy"),dataIndex:"is_variation",width:"10%",ellipsis:!0},{title:n.props.t("pages.shop.product.promotionAdvance.time"),dataIndex:"time",width:"15%",ellipsis:!0},{title:n.props.t("pages.shop.product.promotionAdvance.creator"),dataIndex:"creator_id",width:"20%",ellipsis:!0},{title:n.props.t("pages.shop.product.promotionAdvance.insertedAt"),dataIndex:"inserted_at",width:"10%",ellipsis:!0,align:"right"}]),(0,g.Z)((0,u.Z)(n),"getDataListPromotions",(function(){var t,o,e=n.props,r=e.timezone,a=e.t;return null===(t=n.props.promotionAdvances)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.map((function(t){var o=n.props.users.find((function(o){return o.user_id==t.creator_id}));return{key:t.id,display_id:t.display_id,name:go("div",null,go("div",null,go("span",null,go("span",null,go(uo.default,{recordSrc:t.name},go("a",null,t.name))),t.group_name&&go("span",{style:{marginLeft:8}},"(",t.group_name,")")),"\xa0",t.is_used&&go(gt.default,{color:"green"},a("pages.shop.product.promotionAdvance.used")),"coupon_id_multiple_times"==t.type&&go(gt.default,{color:"orange"},(null===t||void 0===t?void 0:t.used_count)||0)),go("div",{style:{color:"#999",marginTop:3}},(0,Ot.hq)(t.type)),(t.shop_customer_id||t.order_id)&&go("div",{style:{marginTop:3}},t.shop_customer_name&&go(gt.default,{color:"geekblue"},t.shop_customer_name),t.order&&go(gt.default,{color:"green"},go(uo.default,{recordSrc:t.order},t.order)),t.promo_code_info.sending_count?go(gt.default,{color:"pink"},"\u0110\xe3 g\u1eedi ",t.promo_code_info.sending_count," l\u1ea7n"):go(gt.default,{color:"green"},"Ch\u01b0a g\u1eedi"))),is_variation:["discount_by_order_price","double_reward_point","discount_by_coupon_id","coupon_id_multiple_times"].includes(t.type)?"":t.is_variation?go(gt.default,{color:"pink"},a("pages.shop.product.promotionAdvance.variation")):go(gt.default,{color:"green"},a("products.title")),isActive:go(i.Z,{disabled:t.shop_customer_id,size:"small",onChange:function(o,e){e.stopPropagation(),n.onChangeActive(t.id,t.is_activated)},checked:t.is_activated}),time:t.start_time&&t.end_time?go("div",null,go("div",{style:{color:"rgb(16, 142, 233)"}},(0,Q.o0x)(r,t.start_time,!0)),go("div",{style:{color:"rgb(255, 56, 96)"}},(0,Q.o0x)(r,t.end_time,!0))):"",creator_id:o?go("span",{style:{display:"flex",alignItems:"center",float:"left"}},go(Tt.Z,{id:o.user.fb_id,size:[20,20],name:o.user.name}),"\xa0",go("span",null,o.user.name)):"",inserted_at:(0,Q.o0x)(r,t.inserted_at),data:t}}))})),(0,g.Z)((0,u.Z)(n),"onChangeActive",(function(t,o){var e=n.props,r=e.accessToken,a=e.shopId,i=e.deletePromotionAdvance;n.setState({isLoading:!0}),o?i(r,a,[t],"DEACTIVE_PROMOTIONS").then((function(){return n.setState({isLoading:!1})})):i(r,a,[t],"ACTIVE_PROMOTIONS").then((function(){return n.setState({isLoading:!1})}))})),(0,g.Z)((0,u.Z)(n),"handleClickRow",(function(t){var o=n.props.timezone,e=t.data,r=It()(e);null!=r.start_time&&(r.start_time=wt()(r.start_time).add(o,"hours")),null!=r.end_time&&(r.end_time=wt()(r.end_time).add(o,"hours")),n.setState({promotion:r,isLoadingItem:!0,modalVisibile:!0},(0,s.Z)(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(["double_reward_point","discount_by_coupon_id","discount_by_order_price","coupon_id_multiple_times"].includes(r.type)){t.next=5;break}return t.next=3,n.fetchItemInPromotion(r);case 3:t.next=6;break;case 5:n.setState({isLoadingItem:!1});case 6:case"end":return t.stop()}}),t)}))))})),(0,g.Z)((0,u.Z)(n),"fetchItemInPromotion",(function(t){var o=n.props,e=o.shopId,r=o.accessToken,a={id:t.id},i="".concat((0,Q.LpH)(),"/shops/").concat(e,"/promotion_advance/get_items?access_token=").concat(r);G()({method:"get",url:i,params:a}).then((function(t){var o,e=It()(n.state.promotion);null!==(o=t.data)&&void 0!==o&&o.data&&(e=_o(_o({},t.data.data),{},{start_time:e.start_time,end_time:e.end_time})),n.setState({promotion:e,modalVisibile:!0,isLoadingItem:!1})}))})),(0,g.Z)((0,u.Z)(n),"handleDeletePromotionAdvance",(function(){var t=n.state.selectedRowKeys,o=n.props,e=o.shopId,r=o.accessToken,a=o.deletePromotionAdvance;n.setState({isLoading:!0}),a(r,e,t,"DELETE_PROMOTIONS").then((function(){return n.setState({isLoading:!1})}))})),(0,g.Z)((0,u.Z)(n),"handleRenderPromotionType",(function(t){var o=n.props.t;switch(t){case"fixed_prices":return o("pages.shop.product.promotionAdvance.textFixedPrice");case"discount_by_product":return o("pages.shop.product.promotionAdvance.textDiscountByProduct");case"discount_by_order_price":return o("pages.shop.product.promotionAdvance.textDiscountByOrderPrice");case"coupon":return o("pages.shop.product.promotionAdvance.textCoupon");case"double_reward_point":return o("pages.shop.product.promotionAdvance.textDoubleRewardPoint");case"discount_by_coupon_id":return o("pages.shop.product.promotionAdvance.filterDiscountByCouponId");case"coupon_id_multiple_times":return o("pages.shop.product.promotionAdvance.filterDiscountByCouponIdMult")}})),(0,g.Z)((0,u.Z)(n),"renderProductTag",(function(t){var o=t&&t.name,e={product_display_id:t&&(t.custom_id||(0,Q.pyT)(t.display_id,0)),name:o};return go("div",{className:"tag-variation"},e.product_display_id?go(gt.default,{color:"green",style:{marginRight:3}},e.product_display_id):"",go("b",null,e.name))})),(0,g.Z)((0,u.Z)(n),"renderVariationTag",(function(t){var o=t&&t.product.name,e={product_display_id:t&&(t.product.custom_id||(0,Q.pyT)(t.product.display_id,0)),var_display_id:t&&(t.custom_id||(0,Q.pyT)(t.display_id,0)),name:o};return go("div",{className:"tag-variation"},e.product_display_id?go(gt.default,{color:"green",style:{marginRight:3}},e.product_display_id):"",e.var_display_id?go(gt.default,{color:"pink",style:{marginRight:3}},e.var_display_id):"",go("b",null,e.name))})),(0,g.Z)((0,u.Z)(n),"renderTag",(function(t,o){var e,r=n.props,a=r.t,i=r.users,c=r.currentShop,p=r.orderSourcesCustom,s=r.categories,d="",u="";switch(t.key){case"category_ids":u=a("components.productCreatorFirstStep.category");var l=(0,fo.bu)(s).find((function(o){return o.id==t.value}));d=(null===l||void 0===l?void 0:l.text)||"";break;case"type":u=a("pages.shop.product.promotionAdvance.type"),d=n.handleRenderPromotionType(t.value);break;case"active":u=a("pages.shop.product.promotionAdvance.active"),d="true"==t.value?a("pages.shop.product.promotionAdvance.turnOn"):a("pages.shop.product.promotionAdvance.turnOff");break;case"variation_id":u=a("pages.shop.product.promotionAdvance.variation"),d=n.renderVariationTag(t.value);break;case"product_id":u=a("products.title"),d=n.renderProductTag(t.value);break;case"used_coupon":d=a("pages.shop.product.promotionAdvance.couponUsed");break;case"used_user":var m=i.find((function(o){return o.user_id==t.value}));u=a("pages.shop.product.promotionAdvance.user"),d=(null===m||void 0===m?void 0:m.user.name)||"";break;case"used_time":u=a("pages.shop.product.promotionAdvance.usedTime");var h=(0,Q.o0x)(n.props.timezone,t.value.startDate||"",!1,"DD/MM/YYYY"),f=(0,Q.o0x)(n.props.timezone,t.value.endDate||"",!1,"DD/MM/YYYY");d="".concat(a("pages.shop.product.purchase.from")," ").concat(h," - ").concat(a("pages.shop.product.purchase.to")," ").concat(f);break;case"used_count":u=a("pages.shop.product.promotionAdvance.usedCount");var g="";switch(t.value[0]){case"greaterOrEqual":g=">=";break;case"smallerOrEqual":g="<=";break;case"equal":g="="}d="".concat(g," ").concat((0,Q.ufS)(t.value[1]));break;case"order_sources":var v=(0,Q.K5C)(p,c),_=[];(0,Q.caL)(c).map((function(t){v.find((function(o){return o.id==t.id}))||_.push(t)}));var y=v.concat(_),x=y.findIndex((function(o){return o.id==t.value[0]||o.id&&o.id.toString()==t.value[0]})),b=x>-1?y[x].name:"",P=null;t.value.length>1&&(P=(((null===(e=y[x])||void 0===e?void 0:e.nodes)||[]).find((function(o){return o.custom_id==t.value[1]||o.id==t.value[1]}))||{}).name),d=go("div",{style:{display:"flex"}},go("span",null,a("components.orderAdvanceFilter.".concat("no_source"==t.value?"noSource":"orderSource")),"no_source"!=t.value?":":""),"\xa0",go("strong",null,P?b+"/"+P:"-1"==t.value[0]&&t.value.length>1?b+"/"+t.value[1]:b))}return go(gt.default,{key:"".concat(o,"_").concat(d),closable:!0,onClose:function(){return n.onCloseTag(o)}},u?go("span",{className:"content-tag"},go("span",{style:{fontWeight:500}},u),": ",d):d)})),(0,g.Z)((0,u.Z)(n),"onChangeSelectRowKey",(function(t,o){var e=n.props.promotionAdvances,r=o&&o.length>0?o:(null===e||void 0===e?void 0:e.data)||[],a=n.state,i=a.selectedRowKeys,c=a.selectedPromotions.concat(t.filter((function(t){return!i.includes(t)})).map((function(t){return r.find((function(o){return o.id==t}))}))).filter((function(o){return t.includes(o.id)}));n.setState({selectedRowKeys:t,selectedPromotions:c})})),(0,g.Z)((0,u.Z)(n),"onCloseTag",(function(t){var o=n.props.categories,e=n.state,r=e.filterTags,a=e.params,i=(0,B.Z)(n.state.paramMultipeSource),c=r[t],p=c.key,s=void 0;(r.splice(t,1),"order_sources"==p)&&(i=i.filter((function(t){return!L()(t,c.value)})),s=r.filter((function(t){return t.key==p})).map((function(t){return t.value})));var d=(0,B.Z)(n.state.keyTagFilter);if("category_ids"==p){var u=(0,fo.bu)(o).find((function(t){return t.id==c.value})),l=(0,Dt.fd)(u.nodes,[u.id]);d=d.filter((function(t){return!l.includes(parseInt(t))})),s=(0,B.Z)(d)}n.setState({filterTags:r,paramMultipeSource:i,keyTagFilter:d}),n.fetchPromotionAdvance(_o(_o({},a),{},(0,g.Z)({},p,s)))})),(0,g.Z)((0,u.Z)(n),"onSelectTag",(function(t){var o=n.props.shopId,e=It()(n.state.filterTags);"category_ids"==t.key&&(e=e.filter((function(t){return"category_ids"!=t.key||n.state.keyTagFilter.includes(t.value)})));var r=e.findIndex((function(o){return o.key==t.key&&("category_ids"!=t.key||t.value==o.value)}));r<0?e.push(t):e[r].value=t.value,(0,Q.iAs)(t.key,"".concat(o,"_filter_promotion_advance_count")),n.setState({filterTags:e})})),(0,g.Z)((0,u.Z)(n),"onChangeCascader",(function(t,o){var e;if(!(!t||1==(null===o||void 0===o?void 0:o.length)&&(null===(e=o[0])||void 0===e?void 0:e.isRoot)||o[1]&&100==o[1].value)){var r=n.state.params,a=t[0],i=t[1];if("order_sources"!=a){if(["used_coupon"].includes(a)&&(i=!0),"category_ids"==a)return n.onChangeCategories(t,o);var c={key:a,value:i};n.onSelectTag(c),n.fetchPromotionAdvance(_o(_o({},r),{},(0,g.Z)({},c.key,c.value)))}else(0,Q.$lX)({selectedOptions:o,paramMultipeSource:n.state.paramMultipeSource,isFilterMultipleSource:!0,callbackState:n.callbackState})}})),(0,g.Z)((0,u.Z)(n),"onChangeCategories",(function(t,o){var e=n.props.shopId,r=It()(n.state.keyTagFilter),a=It()(n.state.filterTags),i=t.length,c=t[0],p=t[i-1],s={key:c,value:p},d=[];t.map((function(t,o){o>0&&o<i-1&&d.push(t)})),r=r.filter((function(t){return!d.includes(t)}));var u=function(t){var o=t.length-1;return(0,Dt.fd)(t[o].children,[t[o].value],"children")}(o);r=bt()(r.concat(u));var l=d.concat(u);(a=a.filter((function(t){return t.key!=c||!l.includes(t.value)}))).push(s),n.setState({filterTags:a,keyTagFilter:r}),(0,Q.iAs)(s.key,"".concat(e,"_filter_promotion_advance_count")),n.fetchPromotionAdvance(_o(_o({},n.state.params),{},(0,g.Z)({},s.key,r)))})),(0,g.Z)((0,u.Z)(n),"handleFilterSelectItem",(function(t,o){var e,r=n.state,a=r.searchResultVariation,i=r.searchResultProduct,c=r.params;"variation"==o?(e={key:"variation_id",value:a.find((function(o){return o.id==t}))},n.fetchPromotionAdvance(_o(_o({},c),{},{variation_id:t}))):(e={key:"product_id",value:i.find((function(o){return o.id==t}))},n.fetchPromotionAdvance(_o(_o({},c),{},{product_id:t})));n.onSelectTag(e)})),(0,g.Z)((0,u.Z)(n),"debounceHandleOnChangeUsedCount",y()((function(t){return n.handleOnChangeUsedCount(t)}),500)),(0,g.Z)((0,u.Z)(n),"handleOnChangeUsedCount",(function(t){if(""===t){var o=n.state.filterTags.findIndex((function(t){return"used_count"==t.key}));n.onCloseTag(o)}else{var e=n.state,r=e.params,a={key:"used_count",value:[e.filterByUsedCount,parseInt(t)||0]};n.onSelectTag(a),n.fetchPromotionAdvance(_o(_o({},r),{},{used_count:a.value}))}})),(0,g.Z)((0,u.Z)(n),"onChangeFilterByUsedCount",(function(t){return n.setState({filterByUsedCount:t})})),(0,g.Z)((0,u.Z)(n),"handleFilterOrderSources",(function(){var t=It()(n.state.filterTags),o=n.state,e=o.params,r=o.isFilterExcludeSource,a=(n.state.paramMultipeSource||[]).filter((function(t){return t.length>0}));t=t.filter((function(t){return"order_sources"!=t.key})),a.map((function(o){t.find((function(t){return"order_sources"==t.key&&(1==o.length&&1==t.value.length&&t.value[0]==o[0]||2==o.length&&2==t.value.length&&t.value[0]==o[0]&&t.value[1]==o[1])}))||t.push({key:"order_sources",value:o})})),n.setState({filterTags:t},(function(){var o=t.filter((function(t){return"order_sources"==t.key}));o=o.map((function(t){return t.value})),n.fetchPromotionAdvance(_o(_o({},e),{},{order_sources:o,is_filter_exclude_source:r}))}))})),(0,g.Z)((0,u.Z)(n),"callbackState",(function(t){Object.keys(t).includes("isFilterExcludeSource")&&localStorage.setItem("isFilterExcludeSourcePromotionAdvance",t.isFilterExcludeSource),n.setState(t)})),(0,g.Z)((0,u.Z)(n),"callBack",(function(){return n.handleFilterOrderSources()})),(0,g.Z)((0,u.Z)(n),"getOptions",(function(){var t,o=n.props,e=o.t,a=o.shopId,i=o.accessToken,c=o.warehouses,p=o.currentShop,s=o.users,d=o.employeeList,u=o.categories,l=n.state,m=l.searchResultVariation,h=l.searchResultProduct,f=l.params,v=l.filterByUsedCount,_=d&&d.length?d.findIndex((function(t){return"used_user"==t.which&&"promotionAdvanceFilter"==t.type})):-1,y=-1==_?s:d[_].users,x=_>-1?d[_].text:void 0,b=y.map((function(t){var o=t.user_id;return{value:o,label:(0,Q.q$s)(o,y)}})),P=go(_t.default,{onChange:n.onChangeFilterByUsedCount,value:v,id:"usedCountSelect"},go(bo,{className:"usedCountOpt",value:"greaterOrEqual",key:1},">="),go(bo,{className:"usedCountOpt",value:"smallerOrEqual",key:2},"<="),go(bo,{className:"usedCountOpt",value:"equal",key:3},"=")),I=(0,Ot.rV)({callbackState:n.callbackState,callBack:n.callBack,restState:_o(_o({},n.state),{},{isFilterMultipleSource:!0})}),S=[{value:"category_ids",label:e("pages.shop.product.management.filterByCategory"),isRoot:!0,children:[{value:"search",key:"search",disabled:!0,label:go(ho.Z,{handleTags:function(t,o){n.setState({keyTagFilter:o},(function(){n.onSelectTag(t),n.fetchPromotionAdvance(_o(_o({},n.state.params),{},(0,g.Z)({},t.key,o)))}))},tags:n.state.filterTags,keyTagFilter:n.state.keyTagFilter,tagKey:"category_ids",isType:"promotion"})}].concat((0,Ot.ux)(u,!1,!0))},{value:"order_sources",label:e("components.orderAdvanceFilter.orderSource"),isRoot:!0,children:I},{value:"type",label:e("pages.shop.product.promotionAdvance.type"),isRoot:!0,children:[{value:"fixed_prices",label:go("div",null,e("pages.shop.product.promotionAdvance.textFixedPrice"))},{value:"discount_by_product",label:go("div",null,e("pages.shop.product.promotionAdvance.textDiscountByProduct"))},{value:"discount_by_order_price",label:go("div",null,e("pages.shop.product.promotionAdvance.textDiscountByOrderPrice"))},{value:"coupon",label:go("div",null,e("pages.shop.product.promotionAdvance.textCoupon"))},{value:"double_reward_point",label:go("div",null,e("pages.shop.product.promotionAdvance.textDoubleRewardPoint"))},{value:"discount_by_coupon_id",label:go("div",null,e("pages.shop.product.promotionAdvance.filterDiscountByCouponId"))},{value:"coupon_id_multiple_times",label:go("div",null,e("pages.shop.product.promotionAdvance.filterDiscountByCouponIdMult"))}]},{value:"active",label:e("pages.shop.product.promotionAdvance.active"),isRoot:!0,children:[{value:"true",label:go("div",null,e("pages.shop.product.promotionAdvance.turnOn"))},{value:"false",label:go("div",null,e("pages.shop.product.promotionAdvance.turnOff"))}]},{value:"variation_id",label:e("pages.shop.product.promotionAdvance.variation"),isRoot:!0,children:[{value:"search-variation",label:go("div",{onClick:function(t){return t.stopPropagation()}},go($.Z,{accessToken:i,searchResult:m,combo_by:"variation",searchOnly:!0,shopId:a,callback:function(t){return n.setState({searchResultVariation:t})},is_filter:!0}))}].concat((0,B.Z)(m.map((function(t,o){return{value:"variation-".concat(o),label:go("div",{onClick:function(o){o.stopPropagation(),n.handleFilterSelectItem(t.id,"variation")}},go(po.Z,{width:448,t:e,key:o,currentShop:p,combo_by:"variation",item:t,warehouses:c}))}}))))},{value:"product_id",label:e("products.title"),isRoot:!0,children:[{value:"search-product",label:go("div",{onClick:function(t){return t.stopPropagation()}},go($.Z,{accessToken:i,searchResult:h,combo_by:"product",searchOnly:!0,shopId:a,callback:function(t){return n.setState({searchResultProduct:t})},is_filter:!0}))}].concat((0,B.Z)(h.map((function(t,o){return{value:"variation-".concat(o),label:go("div",{onClick:function(o){o.stopPropagation(),n.handleFilterSelectItem(t.id,"product")}},go(po.Z,{width:300,t:e,key:o,currentShop:p,combo_by:"product",item:t,warehouses:c}))}}))))},{value:"used_coupon",label:e("pages.shop.product.promotionAdvance.couponUsed")},{value:"used_user",label:e("pages.shop.product.promotionAdvance.user"),isRoot:!0,children:[{value:100,label:go("div",{onClick:function(t){return t.stopPropagation()}},go(r.default,{onChange:function(t){return n.handleSearchEmployee(t,"used_user")},value:x,placeholder:e("components.orderAdvanceFilter.enterEmployee"),allowClear:!0}))}].concat(b)},{value:"used_time",label:e("pages.shop.product.promotionAdvance.usedTime"),isRoot:!0,children:[{value:"period",label:go("span",{onClick:function(t){return t.stopPropagation()}},go(xo,{ranges:(t={},(0,g.Z)(t,e("pages.shop.statistic.yesterday"),[wt()().add(-1,"days").startOf("day"),wt()().add(-1,"days").endOf("day")]),(0,g.Z)(t,e("pages.shop.statistic.today"),[wt()().startOf("day"),wt()().endOf("day")]),(0,g.Z)(t,e("pages.shop.statistic.lastWeek"),[wt()().add(-7,"days").startOf("day"),wt()().endOf("day")]),(0,g.Z)(t,e("pages.shop.statistic.lastMonth"),[wt()().add(-30,"days").startOf("day"),wt()().endOf("day")]),(0,g.Z)(t,e("pages.shop.statistic.thisMonth"),[wt()().startOf("month").startOf("day"),wt()().endOf("month").endOf("day")]),t),value:f&&f.endDate&&f.startDate?[wt()(f.startDate,"X"),wt()(f.endDate,"X")]:[],format:"DD/MM/YYYY",style:{width:300,marginRight:10},onChange:function(t){return n.onChangeFilterDate(t)}}))}]},{value:"used_count",label:e("pages.shop.product.promotionAdvance.usedCount"),isRoot:!0,children:[{value:v,label:go("span",{onClick:function(t){return t.stopPropagation()}},go(r.default,{addonBefore:P,placeholder:e("pages.shop.product.promotionAdvance.inputCount"),onClick:function(t){return t.target.focus()},onChange:function(t){return n.debounceHandleOnChangeUsedCount(t.target.value)}}))}]}];return(0,Q.QIx)(S,"".concat(a,"_filter_promotion_advance_count"))})),(0,g.Z)((0,u.Z)(n),"onChangeFilterDate",(function(t){var o=n.state,e=o.params,r=o.filterTags,a=n.props.shopId,i=r.findIndex((function(t){return"used_time"==t.key}));if(t&&t.length>0){var c=t[0].startOf("day").unix(),p=t[1].endOf("day").unix(),s={key:"used_time",value:{startDate:t[0].startOf("day"),endDate:t[1].endOf("day")}};i>-1?r[i]=s:r.push(s),e.startDate=c,e.endDate=p,n.fetchPromotionAdvance(e)}else{i>-1&&n.setState({filterTags:r.splice(i,1)});var d=e;d=(d=d.startDate?omit(d,"startDate"):d).endDate?omit(d,"endDate"):d,n.setState({params:d},(function(){return n.fetchPromotionAdvance(d)}))}(0,Q.iAs)("used_time","".concat(a,"_filter_promotion_advance_count")),n.setState({filterTags:r})})),(0,g.Z)((0,u.Z)(n),"handleSearchEmployee",(function(t,o){var e=t.target?t.target.value:t;n.props.pushUsersTextSearch(e,n.props.users,o,"promotionAdvanceFilter")})),(0,g.Z)((0,u.Z)(n),"handleDeleteFilter",(function(){L()(n.state.params,Zo)||n.setState({params:_o(_o({},Zo),{},{page_size:n.state.pageSize}),filterTags:[],paramMultipeSource:[],searchPageId:null,keyTagFilter:[]},(function(){n.fetchPromotionAdvance(n.state.params)}))})),(0,g.Z)((0,u.Z)(n),"handleTableChange",(function(t){var o=n.state.params;o.page=t.current,n.setState({pageSize:t.pageSize},(function(){localStorage.setItem("promotionAdvancePageSize",t.pageSize),o.page_size=t.pageSize,n.fetchPromotionAdvance(o)})),document.querySelector(".ant-table-body").scrollTop=0})),(0,g.Z)((0,u.Z)(n),"onSelectRow",(function(){var t=n.props,o=t.shopId,e=t.accessToken,r=n.state,a=r.params,i=r.pageSize,c="".concat((0,Q.LpH)(),"/shops/").concat(o,"/promotion_advance?access_token=").concat(e);n.setState({loadingData:!0});(function t(o){return G().get(c,{params:o}).then((function(e){var r=n.state,a=r.loadingData,c=r.selectedRowKeys,p=e.data.data,s=p.map((function(t){return t.id})),d=c.filter((function(t){return!s.includes(t)})).concat(s);return a&&n.onChangeSelectRowKey(d,p),(d||[]).length>=e.data.total_entries||0==p.length||p.length<i||!a?void 0:(o.page+=1,t(o))}))})(_o(_o({},a),{},{page:1})).then((function(t){return n.setState({loadingData:!1})}))})),(0,g.Z)((0,u.Z)(n),"getCount",(function(t){var o=n.props.promotionAdvances.counters;return"all"==t?(o||[]).reduce((function(t,o){return t+o.count}),0):"discount_by_coupon_id"==t?(o||[]).filter((function(t){return"discount_by_coupon_id"==t.type||"coupon_id_multiple_times"==t.type})).reduce((function(t,o){return t+o.count}),0):(o||[]).filter((function(o){return o.type==t})).reduce((function(t,o){return t+o.count}),0)})),(0,g.Z)((0,u.Z)(n),"getTypePromotions",(function(){return[{text:n.props.t("commons.all"),value:"all",count:n.getCount("all")},{text:n.props.t("pages.shop.product.promotion.quantityProduct"),value:"discount_by_product",count:n.getCount("discount_by_product")},{text:n.props.t("orders.orderValue"),value:"discount_by_order_price",count:n.getCount("discount_by_order_price")},{text:n.props.t("pages.shop.product.promotionAdvanceImportExcel.fixedPrices"),value:"fixed_prices",count:n.getCount("fixed_prices")},{text:n.props.t("pages.shop.product.promotionAdvanceImportExcel.coupon"),value:"coupon",count:n.getCount("coupon")},{text:"Coupon",value:"discount_by_coupon_id",count:n.getCount("discount_by_coupon_id")},{text:n.props.t("containers.formBox.rewardPoints"),value:"double_reward_point",count:n.getCount("double_reward_point")},{text:n.props.t("pages.shop.product.promotionAdvance.attachmentProducts"),value:"discount_by_attachment_products",count:n.getCount("discount_by_attachment_products")}]})),(0,g.Z)((0,u.Z)(n),"handleOnChangeType",(function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"type_promotion_selected";if("type_promotion_selected"!=o||"collapse"!=t){var e=It()(n.state.params);e[o]=t,"type_promotion_selected"==o&&(e.group_name="all"),n.fetchPromotionAdvance(e)}})),(0,g.Z)((0,u.Z)(n),"checkTypesFilter",(function(){for(var t=[],o=n.radioGroup.childNodes,e=-1,r=0;r<o.length;r++){var a=o[r];if(a.style.display="inline-block",a.getBoundingClientRect().top>n.radioGroup.getBoundingClientRect().top){e=r;break}}if(-1!=e)for(var i=function(r){var a=o[r],i=n.state.collapsedRadios.length&&r==o.length-1;if(i){if(!(a.getBoundingClientRect().top>n.radioGroup.getBoundingClientRect().top))return"break";a=o[e-2]}if(!a)return"break";var c=null;n.getTypePromotions().forEach((function(t){a.lastChild.firstChild.textContent==t.text&&(c=t.value)})),i?t.unshift(c):t.push(c),a.style.display="none"},c=e-1;c<o.length;c++){if("break"===i(c))break}n.setState({collapsedRadios:t})})),(0,g.Z)((0,u.Z)(n),"getCollapsedRadios",(function(){var t=n.state,o=t.collapsedRadios,e=t.params,r=t.isLoading;return go(ft.default,{onClick:function(t){var o=t.key;return n.handleOnChangeType(o)}},o.map((function(t){if(!t)return null;var o=n.getTypePromotions().find((function(o){return o.value==t}))||{};return go(ft.default.Item,{key:t},null===o||void 0===o?void 0:o.text,go(gt.default,{style:{marginLeft:10},key:o.count},r&&e.type==o.value?go(At.Z,null):o.count))})))})),(0,g.Z)((0,u.Z)(n),"getRadioButton",(function(t,o){var e=n.state,r=e.isLoading,a=e.params;return go(Io,{key:t.value,value:t.value,onChange:function(t){return n.handleOnChangeType(t.target.value)}},t.text,go(gt.default,{key:t.value},r&&a.type_promotion_selected==t.value?go(At.Z,null):t.count),o&&go(Et.Z,{style:{marginLeft:5}}))})),(0,g.Z)((0,u.Z)(n),"renderTypePromotion",(function(){var t=n.state,o=t.params,e=t.collapsedRadios,r=o.type_promotion_selected;return go("div",{className:"status-dropdown"},go(Po,{id:"status-group",value:o.type_promotion_selected},n.getTypePromotions().map((function(t){return n.getRadioButton(t)})),e.length>0&&go(ht.default,{placement:"bottomLeft",overlay:n.getCollapsedRadios()},e.includes(r)?n.getRadioButton(n.getTypePromotions().find((function(t){return t.value==r})),!0):go(Io,{value:"collapse"},go(Et.Z,null)))))})),(0,g.Z)((0,u.Z)(n),"productAdvanceTableHeighStyle",(function(t){return t?go(St.default,{id:"1139367835"},[".product-promotion .ant-table-wrapper{margin-top:0px !important;}",".product-promotion .ant-table-body,.product-promotion .ant-table-body-inner{min-height:calc(100vh - 240px) !important;}"]):go(St.default,{id:"3235408108"},[".product-promotion .ant-table-wrapper{margin-top:0px !important;}",".product-promotion .ant-table-body,.product-promotion .ant-table-body-inner{margin-top:0px !important;min-height:calc(100vh - 212px) !important;}"])})),(0,g.Z)((0,u.Z)(n),"getTableTitle",(function(){var t=n.state,o=t.params,e=t.isLoading,r=n.props,a=r.promotionAdvances.counters,i=r.t,c=o.type_promotion_selected,p="all"!=c?a.filter((function(t){return t.type==c&&t.group_name})).reduce((function(t,o){return o.group_name&&t.push(o.group_name),t}),[]):[];if("all"!=c&&null!==p&&void 0!==p&&p.length){p.unshift("all");var s=o.group_name||"all";return go(v.default,{activeKey:s,onChange:function(t){return n.handleOnChangeType(t,"group_name")},size:"small",className:"tabs-group"},bt()(p).map((function(t){var o=a.filter((function(o){return("all"==t||o.group_name==t)&&o.type==c})).reduce((function(t,o){return t+o.count}),0);return go(So,{key:t,tab:go("span",null,"all"!=t?t:i("commons.all")," ",go(gt.default,{key:t,color:s==t?"#096dd9":void 0},e&&s==t?go(At.Z,null):o))})})))}})),n.state={isLoading:!1,promotion:t.promotion||Ao,modalVisibile:!1,orderPrices:[],selectedRowKeys:[],searchResultBonus:[],searchBonusBy:"variation",popupVisibleCascader:!1,searchTerm:"",filterTags:[],params:_o({},Zo),searchResultVariation:[],searchResultProduct:[],pageSize:parseInt(localStorage.getItem("promotionAdvancePageSize")||30),filterByUsedCount:"greaterOrEqual",loadingData:!1,selectedPromotions:[],collapsedRadios:[],paramMultipeSource:[],searchPageId:null,isFilterExcludeSource:!1,keyTagFilter:[]},n}return(0,l.Z)(e,[{key:"componentDidMount",value:function(){if(this.radioGroup=document.getElementsByClassName("ant-radio-group")[0],localStorage.isFilterExcludeSourcePromotionAdvance)try{this.setState({isFilterExcludeSource:JSON.parse(localStorage.getItem("isFilterExcludeSourcePromotionAdvance"))||!1})}catch(t){console.log(t)}window.onresize=this.checkTypesFilter,this.checkTypesFilter(),this.fetchPromotionAdvance()}},{key:"componentDidUpdate",value:function(t){L()(this.props,t)||this.checkTypesFilter(),L()(t.textSearch,this.props.textSearch)||this.handleSearchPromotionAdvance(this.state.params)}},{key:"render",value:function(){var t=this,o=this.props,e=o.t,n=o.accessToken,r=o.shopId,a=o.promotionAdvances.total_entries,i=o.currentShop,c=this.state,p=c.modalVisibile,s=c.isLoading,d=c.selectedRowKeys,u=c.filterTags,l=c.params,m=c.pageSize,h=c.isLoadingItem,f=c.loadingData,g=c.selectedPromotions;return go("div",null,go("div",{className:"tools-content",style:{display:"flex",justifyContent:"space-between",marginBottom:u.length?0:10}},go("div",null,go(E.Z,{icon:go(U.Z,null),title:e("pages.shop.product.promotion.createPromotionProduct"),onClick:function(){return t.setState({modalVisibile:!0})}}),go(Z.Z,{icon:go(st.Z,null),disabled:s,title:e("pages.shop.orderControlInfo.sync"),onClick:function(){return t.fetchPromotionAdvance(l)},isButton:!0}),go($t,{accessToken:n,shopId:r}),go(io,{accessToken:n,shopId:r,selectedRowKeys:d,selectedPromotions:g}),d.length>0&&go(Z.Z,{disabled:s,icon:go(lt.Z,null),onClick:function(){return t.handleDeletePromotionAdvance()},title:e("pages.shop.product.promotionAdvance.delete"),isButton:!0}),go(mo.Z,{selectedLength:d.length,loadingData:f,total:a,onClick:function(){return t.setState({loadingData:!1,selectedRowKeys:[],selectedPromotions:[]})}})),go("div",{style:{display:"flex"}},u.length>0&&go(C.default,{danger:!0,onClick:function(){return t.handleDeleteFilter()}},e("pages.shop.statistic.customer.deleteFilter")),"\xa0",go(co.Z,{options:this.getOptions(),popupClassName:"cascader-filter-promotion-advance",onChange:this.onChangeCascader,changeOnSelect:!0}))),u&&u.length>0&&go("div",{className:"tags-filter",style:{padding:"0px 20px"}},u.map(this.renderTag)),this.renderTypePromotion(),go(lo.Z,{className:"table-promotion-advance",title:function(){return t.getTableTitle()},columns:this.columns,dataSource:this.getDataListPromotions(),size:"small",loading:s,onRow:function(o){return{onClick:function(e){return t.handleClickRow(o)}}},rowSelection:{selectedRowKeys:d,onChange:function(o){return t.onChangeSelectRowKey(o)},preserveSelectedRowKeys:!0,isSelection:!0,onSelectRow:this.onSelectRow},onChange:this.handleTableChange,pagination:{size:"small",pageSize:m,current:l.page,pageSizeOptions:Eo,showSizeChanger:!0,total:a},scroll:{y:"calc(100vh - 250px)"}}),p&&go(so.Z,{shopId:r,handleCancel:function(){return t.setState({modalVisibile:!1,promotion:Ao,isLoadingItem:!1})},modalVisibile:p,promotion:this.state.promotion,currentShop:i,accessToken:n,isLoadingItem:h}),go("style",{dangerouslySetInnerHTML:{__html:Ct()}}),this.productAdvanceTableHeighStyle(u.length>0))}}]),e}(x.Component))||ro,ko=(0,P.$j)((function(t){return _o({timezone:t.navigation.user.timezone,currentShop:t.shop.currentShop,users:t.user.users,warehouses:t.warehouse.warehouses,employeeList:t.user.filterEmployeeList,orderSourcesCustom:(0,V.ME)(t)},(0,V.kI)(t))}),{fetchPromotionAdvance:X.wfk,deletePromotionAdvance:X.ClR,pushUsersTextSearch:X.mw6,fetchCountPromotionAdvance:X.n$A})(wo),Co=x.createElement;function Oo(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function Do(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?Oo(Object(e),!0).forEach((function(o){(0,g.Z)(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Oo(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function To(t){var o=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=(0,f.Z)(t);if(o){var r=(0,f.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,h.Z)(this,e)}}var No={page:1,page_size:30},Bo=v.default.TabPane,Ro=function(t){(0,m.Z)(e,t);var o=To(e);function e(t){var n;return(0,d.Z)(this,e),n=o.call(this,t),(0,g.Z)((0,u.Z)(n),"fetchPromotionProducts",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Do({},No),o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=n.props,r=e.accessToken,a=e.shopId;n.setState({params:t,isLoading:o}),n.props.fetchPromotionProducts(r,a,t).then((function(){return n.setState({isLoading:!1})}))})),(0,g.Z)((0,u.Z)(n),"handleTableChange",(function(t){var o=n.state.params;o.page=t.current,n.fetchPromotionProducts(o),document.querySelector(".ant-table-body").scrollTop=0})),(0,g.Z)((0,u.Z)(n),"columns",[{title:"ID",dataIndex:"id",ellipsis:!0,width:"6%"},{title:n.props.t("pages.shop.product.promotion.isActive"),dataIndex:"isActive",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.namePromotion"),dataIndex:"name",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.discount"),dataIndex:"discount",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.promotionPercent"),dataIndex:"promotionPercent",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.maxPromotionByPercent"),dataIndex:"maxPromotionByPercent",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.totalPriceOrders"),dataIndex:"totalPriceOrders",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.quantityProduct"),dataIndex:"quantityProduct",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.freeShip"),dataIndex:"freeShip",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.insertedAt"),dataIndex:"insertedAt",align:"right",ellipsis:!0},{title:n.props.t("pages.shop.product.promotion.updatedAt"),dataIndex:"updateAt",align:"right",ellipsis:!0}]),(0,g.Z)((0,u.Z)(n),"getData",(function(){return n.props.promotionProducts.data.map((function(t){return{key:t.id,id:(0,Q.pyT)(t.id,0),isActive:Co(i.Z,{checked:t.is_active,onChange:function(o,e){n.onChangeActive(t.id,t.is_active),e.stopPropagation()}}),name:Co("strong",null,t.name),discount:Co("strong",null,(0,Q.ufS)(t.discount_amount,n.props.currentShop.currency)),promotionPercent:Co("strong",null,"".concat(t.promotion_percent," %")),maxPromotionByPercent:Co("strong",null,(0,Q.ufS)(t.max_promotion_by_percent,n.props.currentShop.currency)),totalPriceOrders:0!=t.total_orders?Co("strong",null,(0,Q.ufS)(t.total_orders,n.props.currentShop.currency)):Co(ct.Z,{style:{color:"#DC143C",fontSize:14}}),quantityProduct:Co("strong",null,t.quantity_product>0?(0,Q.oH6)(t.quantity_product):Co(ct.Z,{style:{color:"#DC143C",fontSize:14}})),freeShip:t.is_free_shipping?Co(pt.Z,{style:{color:"#096dd9",fontSize:14}}):"",insertedAt:(0,Q.o0x)(n.props.timezone||7,t.inserted_at),updateAt:(0,Q.o0x)(n.props.timezone||7,t.updated_at),action:t}}))})),(0,g.Z)((0,u.Z)(n),"handleRowClick",(function(t){var o=t.action;n.setState({modalDetailVisible:!0,selectedPromotion:o,isLoadingListProduct:!0})})),(0,g.Z)((0,u.Z)(n),"handleDeletePromotion",(function(){var t=n.props.t,o=n.state.selectedRowKeys;a.Z.confirm({title:t("pages.shop.product.promotion.confirmedDeletePromotion"),content:t("pages.shop.product.promotion.wantToDelete")+" "+o.length+" "+t("pages.shop.product.promotion.selectedPromotion"),okText:t("delete"),cancelText:t("cancel"),onOk:function(){var t=n.props,e=t.accessToken,r=t.shopId;(0,t.deletePromotions)(e,r,{promotion_ids:o}).then((function(){return n.setState({selectedRowKeys:[]})}))}})})),(0,g.Z)((0,u.Z)(n),"handleActivePromotion",(function(t){var o=n.state.selectedRowKeys,e=n.props,r=e.accessToken,a=e.shopId,i=e.activePromotions,c=e.promotionProducts,p=[];Number.isInteger(t)?(c.data.forEach((function(o){o.id==t&&p.push(o)})),i(r,a,{promotion_ids:[t]},p)):(c.data.forEach((function(t){o.includes(t.id)&&p.push(t)})),i(r,a,{promotion_ids:o},p).then((function(){return n.setState({selectedRowKeys:[]})})))})),(0,g.Z)((0,u.Z)(n),"onChangeActive",(function(t,o){o?n.handleDeactivePromotion(t):n.handleActivePromotion(t)})),(0,g.Z)((0,u.Z)(n),"handleDeactivePromotion",(function(t){var o=n.state.selectedRowKeys,e=n.props,r=e.accessToken,a=e.shopId,i=e.deactivePromotions,c=e.promotionProducts,p=[];Number.isInteger(t)?(c.data.forEach((function(o){o.id==t&&p.push(o)})),i(r,a,{promotion_ids:[t]},p)):(c.data.forEach((function(t){o.includes(t.id)&&p.push(t)})),i(r,a,{promotion_ids:o},p).then((function(){return n.setState({selectedRowKeys:[]})})))})),(0,g.Z)((0,u.Z)(n),"onChangeActiveKey",(function(t){if("default"==t){var o=n.state.params;o.textSearch=n.state.textSearch,n.fetchPromotionProducts(o)}n.setState({activeKey:t})})),(0,g.Z)((0,u.Z)(n),"onSelectRow",(function(){var t=n.props,o=t.shopId,e=t.accessToken,r=n.state.params,a="".concat((0,Q.LpH)(),"/shops/").concat(o,"/promotion_products?access_token=").concat(e);n.setState({loadingData:!0});(function(t){return G().get(a,{params:t}).then((function(t){var o=n.state,e=o.loadingData,r=o.selectedRowKeys,a=t.data.data.map((function(t){return t.id})),i=r.filter((function(t){return!a.includes(t)})).concat(a);e&&n.setState({selectedRowKeys:i})}))})(Do(Do({},r),{},{page:1})).then((function(t){return n.setState({loadingData:!1})}))})),(0,g.Z)((0,u.Z)(n),"renderDefaultPromotion",(function(){var t=n.props,o=t.promotionProducts.total_entries,e=t.t,r=t.accessToken,a=t.shopId,i=n.state,c=i.modalDetailVisible,p=i.selectedPromotion,s=i.isLoadingListProduct,d=i.params,u=i.isLoading,l=i.selectedRowKeys,m=i.loadingData;return Co(x.Fragment,null,Co("div",{className:"tools-content"},Co(E.Z,{icon:Co(U.Z,null),title:e("pages.shop.product.promotion.createPromotionProduct"),onClick:function(){return n.setState({selectedPromotion:null,modalDetailVisible:!0})}}),Co(Z.Z,{icon:Co(st.Z,null),disabled:u,title:e("pages.shop.orderControlInfo.sync"),onClick:function(){return n.fetchPromotionProducts()},isButton:!0}),l.length>0&&Co("strong",null,Co(Z.Z,{icon:Co(dt.Z,null),onClick:n.handleActivePromotion,title:e("pages.shop.product.promotion.activePromotion"),isButton:!0}),Co(Z.Z,{icon:Co(ut.Z,null),color:"rgb(220, 20, 60)",onClick:n.handleDeactivePromotion,title:e("pages.shop.product.promotion.DeactivePromotion"),isButton:!0}),Co(Z.Z,{icon:Co(lt.Z,null),tooltip:"".concat(e("delete")," ").concat(l.length," ").concat(e("pages.shop.product.promotion.selectedPromotion")," "),onClick:n.handleDeletePromotion,title:e("delete"),isButton:!0})),Co(mo.Z,{selectedLength:l.length,loadingData:m,total:o,onClick:function(){return n.setState({loadingData:!1,selectedRowKeys:[]})}})),Co(lo.Z,{className:u?"blur-when-loading":"",size:"small",dataSource:n.getData(),columns:n.columns,pagination:{size:"small",pageSize:30,total:o,current:d.page},scroll:{x:1470,y:"calc(100vh - 212px)"},onChange:n.handleTableChange,onRow:function(t){return{onClick:function(o){return n.handleRowClick(t)}}},rowSelection:{selectedRowKeys:l,onChange:function(t){return n.setState({selectedRowKeys:t})},preserveSelectedRowKeys:!0,isSelection:!0,onSelectRow:n.onSelectRow}}),Co(it,{accessToken:r,shopId:a,visible:c,close:function(){return n.setState({modalDetailVisible:!1})},timezone:n.props.timezone,promotion:p,isLoadingListProduct:s}))})),(0,g.Z)((0,u.Z)(n),"renderAdvancePromotion",(function(){var t=n.props,o=t.shopId,e=t.accessToken,r=n.state,a=r.activeKey,i=r.textSearch;return Co(x.Fragment,null,"advance"==a&&Co(ko,{accessToken:e,shopId:o,textSearch:i}))})),(0,g.Z)((0,u.Z)(n),"debounceHandleSearchPromotion",y()((function(t){var o=n.state,e=o.activeKey,r=o.params;"default"==e&&(r.textSearch=t,n.fetchPromotionProducts(r))}),400)),n.state={params:Do({},No),modalDetailVisible:!1,selectedPromotion:null,isLoadingListProduct:!1,isLoading:!1,selectedRowKeys:[],activeKey:"advance",textSearch:"",loadingData:!1},n}return(0,l.Z)(e,null,[{key:"getInitialProps",value:function(){var t=(0,s.Z)(p().mark((function t(o,e){var n,r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.store.dispatch,r=o.query.shopId,!o.isServer){t.next=10;break}return t.next=4,n((0,X.WD1)(e,r,No));case 4:return t.next=6,n((0,X.pED)(e,r,!1));case 6:return t.next=8,n((0,X.P3w)(e,r,!1));case 8:t.next=13;break;case 10:return n((0,X.WD1)(e,r,No)),t.next=13,n((0,X.P3w)(e,r,!1));case 13:return t.next=15,n((0,X.A56)(e,r));case 15:return t.next=17,n((0,X.qkF)(e,r));case 17:return t.abrupt("return",{});case 18:case"end":return t.stop()}}),t)})));return function(o,e){return t.apply(this,arguments)}}()}]),(0,l.Z)(e,[{key:"render",value:function(){var t=this,o=this.state,e=o.activeKey,n=o.textSearch,a=this.props.t;return Co(A.Z,{className:"product-promotion"},Co("div",{className:"tools-container"},Co(v.default,{activeKey:e,defaultActiveKey:"advance",tabPosition:"top",onChange:function(o){return t.onChangeActiveKey(o)}},Co(Bo,{tab:a("pages.shop.product.promotion.default"),key:"default"},this.renderDefaultPromotion()),Co(Bo,{tab:a("pages.shop.product.promotion.advance"),key:"advance"},this.renderAdvancePromotion())),Co("div",{className:"filter"},Co(r.default,{placeholder:a("pages.shop.product.promotionAdvance.searchPromotionByNameId"),onChange:function(o){t.setState({textSearch:o.target.value}),t.debounceHandleSearchPromotion(o.target.value)},prefix:Co(mt.Z,null),value:n}))))}}]),e}(x.Component);(0,g.Z)(Ro,"pageInfo",{title:"pages.shop.product.promotion.promotionOfProduct",sassStyle:S()});var Lo=(0,P.$j)((function(t){return Do({timezone:t.navigation.user.timezone},(0,V.HN)(t))}),{fetchPromotionProducts:X.WD1,deletePromotions:X.oJk,activePromotions:X._IG,deactivePromotions:X.X$7,fetchCategories:X.pED,fetchProductsTags:X.qkF,fetchPrintBarcodes:X.P3w,fetchMaterials:X.A56})((0,b.Z)(Ro))},49800:function(t,o,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/product/promotion",function(){return e(33367)}])}},function(t){t.O(0,[5460,2902,9774,2888,179],(function(){return o=49800,t(t.s=o);var o}));var o=t.O();_N_E=o}]);