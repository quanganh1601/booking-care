(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{93264:function(t){!function(){"use strict";t.exports=".option-attribute .ant-select-item-group{background-color:#d9d9d9;font-weight:800}"}()},52469:function(t){!function(){"use strict";t.exports=".checkbox-auto-gen-variation{margin-right:5px}.checkbox-auto-gen-variation .ant-checkbox .ant-checkbox-inner{width:20px;height:20px}.checkbox-auto-gen-variation .ant-checkbox .ant-checkbox-inner::after{transform:rotate(45deg) scale(1) translate(-45%, -70%)}.edit-remain-quantity .ant-input-prefix{width:70%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;height:30px}.batch-shelf-modal .ant-modal-body{max-height:72vh;min-height:36vh;overflow:auto}.variation-expanded-items{display:flex;width:100%;height:36px;padding-left:16px}.variation-expanded-items .variation-expanded-item{width:25%;display:flex;align-items:center}.variation-expanded-items .variation-expanded-item .title{font-weight:500;margin-right:8px}"}()},25803:function(t){!function(){"use strict";t.exports="tr.drop-over-downward td{border-bottom:2px dashed #096dd9}tr.drop-over-upward td{border-top:2px dashed #096dd9}.note-textarea{border-radius:2px !important}.promotion-product{margin-top:10px;background-color:#f7f7f7;box-shadow:rgba(63,63,68,.05) 0px 0px 0px 1px,rgba(63,63,68,.15) 0px 1px 3px 0px;border-radius:2px;border:none;position:relative}.promotion-product .header{display:flex;justify-content:space-between;align-items:center;padding:8px 16px;background:#fff}.promotion-product .header .title{font-weight:550;margin-left:5px}.promotion-product .header .search{width:420px}.promotion-product .ant-table-wrapper{border:none !important}.product-promotion-table .ant-table-cell{white-space:normal !important}.box-auto-complete{margin-bottom:0px !important}.print-label .tox-statusbar{height:0px;border:none}.print-label .tox-tinymce{min-height:81vh !important}.print-label li{list-style-type:unset !important}"}()},19814:function(t){!function(){"use strict";t.exports=".attribute-table-edit{margin-top:10px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border:none !important;width:410px}.attribute-table-edit .ant-empty-normal{margin:0px}.attribute-table-edit .ant-table-body{width:410px}.attribute-table-edit .ant-table-tbody>tr>td.ant-table-cell:first-child{padding:4px 0px !important}.attribute-table-edit .ant-table-tbody>tr>td.ant-table-cell:nth-child(2){padding:4px 0px 4px 4px !important}.attribute-table-edit .ant-table{border-radius:2px}.attribute-table-edit .ant-table .ant-input{min-height:32px;border-radius:2px !important}"}()},80381:function(t){!function(){"use strict";t.exports=".video-card{height:100%;width:100%;border:1px solid #d9d9d9;position:relative}.video-card .video-card-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:calc(100% - 16px);height:calc(100% - 16px);overflow:hidden;padding:8}.video-card .video-card-content .video-care-error{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:red}.video-card .video-card-info{width:100%;height:100%}.video-card .video-card-function{position:absolute;top:50%;transform:translateY(-50%);z-index:1;padding:20px;text-align:center;opacity:0;transition:.5s;width:100%;height:100%;padding:0;display:flex;align-items:center;justify-content:center}.video-card .video-card-function .container-image-icon{position:relative;width:45px;height:45px}.video-card .video-card-function .container-image-icon .icon{position:absolute;cursor:pointer}.video-card .video-card-function .container-image-icon .icon-top-left{top:0;left:0}.video-card .video-card-function .container-image-icon .icon-top-right{top:0;right:0}.video-card .video-card-function .container-image-icon .icon-bottom-left{bottom:0;left:0}.video-card .video-card-function .container-image-icon .icon-bottom-right{bottom:0;right:0}.video-card .video-card-function .container-video-icon{display:flex;justify-content:space-between;width:80%}.video-card .video-card-content:hover .video-card-function{opacity:1;background-color:rgba(0,0,0,.5)}.video-card .video-card-function span{color:#fff;margin:0;padding:0px;font-size:16px;text-transform:uppercase;opacity:90%}"}()},5823:function(t){!function(){"use strict";t.exports=".modal-boost-products .ant-modal .ant-modal-body .ant-table-wrapper{border:0 !important}.modal-boost-products .ant-modal .ant-modal-body .ant-table-wrapper .row-selection-boost-product{background-color:#f7f7f7}.product-creator-modal .ant-modal{top:20px !important}.product-creator-modal .ant-modal .ant-modal-header{padding:6px 24px !important}.product-creator-modal .ant-modal .ant-modal-body{padding-bottom:0;background-color:#ededed;height:calc(100vh - 125px);overflow:hidden;border-radius:2px;padding:unset}.product-creator-modal .ant-modal .submenu-sale-channel .ant-menu-submenu-arrow{display:none}.product-creator-modal .ant-modal .ant-modal-footer{padding:0;text-align:left !important}.product-creator-modal .ant-modal .steps-container{padding:16px;overflow:auto}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels{font-size:13px}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .logistics-setting-panel{padding:13px;background:#fafafa}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .logistics-setting-panel__section{border:1px solid #e8e8e8;border-radius:1px;position:relative;padding:10px}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .logistics-setting-panel__section .logistics-setting-panel__item{padding:0 20px;display:flex;align-items:center}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .logistics-setting-panel__section .logistics-setting-panel__item .logistics-setting-panel__item__label{font-size:10px;color:#fff;background-color:#ff5722;line-height:1.8em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border-radius:2px;text-align:center;vertical-align:middle;padding:2px 8px}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .logistics-setting-panel__section .logistics-setting-panel__item .ember-view{display:flex;justify-content:flex-end}.product-creator-modal .ant-modal .steps-container .shopee_logistics_channels .shopee-button--inverted{background:0 0;border:1px solid #ff5722;box-shadow:none;color:#ff5722;margin-top:10px;width:35%}.product-creator-modal .ant-modal .steps-container .first-step{display:flex;flex-direction:column;padding-bottom:16px;font-size:14px}.product-creator-modal .ant-modal .steps-container .first-step .box-p1{flex:1;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container{background-color:#fff;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:16px}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info{display:grid;width:100%;margin-bottom:16px}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info .print-label img{max-width:600px !important}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info .title{font-weight:500;white-space:nowrap;margin-bottom:4px}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info .ant-input{border-radius:2px !important}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info .ant-input-affix-wrapper{margin-top:10px;border-radius:2px !important}.product-creator-modal .ant-modal .steps-container .first-step .box-p1 .id-container .product-info .brand .ant-select{width:100%;margin-top:10px}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table{margin-top:16px;box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border:none !important}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-empty-normal{margin:0px}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-table-body{overflow:hidden !important;max-height:-webkit-fit-content !important;max-height:-moz-fit-content !important;max-height:fit-content !important}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-table-tbody>tr>td.ant-table-cell:first-child{padding:4px 0 !important}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-table-tbody>tr>td.ant-table-cell:nth-child(2){padding:4px 8px 4px 0 !important}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-table{border-bottom:0 !important;border-radius:2px}.product-creator-modal .ant-modal .steps-container .first-step .attribute-table .ant-table .ant-input{min-height:32px;border-radius:2px !important}.product-creator-modal .ant-modal .steps-container .first-step .limit_quantity_to_warn{margin-top:15px;display:flex;line-height:37px;font-size:14px}.product-creator-modal .ant-modal .steps-container .first-step .limit_quantity_to_warn .ant-input-prefix{font-size:14px}.product-creator-modal .ant-modal .steps-container .first-step .limit_quantity_to_warn .ant-input{text-align:right}.product-creator-modal .ant-modal .steps-container .first-step .add-attribute{position:absolute;right:8px;top:4px;z-index:999;display:flex;align-items:flex-end;justify-content:space-between}.product-variations{box-shadow:0 0 0 1px rgba(63,63,68,.05),0 1px 3px 0 rgba(63,63,68,.15);border-radius:2px}.product-variations .product-tools{display:flex;padding:12px 16px;background:#fff;border-radius:2px 2px 0px 0px;border-bottom:1px solid #d9d9d9}.product-variations .ant-form-item{margin:0px !important}.product-variations .editable-cell{position:relative}.product-variations .editable-cell-value-wrap{cursor:pointer;min-height:32px;padding:4px}.product-variations .editable-row:hover .editable-cell-value-wrap{border:1px solid #d9d9d9;border-radius:2px;padding:3px}.product-variations .ant-input{border-radius:2px !important}.product-variations .box-input-number-wrapper{border:0px !important}.product-variations .ant-input-number-focused{border-radius:2px !important}.product-variations .box-input-number-wrapper .input-format-number{border-radius:2px;border:1px solid #d9d9d9}.product-variations .ant-input-number-input{padding:0px 4px 0px 0px}.product-variations .editable-table{border:none !important}.product-variations .editable-table .ant-table-bordered .ant-table-body>table{border:none !important}.product-variations .editable-table .align-right-column{white-space:normal !important}.ant-select-disabled .ant-select-selection{cursor:default;color:rgba(0,0,0,.65)}.ant-input-disabled{cursor:default;color:rgba(0,0,0,.65)}.remain-input .ant-input-disabled{cursor:pointer}.ant-select-not-found{cursor:default !important}.ant-select-dropdown-search .ant-select-search__field__mirror{display:none}.ant-select-tree ul,.ant-select-tree li{font-size:14px}.remain-input .ant-input-affix-wrapper{border-radius:2px}.ant-tree ul,.ant-tree li{font-size:14px}.ant-tree .ant-tree-node-content-wrapper{width:100%}.ant-select-selection--multiple>ul>li{margin-top:2px !important}.image-container .ant-popover-inner{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.image-container .ant-popover-inner .ant-upload-list-picture-card{flex-wrap:wrap;flex-direction:row;max-width:560px}.image-container .ant-popover-inner .ant-upload-select-picture-card .anticon{font-size:28px;color:#999}.image-container .ant-popover-inner .ant-upload-select-picture-card .ant-upload-text{margin-top:8px;font-size:12px;color:#666}.ant-upload-list-picture-card{display:flex}.image-preview{z-index:99999}.image-preview .ant-modal-body{padding:0;line-height:.5}.remain-popover .ant-input-affix-wrapper:not(:last-child){margin-bottom:5px}.remain-popover .ant-input{text-align:right}.ant-table-bordered .ant-table-tbody>tr>td,.ant-table-bordered .ant-table-thead>tr>th{border:none}.attribute-list{padding:0;max-width:137px}.attribute-list .ant-popover-arrow{display:none}.attribute-list .ant-menu-item{font-size:14px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:137px}.attribute-list .ant-menu-item:not(:last-child){border-bottom:1px dashed #d9d9d9}.attribute-list .ant-menu-item-active{background:#ecf6fd}.attribute-list .ant-popover-inner-content{padding:0 !important}.attribute-list .ant-popover-inner{overflow:hidden}"}()},12499:function(t,e,r){"use strict";var n,o=r(8799),a=r(74047),i=r(52700),c=r(4706),s=r(33814),u=r(44102),l=r(20775),d=r(26265),p=r(64749),f=r(23279),h=r.n(f),m=r(67294),g=r(7463),v=r(36492),y=r(95213),_=r(87217),b=r(82732),S=r(93264),w=r.n(S),C=m.createElement;function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){(0,d.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function k(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,l.Z)(t);if(e){var o=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var P=p.default.Option,I=p.default.OptGroup,V=(0,_.Z)()(n=function(t){(0,s.Z)(r,t);var e=k(r);function r(t){var n;return(0,a.Z)(this,r),n=e.call(this,t),(0,d.Z)((0,c.Z)(n),"handleOutsideSize",(function(t){n.divRef.current&&!n.divRef.current.contains(t.target)&&n.toggleEdit()})),(0,d.Z)((0,c.Z)(n),"handleFocus",(function(){var t;null===(t=n.input)||void 0===t||t.focus()})),(0,d.Z)((0,c.Z)(n),"toggleEdit",(function(){var t=n.props.callBack,e=n.state,r=e.open,o=e.changeValue;!o&&t({currentEdit:null}),!r&&n.setState({open:!0}),o&&n.setState({changeValue:!1})})),(0,d.Z)((0,c.Z)(n),"save",(function(t,e){var r=n.props,o=r.handleSave,a=r.dataIndex,i=r.currentShop,c=r.callBack,s=r.index;("number"==e&&n.setState({changeValue:!0},(function(){return c({currentEdit:null})})),"weight"==a)?o(a,(i.config_weight_product?1e3*t:t)||0,s):o(a,t&&t.target?t.target.value:t,s)})),(0,d.Z)((0,c.Z)(n),"attributeSelectChildren",(function(){var t=n.props.isClone?n.props.product:n.props.creator;return t.product_attributes&&t.product_attributes.length>0?t.product_attributes.filter((function(t){return""!=t.name})).map((function(t,e){return C(I,{label:t.name,key:e},(t.values||[]).map((function(r,n){var o,a=null===(o=t.keyword.find((function(t){return t.value==r})))||void 0===o?void 0:o.keyValue;return C(P,{value:JSON.stringify({name:t.name,value:r,keyValue:(0,y.Mle)(a,!0).toUpperCase()}),key:"".concat(e).concat(n)},C("strong",null,t.name,": "),r)})))})):null})),(0,d.Z)((0,c.Z)(n),"debounceOnChange",h()((function(t){return n.save(t,"string")}),300)),(0,d.Z)((0,c.Z)(n),"handleChangeSize",(function(t,e){var r=n.props,o=r.record,a=r.index,i=x(x({},o.size||{}),{},(0,d.Z)({},e,t));n.props.handleSave("size",i,a)})),(0,d.Z)((0,c.Z)(n),"getInput",(function(){var t=n.props,e=t.dataIndex,r=t.record,a=t.currentShop,i=t.handleAttributeSelect,c=t.handleAttributeDeselect,s=t.index,u=t.handleSave,l=t.creator,d=(r.size||{}).length||0,f=(r.size||{}).width||0,h=(r.size||{}).height||0;if("weight"==e||"limit_quantity_to_warn"==e||e.match(/.*_price/)||"price_at_counter"==e){var m="weight"==e?r[e]:(0,b.vW)(r[e]||0),y="retail_price"==e&&l.is_accessory;return C(g.default,{isMoney:"limit_quantity_to_warn"!=e&&"weight"!=e,isPercent:"weight"==e,currency:a.currency,callBack:function(t){return n.save(t,"number")},value:m||0,onBlur:function(){return n.toggleEdit()},decimal:"weight"==e,autoFocus:!0,disabled:y})}return"fields"==e?C(p.default,{mode:"multiple",dropdownStyle:{fontSize:14},style:{width:"100%"},ref:function(t){return n.input=t},value:r.fields,open:n.state.open,onBlur:function(){return n.toggleEdit()},onSelect:function(t){return i(t,s)},onDeselect:function(t){return c(t,s)},dropdownMatchSelectWidth:!1,dropdownClassName:"option-attribute"},n.attributeSelectChildren()):"keyword"==e?C(p.default,{mode:"tags",dropdownStyle:{display:"none"},style:{width:"100%"},ref:function(t){return n.input=t},value:r.keyword?r.keyword.split(/\;+/):[],onBlur:function(){return n.toggleEdit()},onChange:function(t){var e=t.filter((function(t){return t.trim()})).map((function(t){return t.trim().replace(/\s*\;/g,"").replace(/\;+/g,"|")})).join("|");u("keyword",e,s)}}):"size"==e?C("div",{ref:n.divRef},C(o.Z,{ref:function(t){return n.input=t},step:1,value:d,size:"small",style:{width:50},parser:function(t){return t.replace(/(\.|\,)/g,"")},onChange:function(t){return n.handleChangeSize(t,"length")}}),C("span",{style:{marginLeft:7,marginRight:7}},"x"),C(o.Z,{step:1,value:f,size:"small",style:{width:50},parser:function(t){return t.replace(/(\.|\,)/g,"")},onChange:function(t){return n.handleChangeSize(t,"width")}}),C("span",{style:{marginLeft:7,marginRight:7}},"x"),C(o.Z,{step:1,value:h,size:"small",style:{width:50},parser:function(t){return t.replace(/(\.|\,)/g,"")},onChange:function(t){return n.handleChangeSize(t,"height")}})):C(v.Z$,{ref:function(t){return n.input=t},onPressEnter:function(t){return n.save(t.target.value,"string")},onChange:function(t){return n.debounceOnChange(t.target.value)},placeholder:n.getPlaceholder(e),value:r[e],onBlur:function(){return n.toggleEdit()}})})),(0,d.Z)((0,c.Z)(n),"getPlaceholder",(function(t){var e=n.props,r=e.record,o=e.creator,a=e.t,i=e.currentShop,c="";return"custom_id"===t&&(c=r.display_id?(0,y.pyT)(r.display_id,0):a("automatic")),"barcode"===t&&(c=o.display_id&&r.display_id?i.use_custom_id_for_barcode&&r.custom_id?r.custom_id:"".concat(o.display_id,"-").concat(r.display_id):void 0),c})),n.state={open:!0,changeValue:!1},n.divRef=m.createRef(),n}return(0,i.Z)(r,[{key:"componentDidMount",value:function(){setTimeout(this.handleFocus),document.addEventListener("click",this.handleOutsideSize)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleOutsideSize)}},{key:"render",value:function(){return C("div",null,this.getInput(),C("style",{dangerouslySetInnerHTML:{__html:w()}}))}}]),r}(m.Component))||n;e.Z=V},37145:function(t,e,r){"use strict";r.d(e,{Z:function(){return f}});var n=r(74047),o=r(52700),a=r(33814),i=r(44102),c=r(20775),s=r(67294),u=r(95213),l=r(15074),d=s.createElement;function p(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,c.Z)(t);if(e){var o=(0,c.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}var f=function(t){(0,a.Z)(r,t);var e=p(r);function r(t){var o;return(0,n.Z)(this,r),(o=e.call(this,t)).state={html:t.html},o}return(0,o.Z)(r,[{key:"componentDidUpdate",value:function(t,e){(t.html!=this.props.html||!t.isEditting&&this.props.isEditting!=t.isEditting)&&this.setState({html:this.props.html})}},{key:"render",value:function(){var t=this,e=this.props,r=e.onChange,n=e.accessToken;return d("div",{className:"print-label",style:this.props.style},d(l.M,{init:{autoresize_on_init:!1,content_style:"img { max-width: 600px; height: auto };",plugins:"link autoresize print preview searchreplace autolink directionality visualblocks visualchars fullscreen image template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern help code emoticons",toolbar:"undo redo | formatselect | fontsizeselect | fontselect bold italic strikethrough forecolor backcolor | image | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | removeformat | addcomment | code emoticons preview",fontsize_formats:"2pt 4pt 6pt 8pt 10pt 12pt 14pt 18pt 24pt 36pt",images_upload_url:"".concat((0,u.LpH)(!0),"/contents?access_token=").concat(n),paste_data_images:!0,inline_styles:!0,valid_children:"+body[style]",font_formats:"Zawgyi (Myanmar)=Zawgyi-One;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",init_instance_callback:function(t){t.on("ExecCommand",(function(t){(0,u.jkM)(t)}))},images_upload_handler:function(t,e,r){var o,a;(o=new XMLHttpRequest).withCredentials=!1,o.open("POST","".concat((0,u.LpH)(!0),"/contents?access_token=").concat(n)),o.onload=function(){var t;200!=o.status||o.status>=300?r("HTTP Error: "+o.status):(t=JSON.parse(o.responseText))&&"string"==typeof t.content_url?e(t.content_url):r("Invalid JSON: "+o.responseText)},(a=new FormData).append("file",t.blob(),t.filename()),o.send(a)}},apiKey:"je99cb2xdb7gg3gty6dn9rne9vblokq43m78p69xoue1c1sq",value:this.state.html,onEditorChange:function(e){t.setState({html:e}),r(e)}}))}}]),r}(s.Component)},15118:function(t,e,r){"use strict";var n,o=r(2307),a=r(74047),i=r(52700),c=r(4706),s=r(33814),u=r(44102),l=r(20775),d=r(26265),p=r(67294),f=r(14494),h=r(87217),m=r(95213),g=p.createElement;function v(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,l.Z)(t);if(e){var o=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var y=(0,h.Z)()(n=function(t){(0,s.Z)(r,t);var e=v(r);function r(t){var n;return(0,a.Z)(this,r),n=e.call(this,t),(0,d.Z)((0,c.Z)(n),"columns",[{title:"ID",dataIndex:"id",align:"right",width:"10%",editable:!0},{title:n.props.t("components.productCreatorFirstStep.autoCode"),dataIndex:"custom_id",align:"right",width:"10%",editable:!0},{title:n.props.t("components.accessoriesSecondStep.retailPrice"),dataIndex:"retail_price",align:"right",width:"10%",editable:!0},{title:n.props.t("components.productVariationCard.selectProperties"),dataIndex:"fields",align:"center",editable:!0},{title:n.props.t("components.productVariationCard.weight"),dataIndex:"weight",align:"right",width:"10%",editable:!0},{title:n.props.t("components.productImportExcel.index.actualRemain"),dataIndex:"total_quantity",align:"right",width:"10%"}]),(0,d.Z)((0,c.Z)(n),"getData",(function(){var t=n.props,e=t.currentShop,r=t.shopeeProduct;return r&&r.variation&&r.variation.length?r.variation.map((function(t,e){return t.key=e,t})).map((function(t){return{id:t.id,key:t.key,custom_id:t.sku?t.sku:"",weight:t.weight?t.weight:0,images:[],fields:r.tier&&r.tier.length>0&&n.getFields(t.name)?n.getFields(t.name).trim():"",retail_price:(0,m.ufS)(t.price,e.currency),total_quantity:(0,m.oH6)(t.quantity),visible:!1}})):[]})),(0,d.Z)((0,c.Z)(n),"getDataCreate",(function(){var t=n.props,e=t.product,r=t.currentShop;return(e.variations||[]).map((function(t,e){return t.key=e,t})).map((function(t){return{id:"",key:t.key,custom_id:t.custom_id,weight:t.weight?t.weight:0,images:[],fields:t.fields&&t.fields.length>0?n.getFieldsCreate(t.fields).trim():"",retail_price:(0,m.ufS)(t.retail_price,r.currency),total_quantity:(0,m.oH6)(t.remain_quantity),visible:!1}}))})),(0,d.Z)((0,c.Z)(n),"getFieldsCreate",(function(t){return t.reduce((function(t,e){return t+" "+e.name+":"+e.value}),"")})),(0,d.Z)((0,c.Z)(n),"getFields",(function(t){var e=n.props,r=e.shopeeProduct;e.t;return(t?t.split(","):[]).reduce((function(t,e,n){return t+"  "+r.tier[n].name+":"+e}),"")})),n.state={cartesianProductOf:[]},n}return(0,i.Z)(r,[{key:"render",value:function(){var t=this.props.createInShopee;return g("div",{className:"product-variations",style:{marginBottom:10}},g(o.Z,{rowClassName:function(){return"editable-row"},className:"editable-table",bordered:!0,dataSource:t?this.getDataCreate():this.getData(),columns:this.columns,pagination:!1}))}}]),r}(p.Component))||n;e.Z=(0,f.$j)(null,{})(y)},73363:function(t,e,r){"use strict";var n,o=r(62443),a=r(84960),i=r(28140),c=r(28465),s=r(94055),u=r(74047),l=r(52700),d=r(4706),p=r(33814),f=r(44102),h=r(20775),m=r(26265),g=r(56697),v=r(67294),y=r(14494),_=r(87217),b=r(95357),S=r(53587),w=r(14457),C=r(73171),Z=r(49101),x=r(99562),k=r(57119),P=r(95213),I=r(31432),V=r(80381),O=r.n(V),D=r(22318),N=v.createElement;function A(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,h.Z)(t);if(e){var o=(0,h.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}var T=g.Z.confirm,F=(0,_.Z)()(n=function(t){(0,p.Z)(r,t);var e=A(r);function r(t){var n;return(0,u.Z)(this,r),n=e.call(this,t),(0,m.Z)((0,d.Z)(n),"handleCancelPreview",(function(){return n.setState({previewVisible:!1})})),(0,m.Z)((0,d.Z)(n),"handelRemoveImage",(function(t,e,r){t=t.filter((function(t){return t.uid!=e.uid})),n.props.handleSave("images",t,r)})),(0,m.Z)((0,d.Z)(n),"handleRemoveVideo",(function(t,e,r){t=t.filter((function(t){return t.uid!=e.uid})),n.setState({keyViewingFiles:e.uid,videoList:t}),n.props.handleSave("videos",t,r)})),(0,m.Z)((0,d.Z)(n),"handlePinFile",(function(t,e,r,o){var a=t.findIndex((function(t){return t.uid==e.uid}));t.splice(0,0,t.splice(a,1)[0]),"videos"==o&&n.setState({keyViewingFiles:e.uid,videoList:t}),n.props.handleSave(o,t,r)})),(0,m.Z)((0,d.Z)(n),"renderFileCard",(function(t,e,r,o){var a=n.props,i=a.handleSetProductImage,c=a.t,u=n.state,l=u.visibleModalVideo,d=u.keyViewingFiles,p=u.visibleModalImage;return N("div",{className:"video-card"},N("div",{className:"video-card-content"},N("div",{className:"video-card-info"},"images"==o?N("img",{style:{width:"100%",height:"100%",objectFit:"cover"},src:(0,P.UXE)(e.response.content_url,86,86)}):N("video",{width:"100%",height:"100%",autoPlay:l,muted:!0},N("source",{src:e.response.content_url,type:"video/mp4"})),N("div",null,N("div",{className:"video-card-function"},N("div",{className:"".concat("images"==o?"container-image-icon":"container-video-icon"," ")},N(s.default,{title:c("pages.shop.setting.crmProfile.see")},N(b.Z,{className:"icon icon-top-left",onClick:function(){return n.setState("images"==o?{visibleModalImage:!0,keyViewingFiles:e.uid}:{visibleModalVideo:!0,keyViewingFiles:e.uid})}})),"images"==o&&N(s.default,{title:c("components.productCreatorFirstStep.settingUpProductImage")},N(S.Z,{className:"icon icon-top-right",onClick:function(){return i(e.response.content_url)}})),N(s.default,{title:c("components.productCreatorFirstStep.pin")},N(w.Z,{className:"icon icon-bottom-left",onClick:function(){return n.handlePinFile(t,e,r,o)}})),N(s.default,{title:c("components.orderAdvanceFilter.delete")},N(C.Z,{className:"icon icon-bottom-right",onClick:function(){"images"==o?n.handelRemoveImage(t,e,r):n.handleRemoveVideo(t,e,r)}}))))))),e.uid==d&&N(g.Z,{visible:"images"==o?p:l,onCancel:function(){return n.setState("images"==o?{visibleModalImage:!1}:{visibleModalVideo:!1})},wrapClassName:"image-preview",footer:null},"images"==o?N("img",{style:{width:"100%",height:"100%",objectFit:"cover"},src:(0,P.UXE)(e.response.content_url,352,352),width:352,height:"auto"}):N("video",{width:"100%",height:"100%",autoPlay:l,controls:!0,muted:!0},N("source",{src:e.response.content_url,type:"video/mp4"}))))})),(0,m.Z)((0,d.Z)(n),"handlePreview",(function(t){var e;n.setState({previewImage:(null===(e=t.response)||void 0===e?void 0:e.content_url)||(null===t||void 0===t?void 0:t.thumbUrl),previewVisible:!0})})),(0,m.Z)((0,d.Z)(n),"renderUploadFile",(function(t,e,r){var o=n.state,a=o.previewVisible,i=o.previewImage,s=n.props,u=s.accessToken,l=s.t;return N("div",{style:{display:"flex"}},N(c.Z,{action:"".concat((0,P.LpH)(),"/contents?access_token=").concat(u),listType:"picture-card",accept:"image"==r?"image/*":"video/*",multiple:!0,beforeUpload:function(t){if("image"==r)return new Promise((function(e){var r=new FileReader;r.onload=function(){var n=new Image;n.onload=function(){t.width=n.width,t.height=n.height,e(t)},n.src=r.result},r.readAsDataURL(t)}))},data:function(t){if("image"==r)return{file:t,width:t.width,height:t.height}},fileList:t,onPreview:n.handlePreview,onChange:function(t){if("image"==r){if("error"==t.file.status)return void(t.file.size>3e4?D.Z.error("Th\u1ea5t b\u1ea1i","Dung l\u01b0\u1ee3ng \u1ea3nh qu\xe1 l\u1edbn"):D.Z.error("Th\u1ea5t b\u1ea1i","L\u1ed7i kh\xf4ng x\xe1c \u0111\u1ecbnh"));n.props.handleSave("images",t.fileList,e)}else"error"==t.file.status&&D.Z.error("Th\u1ea5t b\u1ea1i","L\u1ed7i kh\xf4ng x\xe1c \u0111\u1ecbnh"),"done"==t.file.status&&n.setState({videoList:t.fileList.filter((function(t){return!t.error}))},(function(){return n.props.handleSave("videos",t.fileList,e)}))},itemRender:function(o,a){return a.error?N("div",{style:{border:"1px solid red"},className:"video-card"},N("div",{className:"video-card-content"},N("div",{className:"video-care-error"},N("p",null,l("error"))),N("div",{className:"video-card-info"},N("div",null,N("div",{style:{width:"100%",height:"100%"},className:"video-card-function"},N(C.Z,{style:{cursor:"pointer",marginTop:12},onClick:function(){return n.handleRemoveVideo(t,a,e)}})))))):a.response&&a.response.content_url?"image"==r?n.renderFileCard(t,a,e,"images"):"video"==r?n.renderFileCard(t,a,e,"videos"):o:o}},N("div",null,N(Z.Z,null),N("div",{className:"ant-upload-text"},"image"==r?"Upload ".concat(l("pages.shop.product.variation.image")):"Upload video"))),N(g.Z,{visible:a,footer:null,onCancel:n.handleCancelPreview,wrapClassName:"image-preview"},N("img",{style:{width:"100%"},src:i})))})),(0,m.Z)((0,d.Z)(n),"popoverImages",(function(t,e){var r=(0,i.Z)(n.state.videoList);return N("div",null,n.renderUploadFile(t,e,"image"),n.renderUploadFile(r.filter((function(t){return!t.error})),e,"video"))})),(0,m.Z)((0,d.Z)(n),"handleHoverChange",(function(t,e,r){var o=Array(r).fill(!1);o[e]=t;var a=Array(r).fill(!1);n.setState({hoveredImageOrVideo:o,clickedImageOrVideo:a})})),(0,m.Z)((0,d.Z)(n),"renderHoverImageOrVideo",(function(t,e){var r,n;return N("div",null,t.length?N("img",{src:(0,P.UXE)(null===(r=t[0].response)||void 0===r?void 0:r.content_url,600,600),width:300,style:{objectFit:"cover"},height:"auto"}):e.length?N("div",{style:{height:300,borderRadius:2,overflow:"hidden"}},N("video",{className:"image-video",height:"300",autoPlay:!0,controls:!0,muted:!0},N("source",{src:null===(n=e[0].response)||void 0===n?void 0:n.content_url,type:"video/mp4"}))):N(a.ZP,{icon:N(x.Z,null),size:300,style:{borderRadius:2}}))})),(0,m.Z)((0,d.Z)(n),"handleShowConfirm",(function(t,e,r,o){var a=n.state.clickedImageOrVideo;"visibleImages"==r&&a.includes(!0)?(a[e]=!1,n.setState({clickedImageOrVideo:a})):n.showModalConfirm(t,e,r,o)})),(0,m.Z)((0,d.Z)(n),"showModalConfirm",(function(t,e,r,o){var a=n.props,i=a.t,c=a.variationsData,s=Array(o).fill(!1),u=c[e].videos&&c[e].videos.length>0?c[e].videos.filter((function(t){return t})).map((function(t,e){return t.uid?t:{uid:e,response:{content_url:t},status:"done",url:t}})):[];T({title:i("components.productCreatorSecondStep.confirmSync"),icon:N(k.Z,null),okText:i("components.productCreatorSecondStep.next"),cancelText:i("components.productCreatorSecondStep.cancel"),onOk:function(){s[e]=t,c[e][r]=t,n.props.setVariations(c),"visibleImages"==r?n.setState({clickedImageOrVideo:s,videoList:u}):n.setState({videoList:u})},onCancel:function(){c[e][r]=!1,n.props.setVariations(c),"visibleImages"!=r&&n.setState({clickedImageOrVideo:s})}})})),(0,m.Z)((0,d.Z)(n),"handleClickChange",(function(t,e,r){var o=Array(r).fill(!1);o[e]=t;var a=Array(r).fill(!1);n.setState({hoveredImageOrVideo:a,clickedImageOrVideo:o})})),(0,m.Z)((0,d.Z)(n),"handlePopoverVisible",(function(t,e){var r=n.props,o=r.variationsData,a=r.isProduct;o[e].visibleImages=t,a&&n.props.setVariations(o),o[e].visibleImages&&n.setState({videoList:o[e].videos&&-1!=o[e].videos?o[e].videos.filter((function(t){return t})).map((function(t,e){return t.uid?t:{uid:e,response:{content_url:t},status:"done",url:t}})):[]})})),n.state={clickedImageOrVideo:[],hoveredImageOrVideo:[],videoList:[],previewVisible:!1,previewImage:"0",keyViewingFiles:void 0,visibleModalVideo:!1,visibleModalImage:!1},n}return(0,l.Z)(r,[{key:"render",value:function(){var t,e,r,n,i=this,c=this.props,s=c.variation,u=c.variationsData,l=(c.creator,c.isCloneSync),d=this.state,p=d.hoveredImageOrVideo,f=d.clickedImageOrVideo,h=u.length,m=u.findIndex((function(t){return t.key==s.key})),g=s.images||[],y=s.videos||[];return N(v.Fragment,null,N(o.default,{content:this.renderHoverImageOrVideo(g,y),trigger:"hover",placement:"right",visible:p[m],onVisibleChange:function(t){return i.handleHoverChange(t,m,h)}},N(o.default,{trigger:"click",overlayClassName:"image-container",content:this.popoverImages(g,m),placement:"right",visible:f[m],onVisibleChange:function(t){return l?i.handleShowConfirm(t,m,"visibleImages",h):(i.handleClickChange(t,m,h),i.handlePopoverVisible(t,m))}},N("div",{style:{alignItems:"center",cursor:"pointer"}},g[0]&&g[0].response&&null!==(t=g[0].response)&&void 0!==t&&t.content_url?N(a.ZP,{src:(0,P.UXE)(null===(e=g[0].response)||void 0===e?void 0:e.content_url,32,32),size:32,style:{borderRadius:2}}):y[0]&&y[0].response&&null!==(r=y[0].response)&&void 0!==r&&r.content_url?N("div",{style:{width:30,height:30,borderRadius:2,marginLeft:6,overflow:"hidden"}},N("video",{className:"image-video",height:"30",muted:!0},N("source",{src:null===(n=y[0].response)||void 0===n?void 0:n.content_url,type:"video/mp4"}))):N(a.ZP,{icon:N(x.Z,null),size:32,style:{borderRadius:2}})))),N("style",{dangerouslySetInnerHTML:{__html:O()}}))}}]),r}(v.Component))||n;e.Z=(0,y.$j)((function(t){return{creator:(0,I.mz)(t),currentShop:t.shop.currentShop}}))(F)},60517:function(t,e,r){"use strict";r.d(e,{Z:function(){return Qe}});var n=r(11187),o=r(94055),a=r(65400),i=r(28140),c=r(74047),s=r(52700),u=r(4706),l=r(33814),d=r(44102),p=r(20775),f=r(26265),h=r(56697),m=r(50361),g=r.n(m),v=r(67294),y=r(14494),_=r(25449),b=r(7085),S=r(95357),w=r(88633),C=r(20574),Z=r(92104),x=r(49101),k=r(2307),P=r(82891),I=r(59361),V=r(4863),O=r(40987),D=r(42378),N=r(62443),A=r(51024),T=r(12386),F=r(60171),R=r(64749),E=r(23279),z=r.n(E),j=r(44908),M=r.n(j),q=r(91966),B=r.n(q),L=r(39693),W=r.n(L),G=r(7145),H=r.n(G),K=r(54549),U=r(8212),J=r(73171),Q=r(92977),$=r(73218),Y=r(22693),X=r(42768),tt=r(6700),et=r(17918),rt=r(95213),nt=r(31432),ot=r(36934),at=r(87217),it=r(25803),ct=r.n(it),st=r(97705),ut=r(7463),lt=r(91229),dt=r(38347),pt=r(90937),ft=v.createElement;function ht(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function gt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var vt,yt=-1,_t=function(t){(0,l.Z)(r,t);var e=gt(r);function r(){return(0,c.Z)(this,r),e.apply(this,arguments)}return(0,s.Z)(r,[{key:"render",value:function(){var t=this.props,e=t.isOver,r=t.connectDragSource,n=t.connectDropTarget,o=(t.moveRow,(0,dt.Z)(t,["isOver","connectDragSource","connectDropTarget","moveRow"])),a=mt(mt({},o.style),{},{cursor:"move"}),i=o.className;return e&&(o.index>yt&&(i+=" drop-over-downward"),o.index<yt&&(i+=" drop-over-upward")),r(n(ft("tr",(0,lt.Z)({},o,{className:i,style:a}))))}}]),r}(v.Component),bt={beginDrag:function(t){return yt=t.index,{index:t.index}}},St=(0,pt.GR)("row",{drop:function(t,e){var r=e.getItem().index,n=t.index;r!==n&&(t.moveRow(r,n),e.getItem().index=n)}},(function(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver()}}))((0,pt.Ej)("row",bt,(function(t){return{connectDragSource:t.dragSource()}}))(_t)),wt=r(13383),Ct=r(36492),Zt=r(48519),xt=r(88460),kt=r(76570),Pt=r(20920),It=r(32745),Vt=r(23177),Ot=v.createElement;function Dt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function At(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var Tt=(0,at.Z)()(vt=function(t){(0,l.Z)(r,t);var e=At(r);function r(t){var n;return(0,c.Z)(this,r),n=e.call(this,t),(0,f.Z)((0,u.Z)(n),"columnsPromotion",[{title:"",dataIndex:"none",width:"1%",align:"center"},{title:n.props.t("components.productCreatorFirstStep.promotionName"),dataIndex:"promotionName",ellipsis:!0},{title:n.props.t("components.productCreatorFirstStep.warehouses"),dataIndex:"warehouses",ellipsis:!0,align:"center"},{title:n.props.t("components.productCreatorFirstStep.type"),dataIndex:"type",ellipsis:!0,align:"center"},{title:n.props.t("pages.shop.product.promotionAdvance.discount"),dataIndex:"discount",ellipsis:!0,align:"center"},{title:n.props.t("components.productCreatorFirstStep.priceAfterDiscount"),dataIndex:"price",ellipsis:!0,align:"center"}]),(0,f.Z)((0,u.Z)(n),"columnsDiscountByProduct",[{title:"",dataIndex:"none",width:"1%",align:"center"},{title:"",dataIndex:"name",ellipsis:!0},{title:n.props.t("components.productCreatorFirstStep.fromQuantity"),dataIndex:"fromQuantity",width:"12%",ellipsis:!0,align:"center"},{title:n.props.t("components.productCreatorFirstStep.toQuantity"),dataIndex:"toQuantity",width:"12%",ellipsis:!0,align:"center"},{title:n.props.t("pages.shop.product.promotionAdvance.discount"),dataIndex:"discount",width:"15%",ellipsis:!0,align:"center"},{title:n.props.t("components.productCreatorFirstStep.priceAfterDiscount"),dataIndex:"price",width:"25%",ellipsis:!0,align:"center"}]),(0,f.Z)((0,u.Z)(n),"columnsCoupon",[{title:"",dataIndex:"none",width:"1%",align:"center"},{title:"",dataIndex:"name",ellipsis:!0},{title:n.props.t("pages.shop.product.promotionAdvance.discount"),dataIndex:"discount",ellipsis:!0,align:"center"}]),(0,f.Z)((0,u.Z)(n),"getTypeByProduct",(function(t){n.props.t;var e=(0,Pt.hq)(t.type);return Ot("span",null,e)})),(0,f.Z)((0,u.Z)(n),"getWarehouses",(function(t){var e,r=n.props,o=r.t,a=r.warehouses;if((null===(e=t.warehouse_ids)||void 0===e?void 0:e.length)>0){var i=a.filter((function(e){return t.warehouse_ids.includes(e.id)})).map((function(t){return t.name})).join(", ");return Ot("span",null,i)}return o("components.productCreatorFirstStep.allWarehouse")})),(0,f.Z)((0,u.Z)(n),"sourceDiscountByProduct",(function(t,e,r){var o=n.props,a=o.currentShop.currency,c=o.product,s=c.name,u=(c.id,c.variations),l=c.custom_id,d=c.display_id,p=[],f=n.getRetailPrices(t,e),h=Math.max.apply(Math,(0,i.Z)(f)),m=Math.min.apply(Math,(0,i.Z)(f));return t.map((function(t,e){var n,o=t.variation_id?u.find((function(e){return e.id==t.variation_id})):null,i={key:e,name:Ot("div",null,!o&&Ot("b",{style:{marginRight:5}},s||""),!o&&Ot("span",null,Ot(I.default,{color:"green"},l||(0,rt.pyT)(d,0))),o&&Ot("span",null,Ot(I.default,{color:"pink"},o.custom_id||(0,rt.pyT)(o.display_id,0))))};"coupon"==r?(i=Nt(Nt({},i),{},{discount:null!==(n=t.coupon_item_info)&&void 0!==n&&n.is_percent?"".concat(t.coupon_item_info.discount,"%"):(0,rt.ufS)(t.coupon_item_info.discount,a)}),p.push(i)):t.level_info.map((function(t){h=t.is_percent?h*t.discount/100:h-t.discount>0?h-t.discount:0,m=t.is_percent?m*t.discount/100:m-t.discount>0?m-t.discount:0,i=Nt(Nt({},i),{},{fromQuantity:t.from_quantity,toQuantity:t.to_quantity,discount:t.is_percent?"".concat(t.discount,"%"):(0,rt.ufS)(t.discount,a),price:o?t.is_percent?(0,rt.ufS)(o.retail_price*t.discount/100,a):o.retail_price-t.discount>0?(0,rt.ufS)(o.retail_price-t.discount,a):(0,rt.ufS)(0,a):h>0?"".concat((0,rt.ufS)(m,a)," - ").concat((0,rt.ufS)(h,a)):(0,rt.ufS)(h,a)}),p.push(i)}))})),p})),(0,f.Z)((0,u.Z)(n),"getDiscountByProduct",(function(t,e,r){var o=n.props,a=o.t,i=o.currentShop.currency;if(!e&&"coupon"==r){var c=t[0].coupon_item_info;return null!==c&&void 0!==c&&c.is_percent?"".concat((null===c||void 0===c?void 0:c.discount)||0,"%"):(0,rt.ufS)((null===c||void 0===c?void 0:c.discount)||0,i)}return Ot(N.default,{trigger:"hover",content:function(){return Ot(k.Z,{size:"small",pagination:!1,style:{width:"coupon"==r?400:600},columns:"coupon"==r?n.columnsCoupon:n.columnsDiscountByProduct,dataSource:n.sourceDiscountByProduct(t,e,r)})},placement:"right"},Ot("a",null,a("pages.shop.statistic.product.detail")))})),(0,f.Z)((0,u.Z)(n),"getDiscount",(function(t){var e,r=n.props,o=r.currentShop.currency,a=r.t,c=r.product,s=c.id,u=c.variations;switch(t.type){case"combo":t.is_value_combo||(e=t.is_use_percent?t.max_discount_by_percent>0?"".concat(t.discount_by_percent,"% - ").concat(a("components.productCreatorFirstStep.maxPrice"),": ").concat((0,rt.ufS)(t.max_discount_by_percent,o)):"".concat(t.discount_by_percent,"%"):(0,rt.ufS)(t.discount_amount,o));break;case"promotion_product":e=t.is_use_percent?t.max_promotion_by_percent>0?"".concat(t.promotion_percent,"% - ").concat(a("components.productCreatorFirstStep.maxPrice"),": ").concat((0,rt.ufS)(t.max_promotion_by_percent,o)):"".concat(t.promotion_percent,"%"):(0,rt.ufS)(t.discount_amount,o);break;case"fixed_prices":var l=u.reduce((function(e,r){var n=(t.items||[]).findIndex((function(e){return!t.is_variation&&e.product_id==s||t.is_variation&&e.variation_id==r.id}));if(n>-1){var o=r.retail_price-t.items[n].fixed_prices;o=o>0?o:0,e.push(o)}return e}),[]);l=M()(l);var d=Math.max.apply(Math,(0,i.Z)(l)),p=Math.min.apply(Math,(0,i.Z)(l));l.length>0&&(e=1==l.length?(0,rt.ufS)(p,o):"".concat((0,rt.ufS)(p,o)," - ").concat((0,rt.ufS)(d,o)));break;case"discount_by_product":case"coupon":var f=(t.items||[]).filter((function(e){return!t.is_variation&&e.product_id==s||t.is_variation&&u.find((function(t){return t.id==e.variation_id}))}));e=f.length>0?n.getDiscountByProduct(f,t.is_variation,t.type):""}return e})),(0,f.Z)((0,u.Z)(n),"getRetailPrices",(function(t,e){var r=n.props.product,o=r.id,a=r.variations,i=[],c=(t||[]).filter((function(t){return!e&&t.product_id==o||e&&a.find((function(e){return e.id==t.variation_id}))}));return c.length&&(i=a.reduce((function(t,r){e?c.findIndex((function(t){return t.variation_id==r.id}))>-1&&t.push(r.retail_price):t.push(r.retail_price);return t}),[])),i})),(0,f.Z)((0,u.Z)(n),"getPrice",(function(t){var e=n.props,r=e.currentShop.currency,o=(e.t,e.product),a=o.id,c=o.variations,s=[];switch(t.type){case"combo":s=n.getRetailPrices(t.combo_product_variations,t.is_variation);break;case"promotion_product":s=c.map((function(t){return t.retail_price}));break;case"fixed_prices":s=(t.items||[]).filter((function(e){return!t.is_variation&&e.product_id==a||t.is_variation&&c.find((function(t){return t.id==e.variation_id}))})).map((function(t){return t.fixed_prices}));break;case"coupon":s=c.reduce((function(e,r){var n=(t.items||[]).findIndex((function(e){return!t.is_variation&&e.product_id==a||t.is_variation&&e.variation_id==r.id}));if(n>-1){var o=r.retail_price;if("coupon"==t.type){var i,c=null===(i=t.items[n].coupon_item_info)||void 0===i?void 0:i.is_percent,s=c?100-t.items[n].coupon_item_info.discount:t.items[n].coupon_item_info.discount;o=s>0?c?o*s/100:o-s:0}else o-=t.items[n].fixed_prices;o=o>0?o:0,e.push(o)}return e}),[])}s=M()(s);var u=Math.max.apply(Math,(0,i.Z)(s)),l=Math.min.apply(Math,(0,i.Z)(s));switch(t.type){case"combo":return t.is_value_combo?(0,rt.ufS)(t.value_combo,r):s.length?(t.is_use_percent?(u=t.max_promotion_by_percent>0?u-t.max_promotion_by_percent:u*(100-t.discount_by_percent)/100,l=t.max_promotion_by_percent>0?l-t.max_promotion_by_percent:l*(100-t.discount_by_percent)/100):(u-=t.discount_amount,l-=t.discount_amount),u<=0&&l<=0?"":(l<=0&&(l=0),1==s.length?(0,rt.ufS)(l,r):"".concat((0,rt.ufS)(l,r)," - ").concat((0,rt.ufS)(u,r)))):"";case"promotion_product":return t.is_use_percent?(u=t.max_promotion_by_percent>0?u-t.max_promotion_by_percent:u*(100-t.promotion_percent)/100,l=t.max_promotion_by_percent>0?l-t.max_promotion_by_percent:l*(100-t.promotion_percent)/100):(u-=t.discount_amount,l-=t.discount_amount),u<=0&&l<=0?"":(l<=0&&(l=0),1==s.length?(0,rt.ufS)(l,r):"".concat((0,rt.ufS)(l,r)," - ").concat((0,rt.ufS)(u,r)));case"fixed_prices":return s.length&&s.length>0?u>0&&u!=l?"".concat((0,rt.ufS)(l,r)," - ").concat((0,rt.ufS)(u,r)):(0,rt.ufS)(l,r):"";case"coupon":return s.length?1==s.length?(0,rt.ufS)(l,r):"".concat((0,rt.ufS)(l,r)," - ").concat((0,rt.ufS)(u,r)):"";default:return""}})),(0,f.Z)((0,u.Z)(n),"handleOpenPromotion",(function(t){var e=n.props,r=e.showPromotionAdvance,o=e.shopId,a=e.accessToken,i=e.fetchComboPorductVariations;return"combo"==t.type?i(a,o,{combo_product_id:t.id,is_show:!0}).then((function(e){n.setState({record:Nt(Nt({},t),{},{variations:e})})})):r(a,o,t.id).then((function(t){return n.setState({record:Nt({},t)})}))})),(0,f.Z)((0,u.Z)(n),"getPromotion",(function(){var t=n.state.searchPromotionAndCombo,e=n.props,r=e.t,o=e.currentShop.timezone,a=e.product,i=n.props.checkPromotions(a);i=i.concat(n.props.checkCombos(a));var c=(t||"").toString().trim(),s=c?i.filter((function(t){return(0,rt.C6S)(c,t.display_id)||(0,rt.C6S)(c,t.name)})):i;return s.length>0?s.map((function(t,e){return{key:e,promotionName:Ot("div",null,["promotion_product"].includes(t.type)?Ot("div",{style:{fontWeight:500}},t.name):Ot("a",{onClick:function(){return n.handleOpenPromotion(t)}},t.name),!["promotion_product"].includes(t.type)&&t.start_time&&t.end_time&&Ot("div",{style:{whiteSpace:"normal"}},Ot("span",{style:{fontWeight:500}},r("components.productPromotionDetail.from"),":")," ",(0,rt.o0x)(o,t.start_time,!1,"YYYY/MM/DD HH:mm")," =",">",Ot("span",{style:{fontWeight:500}}," ",r("components.productPromotionDetail.to"),":")," ",(0,rt.o0x)(o,t.end_time,!1,"YYYY/MM/DD HH:mm"))),type:n.getTypeByProduct(t),warehouses:n.getWarehouses(t),discount:n.getDiscount(t),price:n.getPrice(t)}})):[]})),n.state={searchPromotionAndCombo:null,modalVisibile:!1,record:null},n}return(0,s.Z)(r,[{key:"render",value:function(){var t=this,e=this.state,r=e.searchPromotionAndCombo,n=e.record,o=this.props,a=o.t,i=o.shopId,c=o.currentShop,s=o.accessToken,u=this.getPromotion();return u.length>0||r?Ot("div",{className:"promotion-product"},Ot("div",{className:"header"},Ot("div",{className:"title"},a("components.productCreatorFirstStep.promotion")),Ot("div",{className:"search"},Ot(A.default,{className:"input-promotion-product",suffix:Ot(kt.Z,null),placeholder:a("components.productCreatorFirstStep.placeholderProductPromotion"),value:r,onChange:function(e){return t.setState({searchPromotionAndCombo:e.target.value})},allowClear:!0}))),Ot(k.Z,{className:"product-promotion-table",size:"small",pagination:!1,columns:this.columnsPromotion,dataSource:u,scroll:{y:200}}),n&&"combo"!=n.type&&Ot(It.Z,{shopId:i,handleCancel:function(){return t.setState({record:null})},modalVisibile:!0,promotion:n,currentShop:c,accessToken:s,isShow:!0}),"combo"==(null===n||void 0===n?void 0:n.type)&&Ot(Vt.Z,{accessToken:s,shopId:i,combo:n,visible:!0,close:function(){return t.setState({record:null})},variations:(null===n||void 0===n?void 0:n.variations)||[],timezone:this.props.timezone,isShow:!0})):null}}]),r}(v.Component))||vt,Ft=(0,y.$j)((function(t){return{warehouses:t.warehouse.warehouses,timezone:t.navigation.user.timezone}}),{showPromotionAdvance:ot._kW,fetchComboPorductVariations:ot.VIL})(Tt),Rt=r(19814),Et=r.n(Rt),zt=v.createElement;function jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var Mt,qt=function(t){(0,l.Z)(r,t);var e=jt(r);function r(t){var n;(0,c.Z)(this,r),n=e.call(this,t),(0,f.Z)((0,u.Z)(n),"updateAttribute",(function(t){var e=t.keyAttributeChange;return t.attribute.length?t.attribute.map((function(r,o){return{key:o,keyValue:zt(Ct.Z$,{key:o,onChange:function(o){t.onInputKeywordAttChange(r.keyValue,e,"key",o),n.forceUpdate()},value:(0,rt.Mle)(r.keyValue,!0).toUpperCase(),size:"small",type:"text",className:"input-attribute",style:{width:180}}),value:zt(Ct.Z$,{key:o,onChange:function(o){t.onInputKeywordAttChange(r.keyValue,e,"value",o),n.forceUpdate()},value:r.value,size:"small",type:"text",className:"input-attribute",style:{width:180}}),reorder:zt(Q.Z,{style:{fontSize:18}})}})):[]})),(0,f.Z)((0,u.Z)(n),"changeAttribute",(function(t,e,r){var n=1,o=t.splice(e,n)[0];return n=0,t.splice(r,n,o),t})),(0,f.Z)((0,u.Z)(n),"moveRow",(function(t,e,r){var o=n.state,a=o.attributes,i=o.attribute[t],c=a[r],s=n.changeAttribute(c.keyword,t,e),u=n.changeAttribute(c.values,t,e);c.keyword=s,c.values=u,a[r]=c,n.setState(H()(n.state,{attribute:{$splice:[[t,1],[e,0,i]]}},{attributes:a}),(function(){n.state.attributes.length>0&&n.props.dragDropAttribute(a)}))}));var o=n.updateAttribute(t);return n.state={attributes:t.attributes||[],attribute:o},n.refsArray=[],n}return(0,s.Z)(r,[{key:"render",value:function(){var t=this,e=this.props,r=e.t,n=e.indexAtt,o=this.state.attribute,a=[{title:"",dataIndex:"reorder",width:"10px",align:"center"},{title:r("components.productCreatorFirstStep.keyword"),dataIndex:"keyValue",width:"195px",align:"center"},{title:r("components.productCreatorFirstStep.value"),dataIndex:"value",width:"195px",align:"center"}],i={body:{row:St}};return zt("div",null,zt(k.Z,{columns:a,dataSource:o,className:"attribute-table-edit",size:"small",pagination:!1,components:i,rowKey:"key",onRow:function(e,r){return{index:r,moveRow:function(e,r){return t.moveRow(e,r,n)}}},scroll:{y:300}}),zt("style",{dangerouslySetInnerHTML:{__html:Et()}}))}}]),r}(v.Component),Bt=r(9669),Lt=r.n(Bt),Wt=r(37145),Gt=r(52653),Ht=r(71586),Kt=v.createElement,Ut=function(t,e){var r=t.attributeValues,n=t.callBack,o=(0,v.useState)(r||[]),a=o[0],i=o[1],c=(0,v.useState)(void 0),s=c[0],u=c[1];return Kt("div",{onKeyDown:function(t){[13].includes(t.keyCode)&&a.includes(s)&&(i(a),n(a))}},Kt(R.default,(0,lt.Z)({},t,{onChange:function(t){i(t),n(t)},value:a,onSearch:function(t){u(t)},ref:e})))},Jt=(0,v.forwardRef)(Ut),Qt=v.createElement;function $t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Yt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$t(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Xt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var te,ee=R.default.Option,re=F.Z.TreeNode,ne=T.default.Item,oe=A.default.TextArea,ae=(0,at.Z)()(Mt=(0,pt.Z5)(wt.ZP)(Mt=function(t){(0,l.Z)(r,t);var e=Xt(r);function r(t){var s;(0,c.Z)(this,r),s=e.call(this,t),(0,f.Z)((0,u.Z)(s),"updateAttributes",(function(){var t=s.state.attributes,e=g()(s.props.creator.variations).map((function(e){var r=t.reduce((function(t,e){return t.concat(e.values||[])}),[]).map((function(t){return t.trim()})),n=t.map((function(t){var e;return null===t||void 0===t||null===(e=t.name)||void 0===e?void 0:e.trim()})),o=e.fields.filter((function(t){var e,o;return n.includes(null===(e=t.name)||void 0===e?void 0:e.trim())&&r.includes(null===(o=t.value)||void 0===o?void 0:o.trim())})).map((function(t){var e;return Yt(Yt({},t),{},{name:null===(e=t.name)||void 0===e?void 0:e.trim()})}));return e.fields=o,e}));if(t.length>0){var r=t.map((function(t,e){return Yt(Yt({},t),{},{index:e})}));s.debounceOnChangeInput({product_attributes:H()(r,{$apply:function(t){return t.map((function(t){return H()(t,{$unset:["key","attribute","valuesSelect","edit","delete","reorder"]})}))}}),variations:e})}else s.debounceOnChangeInput({product_attributes:[],variations:e})})),(0,f.Z)((0,u.Z)(s),"columns",[{title:"",dataIndex:"reorder",width:"3px",align:"center"},{title:s.props.t("components.productCreatorFirstStep.properties"),dataIndex:"attribute",width:"25%",align:"center"},{title:s.props.t("components.productCreatorFirstStep.value"),dataIndex:"valuesSelect",align:"center"},{title:"",dataIndex:"edit",width:"5%",align:"center"}]),(0,f.Z)((0,u.Z)(s),"setup",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=s.props,r=e.t,n=e.creator,o=e.isAutoGen,c=g()(n.product_attributes),u=t.length>0?t:c,l=(u=u.reduce((function(t,e){var r=(0,i.Z)(e.values);r=r.map((function(t){return t.toString().trim()}));var n=(0,i.Z)(e.keyword),o=r.reduce((function(t,e){var r=n.findIndex((function(t){return t.value==e}));return r<0?t.push({keyValue:(0,rt.Mle)(e,!0).toUpperCase(),value:e.trim()}):t.push(n[r]),t}),[]);return e.keyword=o,e.values=r,t.push(e),t}),[])).map((function(t,e){var n,i=(0,rt.uuG)(),c=[],u=[];return(null===(n=t.keyword)||void 0===n?void 0:n.length)>0?t.keyword.map((function(t){var e=(0,rt.Mle)(t.keyValue,!0).toUpperCase()==(0,rt.Mle)(t.value,!0).toUpperCase()?"".concat(t.value):"".concat((0,rt.Mle)(t.keyValue,!0).toUpperCase(),": ").concat(t.value),r={label:e,value:t.value};c.push(r)})):((t.values||[]).map((function(t){var e="".concat(t);c.push({label:e,value:t});var r={keyValue:(0,rt.Mle)(t,!0).toUpperCase(),value:t};u.push(r)})),t.keyword=u),{id:t.id||null,key:i,attribute:Qt(Ct.Z$,{onChange:s.onNameChange(i),placeholder:r("components.productCreatorFirstStep.attributeName"),defaultValue:t.name}),valuesSelect:Qt(Jt,{dropdownStyle:{display:"none"},placeholder:r("components.productCreatorFirstStep.enterEachAttributeValue"),mode:"tags",options:c,style:{width:"100%"},disabled:o&&s.state.isEditAttribute.includes(e),attributeValues:t.values,callBack:function(t){return s.onValuesChange(i,t)},ref:function(t){return s.refsArray[e]=t}}),edit:Qt(a.default.Group,null,Qt(N.default,{content:Qt(qt,{t:r,attribute:t.keyword,keyAttributeChange:i,indexAtt:e,attributes:s.state.attributes,dragDropAttribute:s.dragDropAttribute,onInputKeywordAttChange:s.onInputKeywordAttChange}),trigger:"click",visible:s.state.isEditAttribute.includes(e),onVisibleChange:function(){return s.isEdit(e)},placement:"left"},s.state.isEditAttribute.includes(e)?Qt(a.default,{icon:Qt(K.Z,null)}):Qt(a.default,{icon:Qt(U.Z,null)})),Qt(a.default,{onClick:s.onDeleteAttribute(i),icon:Qt(J.Z,null)})),name:t.name,values:t.values,reorder:Qt(Q.Z,{style:{fontSize:18}}),keyword:t.keyword}}));s.setState({attributes:l})})),(0,f.Z)((0,u.Z)(s),"handleInputConfirm",(function(){s.setState({visibleInput:!1,showInputKey:null,showInputIdx:null},(function(){return s.setup()}))})),(0,f.Z)((0,u.Z)(s),"handleEditAtt",(function(t){var e=s.props,r=e.creator.product_attributes,o=e.t,a=s.state.isEditAttribute,i=g()(a);if(r[t].values.length>0){if(a.includes(t)){var c=a.findIndex((function(e){return e==t}));c>-1&&i.splice(c,1)}else i.push(t);s.setState({isEditAttribute:i},(function(){i.includes(t)||s.setState({visibleInput:!1}),s.setup()}))}else n.default.warning(o("components.productCreatorFirstStep.warningEditAttribute"))})),(0,f.Z)((0,u.Z)(s),"isEdit",(function(t){var e=s.state,r=(e.attributes,e.nameSuggestAtt),n=s.props,o=n.creator.product_attributes;n.t;if(t>-1)s.handleEditAtt(t);else{var a=o.findIndex((function(t){return t.name==r}));a>-1&&s.handleEditAtt(a)}})),(0,f.Z)((0,u.Z)(s),"isEditAttributeNew",(function(t){var e=s.state.attributes,r=s.props.t,o=e.findIndex((function(e){return e.key==t&&e.values.length>0}));o>-1?s.handleEditAtt(o):n.default.warning(r("components.productCreatorFirstStep.warningEditAttribute"))})),(0,f.Z)((0,u.Z)(s),"showInput",(function(t,e){s.setState({visibleInput:!0,showInputKey:e,showInputIdx:t},(function(){var t=document.getElementById("input-attribute");t&&t.focus(),s.setup()}))})),(0,f.Z)((0,u.Z)(s),"onInputKeywordAttChange",(function(t,e,r,n){n.stopPropagation();var o=s.props,a=o.creator,i=o.isAutoGen,c=o.shopId,u=s.state.attributes,l=g()(a.variations),d=n.target.value;if(d=(d||"").toString().trim()){var p=u.findIndex((function(t){return t.key===e})),f=u[p].values,h=u[p].keyword,m=u[p].name,v=h.findIndex((function(e){return"value"==r&&e.keyValue,e.value==t}));v=-1==v?h.findIndex((function(e){return e.keyValue==t})):v;var y=l.reduce((function(e,n){var o=n.fields.findIndex((function(e){return m.includes(e.name)&&e.value==f[v]&&(!e.keyValue||e.keyValue==t)}));return o>-1&&("value"==r?n.fields[o].value=d:n.fields[o].keyValue=(0,rt.Mle)(d,!0).toUpperCase(),n.id||(n.custom_id=(0,rt.Qh$)(c,a.custom_id,a.display_id,n.fields,i))),e.push(n),e}),[]);"value"==r?(h[v].value=d,f[v]=d,u[p].values=f):(h[v].keyValue=(0,rt.Mle)(d,!0).toUpperCase(),u[p].keyword=h),s.updateProductCreator(y)}})),(0,f.Z)((0,u.Z)(s),"updateProductCreator",(function(t){if(s.state.attributes.length>0){var e=s.state.attributes.map((function(t,e){return Yt(Yt({},t),{},{index:e})}));s.props.updateProductCreator({product_attributes:H()(e,{$apply:function(t){return t.map((function(t){return H()(t,{$unset:["key","attribute","valuesSelect","edit","delete","reorder"]})}))}}),variations:t})}})),(0,f.Z)((0,u.Z)(s),"onNameChange",(function(t){return function(e){var r,n=s.state.attributes.findIndex((function(e){return e.key===t}));s.state.attributes[n].name=null===(r=e.target.value)||void 0===r?void 0:r.trim(),s.state.attributes[n].isUpdate=!0,s.updateAttributes()}})),(0,f.Z)((0,u.Z)(s),"handleFocus",(function(t){var e;null===(e=s.refsArray[t])||void 0===e||e.focus()})),(0,f.Z)((0,u.Z)(s),"onValuesChange",(function(t,e){var r;e=e.map((function(t){return t.trim()})).filter((function(t){return t}));var n=s.state.attributes,o=n.findIndex((function(e){return e.key===t})),a=[];(null===(r=e)||void 0===r?void 0:r.length)>0&&e.map((function(t){var e;return(e=a).push.apply(e,(0,i.Z)(t.split(";")))})),a.length>0&&(a=M()(a));var c=[];a.map((function(t){var e=n[o].keyword.find((function(e){return e.value.trim()==t.trim()}));if(e)c.push(e);else{var r={keyValue:(0,rt.Mle)(t,!0).toUpperCase(),value:t.trim()};c.push(r)}})),n[o].keyword=c,n[o].values=a,n[o].isUpdate=!0,null!==n&&void 0!==n&&n.length&&s.setup(n),s.updateAttributes(),setTimeout((function(){return s.handleFocus(o)}))})),(0,f.Z)((0,u.Z)(s),"onDeleteAttribute",(function(t){return function(){var e=s.state.attributes,r=e.findIndex((function(e){return e.key===t}));e.splice(r,1),s.setState({attributes:(0,i.Z)(e)}),s.updateAttributes()}})),(0,f.Z)((0,u.Z)(s),"onAddAttributeClick",(function(){var t=g()(s.state.attributes),e=s.props.t,r=(0,rt.uuG)();t.length;t.push({key:r,attribute:Qt(Ct.Z$,{onChange:s.onNameChange(r),placeholder:e("components.productCreatorFirstStep.attributeName")}),valuesSelect:Qt(R.default,{dropdownStyle:{display:"none"},placeholder:e("components.productCreatorFirstStep.enterEachAttributeValue"),mode:"tags",onChange:function(t){return s.onValuesChange(r,t)},style:{width:"100%"}}),edit:Qt(a.default.Group,null,Qt(a.default,{onClick:function(){return s.isEditAttributeNew(r)},icon:Qt(U.Z,null)}),Qt(a.default,{onClick:s.onDeleteAttribute(r),icon:Qt(J.Z,null)})),name:"",values:[],reorder:Qt(Q.Z,{style:{fontSize:18}}),keyword:[]}),s.setState({attributes:t})})),(0,f.Z)((0,u.Z)(s),"handleCreateCategory",(function(){var t=s.props,e=t.accessToken,r=t.shopId,n=t.createCategory,o=t.fetchCategories,a=s.state,i=a.categoryTerm,c=a.parentCategory;n(e,r,{name:i,parent_id:parseInt(c)}).then((function(){o(e,r,!0),s.setState({parentCategory:void 0})}))})),(0,f.Z)((0,u.Z)(s),"getCategoryOptions",(function(t){var e=t.filter((function(t){return!t.third_party})),r=[];return e.forEach((function(t){"private"==s.state.categoryType!=t.is_admin_category&&r.push({label:t.text,value:t.id.toString(),key:t.id,children:t.nodes.length>0?s.getCategoryOptions(t.nodes):[]})})),r})),(0,f.Z)((0,u.Z)(s),"getSupplierOptions",(function(t){var e=[];return t.filter((function(t){return 0!=t.is_activated})).map((function(t){e.push({label:t.name,value:t.id.toString(),key:t.id.toString()})})),e})),(0,f.Z)((0,u.Z)(s),"getProductChannel",(function(){return[{label:"Shopee",value:"-3",key:"-3",children:s.props.currentShop.shopee_account.map((function(t){return{label:t.shopee_shop_name,value:t.shopee_shop_id,key:t.shopee_shop_id.toString()}}))}]})),(0,f.Z)((0,u.Z)(s),"getProductsTagsOrMaterials",(function(t){var e=s.props,r=e.listTagsProducts,n=e.materials,o=[];return(("tags"==t?r:n)||[]).map((function(e){o.push({label:"tags"==t?e.note:e.name,value:e.id.toString(),key:e.id.toString()})})),o})),(0,f.Z)((0,u.Z)(s),"getCategoryCreator",(function(t){var e=[];return t.forEach((function(t){t.is_admin_category||e.push(Qt(re,{title:t.text,key:t.id},t.nodes.length>0&&s.getCategoryCreator(t.nodes)))})),e})),(0,f.Z)((0,u.Z)(s),"notFoundContent",(function(){return Qt("div",null,"private"===s.state.categoryType?Qt("div",{style:{color:"rgba(0,0,0,.65)"}},Qt(o.default,{title:s.props.t("components.productCreatorFirstStep.selectCategoryToGroup")},Qt(a.default,{type:"primary",icon:Qt(x.Z,null),onClick:s.handleCreateCategory,style:{marginRight:10,background:"#ff3860",borderColor:"#ff3860"}},s.props.t("components.orderExportExcel.add")),s.props.t("new"),": ",Qt("strong",null,s.state.categoryTerm)),Qt(F.Z,{onSelect:function(t){return s.setState({parentCategory:t})}},s.getCategoryCreator(s.props.categories.filter((function(t){return!t.third_party}))))):s.props.t("components.productCreatorFirstStep.doNotFound"))})),(0,f.Z)((0,u.Z)(s),"onChangeSupplierProducts",(function(t){var e=s.props.currentShop.supplier_products;e&&e.length>0&&t&&e.filter((function(e){return e.id==t})).length>0&&s.setState({selectedSupplierProducts:e.filter((function(e){return e.id==t}))[0]})})),(0,f.Z)((0,u.Z)(s),"handleAddValue",(function(t,e){s.props.updateProductCreator((0,f.Z)({},e,t))})),(0,f.Z)((0,u.Z)(s),"handleCategory",(function(t){var e=t.length>0?t.map((function(t){return s.props.categories.find((function(e){return e.id==t}))})):[];s.props.updateProductCreator({category:e,category_ids:t.map((function(t){return parseInt(t)}))})})),(0,f.Z)((0,u.Z)(s),"handleChangeCustomidProduct",(function(t){var e=s.props,r=e.creator,n=r.custom_id,o=r.display_id,a=r.variations,c=r.product_attributes,u=r.id,l=e.shopId,d=e.currentShop,p=!localStorage["isAutoGenCustomidVariation_shop_".concat(l)]||JSON.parse(localStorage.getItem("isAutoGenCustomidVariation_shop_".concat(l))),f=(0,i.Z)(a);if(o||!d.use_custom_id_for_barcode||t==n||1!=f.length||f[0].custom_id||f[0].barcode||(f[0].custom_id=t,f[0].barcode=t),p&&t!=n&&c&&c.length>0){var h=u?t||o:t;f.map((function(t){t.custom_id=!t.id&&t.fields&&t.fields.length>0?(0,rt.Qh$)(l,h,o,t.fields,p):t.custom_id}))}s.debounceOnChangeInput({custom_id:(t||"").toString().trim(),variations:f})})),(0,f.Z)((0,u.Z)(s),"debounceChangeCustomidProduct",z()((function(t){return s.handleChangeCustomidProduct(t)}),200)),(0,f.Z)((0,u.Z)(s),"handleChangeManipulationWarehouses",(function(t){var e=[];e=0==t.length||t.length>0&&"all"==t[t.length-1]?[]:t.filter((function(t){return"all"!=t})),s.setState({manipulationWarehouses:0==e.length?["all"]:e}),s.props.updateProductCreator({manipulation_warehouses:e})})),(0,f.Z)((0,u.Z)(s),"onSelectSuggestAtt",(function(t){var e=s.props,r=e.t,n=(e.isAutoGen,s.state.attributes),o=(0,rt.uuG)(),c=[],u=[];t.keyword&&t.keyword.length?t.keyword.map((function(t){var e=(0,rt.Mle)(t.keyValue,!0).toUpperCase()==(0,rt.Mle)(t.value,!0).toUpperCase()?"".concat(t.value):"".concat((0,rt.Mle)(t.keyValue,!0).toUpperCase(),": ").concat(t.value),r={label:e,value:t.value};c.push(r)})):(t.values.map((function(t){var e="".concat(t);c.push({label:e,value:t});var r={keyValue:(0,rt.Mle)(t,!0).toUpperCase(),value:t};u.push(r)})),t.keyword=u),n.push({key:o,attribute:Qt(Ct.Z$,{style:{marginTop:0},onChange:s.onNameChange(o),placeholder:r("components.productCreatorFirstStep.attributeName"),defaultValue:t.name}),valuesSelect:Qt(Jt,{dropdownStyle:{display:"none"},placeholder:r("components.productCreatorFirstStep.enterEachAttributeValue"),mode:"tags",options:c,style:{width:"100%"},attributeValues:t.values,callBack:function(t){return s.onValuesChange(o,t)}}),edit:Qt(a.default.Group,null,Qt(a.default,{onClick:function(){return s.setState({nameSuggestAtt:t.name},(function(){return s.isEdit(-2)}))},icon:Qt(U.Z,null)}),Qt(a.default,{onClick:s.onDeleteAttribute(o),icon:Qt(J.Z,null)})),name:t.name,values:t.values,reorder:Qt(Q.Z,{style:{fontSize:18}}),keyword:t.keyword}),s.setState({attributes:(0,i.Z)(n)}),s.updateAttributes()})),(0,f.Z)((0,u.Z)(s),"suggestProductAttributesMenu",(function(){var t=s.props.currentShop.suggest_product_attributes,e=s.state.attributes;if(t&&(!t||0!=t.length))return Qt(T.default,null,t.filter((function(t){return!e.map((function(t){return t.name})).includes(t.name)})).map((function(t,e){return Qt(ne,{key:e,onClick:function(){return s.onSelectSuggestAtt(t)}},Qt("span",{style:{fontWeight:500,color:"rgb(0, 86, 103)"}},t.name))})))})),(0,f.Z)((0,u.Z)(s),"columnsPromotionalProducts",[{title:"",dataIndex:"none",width:"1%",align:"center"},{title:s.props.t("components.productPromotionDetail.productId"),dataIndex:"productId",width:"15%",ellipsis:!0},{title:s.props.t("components.productPromotionDetail.variationId"),dataIndex:"variationId",width:"15%",ellipsis:!0},{title:s.props.t("products.title"),dataIndex:"product",width:"30%",ellipsis:!0},{title:s.props.t("components.productPromotionDetail.quantity"),dataIndex:"quantity",width:"20%",align:"right"},{title:"",dataIndex:"delete",width:"4%",align:"center"}]),(0,f.Z)((0,u.Z)(s),"getPromotionalProducts",(function(){return s.state.bonusProducts.length>0?s.state.bonusProducts.map((function(t,e){return{key:e,productId:Qt(o.default,{placement:"top",title:t.variation_info.product_id},t.variation_info.product_id),variationId:Qt(o.default,{placement:"top",title:t.variation_info.id},t.variation_info.id),product:Qt(o.default,{placement:"top",title:t.variation_info.name},t.variation_info.name),quantity:Qt("div",{className:"input-quantity"},Qt(ut.default,{currency:s.props.currentShop.currency,min:1,isMoney:!1,value:t.quantity,callBack:function(t){return s.handleInputNumberChangeProduct(t,e)}})),delete:Qt($.Z,{style:{color:"rgb(255, 56, 96)",cursor:"pointer"},onClick:function(){return s.handleDeletePromotionProduct(e)}})}})):[]})),(0,f.Z)((0,u.Z)(s),"delayAddProductLink",(function(){var t=s.state.newLink,e=g()(s.state.links);e.unshift(t),s.setState({links:e,newLink:null}),s.props.updateProductCreator({product_links:e})})),(0,f.Z)((0,u.Z)(s),"handleDeleteProductLink",(function(t){var e=g()(s.state.links);e.splice(t,1),s.setState({links:e}),s.props.updateProductCreator({product_links:e})})),(0,f.Z)((0,u.Z)(s),"handleInputNumberChangeProduct",(function(t,e){var r=s.state.bonusProducts,n=g()(r);n[e].quantity=t,s.setState({bonusProducts:n}),s.props.updateProductCreator({bonus_products:n})})),(0,f.Z)((0,u.Z)(s),"handleDeletePromotionProduct",(function(t){var e=s.state.bonusProducts,r=g()(e);r.splice(t,1),s.setState({bonusProducts:r}),s.props.updateProductCreator({bonus_products:r})})),(0,f.Z)((0,u.Z)(s),"handleSelectPromotionProduct",(function(t){var e=s.state,r=e.searchResult,n=e.bonusProducts,o=r.findIndex((function(e){return e.id==t})),a=g()(n);if("no-result"!=t&&o>-1){var i=a.findIndex((function(e){return e.variation_id==t}));i<0?(a.push({images:r[o].images,quantity:1,variation_id:r[o].id,price_original:r[o].retail_price,variation_info:{id:r[o].custom_id||r[o].display_id,product_id:r[o].product.custom_id||r[o].product.display_id,name:r[o].product.name,retail_price:0,weight:r[o].weight}}),s.setState({bonusProducts:a}),s.props.updateProductCreator({bonus_products:a})):(a[i].quantity++,s.setState({bonusProducts:a}),s.props.updateProductCreator({bonus_products:a})),s.setState({searchResult:[]})}})),(0,f.Z)((0,u.Z)(s),"handleEditProductKeywords",(function(t){t=t.map((function(t){return t.trim()})).filter((function(t){return t}));var e=[];t.map((function(t){var r;return(r=e).push.apply(r,(0,i.Z)(t.split(";")))})),e=M()(e),s.props.updateProductCreator({keyword:e.join("|")})})),(0,f.Z)((0,u.Z)(s),"moveRow",(function(t,e){var r=s.state.attributes[t];s.setState(H()(s.state,{attributes:{$splice:[[t,1],[e,0,r]]}}),(function(){if(s.state.attributes.length>0){var t=s.state.attributes.map((function(t,e){return Yt(Yt({},t),{},{index:e})}));s.props.updateProductCreator({product_attributes:H()(t,{$apply:function(t){return t.map((function(t){return H()(t,{$unset:["key","attribute","valuesSelect","edit","delete","reorder"]})}))}})})}}))})),(0,f.Z)((0,u.Z)(s),"changeAttribute",(function(t,e,r){var n=1,o=t.splice(e,n)[0];return n=0,t.splice(r,n,o),t})),(0,f.Z)((0,u.Z)(s),"dragDropAttribute",(function(t){var e=t.map((function(t,e){return Yt(Yt({},t),{},{index:e})}));s.props.updateProductCreator({product_attributes:H()(e,{$apply:function(t){return t.map((function(t){return H()(t,{$unset:["key","attribute","valuesSelect","edit","delete","reorder"]})}))}})})})),(0,f.Z)((0,u.Z)(s),"getDuplicatedName",(function(t){var e=s.props,r=e.accessToken,n=e.shopId,o="".concat((0,rt.LpH)(),"/shops/").concat(n,"/products/duplicated_name_product?access_token=").concat(r,"&name_update=").concat(t);Lt().get(o).then((function(t){if(t.data){var e=t.data.duplicated_name,r=t.data.inserted_at,n=t.data.custom_id;s.setState({duplicated_name:{is_duplicated:e,date_of_duplicated:r,custom_id_of_duplicated:n}})}}))})),(0,f.Z)((0,u.Z)(s),"debounceOnChangeInput",z()((function(t){t.name?(s.props.updateProductCreator(t),s.getDuplicatedName(t.name)):s.props.updateProductCreator(t)}),400)),(0,f.Z)((0,u.Z)(s),"renderSelectTagsOrMaterials",(function(t,e){var r=s.props,n=r.t,o=r.materials;return Qt(D.ZP,{showSearch:!0,multiple:!0,treeDefaultExpandAll:!0,treeData:s.getProductsTagsOrMaterials(e),defaultValue:W()((0,rt.oHr)(o,t&&t.length?t:[],e)).map((function(t){return(t.id||t).toString()})),placeholder:n("tags"==e?"pages.shop.product.management.tag":"pages.shop.product.material.productMaterial"),filterTreeNode:function(t,e){return(0,rt.Mle)(e.props.title).indexOf((0,rt.Mle)(t))>=0},dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14},onChange:function(t){return s.handleAddValue(t,e)}})})),(0,f.Z)((0,u.Z)(s),"renderNoteProduct",(function(t){return Qt(Gt.Z,{key:1,data:"example",params:t,type:"noteProduct"})})),(0,f.Z)((0,u.Z)(s),"handleCloseAdvanceEditNote",(function(){var t=s.props.creator;t.note_product&&""!=t.note_product?s.setState({editNote:!1,noteChangedByAdvancedEditting:!1}):(s.setState({typeEditNote:"defaultEdit",editNote:!1,noteChangedByAdvancedEditting:!1}),localStorage.setItem("typeEditNote","defaultEdit"))})),(0,f.Z)((0,u.Z)(s),"selectionsEdit",(function(){return Qt(T.default,{onClick:function(t){var e;"advancedEditing"==t.key?s.setState({editNote:!0,typeEditNote:t.key}):(null===(e=s.input)||void 0===e||e.focus(),s.setState({typeEditNote:t.key}));localStorage.setItem("typeEditNote",t.key)}},Qt(T.default.Item,{key:"defaultEdit"},s.props.t("components.productCreatorFirstStep.defaultEdit")),Qt(T.default.Item,{key:"advancedEditing"},s.props.t("components.productCreatorFirstStep.advancedEditing")))})),(0,f.Z)((0,u.Z)(s),"updateIncludedAccessory",(function(t){var e=s.props.creator,r=g()(e.variations);t&&(r=r.map((function(t){var e=t.retail_price_by_currency.map((function(t){return Yt(Yt({},t),{},{retailPriceByCurrency:"0"})}));return t=Yt(Yt({},t),{},{retail_price:0,retail_price_currency_original:0,retail_price_by_currency:e})}))),s.props.updateProductCreator({is_accessory:t,variations:r})})),(0,f.Z)((0,u.Z)(s),"renderIsIncludedAccessory",(function(){var t=s.props,e=t.t,r=t.creator;return Qt("div",{style:{marginTop:5}},Qt(O.Z,{size:"small",checked:r.is_accessory,onChange:s.updateIncludedAccessory}),"\xa0\xa0",e("components.productCreatorFirstStep.accessory"))}));var l=t.creator,d=l.manipulation_warehouses,p=l.bonus_products,h=l.product_links,m=t.warehouses,v=(t.currentShop,m&&m.length>0?m.map((function(t){return t.id})):[]),y=d.filter((function(t){return v.includes(t)}));return s.state={attributes:[],categoryTerm:"",parentCategory:"",categoryType:"private",manipulationWarehouses:y&&y.length>0?y:["all"],isRemainSaving:!1,isEditAttribute:[],visibleInput:!1,showInputKey:null,searchResult:[],bonusProducts:p&&p.length?p:[],isKeyword:!1,showInputIdx:null,newLink:null,links:h&&h.length?h:[],duplicated_name:void 0,editNote:!1,html:"",typeEditNote:localStorage.getItem("typeEditNote")||"defaultEdit",noteChangedByAdvancedEditting:!1},s.refsArray=[],s}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){this.setup();var t=this.props.creator.note_product,e=this.state.typeEditNote;t&&""!=t||"advancedEditing"!=e||this.setState({typeEditNote:"defaultEdit"})}},{key:"componentDidUpdate",value:function(t,e){var r=this.props.creator.manipulation_warehouses,n=this.state.manipulationWarehouses,o=B()(r,t.creator.manipulation_warehouses).length>0||B()(t.creator.manipulation_warehouses,r).length>0,a=e.manipulationWarehouses.filter((function(t){return!n.includes(t)}));o&&0==a.length&&e.manipulationWarehouses.length==n.length&&this.setState({manipulationWarehouses:r.length>0?r:["all"]}),t.isAutoGen!=this.props.isAutoGen&&this.setup()}},{key:"render",value:function(){var t=this,e=this.state,r=e.attributes,n=e.manipulationWarehouses,i=e.searchResult,c=e.newLink,s=e.links,u=e.duplicated_name,l=e.editNote,d=e.noteChangedByAdvancedEditting,p=this.props,f=p.creator,m=p.brands,g=p.currentShop,v=p.currentShop,y=v.warranty_policies,_=v.currency,b=v.timezone,S=v.create_orders_after_comfirmation,w=p.t,C=p.warehouses,Z=p.accessToken,T=p.shopId,F=p.productMeasurement,E=p.categories,z=f.brand_id&&m.data.find((function(t){return t.id==f.brand_id})),j=g?(0,Zt.zE)(g.role):{},M=(f.category_ids||[]).filter((function(t){return(0,Ht.bu)(E||[]).map((function(t){var e;return null===(e=t.id)||void 0===e?void 0:e.toString()})).includes(t.toString())})),q=f.keyword?f.keyword.replace(/(\|)/g,";").split(";"):[],B=f.note_product&&(/<.*\/>/.test(f.note_product)||/<\/.*>/.test(f.note_product)),L={body:{row:St}};return Qt("div",{className:"first-step"},Qt("div",{style:{display:"flex"}},Qt("div",{className:"box-p1",style:{marginRight:16}},Qt("div",{className:"id-container"},Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productCreatorFirstStep.productId")," ",Qt("span",{style:{color:"#F5222D",marginRight:4}},"*")),Qt(Ct.Z$,{style:{marginTop:0},placeholder:f.display_id||w("components.productCreatorFirstStep.productId"),defaultValue:f.custom_id,prefix:Qt(Y.Z,null),onChange:function(e){return t.debounceChangeCustomidProduct(e.target.value)}})),Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productCreatorFirstStep.nameProduct")," ",Qt("span",{style:{color:"#F5222D",marginRight:4}},"*")),Qt(Ct.Z$,{style:{marginTop:0},prefix:Qt(X.Z,null),placeholder:w("components.productCreatorFirstStep.nameProduct"),defaultValue:f.name,onChange:function(e){return t.debounceOnChangeInput({name:(e.target.value||"").toString().trim()})}})),(null===S||void 0===S?void 0:S.checked)&&Qt("div",{className:"product-info"},Qt("span",{className:"title"},"Keyword"),Qt(R.default,{dropdownStyle:{display:"none"},style:{marginTop:0},placeholder:"Keyword",mode:"tags",value:q,onChange:function(e){return t.handleEditProductKeywords(e)}})),u&&(null===u||void 0===u?void 0:u.is_duplicated)&&Qt(V.default,{message:"".concat(w("components.productCreatorFirstStep.productNameWasCreatedAt")," ").concat(null!==u&&void 0!==u&&u.date_of_duplicated?(0,rt.o0x)(b||7,u.date_of_duplicated,!1,"HH:mm DD/MM/YYYY"):""," ").concat(w("components.productCreatorFirstStep.withProductId")," ").concat(null===u||void 0===u?void 0:u.custom_id_of_duplicated),type:"warning",showIcon:!0,style:{marginTop:-8,marginBottom:8}}),(0,rt.rqq)(4,this.props.currentShop)&&Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productCreatorFirstStep.productBrand")),Qt(R.default,{allowClear:!0,showSearch:!0,placeholder:w("components.productCreatorFirstStep.selectProductBrand"),defaultValue:z?f.brand_id.toString():void 0,onChange:function(e){return t.props.updateProductCreator({brand_id:e})},filterOption:function(t,e){return(0,rt.C6S)(t,e.props.children)},style:{width:"100%"}},m.data.map((function(t){return Qt(ee,{key:t.id},t.name)})))),Qt("div",{className:"product-info",style:{marginRight:16}},Qt("span",{className:"title"},w("pages.shop.product.management.tag")),this.renderSelectTagsOrMaterials(f.tags,"tags")),Qt("div",{className:"product-info",style:{marginRight:16}},Qt("span",{className:"title"},w("pages.shop.product.material.material")),this.renderSelectTagsOrMaterials(f.materials,"materials")),Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("pages.shop.product.management.manipulationWarehouse")),Qt(R.default,{style:{width:"100%"},onChange:function(e){return t.handleChangeManipulationWarehouses(e)},mode:"multiple",value:n},Qt(ee,{value:"all"},w("components.stocktakingExportExcel.allWarehouse")),C.map((function(t){return Qt(ee,{key:t.id,value:t.id},t.name)})))),(F||[]).length>0&&Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("pages.shop.product.measure.group")),Qt(R.default,{allowClear:!0,showSearch:!0,placeholder:w("pages.shop.product.measure.configMeasureGroup"),value:f.measure_group_id?f.measure_group_id.toString():void 0,onChange:function(e){t.props.updateProductCreator({measure_group_id:e}),e&&t.props.updateProductCreator({is_price_by_weight:!1})},filterOption:function(t,e){return(0,rt.C6S)(t,e.props.children)}},F.filter((function(t){return!t.is_removed})).map((function(t){return Qt(ee,{key:t.id.toString(),value:t.id.toString()},t.name)})))),Qt("div",null,Qt("div",null,Qt(O.Z,{size:"small",defaultChecked:f.warning_by_variation,onChange:function(e){return t.props.updateProductCreator({warning_by_variation:e})}}),"\xa0\xa0",w("components.productCreatorFirstStep.warningByVariation"),Qt(et.Z,{tip:w("components.productCreatorFirstStep.noteWarningByVariation")})),!f.warning_by_variation&&Qt("div",{style:{display:"flex",marginTop:8,justifyContent:"space-between",alignItems:"center"}},Qt("span",{style:{whiteSpace:"nowrap",fontWeight:500,marginRight:8}},w("components.productCreatorFirstStep.limitNumberToWarn"),":"),Qt(Ct.Z$,{value:(0,rt.ufS)(f.limit_quantity_to_warn,_,!1),onChange:function(e){return t.props.updateProductCreator({limit_quantity_to_warn:(0,rt.FsB)(e.target.value,_,!1)})}})))),f.id&&Qt(Ft,{shopId:T,accessToken:Z,currentShop:g,product:f,checkCombos:function(e){return t.props.checkCombos(e)},checkPromotions:function(e){return t.props.checkPromotions(e)}}),j.view_imported_price&&Qt("div",{className:"link-product",style:{position:"relative",marginTop:16,backgroundColor:"#f7f7f7",borderRadius:2,boxShadow:"0 0 0 1px rgba(63,63,68,.05), 0 1px 3px 0 rgba(63,63,68,.15)"}},Qt("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 16px",background:"#fff",alignItems:"center"}},Qt("div",{style:{fontWeight:550}},w("components.productCreatorFirstStep.productLink")),Qt("div",{style:{width:420}},Qt(A.default,{onPressEnter:function(){return t.delayAddProductLink()},placeholder:w("components.productCreatorFirstStep.placeholderProductLink"),onChange:function(e){return t.setState({newLink:e.target.value})},className:"input-product-link",value:c}))),s&&s.length>0&&Qt("div",null,s.map((function(e,r){return Qt("ul",{style:{display:"flex",justifyContent:"space-between",padding:10,borderTop:"1px solid #d9d9d9",margin:0,background:"#fff"}},Qt("li",null,Qt(xt.default,{recordSrc:e},Qt(o.default,{placement:"top",title:"".concat(w("pages.shop.setting.printingForm.clickToCopy"),": ").concat(e)},Qt(I.default,{color:"#2db7f5",style:{maxWidth:"100%"}},Qt("span",{style:{maxWidth:"100%",overflow:"hidden",display:"flex"}},e))))),Qt("li",null,Qt($.Z,{style:{color:"rgb(255, 56, 96)",cursor:"pointer"},onClick:function(){return t.handleDeleteProductLink(r)}})))}))))),Qt("div",{className:"box-p1"},Qt("div",{className:"id-container"},Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productCreatorFirstStep.category")),Qt(D.ZP,{defaultValue:W()(M).map((function(t){return t.toString()})),showSearch:!0,treeData:this.getCategoryOptions(this.props.categories),onChange:function(e){return t.handleCategory(e)},multiple:!0,placeholder:w("components.productCreatorFirstStep.selectCategoryProduct"),onSearch:function(e){return t.setState({categoryTerm:e})},treeDefaultExpandAll:!0,notFoundContent:this.notFoundContent(),filterTreeNode:function(e,r){return"th"==t.props.currentLanguage?r.props.title.indexOf(e)>=0:(0,rt.Mle)(r.props.title).indexOf((0,rt.Mle)(e))>=0},dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14},style:{marginTop:0}})),j.ql_ncc&&j.ql_nhaphang&&Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productPurchaseDetail.supplierProducts")),Qt(D.ZP,{showSearch:!0,multiple:!0,treeDefaultExpandAll:!0,treeData:this.getSupplierOptions(this.props.supplier_products.data),defaultValue:W()(f.supplier_product_ids).map((function(t){return t.toString()})),placeholder:w("components.productCreatorFirstStep.selectSupplierProducts"),filterTreeNode:function(t,e){return(0,rt.Mle)(e.props.title).indexOf((0,rt.Mle)(t))>=0},dropdownStyle:{maxHeight:400,overflow:"auto",fontSize:14},onChange:function(e){return t.props.updateProductCreator({supplier_product_ids:e})},style:{marginTop:0}})),(0,rt.rqq)(7,this.props.currentShop)&&Qt("div",{className:"product-info"},Qt("span",{className:"title"},w("components.productCreatorFirstStep.warrantyPolicy")),Qt("div",{style:{display:"flex"}},Qt(R.default,{style:{marginTop:0,width:"100%"},defaultValue:f.shop_warranty_policy_id?f.shop_warranty_policy_id.toString():void 0,onChange:function(e){return t.props.updateProductCreator({shop_warranty_policy_id:e,warranty_period:f.warranty_period||12})},allowClear:!0,placeholder:w("components.productCreatorFirstStep.selectWarrantyPolicy")},y.map((function(t){return Qt(ee,{key:t.id},t.name)}))),f.shop_warranty_policy_id&&Qt("div",{className:"period-select",style:{padding:0,paddingLeft:10}},Qt(Ct.Z$,{style:{marginTop:0},onChange:function(e){t.props.updateProductCreator({warranty_period:parseInt(e.target.value)||1})},value:f.warranty_period,suffix:w("month")})))),Qt("div",{className:"product-info"},Qt("span",{className:"title",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},w("components.productCreatorFirstStep.note"),Qt(P.default,{overlay:this.selectionsEdit(),placement:"bottomRight"},Qt("a",null,w("crm.edit"),Qt(U.Z,{style:{marginLeft:10,cursor:"pointer"}})))),"advancedEditing"==this.state.typeEditNote&&Qt("div",{style:{maxHeight:400,overflow:"auto",whiteSpace:B?"normal":"pre-line"}},f.note_product?this.renderNoteProduct({html:f.note_product}):""),"defaultEdit"==this.state.typeEditNote&&Qt(oe,{className:"note-textarea",rows:4,placeholder:w("components.productCreatorFirstStep.noteProduct"),defaultValue:f.note_product,onChange:function(e){return t.debounceOnChangeInput({note_product:e.target.value})},autosize:{minRows:2,maxRows:6},ref:function(e){return t.input=e}}),Qt("div",null,Qt(h.Z,{visible:l,onCancel:function(){return t.handleCloseAdvanceEditNote()},width:"80%",wrapClassName:"editor modal-preview",closable:!1,style:{top:20},footer:null},Qt("div",{style:{height:"92vh",overflow:"auto"}},Qt("div",{className:"print-setting"},Qt("div",{className:"title",style:{paddingBottom:0,border:"none"}},w("components.productCreatorFirstStep.editProductNote"),Qt("div",null,this.state.isCreatedFromDefaultExport?Qt(a.default,{onClick:function(){return t.setState({notePreview:null,selectingDefaultExport:!0})},style:{backgroundColor:"#FFFFFF"}},Qt(tt.Z,null)," ",w("pages.shop.customer.back")):"",Qt(a.default,{onClick:function(){return t.handleCloseAdvanceEditNote()},style:{backgroundColor:"#FFFFFF"}},this.props.t("crm.cancel")),Qt(a.default,{type:"primary",onClick:function(){d&&(""==t.state.html?t.setState({typeEditNote:"defaultEdit",editNote:!1}):t.setState({editNote:!1}),t.props.updateProductCreator({note_product:t.state.html})),t.setState({editNote:!1})}},w("save"))))),Qt(Wt.Z,{isEditting:l,html:f.note_product?B?f.note_product:f.note_product.replace(/\r\n/g,"<br />"):"",onChange:function(e){return t.setState({html:e,noteChangedByAdvancedEditting:!0})},accessToken:Z,style:{overflow:"overlay"}}))))),Qt("div",{style:{display:"flex"}},Qt("div",{style:{width:"50%"}},Qt(O.Z,{size:"small",checked:f.is_price_by_weight,onChange:function(e){t.props.updateProductCreator({is_price_by_weight:e}),e&&t.props.updateProductCreator({measure_group_id:void 0})}}),"\xa0\xa0",w("components.productCreatorFirstStep.priceByWeight")),Qt("div",{style:{width:"50%"}},Qt(O.Z,{size:"small",checked:f.not_print_product,onChange:function(e){return t.props.updateProductCreator({not_print_product:e})}}),"\xa0\xa0",w("components.productCreatorFirstStep.notPrintProduct"))),(0!=g.negative_order_product||g.reward_point_settings&&"true"==g.reward_point_settings.enabled)&&Qt("div",{style:{display:"flex",marginTop:5}},g.reward_point_settings&&"true"==g.reward_point_settings.enabled&&Qt("div",{style:{width:"50%"}},Qt(et.Z,{tip:w("components.productCreatorFirstStep.tipTurnOnEarnPoints")},Qt(O.Z,{size:"small",checked:!f.ignore_awarded_point,onChange:function(e){return t.props.updateProductCreator({ignore_awarded_point:!e})}}),"\xa0\xa0",w("components.productCreatorFirstStep.earnPoints"))),0!=g.negative_order_product&&Qt("div",{style:{width:"50%"}},Qt(O.Z,{size:"small",defaultChecked:0!=f.is_sell_negative,onChange:function(e){return t.props.updateProductCreator({is_sell_negative:e})}}),"\xa0\xa0",w("components.productCreatorFirstStep.negativeVariation"))),this.renderIsIncludedAccessory()),Qt("div",{style:{position:"relative"}},Qt("div",{className:"add-attribute"},Qt(N.default,{content:this.suggestProductAttributesMenu(),placement:"bottom",overlayClassName:"attribute-list",trigger:"hover"},Qt(a.default,{onClick:this.onAddAttributeClick,type:"primary",icon:Qt(x.Z,null),style:{padding:"0px 4px"}},w("components.productCreatorFirstStep.createProperties")))),r.length>1&&Qt("div",{className:"add-attribute",style:{right:"96%",top:8}},Qt(et.Z,{tip:w("components.productCreatorFirstStep.tipReorder")})),Qt(k.Z,{columns:this.columns,className:"attribute-table",size:"small",dataSource:r,pagination:!1,components:L,rowKey:"key",onRow:function(e,r){return{index:r,moveRow:t.moveRow}}})),Qt("div",{style:{position:"relative",marginTop:16,backgroundColor:"#f7f7f7",borderRadius:2}},Qt("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 16px",boxShadow:"0 0 0 1px rgba(63,63,68,.05), 0 1px 3px 0 rgba(63,63,68,.15)",background:"#fff",alignItems:"center"}},Qt("div",{style:{fontWeight:500}},w("components.productCreatorFirstStep.bonusProducts")),Qt("div",{style:{width:420}},Qt(st.Z,{accessToken:Z,searchResult:i,shopId:T,onSelect:this.handleSelectPromotionProduct,callback:function(e){return t.setState({searchResult:e})}}))),this.state.bonusProducts.length>0&&Qt(k.Z,{className:"attribute-table",style:{marginTop:0},columns:this.columnsPromotionalProducts,dataSource:this.getPromotionalProducts(),size:"small",pagination:!1})))),Qt("style",{dangerouslySetInnerHTML:{__html:ct()}}))}}]),r}(v.Component))||Mt)||Mt,ie=(0,y.$j)((function(t){return Yt(Yt(Yt({creator:(0,nt.mz)(t),categories:(0,nt.us)(t)},(0,nt.zN)(t)),{},{currentShop:t.shop.currentShop},(0,nt.RR)(t)),{},{warehouses:t.warehouse.warehouses,promotions_and_combo_by_product:t.product.promotions_and_combo_by_product,productMeasurement:t.settings.productMeasurement,currentLanguage:t.navigation.user.locale})}),{updateProductCreator:ot.U3h,createCategory:ot.k4B,fetchCategories:ot.pED,fetchListOfBrand:ot.ZbI,fetchProduct:ot.MXX})(ae),ce=r(31059),se=r(55673),ue=r(5789),le=r(18446),de=r.n(le),pe=r(65988),fe=r(24616),he=r(79508),me=r(25592),ge=r(47218),ve=r(50161),ye=r(22318),_e=r(52469),be=r.n(_e),Se=r(12499),we=r(41850),Ce=r(73363),Ze=v.createElement;function xe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ke(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xe(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Pe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var Ie=R.default.Option,Ve=(0,at.Z)()(te=function(t){(0,l.Z)(r,t);var e=Pe(r);function r(t){var s;(0,c.Z)(this,r),s=e.call(this,t),(0,f.Z)((0,u.Z)(s),"getAttributesToSync",(function(t,e,r){var n,o=s.props.shopId;try{n=JSON.parse(localStorage.getItem(r))}catch(i){console.log(i)}if(n&&n.length>0){var a=n.filter((function(t){return e.includes(t.name)}));r=="attributes_sync_images_shop_".concat(o)&&(t.attributesToSyncImage=a.length>0?a:["all"]),r=="attributes_sync_price_shop_".concat(o)&&(t.attributesToSyncPrice=a.length>0?a:["all"]),r=="attributes_sync_last_imported_price_shop_".concat(o)&&(t.attributesToSyncLastImportedPrice=a.length>0?a:["all"])}return t})),(0,f.Z)((0,u.Z)(s),"getVariationsColumns",(function(){var t=s.props,e=t.t,r=t.currentShop,n=t.creator,o=s.state.currentEdit,a=r?(0,Zt.zE)(r.role):{},i=(r.multiple_currency||[]).length>0,c=[{title:"",dataIndex:"is_locked",align:"center",width:"50px",fixed:"left"},{title:e("components.productTranferDetail.image"),dataIndex:"images",align:"center",width:"50px",fixed:"left"},{title:e("components.productCreatorFirstStep.autoCode"),dataIndex:"custom_id",align:"left",width:"160px",editable:!0,fixed:"left"},{title:e("components.productVariationCard.barcode"),dataIndex:"barcode",align:"left",width:"8%",editable:!0},{title:"Keyword",dataIndex:"keyword",align:"left",width:"6%",editable:!0},{title:e("components.productVariationCard.lastExportPrice"),dataIndex:"last_imported_price",align:"right",width:"6%",editable:!0},{title:e("components.productCreatorSecondStep.wholesalePrice"),dataIndex:"wholesale_price2",align:"right",width:"5%"},{title:e("components.accessoriesSecondStep.retailPrice"),dataIndex:"retail_price",align:"right",width:"6%",editable:!i},{title:e("components.productVariationCard.selectProperties"),dataIndex:"fields",align:"center",editable:!0},{title:r.config_weight_product?e("components.productVariationCard.weightKg"):e("components.productVariationCard.weight"),dataIndex:"weight",align:"right",width:"90px",editable:!0},{title:e("components.productCreatorSecondStep.limitToWarning"),dataIndex:"limit_quantity_to_warn",width:"90px",align:"right",editable:!0},{title:e("components.productVariationCard.quantity"),dataIndex:"total_quantity",align:"right",width:"5%"},{title:e("components.productVariationCard.remain"),dataIndex:"remain_quantity",align:"right",width:"6%"},{title:e("components.productVariationCard.actualRemain"),dataIndex:"actual_remain_quantity",align:"right",width:"5%"},{title:e("pages.shop.product.variation.pendingQuantity"),dataIndex:"pending",align:"right",width:"5%"},{title:"Gi\xe1 b\xe1n t\u1ea1i qu\u1ea7y",dataIndex:"price_at_counter",align:"right",width:"120px",editable:!0},{title:e("components.productVariationCard.size"),dataIndex:"size",align:"center",width:"218px",editable:!0},{title:e("pages.shop.product.stocktaking.batchShelf"),dataIndex:"batch_shelf",align:"center",width:"60px"},{dataIndex:"operation",align:"center",width:"50px",fixed:"right"}];if((0,rt._sl)(r)){var u=c.findIndex((function(t){return"retail_price"==t.dataIndex})),l={title:e("pages.shop.product.variation.originalPriceOnWeb"),dataIndex:"original_price",align:"right",width:"140px",editable:!0};c.splice(u+1,0,l);var d=c.findIndex((function(t){return"is_locked"==t.dataIndex})),p={title:e("pages.shop.product.variation.storeCakeStatus"),dataIndex:"status_store",align:"center",width:"90px",fixed:"left"};c.splice(d+1,0,p)}if(!a.ql_sanpham){var f=c.findIndex((function(t){return"operation"===t.dataIndex}));f>-1&&c.splice(f,1)}if(!a.view_imported_price){var h=c.findIndex((function(t){return"last_imported_price"===t.dataIndex}));h>-1&&c.splice(h,1)}if(!a.ql_nhaphang||!(0,rt.rqq)(3,r)){var m=c.findIndex((function(t){return"wholesale_price2"===t.dataIndex}));m>-1&&c.splice(m,1)}if(!r.use_warehouse_position){var g=c.findIndex((function(t){return"batch_shelf"===t.dataIndex}));g>-1&&c.splice(g,1)}if(!r.use_product_keyword_when_auto_create_order){var v=c.findIndex((function(t){return"keyword"===t.dataIndex}));v>-1&&c.splice(v,1)}if(!r.use_price_at_counter){var y=c.findIndex((function(t){return"price_at_counter"===t.dataIndex}));y>-1&&c.splice(y,1)}if(!n.warning_by_variation){var _=c.findIndex((function(t){return"limit_quantity_to_warn"===t.dataIndex}));_>-1&&c.splice(_,1)}return c.map((function(t){return ke(ke({},t),{},{render:function(e,r){var n=s.state.variationsData.findIndex((function(t){return t.key==r.key}));return o&&"".concat(n,"_").concat(t.dataIndex)==o?Ze(Se.Z,(0,lt.Z)({},s.props,{record:r,index:n,handleSave:s.handleSave,dataIndex:t.dataIndex,callBack:function(t){return s.setState(ke({},t))},handleAttributeSelect:s.handleAttributeSelect,handleAttributeDeselect:s.handleAttributeDeselect})):Ze("div",{style:{width:"100%"},id:"".concat(n,"_").concat(t.dataIndex),className:"".concat(t.editable?"editable-cell-value-wrap":void 0),onClick:function(){return t.editable&&s.setState({currentEdit:"".concat(n,"_").concat(t.dataIndex)})}},s.renderTableCell(r,t.dataIndex))}})}))})),(0,f.Z)((0,u.Z)(s),"renderTableCell",(function(t,e){var r=s.props,n=r.t,i=r.creator,c=r.currentShop,u=s.state.variationsData,l=u.findIndex((function(e){return e.key==t.key}));switch(e){case"is_locked":return Ze(o.default,{placement:"bottom",title:n("components.productVariationCard.cannotCreateOrderWithBlockedVariation")},Ze("div",null,Ze(O.Z,{defaultChecked:!0,size:"small",checked:!t.is_locked,onChange:function(t){return s.handleSave("is_locked",t,l)}})));case"status_store":var d=u[l].is_hidden||!1,p={cursor:"pointer"};return Ze("div",{style:{fontSize:"larger"},onClick:function(){return s.handleSave("is_hidden",!d,l)}},Ze(d?w.Z:S.Z,{style:p}));case"images":return s.renderImages(t);case"wholesale_price2":return Ze(N.default,{trigger:"click",placement:"top",content:s.wholesalePopcover(l),overlayClassName:"remain-popover",visible:u[l].visibleWholesale,onVisibleChange:function(t){return s.handlePopoverVisible(t,l,"visibleWholesale")},arrowPointAtCenter:!0},Ze("div",{style:{cursor:"pointer",width:"100%"}},t.wholesale_price2));case"remain_quantity":return Ze(N.default,{trigger:"click",placement:"bottomRight",content:s.remainPopover(t.variations_warehouses,l),overlayClassName:"remain-popover",visible:u[l].visible,onVisibleChange:function(t){return s.handlePopoverVisible(t,l,"visible")},arrowPointAtCenter:!0},Ze("div",{style:{cursor:"pointer",width:"100%"}},(0,rt.oH6)(t.variations_warehouses.reduce((function(t,e){return t+e.remain_quantity}),0),c.currency),Ze(U.Z,{style:{cursor:"pointer",paddingLeft:"4px"}})));case"operation":return Ze(a.default,{shape:"circle",type:"link",danger:!0,className:"btn-delete",disabled:1===u.filter((function(t){return!t.do_remove})).length,icon:Ze(J.Z,null),onClick:function(){return s.handleDeleteVariation(l)}});case"fields":return s.renderInfo(t.fields.map((function(t){return JSON.parse(t)})));case"size":return s.renderSizeInfo(t.size,l);case"custom_id":return t.custom_id?t.custom_id:(0,rt.pyT)(t.display_id,0);case"barcode":return c.use_custom_id_for_barcode&&t.custom_id?t.custom_id:t.barcode||(i.display_id&&t.display_id?"".concat(i.display_id,"-").concat(t.display_id):void 0);case"batch_shelf":return Ze("div",{style:{cursor:"pointer",width:"100%"},className:"flex-center"},Ze(fe.Z,{style:{cursor:"pointer",paddingLeft:"4px"},onClick:function(){return s.handlePopoverVisible(!0,l,"visibleBatchShelf")}}),u[l].visibleBatchShelf&&Ze(h.Z,{title:"C\u1ea5u h\xecnh l\xf4-k\u1ec7",visible:u[l].visibleBatchShelf,className:"batch-shelf-modal",width:"60%",onCancel:function(){return s.handlePopoverVisible(!1,l,"visibleBatchShelf")},onOk:function(){return s.handleSaveBatchShelf(l)},okText:"X\xe1c nh\u1eadn"},s.renderBatchShelfContent(l)));case"retail_price":return c.multiple_currency.length?Ze(N.default,{trigger:"click",placement:"top",content:s.retailPriceMultipleCurrency(l),overlayClassName:"remain-popover",visible:u[l].visibleRetailPrice,onVisibleChange:function(t){return s.handlePopoverVisible(t,l,"visibleRetailPrice")},arrowPointAtCenter:!0},Ze("div",{style:{cursor:"pointer",width:"100%"}},t.retail_price)):t[e];default:return t[e]}})),(0,f.Z)((0,u.Z)(s),"getBatchShelfOptions",(function(t,e){var r=[];return t.hide_config_batch_shelf?(e="custom_".concat(e),r=(0,rt.B3G)(t[e])):r=(0,rt.gnl)(t[e]),!r||r&&0==r.length?[]:r.map((function(t){return{key:t,value:t}}))})),(0,f.Z)((0,u.Z)(s),"renderBatchShelfContent",(function(t){var e,r=s.props,n=r.t,o=r.warehouses,a=r.users,i=r.user,c=s.state.variationsData,u=null===(e=a.find((function(t){return t.user_id==i.uid})))||void 0===e?void 0:e.app_warehouse;return Ze("div",null,Ze(se.default,{style:{marginBottom:10}},Ze(ue.default,{span:8,style:{fontWeight:500}},n("pages.shop.product.variation.warehouseName")),Ze(ue.default,{span:5,style:{fontWeight:500}},n("pages.shop.product.variation.batchPosition")),Ze(ue.default,{span:5,style:{paddingLeft:10,fontWeight:500}},n("pages.shop.product.variation.shelfPosition")),Ze(ue.default,{span:3,style:{fontWeight:500,textAlign:"end"}},n("pages.shop.product.variation.batchQuantity")),Ze(ue.default,{span:3,style:{fontWeight:500,textAlign:"end"}},n("pages.shop.product.variation.shelfQuantity"))),(o||[]).filter((function(t){return!u||u&&u==t.id})).map((function(e){var r=c[t].variations_warehouses.find((function(t){return t.warehouse_id==e.id}))||{};return Ze(se.default,{style:{marginBottom:10},key:e.id},Ze(ue.default,{span:8,style:{alignItems:"center",display:"flex",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},null===e||void 0===e?void 0:e.name),Ze(ue.default,{span:5},Ze(R.default,{showSearch:!0,placeholder:n("pages.shop.product.variation.chooseBatchPosition"),value:r.batch_position?r.batch_position.split(";"):void 0,style:{width:"100%"},mode:"multiple",onSelect:function(r){return s.handleBatchShelfChange(r,t,e.id,"batch_position")},onDeselect:function(r){return s.handleDeselectBatchShelf(r,t,e.id,"batch_position")},options:s.getBatchShelfOptions(e,"batch_config")})),Ze(ue.default,{span:5,style:{paddingLeft:10}},Ze(R.default,{showSearch:!0,placeholder:n("pages.shop.product.variation.chooseShelfPosition"),value:r.shelf_position?r.shelf_position.split(";"):void 0,style:{width:"100%"},mode:"multiple",onSelect:function(r){return s.handleBatchShelfChange(r,t,e.id,"shelf_position")},onDeselect:function(r){return s.handleDeselectBatchShelf(r,t,e.id,"shelf_position")},options:s.getBatchShelfOptions(e,"shelf_config")})),Ze(ue.default,{span:3,style:{alignItems:"center",display:"flex",justifyContent:"flex-end"}},(0,rt.oH6)(r.actual_remain_quantity-r.shelf_quantity)),Ze(ue.default,{span:3,style:{alignItems:"center",display:"flex",justifyContent:"flex-end"}},(0,rt.oH6)(r.shelf_quantity)))})))})),(0,f.Z)((0,u.Z)(s),"wholesalePopcover",(function(t){var e=s.props.t;return Ze("div",{className:"configure-line-wholesale"},Ze("div",{className:"add-wholesale"},Ze(a.default,{icon:Ze(x.Z,null),onClick:function(){return s.addLevelWholesale(t)}},e("pages.shop.setting.addLevelRevenue"))),Ze(k.Z,{columns:s.columnsLevelOrder(),dataSource:s.getDataLevelOrder(t),size:"small",pagination:!1,scroll:{y:200}}))})),(0,f.Z)((0,u.Z)(s),"handleInputNumberRetailPrice",(function(t,e,r,n,o){var a=s.state.variationsData,i=g()(n);i[e].retailPriceByCurrency=t,a[r].retail_price_by_currency=i,o&&s.handleSave("retail_price",t,r),s.handleSave("retail_price_by_currency",i,r)})),(0,f.Z)((0,u.Z)(s),"getDataMultipeCurrency",(function(t){var e=s.props,r=e.currentShop,n=e.creator,o=s.state.variationsData,a=o[t].retail_price,i=[{currency:r.currency,retailPriceByCurrency:a}].concat(r.multiple_currency.filter((function(t){return t.currency!=r.currency})).map((function(t){return{currency:t.currency,retailPriceByCurrency:0}}))),c=M()((r.multiple_currency||[]).map((function(t){return t.currency})).concat(r.currency)),u=(o[t].retail_price_by_currency||[]).filter((function(t){return c.includes(t.currency)})),l=u.concat(c.filter((function(t){return!u.map((function(t){return t.currency})).includes(t)})).map((function(t){return t==r.currency?{currency:t,retailPriceByCurrency:a}:{currency:t,retailPriceByCurrency:0}}))),d=u.length?l:i;return d.map((function(e,o){var i=e.retailPriceByCurrency>0?e.retailPriceByCurrency:s.getRateRetailPrice(e.currency,a);return{key:o,currency:Ze("span",null,e.currency),retailPriceByCurrency:Ze(ut.default,{value:i,currency:e.currency,suffix:(0,rt.jKf)(e.currency),isMoney:!0,callBack:function(n){return s.handleInputNumberRetailPrice(n,o,t,d,e.currency==r.currency)},disabled:n.is_accessory})}}))})),(0,f.Z)((0,u.Z)(s),"getRateRetailPrice",(function(t,e){var r,n=s.props.currentShop;if(!e)return 0;var o=null===(r=(n.multiple_currency||[]).find((function(e){return e.currency==t})))||void 0===r?void 0:r.rate,a=rt.cvg.includes(t)?1:100,i=parseFloat(e/o).toFixed(1);return Math.round(i*a)})),(0,f.Z)((0,u.Z)(s),"retailPriceMultipleCurrency",(function(t){var e=s.props.t,r=[{title:e("pages.shop.setting.unit"),dataIndex:"currency",width:"40%"},{title:e("components.accessoriesSecondStep.retailPrice"),dataIndex:"retailPriceByCurrency",width:"60%"}];return Ze("div",{className:"configure-line-wholesale"},Ze(k.Z,{columns:r,dataSource:s.getDataMultipeCurrency(t),size:"small",pagination:!1,scroll:{y:200}}))})),(0,f.Z)((0,u.Z)(s),"addLevelWholesale",(function(t){var e=s.state.variationsData,r=e[t].wholesale_price2?e[t].wholesale_price2:[];r.push({levelProduct:0,wholesalePrices:0}),e[t].wholesale_price2=r,s.setState({variationsData:e})})),(0,f.Z)((0,u.Z)(s),"columnsLevelOrder",(function(){var t=s.props.t;return[{title:t("components.productVariationCard.productQuantity"),dataIndex:"levelProduct",width:"30%"},{title:t("components.productVariationCard.wholesalePrice"),dataIndex:"wholesalePrices"},{title:"",dataIndex:"delete",width:50,align:"center"}]})),(0,f.Z)((0,u.Z)(s),"getDataLevelOrder",(function(t){var e=s.props,r=(e.t,e.currentShop),n=s.state.variationsData;return(n[t].wholesale_price2?n[t].wholesale_price2:[]).map((function(e,n){return{key:n,levelProduct:Ze(ut.default,{value:e.levelProduct,currency:r.currency,isMoney:!1,callBack:function(e){return s.handleInputNumberWholesale(e,n,"levelProduct",t)}}),wholesalePrices:Ze(ut.default,{currency:r.currency,isMoney:!0,value:e.wholesalePrices,callBack:function(e){return s.handleInputNumberWholesale(e,n,"wholesalePrices",t)},suffix:(0,rt.jKf)(r.currency)}),delete:Ze(a.default,{shape:"circle",type:"link",danger:!0,className:"btn-delete",icon:Ze(J.Z,null),onClick:function(){return s.handleDeleteLineInTable(n,t)}})}}))})),(0,f.Z)((0,u.Z)(s),"handleInputNumberWholesale",(function(t,e,r,n){var o=s.state.variationsData,a=g()(o),i=a[n].wholesale_price2?a[n].wholesale_price2:[];i.map((function(n,o){e==o&&("levelProduct"==r?n.levelProduct=t:n.wholesalePrices=t)})),o[n].wholesale_price2=i,s.setState({variationsData:o}),s.handleSave("wholesale_price2",i,n)})),(0,f.Z)((0,u.Z)(s),"handleDeleteLineInTable",(function(t,e){var r=s.state.variationsData,n=g()(r),o=n[e].wholesale_price2&&n[e].wholesale_price2.length?n[e].wholesale_price2:[];o.splice(t,1),r[e].wholesale_price2=o,s.setState({variationsData:r}),s.handleSave("wholesale_price2",o,e)})),(0,f.Z)((0,u.Z)(s),"handleSetState",(function(t){s.setState({variationsData:t})})),(0,f.Z)((0,u.Z)(s),"handleSetProductImage",(function(t){var e=s.props,r=e.updateProductCreator,o=e.t;r({image:t}),n.default.success({content:o("components.productCreatorFirstStep.successfullySetProductImage"),style:{marginTop:"10vh",fontSize:20}})})),(0,f.Z)((0,u.Z)(s),"renderImages",(function(t){var e=s.state.variationsData,r=s.props,n=r.accessToken,o=r.shopId;return Ze(Ce.Z,{shopId:o,accessToken:n,variationsData:e,variation:t,handleSave:s.handleSave,setVariations:s.handleSetState,isProduct:!0,handleSetProductImage:s.handleSetProductImage})})),(0,f.Z)((0,u.Z)(s),"getData",(function(){var t=s.state,e=t.variationsData,r=t.currentEdit,n=(t.isAutoGen,t.textSearch),o=s.props,a=o.creator,i=o.currentShop,c=o.t,u=(a.product_attributes||[]).map((function(t){var e;return null===t||void 0===t||null===(e=t.name)||void 0===e?void 0:e.trim()})),l=(a.product_attributes||[]).reduce((function(t,e){return t.concat(e.values)}),[]).map((function(t){return null===t||void 0===t?void 0:t.trim()})),d=(e||[]).filter((function(t){return((0,rt.C6S)(n,t.custom_id?t.custom_id.toString():"")||(0,rt.C6S)(n,t.display_id?t.display_id.toString():""))&&!t.do_remove}));return d?d.map((function(t){var e=t.key||t.id;return t.key=e,t})).filter((function(t){return!t.do_remove})).map((function(t){var n=e.findIndex((function(e){return e.key==t.key})),o=r&&(r.match(/.*_retail_price/)||r.match(/.*_last_imported_price/))?parseInt(r):-1,d=!0;return-1!=o&&(r.match(/.*_retail_price/)&&(d=s.checkSyncVariationWithAttributes(t,o,"attributesToSyncPrice")),r.match(/.*_last_imported_price/)&&(d=s.checkSyncVariationWithAttributes(t,o,"attributesToSyncLastImportedPrice"))),{key:t.key,custom_id:t.custom_id||"",display_id:t.display_id?t.display_id:"",barcode:i.use_custom_id_for_barcode&&t.custom_id?t.custom_id:t.barcode?t.barcode:void 0,keyword:(t.keyword||"").replace(/(\|)/g,";"),weight:r&&r.match(/.*_weight/)&&r!="".concat(n,"_weight")&&a.syncVariations.weight?c("components.productCreatorFirstStep.sync"):t.weight?i.config_weight_product?parseFloat(t.weight/1e3):t.weight:0,size:r&&r.match(/.*_size/)&&r!="".concat(n,"_size")&&a.syncVariations.size?c("components.productCreatorFirstStep.sync"):t.size,images:t&&"-1"!=t.images?t.images.filter((function(t){return t})).map((function(t,e){return t.uid?t:{uid:e,response:{content_url:t},status:"done",url:t}})):[],videos:t&&t.videos&&"-1"!=t.videos?t.videos.filter((function(t){return t})).map((function(t,e){return t.uid?t:{uid:e,response:{content_url:t},status:"done",url:t}})):[],is_locked:t.is_locked,fields:t.fields&&t.fields.length>0?t.fields.filter((function(t){return(u||[]).includes((t.name||"").trim())&&(l||[]).includes((t.value||"").trim())})).map((function(t){return JSON.stringify({name:(t.name||"").trim(),value:(t.value||"").trim(),keyValue:(0,rt.Mle)(t.keyValue||t.value||"",!0).toUpperCase()})})):[],wholesale_price2:(0,rt.ufS)(t.wholesale_price2&&t.wholesale_price2.length?t.wholesale_price2[0].wholesalePrices:0,i.currency),last_imported_price:d&&r&&r.match(/.*_last_imported_price/)&&r!="".concat(n,"_last_imported_price")&&a.syncVariations.last_imported_price?c("components.productCreatorFirstStep.sync"):(0,rt.ufS)(t.last_imported_price,i.currency),retail_price:d&&r&&r.match(/.*_retail_price/)&&r!="".concat(n,"_retail_price")&&a.syncVariations.retail_price?c("components.productCreatorFirstStep.sync"):(0,rt.ufS)(t.retail_price,i.currency),original_price:r&&r.match(/.*_original_price/)&&r!="".concat(n,"_original_price")&&a.syncVariations.original_price?c("components.productCreatorFirstStep.sync"):(0,rt.ufS)(t.original_price,i.currency),remain_quantity:(0,rt.oH6)(t.variations_warehouses.reduce((function(t,e){return t+e.remain_quantity}),0),i.currency),total_quantity:(0,rt.oH6)(t.variations_warehouses.reduce((function(t,e){return t+e.total_quantity}),0),i.currency),actual_remain_quantity:(0,rt.oH6)(t.variations_warehouses.reduce((function(t,e){return t+e.actual_remain_quantity}),0),i.currency),pending:(0,rt.oH6)(t.variations_warehouses.reduce((function(t,e){return t+e.pending_quantity}),0),i.currency),limit_quantity_to_warn:r&&r.match(/.*_limit_quantity_to_warn/)&&r!="".concat(n,"_limit_quantity_to_warn")&&a.syncVariations.limit_quantity_to_warn?c("components.productCreatorFirstStep.sync"):(0,rt.oH6)(t.limit_quantity_to_warn||0,i.currency),variations_warehouses:t.variations_warehouses,visible:!1,visibleWholesale:!1,visibleRetailPrice:!1,visibleImages:!1,visibleBatchShelf:!1,price_at_counter:r&&r.match(/.*_price_at_counter/)&&r!="".concat(n,"_price_at_counter")&&a.syncVariations.price_at_counter?c("components.productCreatorFirstStep.sync"):(0,rt.ufS)(t.price_at_counter,i.currency)}})):[]})),(0,f.Z)((0,u.Z)(s),"handleDeleteVariation",(function(t){var e=s.state.variationsData;e[t].id?e[t].do_remove=!0:e.splice(t,1),s.setState({variationsData:e},(function(){return s.handleSaveVariation()}))})),(0,f.Z)((0,u.Z)(s),"remainPopover",(function(t,e){var r,n=s.props,i=n.t,c=n.users,u=n.user,l=n.creator,d=l.notCreateTransaction,p=l.manipulation_warehouses,f=n.warehouses,h=n.currentShop,m=n.isRemainSaving,g=s.state.variationsData,v=null===(r=c.find((function(t){return t.user_id==u.uid})))||void 0===r?void 0:r.app_warehouse;return Ze("div",{className:"edit-remain-quantity"},Ze("div",{style:{fontWeight:500,paddingBottom:10,fontSize:16}},i("pages.shop.product.missingProduct.change")),Ze("div",{style:{width:400,maxHeight:600,overflowY:"auto",padding:"0px 10px",overflowX:"hidden"}},(0==g[e].variations_warehouses.length||!g[e].id)&&Ze("div",null,Ze("div",null,i("pages.shop.product.missingProduct.variationNotExits")),Ze(ce.default,{checked:!d,style:{marginBottom:10,marginLeft:0},onChange:function(t){return s.onChangeNotCreateTransaction(t.target.checked,e)}},i("components.productVariationCard.createTransaction"))),f.filter((function(e){return!v||v==e.id&&t.find((function(t){return t.warehouse_id==v}))})).map((function(r){var n,a,i=r.id,c=r.name,u=r.full_address,l=(t||[]).findIndex((function(t){return t.warehouse_id===i})),d=(p||[]).filter((function(t){return f.map((function(t){return t.id})).includes(t)})),m=d&&d.length>0&&d.includes((null===(n=t[l])||void 0===n?void 0:n.warehouse_id)||i)||d&&0==d.length;return Ze(o.default,{placement:"left",title:u,key:i},Ze("div",{style:{marginBottom:5}},Ze(ut.default,{prefix:"".concat(c,":"),disabled:!m,currency:h.currency,isMoney:!1,value:(null===(a=t[l])||void 0===a?void 0:a.remain_quantity)||0,callBack:function(t){return s.handleRemainChange(t,e,i)}})))}))),g[e].id&&t.length>0&&Ze(a.default,{type:"primary",icon:Ze(m?b.Z:he.Z,null),style:{width:"100%",marginTop:10},onClick:function(){return s.handleRemainSave(e)}},i("confirmed")))})),(0,f.Z)((0,u.Z)(s),"handleRemainChange",(function(t,e,r){var n=s.state.variationsData;n.filter((function(t){return!t.do_remove}));var o=n[e].variations_warehouses.findIndex((function(t){return t.warehouse_id==r}));o>-1?(n[e].variations_warehouses[o].remain_quantity=t,n[e].variations_warehouses[o].is_change_quantity=!0,n[e].remain_quantity=n[e].variations_warehouses.reduce((function(t,e){return t+e.remain_quantity}),0)):(n[e].variations_warehouses.push({remain_quantity:t,is_change_quantity:!0,variation_id:n[e].id,warehouse_id:r}),n[e].remain_quantity+=t),s.setState({variationsData:n}),s.props.updateProductCreator({variations:n})})),(0,f.Z)((0,u.Z)(s),"handleBatchShelfChange",(function(t,e,r,n){var o=s.state.variationsData.filter((function(t){return!t.do_remove})),a=o[e].variations_warehouses.findIndex((function(t){return t.warehouse_id==r}));if(-1!=a){var i=o[e].variations_warehouses[a][n]||"",c=i?";":"";o[e].variations_warehouses[a][n]=i+c+t,o[e].variations_warehouses[a].is_change_shelf=!0}else{var u={warehouse_id:r,variation_id:o[e].id,is_change_shelf:!0};u[n]=t,o[e].variations_warehouses=o[e].variations_warehouses.concat(u)}s.setState({variationsData:o}),s.props.updateProductCreator({variations:o})})),(0,f.Z)((0,u.Z)(s),"handleDeselectBatchShelf",(function(t,e,r,n){var o=s.state.variationsData.filter((function(t){return!t.do_remove})),a=o[e].variations_warehouses.findIndex((function(t){return t.warehouse_id==r}));if(-1!=a){var i=o[e].variations_warehouses[a][n].split(";").filter((function(e){return e!=t}));o[e].variations_warehouses[a][n]=i.length>0?i.join(";"):"",o[e].variations_warehouses[a].is_change_shelf=!0,s.setState({variationsData:o}),s.props.updateProductCreator({variations:o})}})),(0,f.Z)((0,u.Z)(s),"handleConfigConsignmentChange",(function(t,e,r,n){var o=s.state.variationsData.filter((function(t){return!t.do_remove})),a=o[e].variations_warehouses.findIndex((function(t){return t.warehouse_id==r}));-1!=a&&(o[e].variations_warehouses[a][n]=t,s.setState({variationsData:o}),s.props.updateProductCreator({variations:o}))})),(0,f.Z)((0,u.Z)(s),"handlePopoverVisible",(function(t,e,r){var n=s.state.variationsData;n[e][r]=t,s.setState({variationsData:n})})),(0,f.Z)((0,u.Z)(s),"handleRemainSave",(function(t){var e=s.state,r=e.variationsData,n=e.isRemainSaving,o=s.props,a=o.accessToken,i=o.updateRemainQuantity,c=o.fetchProduct,u=o.creator,l=u.variations,d=u.manipulation_warehouses,p=o.currentShop,f=r[t].id,h=r[t].last_imported_price?r[t].last_imported_price:"-1",m=r[t].variations_warehouses;p.negative_order_by_upcoming_product&&(m=g()(r[t].variations_warehouses).map((function(t){return t.remain_quantity=t.remain_quantity-t.pending_quantity,t}))),n||(r[t].visible=!1,s.setState({isRemainSaving:!0,variationsData:r}),i(a,f,h,d,m).then((function(e){if(e)c(a,f).then((function(e){var n=e.variations.find((function(t){return t.id===f}));r[t].total_quantity=n.total_quantity,r[t].last_imported_price=n.last_imported_price,r[t].variations_warehouses=n.variations_warehouses,s.setState({variationsData:r,isRemainSaving:!1})}));else{var n=l.find((function(t){return t.id===f}));r[t].total_quantity=n.total_quantity,r[t].last_imported_price=n.last_imported_price,r[t].variations_warehouses=n.variations_warehouses,s.setState({variationsData:r,isRemainSaving:!1})}})))})),(0,f.Z)((0,u.Z)(s),"handleSaveBatchShelf",(function(t){var e=s.state.variationsData,r=s.props,n=r.creator,o=r.updateProductCreator,a=g()(e[t]),i=g()(e);a.id&&(n.syncVariations.batch_position&&i.map((function(t){var e=s.syncBatchShelf(t.variations_warehouses,a.variations_warehouses,"batch_position");return t.variations_warehouses=e,t})),n.syncVariations.shelf_position&&i.map((function(t){var e=s.syncBatchShelf(t.variations_warehouses,a.variations_warehouses,"shelf_position");return t.variations_warehouses=e,t}))),i[t].visibleBatchShelf=!1,s.setState({variationsData:i}),o({variations:i})})),(0,f.Z)((0,u.Z)(s),"syncBatchShelf",(function(t,e,r){var n=s.props.warehouses,o=[];return n.forEach((function(n){var a,i=e.find((function(t){return t.warehouse_id==n.id})),c=t.find((function(t){return t.warehouse_id==n.id}));(c&&i&&(o=o.concat(ke(ke({},c),{},(0,f.Z)({is_change_shelf:!0},r,i[r])))),c&&!i&&(o=o.concat(ke(ke({},c),{},(0,f.Z)({},r,"")))),!c&&i&&i[r])&&(o=o.concat((a={},(0,f.Z)(a,r,i[r]),(0,f.Z)(a,"is_change_shelf",!0),(0,f.Z)(a,"warehouse_id",i.warehouse_id),(0,f.Z)(a,"variation_id",i.variation_id),a)))})),o})),(0,f.Z)((0,u.Z)(s),"onChangeNotCreateTransaction",(function(t,e){var r=s.state.variationsData,n=g()(s.props.creator);n=ke(ke({},n),{},{notCreateTransaction:!t}),s.props.updateProductCreator(n),localStorage.setItem("notCreateTransaction",!t),r[e].not_create_transaction=!t,s.setState({variationsData:r},(function(){return s.handleSaveVariation()}))})),(0,f.Z)((0,u.Z)(s),"handleAddVariation",(function(){var t=s.props,e=t.creator,r=t.warehouses,n=e.syncVariations,o=s.state.variationsData,a=e.variations[0]||{},i=a.images,c=a.weight,u=a.retail_price,l=a.last_imported_price,d=a.wholesale_price2,p=a.price_at_counter,f=a.retail_price_by_currency,h=a.videos,m={key:(0,rt.uuG)(),images:i||[],videos:h||[],last_imported_price:n.last_imported_price&&l?l:0,retail_price:n.retail_price&&u?u:0,price_at_counter:n.price_at_counter&&p?p:0,fields:[],weight:n.weight&&c?c:0,barcode:null,custom_id:null,variations_warehouses:r.map((function(t){return{warehouse_id:t.id,remain_quantity:0}})),actual_remain_quantity:0,remain_quantity:0,total_quantity:0,cogs:0,not_create_transaction:e.notCreateTransaction,wholesale_price2:n.wholesale_price2&&null!==d&&void 0!==d&&d.length?d:[],retail_price_by_currency:n.retail_price&&null!==f&&void 0!==f&&f.length?f:[]};o.unshift(m),s.setState({variationsData:o},(function(){return s.handleSaveVariation()}))})),(0,f.Z)((0,u.Z)(s),"onClickAddVariation",(function(){var t=s.props,e=t.creator,r=t.warehouses,n=t.shopId,o=e.syncVariations,a=s.state,i=a.variationsData,c=a.cartesianProductOf,u=a.unSelectedKeys,l=a.isAutoGen,d=c.filter((function(t,e){return!u.includes(e)}));if(d.length){var p=[],h=e.variations[0]||{},m=h.images,g=h.weight,v=h.retail_price,y=h.last_imported_price,_=h.wholesale_price2,b=h.price_at_counter,S=h.retail_price_by_currency,w=h.videos;d.map((function(t){var a,i=(a={key:(0,rt.uuG)(),images:m,videos:w,last_imported_price:o.last_imported_price?y:0,retail_price:o.retail_price?v:0,price_at_counter:o.price_at_counter?b:0,fields:[],weight:o.weight?g:0,barcode:null,custom_id:(e.custom_id||e.display_id)&&t&&t.length>0&&l?(0,rt.Qh$)(n,e.custom_id,e.display_id,t,l):null,variations_warehouses:r.map((function(t){return{warehouse_id:t.id,remain_quantity:0}})),actual_remain_quantity:0,remain_quantity:0,total_quantity:0,cogs:0,not_create_transaction:e.notCreateTransaction},(0,f.Z)(a,"fields",t||[]),(0,f.Z)(a,"wholesale_price2",o.wholesale_price2?_:[]),(0,f.Z)(a,"retail_price_by_currency",o.retail_price&&null!==S&&void 0!==S&&S.length?S:[]),a);p.push(i)})),s.setState({variationsData:p.concat(i)},(function(){return s.handleSaveVariation()}))}})),(0,f.Z)((0,u.Z)(s),"handleSave",(function(t,e,r){var n=s.state.variationsData;switch(n.filter((function(t){return!t.do_remove})),t){case"is_hidden":n[r][t]=e;break;case"is_locked":n[r][t]=!e;break;case"images":n[r][t]=e.map((function(t){return t.response?t.response.content_url:t}));break;case"videos":e.length>0?n[r][t]=e.map((function(t){if(t.response)return t.response.content_url})):n[r][t]=-1,n[r].videos=n[r].videos.length?n[r].videos.filter((function(t){return t})):n[r].videos;break;case"limit_quantity_to_warn":n[r][t]=e;break;case"weight":case"size":case"last_imported_price":case"retail_price":case"price_at_counter":case"wholesale_price2":case"retail_price_by_currency":n[r][t]=e;break;default:n[r][t]=(e||"").toString().trim()}s.setState({variationsData:n},(function(){return s.handleSaveVariation(!0,r,t)}))})),(0,f.Z)((0,u.Z)(s),"checkSyncVariationWithAttributes",(function(t,e,r){var n=s.props.creator.syncVariations,o=s.state.variationsData,a=t.fields.reduce((function(t,a){return(n[r]||[]).map((function(r){var n,i=((null===(n=o[e])||void 0===n?void 0:n.fields)||[]).find((function(t){return t.name==r.name}));a.name===r.name&&i&&i.value==a.value&&t.push(a)})),t}),[]);return(n[r]||[]).includes("all")||a.length===(n[r]||[]).length})),(0,f.Z)((0,u.Z)(s),"handleSaveVariation",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=s.state,o=n.variationsData,a=n.isAutoGen,c=s.props,u=c.updateProductCreator,l=c.creator,d=l.syncVariations,p=l.display_id,f=l.custom_id,h=c.currentShop,m=c.shopId,g=(0,i.Z)(o);"custom_id"==r&&(g[e].is_edit_custom_id=!0),g.map((function(t){var r;t.id||!a||null!==(r=g[e])&&void 0!==r&&r.is_edit_custom_id||(t.custom_id=t.fields?(0,rt.Qh$)(m,f,p,t.fields,a):t.custom_id)})),u({variations:g});var v=["images","videos","retail_price","retail_price_by_currency","last_imported_price"];t&&(g.map((function(t){if(v.includes(r)){var n="";switch(r){case"retail_price":case"retail_price_by_currency":n="attributesToSyncPrice";break;case"last_imported_price":n="attributesToSyncLastImportedPrice";break;case"images":case"videos":n="attributesToSyncImage"}var a=d[r];if("videos"==r&&(a=d.images),"retail_price_by_currency"==r&&(a=d.retail_price),s.checkSyncVariationWithAttributes(t,e,n)&&a&&(t[r]=o[e][r],"retail_price_by_currency"==r)){var i=((o[e].retail_price_by_currency||[]).find((function(t){return t.currency==h.currency}))||{}).retailPriceByCurrency;(i||0==i)&&(t.retail_price=i)}}else d[r]&&(t[r]=o[e][r])})),u({variations:g}))})),(0,f.Z)((0,u.Z)(s),"styleModal",(function(t){if(t)return Ze(pe.default,{id:"2615464161"},[".ant-modal-mask{z-index:99999;}"])})),(0,f.Z)((0,u.Z)(s),"onSearchVariation",(function(t){s.setState({textSearch:t})})),(0,f.Z)((0,u.Z)(s),"onClearFilterClick",(function(){s.setState({textSearch:""})})),(0,f.Z)((0,u.Z)(s),"renderInfo",(function(t){return t.map((function(t){return Ze("span",{key:t.name},Ze("strong",{style:{color:"#005667"}},t.name,":")," ",Ze("i",{style:{marginRight:4}},t.value))}))})),(0,f.Z)((0,u.Z)(s),"renderSizeInfo",(function(t){var e=s.props.t,r=(t||{}).length||0,n=(t||{}).width||0,o=(t||{}).height||0;return Ze("div",null,t==e("components.productCreatorFirstStep.sync")?t:"".concat(r," x ").concat(n," x ").concat(o))})),(0,f.Z)((0,u.Z)(s),"handleAttributeSelect",(function(t,e){var r=s.state.variationsData,n=s.props,o=n.t,a=n.creator;r.filter((function(t){return!t.do_remove}));var i=JSON.parse(t);if(""!=i.value.trim()){var c=r[e].fields.findIndex((function(t){return t.name===i.name}));c>-1?r[e].fields[c]=JSON.parse(t):r[e].fields.push(JSON.parse(t));var u=a.product_attributes.reduce((function(t,n){var o=r[e].fields.find((function(t){return t.name==n.name}));if(o){var a,i=(null===(a=n.keyword.find((function(t){return t.value==o.value})))||void 0===a?void 0:a.keyValue)||o.value;o.keyValue=(0,rt.Mle)(i).toUpperCase(),o.value=o.value.trim(),t.push(o)}return t}),[]);r[e].fields=u,s.setState({variationsData:r},(function(){return s.handleSaveVariation(!0,e,"fields")}))}else ye.Z.error(o("error"),"Ch\u01b0a c\xf3 gi\xe1 tr\u1ecb")})),(0,f.Z)((0,u.Z)(s),"handleAttributeDeselect",(function(t,e){var r=s.state.variationsData;r.filter((function(t){return!t.do_remove}));var n=JSON.parse(t);r[e].fields.map((function(t,o){t.name===n.name&&r[e].fields.splice(o,1)})),s.setState({variationsData:r},(function(){return s.handleSaveVariation(!0,e,"fields")}))})),(0,f.Z)((0,u.Z)(s),"onSelectSyncWithAttributes",(function(t,e){var r=s.props,n=r.updateProductCreator,o=r.creator,a=r.shopId,i=ke({},o.syncVariations);if("all"!==t){var c=JSON.parse(t);(i[e]||[]).map((function(t,r){t.name!==c.name&&"all"!==t||i[e].splice(r,1)})),i[e].push(JSON.parse(t))}else i[e]=[],i[e].push(t);"attributesToSyncImage"==e&&localStorage.setItem("attributes_sync_images_shop_".concat(a),JSON.stringify(i.attributesToSyncImage)),"attributesToSyncPrice"==e&&localStorage.setItem("attributes_sync_price_shop_".concat(a),JSON.stringify(i.attributesToSyncPrice)),"attributesToSyncLastImportedPrice"==e&&localStorage.setItem("attributes_sync_last_imported_price_shop_".concat(a),JSON.stringify(i.attributesToSyncLastImportedPrice)),localStorage.setItem("syncVariations",JSON.stringify(i)),n({syncVariations:i})})),(0,f.Z)((0,u.Z)(s),"onDeselectSyncWithAttributes",(function(t,e){var r=s.props,n=r.updateProductCreator,o=r.creator,a=r.shopId,i=ke({},o.syncVariations);(i[e]||[]).map((function(r,n){if("all"==r)i[e].splice(n,1);else{var o=JSON.parse(t);r.name===o.name&&i[e].splice(n,1)}})),"attributesToSyncImage"==e&&localStorage.setItem("attributes_sync_images_shop_".concat(a),JSON.stringify(i.attributesToSyncImage)),"attributesToSyncPrice"==e&&localStorage.setItem("attributes_sync_price_shop_".concat(a),JSON.stringify(i.attributesToSyncPrice)),"attributesToSyncLastImportedPrice"==e&&localStorage.setItem("attributes_sync_last_imported_price_shop_".concat(a),JSON.stringify(i.attributesToSyncLastImportedPrice)),localStorage.setItem("syncVariations",JSON.stringify(i)),n({syncVariations:i})})),(0,f.Z)((0,u.Z)(s),"checkAutoGenCustomidVariation",(function(t){var e=s.props.shopId;s.setState({isAutoGen:t}),s.props.autoGen(t),localStorage.setItem("isAutoGenCustomidVariation_shop_".concat(e),t)})),(0,f.Z)((0,u.Z)(s),"checkCustomGenAutoVariation",(function(t){var e=s.props.shopId;s.setState({isCustomGenAuto:t}),localStorage.setItem("is_custom_gen_variation_shop_".concat(e),t)})),(0,f.Z)((0,u.Z)(s),"getHeightItem",(function(t){var e=t.index,r=s.state.cartesianProductOf[e].map((function(t){return"".concat(t.name,": ").concat(t.value)})).join(" ").length;return r<45?45:r})),(0,f.Z)((0,u.Z)(s),"renderQuickAddContent",(function(){var t=s.state,e=t.autoCreateVariation,r=t.unSelectedKeys,n=t.isCustomGenAuto,o=t.cartesianProductOf,i=t.isAutoGen,c=s.props.t,u=0==o.filter((function(t,e){return!r.includes(e)})).length,l=o.length,d=45*o.length>350?350:45*o.length;return Ze("div",null,e&&o&&(0,Pt.ng)(560,d,l,s.getHeightItem,s.renderItemQuickAddContent,o),i&&Ze("div",{style:{maxHeight:"50vh",overflow:"auto",width:"100%",display:"grid",borderBottom:"1px solid #f0f0f0",paddingBottom:5,paddingTop:5}},Ze(ce.default,{className:"custom-gen-variation",checked:n,onChange:function(t){return s.checkCustomGenAutoVariation(t.target.checked)}},"".concat(c("components.productCreatorFirstStep.customGenVariation"),' "-"'))),Ze(a.default,{disabled:u,onClick:s.onClickAddVariation,style:{width:"100%",marginTop:10,borderRadius:2},type:"primary"},c("components.productCreatorSecondStep.quicklyAddCodeSamples")))})),(0,f.Z)((0,u.Z)(s),"renderItemQuickAddContent",(function(t,e){var r=s.state.unSelectedKeys,n=s.props.t;return Ze(se.default,{key:e,type:"flex",align:"middle",justify:"space-between",style:{borderBottom:"1px solid #f0f0f0",paddingBottom:5,paddingTop:0==e?0:5}},Ze(ue.default,{span:21},Ze("div",{style:{padding:"5px 5px 5px 8px",minWidth:200}},s.renderInfo(t))),Ze(ue.default,{span:3},Ze(ce.default,{checked:!r.includes(e),onChange:function(){return s.onChangeCheckbox(e)}},n("create"))))})),(0,f.Z)((0,u.Z)(s),"handleWarehouseChange",(function(t,e){var r=s.state.transferVariation;r[t]=e,s.setState({transferVariation:r})})),(0,f.Z)((0,u.Z)(s),"handleTransfer",(function(){s.setState({loadingTransfer:!0});var t=s.props,e=t.accessToken,r=t.currentShop,n=t.fetchProduct,o=t.t,a=t.updateProductCreator,i=s.state,c=i.transferVariation,u=i.variationsData,l="".concat((0,rt.LpH)(),"/shops/").concat(r.id,"/products/variations_transfer?access_token=").concat(e);return Lt().post(l,c).then((function(t){if(t.data.success){var r=g()(u),i=r[0].id;n(e,i).then((function(t){var e=r.map((function(e){var r=t.variations.find((function(t){return t.id==e.id}));return r&&(e.variations_warehouses=r.variations_warehouses),e}));a({manipulation_warehouses:t.manipulation_warehouses}),s.setState({variationsData:e}),ye.Z.success(o("success"),"Chuy\u1ec3n kho th\xe0nh c\xf4ng"),s.setState({loadingTransfer:!1})}))}else ye.Z.error(o("error"),"C\xf3 l\u1ed7i x\u1ea3y ra ho\u1eb7c kh\xf4ng c\xf3 s\u1ea3n ph\u1ea9m trong kho c\u1ea7n chuy\u1ec3n")}))})),(0,f.Z)((0,u.Z)(s),"getSelectValueSync",(function(t,e){return t[e]&&t[e].length>0?"all"==t[e][0]?["all"]:(t[e]||[]).map((function(t){return JSON.stringify({name:t.name})})):[]})),(0,f.Z)((0,u.Z)(s),"renderOptionSelectSync",(function(t,e,r){var n=s.props.t;return Ze(R.default,{mode:"multiple",dropdownStyle:{fontSize:14},style:{width:"100%",borderRadius:"2px !important"},value:e.length?e:["all"],onSelect:function(t){return s.onSelectSyncWithAttributes(t,r)},onDeselect:function(t){return s.onDeselectSyncWithAttributes(t,r)}},Ze(Ie,{value:"all",key:"all"},n("components.productVariationCard.allVariation")),t&&t.length>0?t.filter((function(t){return""!=t.name})).map((function(t,e){return Ze(Ie,{value:JSON.stringify({name:t.name}),key:e},t.name)})):null)})),(0,f.Z)((0,u.Z)(s),"renderSyncContent",(function(){var t=s.props,e=t.t,r=t.creator,n=r.syncVariations,o=r.product_attributes,a=r.warning_by_variation,i=t.currentShop,c=s.getSelectValueSync(n,"attributesToSyncImage"),u=s.getSelectValueSync(n,"attributesToSyncPrice"),l=s.getSelectValueSync(n,"attributesToSyncLastImportedPrice"),d=i?(0,Zt.zE)(i.role):{};return Ze("div",{style:{display:"flex",flexDirection:"column"}},Ze(ce.default,{checked:n.last_imported_price,onChange:function(t){return s.onChangeSyncVariations("last_imported_price",t.target.checked)}},e("components.productVariationCard.lastExportPrice")),n.last_imported_price&&s.renderOptionSelectSync(o,l,"attributesToSyncLastImportedPrice"),i.use_price_at_counter&&Ze(ce.default,{checked:n.price_at_counter,onChange:function(t){return s.onChangeSyncVariations("price_at_counter",t.target.checked)}},"Gi\xe1 b\xe1n t\u1ea1i qu\u1ea7y"),d.ql_nhaphang&&(0,rt.rqq)(3,i)&&Ze(ce.default,{checked:n.wholesale_price2,onChange:function(t){return s.onChangeSyncVariations("wholesale_price2",t.target.checked)}},e("components.accessoriesSecondStep.wholesale")),Ze(ce.default,{checked:n.weight,onChange:function(t){return s.onChangeSyncVariations("weight",t.target.checked)}},s.props.currentShop.config_weight_product?e("components.productVariationCard.weightKg"):e("components.productVariationCard.weight")),a&&Ze(ce.default,{checked:n.limit_quantity_to_warn,onChange:function(t){return s.onChangeSyncVariations("limit_quantity_to_warn",t.target.checked)}},e("components.productCreatorSecondStep.limitToWarning")),Ze(ce.default,{checked:n.batch_position,onChange:function(t){return s.onChangeSyncVariations("batch_position",t.target.checked)}},e("pages.shop.product.variation.batchPosition")),Ze(ce.default,{checked:n.shelf_position,onChange:function(t){return s.onChangeSyncVariations("shelf_position",t.target.checked)}},e("pages.shop.product.variation.shelfPosition")),i.is_syncing_web&&Ze(ce.default,{checked:n.original_price,onChange:function(t){return s.onChangeSyncVariations("original_price",t.target.checked)}},e("pages.shop.product.variation.originalPriceOnWeb")),Ze(ce.default,{checked:n.retail_price,onChange:function(t){return s.onChangeSyncVariations("retail_price",t.target.checked)}},e("components.accessoriesSecondStep.retailPrice")),n.retail_price&&s.renderOptionSelectSync(o,u,"attributesToSyncPrice"),Ze("div",null,Ze(ce.default,{checked:n.images,onChange:function(t){return s.onChangeSyncVariations("images",t.target.checked)}},e("components.productTranferDetail.imageVideo"),Ze(et.Z,{tip:e("components.productVariationCard.tip")})),n.images&&s.renderOptionSelectSync(o,c,"attributesToSyncImage")),Ze(ce.default,{checked:n.size,onChange:function(t){return s.onChangeSyncVariations("size",t.target.checked)}},e("pages.shop.setting.printingForm.size")))})),(0,f.Z)((0,u.Z)(s),"renderTransferContent",(function(){var t=s.props,e=t.t,r=t.warehouses,n=s.state,o=n.transferVariation,i=n.loadingTransfer,c=function(t){return r.map((function(r){var n=r.name,o=r.full_address,a=r.id;return Ze(Ie,{key:a,value:a,disabled:a==t},"".concat(n," - ").concat(o||e("components.orderAdvanceFilter.noAddress")))}))},u=!o.from_warehouse_id||!o.to_warehouse_id||o.from_warehouse_id==o.to_warehouse_id;return Ze("div",{style:{display:"grid"},className:"crm-modal"},Ze("div",{style:{marginBottom:10,fontWeight:500}},e("components.productVariationCard.transferAllVariation")),Ze("div",{style:{display:"grid"}},Ze("span",{style:{fontWeight:500}},e("pages.shop.product.transfer.fromWarehouse")),Ze(R.default,{placeholder:e("components.productTranferDetail.selectWarehouse"),value:o.from_warehouse_id,style:{marginBottom:10,width:300},onChange:function(t){return s.handleWarehouseChange("from_warehouse_id",t)},dropdownClassName:"select-warehouse-dropdown"},c())),Ze("div",{style:{display:"grid"}},Ze("span",{style:{fontWeight:500}},e("pages.shop.product.transfer.toWarehouse")),Ze(R.default,{placeholder:e("components.productTranferDetail.selectWarehouse"),onChange:function(t){return s.handleWarehouseChange("to_warehouse_id",t)},value:o.to_warehouse_id,style:{marginBottom:10,width:300},dropdownClassName:"select-warehouse-dropdown"},c(o.from_warehouse_id))),Ze(a.default,{onClick:function(){return s.handleTransfer()},type:"primary",disabled:u,loading:i},"X\xe1c nh\u1eadn"))})),(0,f.Z)((0,u.Z)(s),"handleChangeSelectAtt",(function(t,e){s.setState({attributesQuickAddVariation:t,visible:!1}),s.autoCreateVariation(e&&e.length>0?e:[],t)})),(0,f.Z)((0,u.Z)(s),"renderTitleQuickAdd",(function(){var t=s.props,e=t.t,r=t.creator.product_attributes,n=s.state.attributesQuickAddVariation;return Ze("div",{id:"quick_add_variation",style:{display:"flex",alignItems:"center"}},Ze("span",{style:{marginRight:10}},e("components.productCreatorFirstStep.quickAddVariations")),Ze(R.default,{style:{flex:1},onChange:function(t){return s.handleChangeSelectAtt(t,r)},mode:"multiple",value:n,getPopupContainer:function(){return document.getElementById("quick_add_variation")}},r&&r.length>0?r.filter((function(t){return""!=t.name})).map((function(t,e){return Ze(Ie,{value:t.name,key:e},t.name)})):null))}));var l=t.creator,d=l.variations,p=l.id,m=t.warehouses,v=g()(d||[]);return v.forEach((function(t){t.variations_warehouses.length||(t.variations_warehouses=m.map((function(e){return{variation_id:t.id,warehouse_id:e.id,remain_quantity:0,batch_position:"",shelf_position:""}})))})),s.state={variationsData:v,previewVisible:!1,previewImage:"0",loadingTransfer:!1,cartesianProductOf:[],autoCreateVariation:null,textSearch:"",unSelectedKeys:[],currentEdit:null,isRemainSaving:!1,transferVariation:{product_id:p},isWhosaleSaving:!1,isAutoGen:!localStorage["isAutoGenCustomidVariation_shop_".concat(t.currentShop.id)]||JSON.parse(localStorage.getItem("isAutoGenCustomidVariation_shop_".concat(t.currentShop.id))),isCustomGenAuto:!!localStorage["is_custom_gen_variation_shop_".concat(t.currentShop.id)]&&JSON.parse(localStorage.getItem("is_custom_gen_variation_shop_".concat(t.currentShop.id))),attributesQuickAddVariation:[]},s}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){var t=this.props,e=t.updateProductCreator,r=t.creator,n=r.variations,o=r.product_attributes,a=t.shopId,i=JSON.parse(localStorage.getItem("syncVariations"));if(i){var c=o.map((function(t){return t.name}))||[];i=this.getAttributesToSync(i,c,"attributes_sync_images_shop_".concat(a)),i=this.getAttributesToSync(i,c,"attributes_sync_price_shop_".concat(a)),e({syncVariations:i=this.getAttributesToSync(i,c,"attributes_sync_last_imported_price_shop_".concat(a))})}0==n.length&&this.handleAddVariation()}},{key:"componentDidUpdate",value:function(t){var e=this.props.creator,r=e.variations,n=e.is_accessory,o=this.state.variationsData,a=0,i=0,c=[],s=[],u=[];o.map((function(t){a+=t.fields.length,t.fields.map((function(t){c.push(t)}))})),r.map((function(t){i+=t.fields.length,t.fields.map((function(t){s.push(t)}))})),c.length>0&&s.length>0&&c.map((function(t){u.push(s.findIndex((function(e){return e.name==t.name&&e.value==t.value&&(!e.keyValue&&!t.keyValue||e.keyValue&&t.keyValue&&e.keyValue==t.keyValue)})))})),a==i&&!u.includes(-1)&&de()(t.creator.is_accessory,n)||this.setState({variationsData:r})}},{key:"autoCreateVariation",value:function(t,e){var r=this;e||(e=t.map((function(t){return null===t||void 0===t?void 0:t.name})),this.setState({attributesQuickAddVariation:e})),e.length&&(t=t.filter((function(t){return e.includes(t.name)})));var n=[];t.map((function(t){if(t.values){var e=[];t.values.map((function(r){var n=(t.keyword||[]).find((function(t){return t.value==r.trim()}));e.push({id:(0,rt.uuG)(),name:t.name,value:r.toString().trim(),keyValue:(0,rt.Mle)((null===n||void 0===n?void 0:n.keyValue)||(null===n||void 0===n?void 0:n.value),!0).toUpperCase()})})),n.push(e)}}));var o=[];(0,rt.JIQ)(n).map((function(t,e){var n=null;t.map((function(t,e){r.state.variationsData.findIndex((function(e){return e.fields&&e.fields.find((function(e){return e.name.toString().trim()==t.name&&e.value.toString().trim()==t.value}))}))<0&&(n=-1)})),null==n&&(o.includes(e)||o.push(e))})),this.setState({unSelectedKeys:o,cartesianProductOf:(0,rt.JIQ)(n)})}},{key:"handleClick",value:function(t){this.autoCreateVariation(t),this.setState({autoCreateVariation:!0})}},{key:"onChangeSyncVariations",value:function(t,e){var r=this.props,n=r.updateProductCreator,o=ke({},r.creator.syncVariations);o[t]=e,localStorage.setItem("syncVariations",JSON.stringify(o)),n({syncVariations:o})}},{key:"onChangeCheckbox",value:function(t){var e=(0,i.Z)(this.state.unSelectedKeys);e.includes(t)?e=e.filter((function(e){return e!=t})):e.push(t),this.setState({unSelectedKeys:e})}},{key:"render",value:function(){var t=this,e=this.props,r=e.creator.product_attributes,n=e.t,o=e.currentShop,i=this.state,c=i.previewVisible,s=i.textSearch,u=i.isAutoGen,l=r&&r.length?r.filter((function(t){return t.values&&t.values.length})):[],d=o?(0,Zt.zE)(o.role):{},p=this.getVariationsColumns();return Ze("div",{className:"product-variations"},Ze("div",{className:"product-tools"},Ze("div",{style:{flex:8,position:"relative",display:"flex",alignItems:"center"}},Ze("div",null,Ze(A.default,{placeholder:n("components.productCreatorFirstStep.enterTheCodeSample"),style:{width:180,height:32},value:s,onChange:function(e){return t.onSearchVariation(e.target.value)},prefix:Ze(kt.Z,null),allowClear:!0})),Ze(N.default,{placement:"bottom",title:n("components.productCreatorSecondStep.syncAllCodeSamplesValues"),content:this.renderSyncContent(),trigger:"click"},Ze(a.default,{icon:Ze(me.Z,null),style:{marginLeft:12}},n("components.productCreatorFirstStep.sync"))),Ze(N.default,{placement:"bottom",title:n("pages.shop.product.management.tranferWarehouse"),content:this.renderTransferContent(),trigger:"click"},Ze(a.default,{icon:Ze(ge.Z,null),style:{marginLeft:12}},n("pages.shop.product.management.tranferWarehouse"))),Ze("span",{style:{marginLeft:12}},Ze(ce.default,{className:"checkbox-auto-gen-variation",checked:u,onChange:function(e){return t.checkAutoGenCustomidVariation(e.target.checked)}},n("components.productCreatorFirstStep.autoGenCustomidVariation")))),Ze("div",{style:{display:"flex"}},r.length>0&&d.create_product&&Ze(N.default,{placement:"top",title:this.renderTitleQuickAdd(),content:this.renderQuickAddContent(),trigger:"click"},Ze(a.default,{icon:Ze(ve.Z,null),onClick:function(){return t.handleClick(l)},style:{marginRight:12},type:"primary",ghost:!0},n("components.productCreatorFirstStep.quickAdd"))),d.create_product&&Ze(a.default,{onClick:this.handleAddVariation,type:"primary",icon:Ze(x.Z,null)},n("components.productCreatorFirstStep.createVariation")))),Ze(we.Z,{rowClassName:"editable-row",className:"editable-table",dataSource:this.getData(),columns:p,pagination:!1,scroll:{y:"calc(72vh - 50px)",x:100*p.length+((0,rt._sl)(o)?468:218)}}),this.styleModal(c),Ze("style",{dangerouslySetInnerHTML:{__html:be()}}))}}]),r}(v.Component))||te,Oe=(0,y.$j)((function(t){return{currentShop:t.shop.currentShop,creator:(0,nt.mz)(t),warehouses:(0,nt.op)(t),users:t.user.users,user:t.navigation.user}}),{updateProductCreator:ot.U3h,updateRemainQuantity:ot.ZP9,fetchProduct:ot.MXX,updateProductAction:ot.w6n})(Ve),De=r(83049),Ne=r(5823),Ae=r.n(Ne),Te=r(15118),Fe=r(84960),Re=r(28465),Ee=r(99562),ze=v.createElement;function je(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Me(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var qe,Be=A.default.TextArea,Le=function(t){(0,l.Z)(r,t);var e=Me(r);function r(t){var n;return(0,c.Z)(this,r),n=e.call(this,t),(0,f.Z)((0,u.Z)(n),"handleChangeCreateProduct",(function(t,e){var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?je(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},n.props.createProduct);r[t]=e,n.props.changeProductCreate(r)})),(0,f.Z)((0,u.Z)(n),"handlePreview",(function(t){n.setState({previewImage:t.response.content_url||t.thumbUrl,previewVisible:!0})})),(0,f.Z)((0,u.Z)(n),"handleChangeFiles",(function(t){var e=t.fileList;t.file;n.setState({fileList:e}),n.handleChangeCreateProduct("images",e)})),(0,f.Z)((0,u.Z)(n),"popoverImages",(function(){var t=n.props,e=t.accessToken,r=t.t,o=(t.createProduct,n.state.fileList);return ze(Re.Z,{action:"".concat((0,rt.LpH)(),"/contents?access_token=").concat(e),listType:"picture-card",accept:"image/*",multiple:!0,beforeUpload:function(t){return new Promise((function(e){var r=new FileReader;r.onload=function(){var n=new Image;n.onload=function(){t.width=n.width,t.height=n.height,e(t)},n.src=r.result},r.readAsDataURL(t)}))},data:function(t){return{file:t,width:t.width,height:t.height}},fileList:o,onPreview:n.handlePreview,onChange:n.handleChangeFiles},ze("div",null,ze(x.Z,null),ze("div",{className:"ant-upload-text"},r("components.productVariationCard.upload"))))})),n.state={previewVisible:!1,fileList:((t.facebookProduct?t.facebookProduct.images:[])||[]).map((function(t,e){return{uid:e,response:{content_url:t},status:"done",url:t}}))},n}return(0,s.Z)(r,[{key:"render",value:function(){var t=this,e=this.state.fileList,r=this.props,n=r.createProduct,o=r.t,a=r.createInFacebook,i=r.facebookProduct,c=this.props.product?this.props.product.custom_id:"";return ze("div",{className:"create-facebok-shop-product"},ze("div",{style:{display:"flex",backgroundColor:"white",padding:"15px"}},ze("div",{style:{width:200}},ze(N.default,{trigger:"click",overlayClassName:"image-container",content:this.popoverImages(),placement:"right"},ze("div",null,e[0]&&e[0].response?ze(Fe.ZP,{src:e[0].response.content_url,size:200,style:{borderRadius:2}}):ze(Fe.ZP,{icon:ze(Ee.Z,null),size:200,style:{borderRadius:2}})))),ze("div",{style:{width:300,marginLeft:"10px"}},ze("div",{className:"product-info"},ze("span",null,o("components.productCreatorFirstStep.productId"),"(*)"),ze(A.default,{placeholder:o("components.productCreatorFirstStep.autoCode"),defaultValue:a?c:i&&i.sku||"",prefix:ze(Y.Z,null),disabled:!0})),ze("div",{className:"product-info"},ze("span",null,o("components.productCreatorFirstStep.nameProduct"),"(*)"),ze(A.default,{prefix:ze(X.Z,null),placeholder:o("components.productCreatorFirstStep.nameProduct"),defaultValue:a?this.props.product.name:i&&""|i.name,disabled:!0})),ze("div",{className:"product-info"},ze("span",null,o("pages.shop.product.variation.retailPrice"),"(*)"),ze(A.default,{prefix:ze(X.Z,null),type:"text",placeholder:o("pages.shop.product.variation.retailPrice"),onChange:function(e){return t.handleChangeCreateProduct("price",e.target.value)},value:a?n.price:i&&i.price}))),ze("div",{style:{width:"calc(100% - 520px)",marginLeft:"10px"}},ze("span",null,ze("span",null,o("crm.description"),"(*)"),ze(Be,{style:{height:"86px"},onChange:function(e){return t.handleChangeCreateProduct("description",e.target.value)},value:a?n.description||"":i&&i.description.replace("undefined",""),showCounts:!0})))))}}]),r}(v.Component),We=v.createElement;function Ge(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function He(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ke(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var o=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}var Ue=h.Z.confirm,Je=(0,at.Z)()(qe=function(t){(0,l.Z)(r,t);var e=Ke(r);function r(t){var s;return(0,c.Z)(this,r),s=e.call(this,t),(0,f.Z)((0,u.Z)(s),"productInfo",(function(){var t=s.props,e=t.listTagsProducts,r=t.accessToken,n=t.shopId,o=t.materials;return We("div",null,We(ie,{accessToken:r,shopId:n,listTagsProducts:e,materials:o,isAutoGen:s.state.isAutoGen,checkCombos:function(t){return s.props.checkCombos(t)},checkPromotions:function(t){return s.props.checkPromotions(t)}}),We(Oe,{accessToken:r,shopId:n,autoGen:function(t){return s.setState({isAutoGen:t})}}))})),(0,f.Z)((0,u.Z)(s),"createProductFaceBookshop",(function(){var t=s.state,e=t.createFacebookshopProduct,r=t.openKey,n=(t.shopId,s.props),o=n.t,a=n.creator,c=n.currentShop,u=n.extension,l=r.replace("facebook@@@",""),d=a.variations,p=He({},a),f=(0,i.Z)(d);if(e.description&&e.price&&e.images){var h=e.images.map((function(t){return t.response.content_url})),m=f[0];m=He(He({},m),{},{images:[].concat((0,i.Z)(h),(0,i.Z)(m.images)),price:e.price}),f[0]=m,f=f.map((function(t){return t.description=e.description,t})),p.variations=f,(0,ot.cjs)({pageId:l,selectedProducts:[p],currentShop:c,extension:u})}else ye.Z.error(o("error"))})),(0,f.Z)((0,u.Z)(s),"createProductShopee",(function(){var t=s.state.createProduct,e=s.props,r=e.accessToken,n=e.shopId;(0,e.createShopeeProduct)(r,n,t,s.state.shopeeAccount).then((function(t){t.success?(s.setState({createInShopee:!1}),ye.Z.success("Th\xe0nh c\xf4ng","T\u1ea1o m\u1edbi s\u1ea3n ph\u1ea9m Shopee th\xe0nh c\xf4ng")):ye.Z.error("L\u1ed7i",t.message)}))})),(0,f.Z)((0,u.Z)(s),"handleClearSellingStatus",(function(){var t=s.props,e=t.accessToken,r=t.shopId,n=t.creator;s.setState({isClearSellingStatus:!0}),s.props.clearSellingStatus(e,r,n.id).then((function(t){s.setState({isClearSellingStatus:!1})}))})),(0,f.Z)((0,u.Z)(s),"handleHideProduct",(function(){var t=s.props,e=t.accessToken,r=t.shopId,n=t.creator,o=t.setVisible,a=t.getTotalRemainQuantityAndPrice,i=t.hideProduct,c=g()(n);s.setState({isHideProduct:!0});var u=!c.is_hide;c=He(He({},c),{},{is_hide:!c.is_hide}),i(e,r,[c.id],u).then((function(){o(!1),a(e,r,s.props.params),s.setState({isHideProduct:!1})}))})),(0,f.Z)((0,u.Z)(s),"modalTitle",(function(){var t=s.state,e=t.isLoading,r=t.isClearSellingStatus,i=t.isHideProduct,c=s.props,u=c.creator,l=c.creator,d=l.name,p=l.product_attributes,f=l.id,h=l.is_hide,m=c.t,g=c.timezone,v=p&&-1!=p?p.findIndex((function(t){return""==t.name})):-1,y=s.contentError();return We("div",{style:{display:"flex",justifyContent:"space-between"}},We("div",{style:{paddingTop:"10px",paddingBottom:"".concat(!s.state.create_in_shopee&&"Pos"!=s.state.openKey)?"5px":"0px"}},We("div",null,We(_.Z,null)," \xa0",m("containers.productCreator.productSetup")),u.inserted_at&&We("div",{style:{fontSize:14}},m("pages.shop.order.insertedAt"),": ",(0,rt.o0x)(g,u.inserted_at,!0))),We("div",{style:{padding:"10px 30px 10px 10px"}},f&&We(o.default,{title:m("containers.productCreator.".concat(h?"openProducts":"hideProduct"))},We(a.default,{icon:We(i?b.Z:h?S.Z:w.Z,null),onClick:function(){return s.handleHideProduct()}})),f&&We(o.default,{title:m("pages.shop.product.variation.clearSellingStatus")},We(a.default,{icon:We(r?b.Z:C.Z,null),onClick:function(){return s.handleClearSellingStatus()},disabled:r,style:{marginLeft:10}})),!s.state.createInShopee&&"Pos"==s.state.openKey&&We(a.default,{type:"primary",style:{marginLeft:10},onClick:function(){return d&&-1==v?s.handleSave():n.default.warning(y)},disabled:e},We(Z.Z,null),m("save")),s.state.create_in_shopee&&"Pos"!=s.state.openKey&&We(a.default,{type:"primary",style:{marginLeft:10},onClick:function(){return s.createProductShopee()}},We(Z.Z,null)," ",m("containers.productCreator.addNewProduct")," ",s.state.openKey.startsWith("facebook@@@")?"Facebook":"Shopee"),s.state.createInFacebook&&"Pos"!=s.state.openKey&&We(a.default,{type:"primary",style:{marginLeft:10},onClick:function(){return s.createProductFaceBookshop()}},We(Z.Z,null)," ",m("containers.productCreator.addNewProduct")," ",s.state.openKey.startsWith("facebook@@@")?"Facebook":"Shopee")))})),(0,f.Z)((0,u.Z)(s),"contentError",(function(){var t=s.props,e=t.creator,r=e.name,n=e.product_attributes,o=t.t,a=n&&-1!=n?n.findIndex((function(t){return""==t.name})):-1,i="";return r||(i+=o("components.productCreatorFirstStep.nameProduct")+", "),-1!=a&&(i+=o("components.productCreatorFirstStep.attributeName")),i+" "+o("containers.productCreator.contentErr")})),(0,f.Z)((0,u.Z)(s),"customizer",(function(t,e){if(!t.length&&!e.length)return!1;var r=[],n=[];t.map((function(t){r.push({name:t.name,value:t.value})})),e.map((function(t){n.push({name:t.name,value:t.value})}));var o=!0;return r.length==n.length?r.map((function(t){-1==n.findIndex((function(e){return e.name==t.name&&e.value==t.value}))&&(o=!1)})):o=!1,o})),(0,f.Z)((0,u.Z)(s),"handleSave",(function(){var t=s.props,e=t.accessToken,r=t.creator,n=t.shopId,o=t.createProduct,a=t.setVisible,i=t.updateProduct,c=t.getTotalRemainQuantityAndPrice,u=t.clearProductCreator,l=t.handleCallback,d=g()(r);s.setState({isLoading:!0},(function(){setTimeout((function(){if(d.id){if(localStorage.getItem("columnsProduct")){var t=JSON.parse(localStorage.getItem("columnsProduct")).checkedListProduct.includes("promotion");d=He(He({},d),{},{is_promotion:t})}i(e,n,d).then((function(t){s.setState({isLoading:!1}),t&&(a(!1),c(e,n,s.props.params))}))}else o(e,n,d).then((function(t){t&&(u(),a(!1)),l&&l(t),s.setState({isLoading:!1,tab_key:"general"})})).catch(s.handleSetDraft())}))}))})),(0,f.Z)((0,u.Z)(s),"handleSetDraft",(function(){var t=s.props.currentShop;if(s.props.creator){var e=s.props.creator,r=e.name,n=e.product_attributes,o=e.category_ids,a=e.custom_id,i=e.display_id,c=e.variations;"undefined"!==typeof Storage&&(localStorage["creator_product_shop_".concat(t.id)]&&localStorage.removeItem("creator_product_shop_".concat(t.id)),(r||n.length>0||o.length>0||a||c&&c.length>1)&&!i&&(c&&c.length&&c.map((function(t){var e=t.images.findIndex((function(t){return"error"==t.status}));-1==e||t.images.splice(e,1)})),localStorage.setItem("creator_product_shop_".concat(t.id),JSON.stringify(s.props.creator))))}})),(0,f.Z)((0,u.Z)(s),"onCancelModal",(function(){s.handleSetDraft(),s.setState({tab_key:"general",tab_shopee_key:"info"}),s.props.setVisible(!1),s.props.clearPromotionAndComboByProduct(),s.setState({createInShopee:!1,openKey:"Pos",shopeeAccount:void 0,create_in_shopee:!1,createProduct:void 0,tempShopeeProduct:void 0,tempFacebooklProduct:void 0,createInFacebook:!1})})),(0,f.Z)((0,u.Z)(s),"onOpenModal",(function(){var t=s.props,e=t.t,r=t.setVisible,n=t.clearProductCreator,o=t.shopId,a=t.updateProductCreator;localStorage.getItem("creator_product_shop_".concat(o))?Ue({title:e("containers.productCreator.alert"),content:e("containers.productCreator.content"),okText:e("containers.productCreator.continous"),cancelText:e("containers.productCreator.delete"),onOk:function(){if(localStorage["creator_product_shop_".concat(o)]){var t=JSON.parse(localStorage.getItem("creator_product_shop_".concat(o)));a(t),r(!0)}},onCancel:function(){r(!0),n(),localStorage.removeItem("creator_product_shop_".concat(o))}}):(s.props.setVisible(!0),s.props.clearProductCreator(),s.props.clearShopeeProduct())})),(0,f.Z)((0,u.Z)(s),"onChangeOpenkey",(function(t){s.setState({shopeeAccount:void 0,create_in_shopee:!1,createProduct:void 0,createInFacebook:!1},(function(){if("Pos"==t)s.setState({openKey:t,tempShopeeProduct:void 0,tempFacebooklProduct:null});else if(t.startsWith("facebook@@@")){var e=t.replace("facebook@@@",""),r=s.props.facebookShopProductByPos,n=r.find((function(t){return t.marketplace_shop_id==e}))&&s.props.creator.id?r.find((function(t){return t.marketplace_shop_id==e})):void 0;s.setState({tempFacebooklProduct:n});var o=!n,a=n?null:{name:s.props.creator.name,custom_id:s.props.creator.custom_id,tier:s.props.creator.product_attributes||[],variations:s.props.creator.variations||[]};s.setState({openKey:t,createInFacebook:o,createFacebookshopProduct:a})}else{var i=s.props,c=(i.creator,i.accessToken,i.shopId,i.currentShop.shopee_account.find((function(e){return e.shopee_shop_id+""==t+""}))),u=s.props.shopeeProductByPos.find((function(e){return e.shopee_id+""==t+""}))&&s.props.creator.id?s.props.shopeeProductByPos.find((function(e){return e.shopee_id+""==t+""})).product:void 0,l=s.props.shopeeProductByPos.find((function(e){return e.shopee_id+""==t}))&&s.props.creator.id?s.props.shopeeProductByPos.find((function(e){return e.shopee_id+""==t+""})).attributes:void 0;s.setState({tempShopeeProduct:u,tempShopeeAtt:l});var d=!u,p=u?void 0:{name:s.props.creator.name,custom_id:s.props.creator.custom_id,tier:s.props.creator.product_attributes||[],variations:s.props.creator.variations||[]};s.setState({openKey:t,shopeeAccount:c,create_in_shopee:d,createProduct:p})}}))})),(0,f.Z)((0,u.Z)(s),"changeFacebookProductCreate",(function(t){s.setState({createFacebookshopProduct:t})})),(0,f.Z)((0,u.Z)(s),"renderFacebookCreateFroduct",(function(){var t=s.props,e=t.t,r=t.accessToken,n=t.currentShop,o=s.state.createFacebookshopProduct;return We("div",null,We(Le,{accessToken:r,t:e,changeProductCreate:s.changeFacebookProductCreate,createProduct:o,product:s.props.creator,createInFacebook:s.state.createInFacebook,facebookProduct:s.state.tempFacebooklProduct}),We("div",{style:{marginTop:"20px"}},We(Te.Z,{shopeeProduct:s.state.tempFacebooklProduct,currentShop:n,product:s.props.creator,createInShopee:s.state.createInFacebook,createProduct:s.state.createFacebookshopProduct})))})),s.state={isLoading:!1,tab_key:"general",tab_shopee_key:"info",openKey:"Pos",createProduct:{name:"",custom_id:""},createFacebookshopProduct:{name:"",custom_id:"",description:"",price:0},isAutoGen:!0},s}return(0,s.Z)(r,[{key:"componentWillUnmount",value:function(){(0,ot.zWK)()}},{key:"componentDidMount",value:function(){var t=this,e=this.props,r=e.updateProductCreator,n=e.creator,o=e.shopId,a=g()(n);if(window.addEventListener("beforeunload",(function(e){var r=t.props.creator,n=r.name,a=r.product_attributes,i=r.category_ids,c=r.custom_id,s=r.display_id,u=r.variations;e.preventDefault(),"undefined"!==typeof Storage&&(localStorage["creator_product_shop_".concat(o)]&&localStorage.removeItem("creator_product_shop_".concat(o)),(n||a.length>0||i.length>0||c||u&&u.length>1)&&!s&&(u&&u.length&&u.map((function(t){var e=t.images.findIndex((function(t){return"error"==t.status}));-1==e||t.images.splice(e,1)})),localStorage.setItem("creator_product_shop_".concat(o),JSON.stringify(t.props.creator))))})),localStorage.getItem("isImportQuantityZero")){var i=JSON.parse(localStorage.getItem("isImportQuantityZero"));r(a=He(He({},a),{},{isImportQuantityZero:i}))}if(localStorage.getItem("notCreateTransaction")){var c=JSON.parse(localStorage.getItem("notCreateTransaction"));r(a=He(He({},a),{},{notCreateTransaction:c}))}localStorage["isAutoGenCustomidVariation_shop_".concat(o)]&&this.setState({isAutoGen:JSON.parse(localStorage.getItem("isAutoGenCustomidVariation_shop_".concat(o)))})}},{key:"render",value:function(){var t=this.state.isLoading,e=this.props,r=e.visible,n=e.t,o=e.permission,a=(e.currentShop,e.pages,e.shopId,e.content);return We("div",{style:{display:"inline "}},r&&We(h.Z,{onCancel:this.onCancelModal,style:{top:60},maskClosable:!1,visible:r,width:"95%",wrapClassName:"product-creator-modal",title:this.modalTitle(),footer:!1},t?We("div",{style:{fontSize:16,width:"100%",marginTop:20,textAlign:"center"}},We(b.Z,{style:{fontSize:18,color:"#096dd9"}})," ",n("containers.productCreator.savingProduct")):We("div",{style:{display:"flex",flexDirection:"row",height:"100%"}},"Pos"==this.state.openKey&&We("div",{className:"steps-container",style:{flex:1}},this.productInfo()),this.state.openKey&&this.state.openKey.startsWith("facebook@@@")&&We("div",{className:"steps-container",style:{flex:1}},this.renderFacebookCreateFroduct()))),o&&We(De.Z,{icon:We(x.Z,null),title:n("containers.productCreator.addNewProduct"),onClick:this.onOpenModal,content:a}),We("style",{dangerouslySetInnerHTML:{__html:Ae()}}))}}]),r}(v.Component))||qe,Qe=(0,y.$j)((function(t){return He(He({creator:(0,nt.mz)(t),currentShop:t.shop.currentShop,shopeeProduct:t.product.shopeeProduct},(0,nt.$L)(t)),{},{pages:t.shop.pages,extension:t.shop.extension,materials:t.product.materials.filter((function(t){return!t.is_removed})),listTagsProducts:(t.product.product_tags||[]).filter((function(t){return!t.is_removed})),timezone:t.navigation.user.timezone})}),{createProduct:ot.ryh,clearProductCreator:ot.bbR,updateProduct:ot.nMh,getTotalRemainQuantityAndPrice:ot.KcS,updateProductCreator:ot.U3h,clearShopeeProduct:ot.ntZ,createShopeeProduct:ot.qU5,fetchShopeeProduct:ot.zNg,clearPromotionAndComboByProduct:ot.V3S,clearSellingStatus:ot.OqG,hideProduct:ot.MHL})(Je)}}]);